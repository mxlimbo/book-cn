<HTML>
<HEAD>
<TITLE>Fields</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch04b.htm", "ch04d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="120"><H1>Fields</H1></A>

<P>Fields are named variables where Outlook stores the data for your 
application. A number of built-in fields store default information. These built-in fields 
are associated with folders and their default content type. For example, in a 
Contacts folder, built-in fields include First Name, Last Name, Mailing Address, 
and Primary Phone. In your Inbox, built-in fields include From, To, Subject, 
and Message. Outlook also supports Office document properties as fields. For 
more information on using Office document properties as fields, see the section 
titled &quot;<A HREF="ch05i.htm#187">Extending Functionality with Office Document Forms</A>&quot; in <A HREF="ch05a.htm">Chapter 5</A>.</p>

<P>Outlook provides an extensive amount of built-in fields, but there will 
be many times when you need to add custom fields for your application. 
Outlook fully supports this capability and allows you to add custom fields to any 
folder. Your custom fields can range from a simple data type, such as a text field, to 
a complex data type, such as a formula field that includes a formula to 
calculate the value of the field from other Outlook fields.</p>

<A NAME="121"><H2>Creating Custom Fields</H2></A>

<P>The easiest way to create and delete custom fields in Outlook is to use the 
Field Chooser. The Field Chooser allows you to see both the built-in Outlook 
fields and your custom fields. The easiest way to access the Field Chooser is to 
select a table view in your folder, such as any of the default Outlook views that begin 
with the word <I>By</I>. For example, in your calendar, you can switch your view to the 
By Category view. After selecting a table view, right-click on the column 
headings and select Field Chooser from the context menu, as shown in Figure 
4-9.</p>

<P>
<A HREF="javascript:fullSize('f04oh09x.htm')"> <img src="images/f04oh09.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 4-9</B> <I>Select the Field Chooser from the context menu for a table view.</I><!-- /CAPTION -->
</p>

<P>To create the new field, click the New button, enter a name and data 
type for the field, and select the appropriate format. The following is a list of 
possible data types for fields in Outlook and the type of formatting these fields support:</p>

<UL>
<P><LI><i>Text.</I> This field type can hold text strings or a combination of 
text strings and numbers, such as a mailing address. It can be up to 
255 characters long.</li></p>

<P><LI><i>Number</I>. Use this type of field for numeric data (except 
numbers that represent currency) and for mathematical calculations. You 
can customize the format of this field with nine different formats, 
such as a scientific notation format (125.3E+03).</li></p>

<P><LI><i>Percent.</I> Store numeric data that is a percentage here. You can 
choose from four different formats. For example, you can set how many 
decimal places to show in the percentage, such as show only one 
decimal place (10.9%).</li></p>

<P><LI><i>Currency.</I> Store numeric data represented as currency here. You 
can format this data type to either show or hide the cents portion 
of the currency. For example, you can have this data type show 
either $5,232 or $5,232.10.</li></p>

<P><LI><i>Yes/No.</I> This field stores data that holds only one of two values 
for the following pairs of values: Yes/No, True/False, On/Off, or 
a checked or unchecked check box.</li></p>

<P><LI><i>Date/Time.</I> Store date and time data here. You can format this 
field with a number of standard formats, such as Monday, May 05, 
1998 7:00 AM; 5/5/98 7:00 AM; May 5, 1998; or Mon 5/5/1998.</li></p>

<P><LI><i>Duration.</I> This field is for numeric time data represented as 
an amount of time elapsed. You can expose the data in this field in 
several formats, such as 12h or 12 hours. This field automatically 
calculates when the data in the field should be displayed as days, hours, 
or minutes. For example, if you set the format for this field as &quot;12 hours&quot; and you enter <I>.25</I>, Outlook automatically displays 15 minutes. 
You can also set the format so that Outlook takes into account only 
working hours. (By default, that means an 8-hour day, but you can 
customize the default.)</li></p>

<P><LI><i>Keywords.</I> This data type is used to hold multiple text values 
(which are separated by commas) and is similar to the Categories field 
used in Outlook. When creating custom views, keywords can be used 
to identify items. Examples of keyword field values are 
<I>small, medium, </I>and<I> large</I>.</li></p>

<P><LI><i>Combination.</I> This data type holds a combination of fields and 
literal text. You can show each field or only the first nonempty 
field. The fields created with this data type are read-only in Outlook. 
For more information on creating combination fields, see the next 
section, titled &quot;<A HREF="ch04c.htm#122">Creating Combination Fields</A>.&quot;</li></p>

<P><LI><i>Formula.</I> This data type holds the results of formulas you 
create. You can use the Microsoft Visual Basic expression service that is 
built into Outlook to create functions and operators for your 
formula. The fields created with this data type are read-only in Outlook. 
For more information on creating formula fields, see the section 
titled &quot;<A HREF="ch04c.htm#123">Creating Formula Fields</A>&quot; later in this chapter.</li></p>

<P><LI><I>Integer.</I> This data type holds nondecimal numeric information. 
You can customize the format to be only numbers, such as 3,332, or 
to be &quot;computer&quot; numbers formatted as kilobytes, megabytes, 
and gigabytes.</li></p>
</UL>

<A NAME="122"> <H2>Creating Combination Fields</H2></A>

<P>You can combine values from other fields with literal strings to create a new 
field, called a combination field. Combination fields are useful when you have 
many different types of fields and want to create a single field that combines them 
all. You can also use a combination field when you have multiple fields that 
hold conflicting data and you want to display only one of the fields in your form. 
Here's how you would create a combination field from two fields and a text fragment:</p>

<OL>
<P><LI>In your Inbox, open the Field Chooser and click New.</li></p>

<P><LI>Enter a name for the field, such as <I>My Follow-Up Field</I>, and select Combination as the type of field.</li></p>

<P><LI>Click Edit.</li></p>

<P><LI>You have the choice to either join fields and text fragments 
together to create a combination field or show only the first nonempty 
field and ignore all the subsequent fields. Select the Joining Fields 
And Any Text Fragments To Each Other option.</li></p>

<P><LI>Type <I>Need</I> in the Formula box.</li></p>

<P><LI>Click the Field button, point to Frequently-Used Fields, and 
then click Follow Up Flag.</li></p>

<P><LI>Type <I>By</I> in the Formula box.</li></p>

<P><LI>Click the Field button, point to Frequently-Used Fields, and 
then click Due By.</li></p>

<P><LI>Click OK twice.</li></p>

<P><LI>Drag and drop this new field from the Field Chooser onto your 
Inbox column headings. You should see something similar to Figure 4-10.</li></p>
</OL>

<P>Use a combination field when you want to expose a primary value for 
a specific field but also need the option to expose a field that holds a 
secondary value if the primary value is not available. If the primary value is available, 
you do not want to display the secondary value. For example, in our 
Document Library application, users can drag and drop Office documents into the 
public folder. Outlook can expose the properties of these office documents as 
fields. In the Outlook view, we want to expose the document author, but because 
users are not required to fill this property in when designing or saving the 
document, the Author property could be left blank. If the Author property is left 
blank, we want to use the From field in Outlook to display the name of the user 
who dragged and dropped the document into the folder. Follow the steps below to create the combination field that shows the first nonempty field.</p>

<P>
<A HREF="javascript:fullSize('f04oh10x.htm')"> <img src="images/f04oh10.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 4-10</B> <I>Two different fields are combined to create a single combination field.</I><!-- /CAPTION -->
</p>

<OL>
<P><LI>Go to the Document Library folder you created, and open the 
Field Chooser.</li></p>

<P><LI>Click New.</li></p>

<P><LI>Type a name for the field, such as <I>Document Author</I>.</li></p>

<P><LI>Select Combination as the field type.</li></p>

<P><LI>Click Edit.</li></p>

<P><LI>Select the option named Showing Only The First Non-Empty 
Field, Ignoring Subsequent Ones.</li></p>

<P><LI>Click the Field button, point to All Document Fields, and 
click Author.</li></p>

<P><LI>Click the Field button, point to All Mail Fields, and click From.</li></p>

<P><LI>Click OK twice.</li></p>

<P><LI>Drag and drop your new field from the Field Chooser onto the 
view column headings. You should see a view similar to the one shown 
in Figure 4-11.</li></p>

<P>
<A HREF="javascript:fullSize('f04oh11x.htm')"> <img src="images/f04oh11.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 4-11</B> <I>You can use combination fields to show the first nonempty value from multiple Outlook fields.</I><!-- /CAPTION -->
</p>

</OL>

<A NAME="123"><H2>Creating Formula Fields</H2></A>

<P>Formula fields allow you to use functions to calculate values from both 
standard and custom fields. These calculated values are stored inside of the 
formula field. Use formula fields when you need to calculate the value of one field 
based on other fields in your application. For example, you can use a formula field 
to calculate the total of an expense report or a person's wage based on the 
amount of time they worked multiplied by their hourly rate. Outlook makes 
creating formula fields quite easy by offering a simple interface for field selection and 
by displaying a list of all possible formulas and required inputs. You can use 
the provided Field and Function buttons to quickly select the fields and 
functions you want to use in your formula. Outlook will automatically parse your 
formula and check it for syntactical errors.</p>

<P>Formula fields do have some performance implications. First, Outlook 
has to process formula fields whenever values change in the application. The 
more complex you make your formulas, the longer Outlook will take to process 
them. Second, Outlook automatically recalculates formula fields whenever the 
current view changes. Third, Outlook does not allow you to sort, group, or filter 
views by using formula fields.</p>

<P>Follow these steps to create a formula field that displays the amount of 
time elapsed since an item was received. Figure 4-12 shows a custom formula field.</p>

<OL>
<P><LI>In the Field Chooser, click New.</li></p>

<P><LI>Type a name for your new field, such as <I>Days since received.</I></li></p>

<P><LI>Select Formula from the Type drop-down list.</li></p>

<P><LI>Click the Edit button.</li></p>

<P><LI>In the Formula box, type this:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
<I>IIF(DateDiff(&quot;d&quot;,[Received],Now())&gt;=7,
DateDiff(&quot;w&quot;,[Received],Now()) &amp; &quot; week(s) ago&quot;,
DateDiff(&quot;d&quot;,[Received],Now()) &amp; &quot; day(s) ago&quot;)</I>
</PRE></TD></TR></TABLE></P>

<P><LI>Click OK twice.</li></p>

<P><LI>Drag and drop the new field onto your view column headings. 
You should see the field automatically calculate. If the item was 
received within one week, the field displays the amount in days. If the 
item was received more than a week ago, the field displays the 
amount in weeks.</li></p>

<P>
<A HREF="javascript:fullSize('f04oh12x.htm')"> <img src="images/f04oh12.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 4-12</B> <I>A custom formula field in an Outlook view.</I><!-- /CAPTION -->
</p>

</OL>

<A NAME="124"><H2>Using Custom Fields in Filtered Replication</H2></A>

<P>As you learned in Part I, Outlook and Exchange Server support 
synchronizing items offline. By default, Outlook synchronizes all the items from the server 
to your offline database. But what if you don't want to synchronize 
<I>all</I> the server items offline? As you learned in <A HREF="ch02a.htm">Chapter 2</A>, Outlook offers the capability 
to synchronize subsets of information, called filtered replication. You select 
the parameters&#8212;either built-in or custom fields&#8212;that Outlook will use to 
filter the synchronized items. To set up filtered replication, follow these steps:</p>

<OL>
<P><LI>Before setting filtered replication, you should add a custom 
property to the Account Tracking application by selecting the previously 
created Account Tracking folder, which is nested in the Favorites folder.</li></p>

<P><LI>In the Field Chooser, click New.</li></p>

<P><LI>Type <I>txtAccountSalesRep</I> in the Name box, and select Text as 
the type.</li></p>

<P><LI>Click OK.</li></p>

<P><LI>From the File menu, point to the Folder option, and then 
select Properties For Account Tracking.</li></p>

<P><LI>Click on the Synchronization tab. In the This Folder Is Available 
area, make sure that the When Offline Or Online option is selected.</li></p>

<P><LI>Click the Filter button.</li></p>

<P><LI>In the Filter dialog box, click on the Advanced tab.</li></p>

<P><LI>Click the Field button, point to User-Defined 
Fields In Folder, and click txtAccountSalesRep.</li></p>

<P><LI>From the Condition drop-down list, select Is (Exactly). In the 
Value text box, type the name of a user of the Account Tracking application.</li></p>

<P><LI>Click the Add To List button to add your criteria. Your screen 
should look like Figure 4-13.</li></p>

<P>
<A HREF="javascript:fullSize('f04oh13x.htm')"> <img src="images/f04oh13.JPG" width=404 height=302 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 4-13</B> <I>The Filter dialog box, showing synchronization information for the Account Tracking application.</i><!-- /CAPTION -->
</p>

<P><LI>Click OK, click Yes, and then click OK twice. Now only the 
items meeting your criteria will be synchronized to your offline database.</li></p>
</OL>

<P>Figure 4-14 shows the folder before setting filtered replication and 
after setting filtered replication. As you can see, a subset of the information in 
the folder is available to the client offline.</p>

<P>
<A HREF="javascript:fullSize('f04oh14x.htm')"> <img src="images/f04oh14.JPG" width=404 height=376 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 4-14</B> <I>The Account Tracking folder before filtered replication, and the Account Tracking folder after filtered replication. Notice how a subset of items are synchronized offline.</I><!-- /CAPTION -->
</p>

</BODY>
</HTML>






