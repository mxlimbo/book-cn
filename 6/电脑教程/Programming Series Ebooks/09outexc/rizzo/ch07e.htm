<HTML>
<HEAD>
<TITLE>Outlook Today and the Account Tracking Application</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch07d.htm", "ch08a.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="234"><H1>Outlook Today and the Account Tracking Application</H1></A>

<P>Users have a secondary way to interact with the Account Tracking 
application&#8212; through a customized Outlook Today page. Outlook Today is discussed 
more in <A HREF="ch08a.htm">Chapter 8</A>, but here is an overview. Microsoft Outlook 98 includes a 
feature that takes advantage of the HTML support in Outlook. This feature, 
Outlook Today, allows users to view all their information in one HTML window 
rather than as separate modules. You can customize Outlook Today's HTML code 
so that you can provide your Outlook or intranet information in a single 
window view as well.</p>

<p>When customized for the Account Tracking application, Outlook 
Today allows users to quickly create new accounts; find account contacts; and open 
the Account Tracking folder to see how many accounts, tasks, and contacts 
are contained there. The customized Outlook Today page is shown in Figure 7-12.</p>

<p>
<A HREF="javascript:fullSize('f07oh12x.htm')"> <img src="images/f07oh12.JPG" width=404 height=259 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 7-12</B> <I>The customized Outlook Today page in the Account Tracking application. Notice how users can quickly create or find information pertaining to their accounts right from this page.</I><!-- /CAPTION -->
</p>

<A NAME="235"><H2>Viewing the Customized Outlook Today Page</H2></A>

<P>The customized Outlook Today page for the Account Tracking 
application shows you how you can use your VBScript and Outlook object library skills 
in another medium, HTML. The code in the customized Outlook Today page 
uses the Outlook object library to count the number of items in the account 
folder as well as search the folder for specific account contacts. The following code 
is taken from the Account.htm file, which is the Outlook Today page 
customized for the Account Tracking application:</p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
&lt;script language=&quot;VBScript&quot;&gt;

'******************************************************
'In-line code
'
'These lines of code are run when the browser reaches
'them while parsing the document. They set up the global
'variables that are needed throughout the application.
'******************************************************
Set oApplication = window.external.OutlookApplication
Set oNS = oApplication.GetNameSpace(&quot;MAPI&quot;)

'Change this to your location for the Account Tracking Folder
set oAccountFolder = oNS.Folders(&quot;ExBook&quot;).Folders(&quot;Account Tracking&quot;)

'******************************************************
'Sub FindAccountContact
'
'This subroutine takes the name of the contact that the
'user types into the Outlook Today page and searches the
'contact folder for the contact. If the contact is
'found, it displays the contact. If the contact is not
'found, it displays a message box.
'******************************************************
Sub FindAccountContact(ContactName)
    if ContactName &lt;&gt; &quot;&quot; then
        boolFound = 0
        RestrictString = &quot;&quot;
        RestrictString = &quot;[Message Class] = &quot; _
            &quot;&quot;&quot;IPM.Contact.Account contact&quot;&quot;&quot;
        Set oContacts = _
            oAccountFolder.Items.Restrict(RestrictString)
        for i = 1 to oContacts.Count
            set oContact = oContacts.Item(i)
            if oContact.FullName = ContactName then
                oContact.Display()
                boolFound = 1
                exit for
            end if
        next
        if boolFound = 0 then
            msgbox &quot;No contact by that name was found&quot;,, _
                &quot;Find Account Contact&quot;
        end if
    end if
End Sub

'******************************************************
'Sub CreateAccount
'
'This subroutine creates a new Account info form and
'displays it for the user to fill in
'******************************************************
Sub CreateAccount()
    set oAccount = oAccountFolder.Items.Add(&quot;IPM.Post.Account info&quot;)
    oAccount.Display()
End Sub

'******************************************************
'Sub DisplayAccountFolder
'
'This subroutine finds and displays the Account Tracking
'folder in a separate Outlook window. The reason for this
'is to create a new Explorer object separate from the
'current Explorer object in Outlook Today.
'******************************************************
Sub DisplayAccountFolder()
    'Change this location to your folder location
    set oFolder = oNS.Folders(&quot;ExBook&quot;).Folders(&quot;Account Tracking&quot;)
    oFolder.Display()
End Sub

'******************************************************
'Sub GetAccountFolderCounts
'
'This subroutine calculates how many accounts, contacts,
'and tasks are in the Account Tracking folder and
'displays this information
'******************************************************
Sub GetAccountFolderCounts()
    RestrictString = &quot;&quot;
    RestrictString = &quot;[Message Class] = &quot;&quot;IPM.Post.Account info&quot;&quot;&quot;
    Set oAccounts = oAccountFolder.Items.Restrict(RestrictString)
    oAcctCount = oAccounts.Count
    AccountCount.innerHTML = oAcctCount &amp; &quot; Accounts&quot;
    
    RestrictString = &quot;&quot;
    RestrictString = &quot;[Message Class] = &quot; _
        &quot;&quot;&quot;IPM.Contact.Account contact&quot;&quot;&quot;
    Set oContacts = oAccountFolder.Items.Restrict(RestrictString)
    oContactCount = oContacts.Count
    ContactCount.innerHTML = oContactCount &amp; &quot; Contacts&quot;

    RestrictString = &quot;&quot;
    RestrictString = &quot;[Message Class] = &quot;&quot;IPM.Task&quot;&quot;&quot;
    Set oTasks = oAccountFolder.Items.Restrict(RestrictString)
    oTasksCount = oTasks.Count
    TaskCount.innerHTML = oTasksCount &amp; &quot; Tasks&quot;
end Sub
&lt;/script&gt;
</PRE></TD></TR></TABLE></P>

<A NAME="236"><H2>Setting Up the Customized Outlook Today Page</H2></A>

<P>You need to modify the Outlook Today page so that it knows the location 
of the Account Tracking folder and also modify your Registry to point 
Outlook at the customized Outlook Today page. If you want to deploy the 
customized Outlook Today page to users in your organization, consider writing a 
simple Visual Basic program that modifies their Registries and points them to a 
web server containing the customized Outlook Today page. If you have not 
deployed Outlook to your organization yet, you can use the Outlook 98 Deployment 
Kit to set the default location for the Outlook Today page.</p>

<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>
The Deployment Kit is not currently available for 
download or retail purchase. However, the Deployment Kit documentation 
is available at <I><A HREF="http://www.microsoft.com/office/98/outlook/documents/O98DKdoc.htm" TARGET="_window2">http://www.microsoft.com/office/98/outlook/documents/O98DKdoc.htm</A></I>
</BLOCKQUOTE></DIV></P>

<P>The following steps show you how to modify the Outlook Today page and 
your Registry for the Account Tracking application:</p>

<OL>
<P><LI>On the companion CD, open the file named Account.htm in a 
text editor such as Notepad.</li></p>

<P><LI>Change the line</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
set oAccountFolder = oNS.Folders(&quot;ExBook&quot;).Folders( _
    &quot;Account Tracking&quot;)
</PRE></TD></TR></TABLE></P>

<P>so that it reflects the location of the Account Tracking folder. 
For example, if you copied the Account Tracking folder into the 
main tree of your Public Folder hierarchy, the code would look like this:</p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
set oAccountFolder = oNS.Folders(&quot;Public Folders&quot;).Folders( _
    &quot;All Public Folders&quot;).Folders(&quot;Account Tracking&quot;)
</PRE></TD></TR></TABLE></P>

<P><LI>Modify the following line so that it reflects the location where 
you copied the Account Tracking folder:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
set oFolder = oNS.Folders(&quot;ExBook&quot;).Folders(&quot; _
    Account Tracking&quot;)
</PRE></TD></TR></TABLE></P>

<P><LI>Save the file to your hard drive to keep your changes.</li></p>
</OL>

<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>
The general instructions for modifying the Registry 
are given here, but for detailed instructions, follow steps described in <A HREF="ch08a.htm">Chapter 8</A>, in the section titled &quot;<A HREF="ch08b.htm#242">Modifying the Registry</A>.&quot; When the procedure asks you for the URL, specify the 
location where you saved the Account.htm file.
</BLOCKQUOTE></DIV></P>

<P>To modify the Registry for the customized Outlook Today page, add the 
following key to the Registry:</p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Outlook\Today
</PRE></TD></TR></TABLE></P>

<P>Add a new string value to the Today key named 
<I>Url</I>. For its value data, type the path to the Account.htm. For example, 
file://C:\Account.htm<I>.</I> When finished, click the Outlook Today icon in Outlook to display your customized Outlook Today page.</p>

</BODY>
</HTML>






