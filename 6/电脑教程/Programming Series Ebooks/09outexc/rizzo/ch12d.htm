<HTML>
<HEAD>
<TITLE>Setting Up the Event Service</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12c.htm", "ch12e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="409"><H1>Setting Up the Event Service</H1></A>

<P>Before starting to work with the Event Service and writing agents, you first 
must install the service and get it running correctly in your environment. By 
default, the Event Service is installed when you install Exchange Server 5.5. 
However, if you are upgrading from a previous version of Exchange Server, you will 
need to add the Event Service during installation.</P>
<P>By default, the Event Service logs on using the credentials of the 
Exchange Service Account. While this account has permission to access many of the 
items stored in the Exchange Server, it has very limited Windows NT permissions. 
You might want to change the Windows NT account under which the Event 
Service runs to change the access this account has and to audit it. To change 
the account, change the Log On As settings in the Services applet 
of the Control Panel for the Microsoft Exchange Event Service, as 
shown in Figure 12-2.</P>
<P>If you do change the Windows NT account for the Event Service, 
make sure that the account you specify for the Event Service truly does have the 
Log On As A Service permission set in the User Manager For Domains. Also, 
make sure the account has the proper Exchange permissions so that it can access 
any of the mailboxes or public folders where scripts will be installed. By 
default, the Event Service passes a logged-on MAPI session to the Event 
Scripting Agent, so you do not have to write the logon code in the script. But the 
Event Service will try to log on to resources using the Windows NT account 
you specify for the service. If this Windows NT account does not have the 
proper permissions, your scripting agent will not work. You can set the 
permissions (such as Mailbox Owner and Send As permissions) for all 
necessary resources in the Exchange Administrator program.</P>

<P>
<img src="images/f12oh02.GIF" width=288 height=334 border="0">
</P><P>
<!-- CAPTION --><B>Figure 12-2</B> <I>You change the Windows NT account that the Event Service runs under by using the Services applet in the Control Panel.</I><!-- /CAPTION -->
</P>

<P>In addition to setting up the Windows NT account that the Event 
Service will run under, you must also give users permission to create agents. This is 
a two-step process. First, you must give users permission to create and bind 
agents in the system. This is accomplished by setting their permissions for a system 
folder named EventConfig_<I>servername</I>, which is shown in Figure 12-3.</P>

<P>
<A HREF="javascript:fullSize('f12oh03x.htm')"> <img src="images/f12oh03.JPG" width=404 height=224 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 12-3</B> <I>The EventConfig_</I>servername<I> folder is found under the Events Root system folder. You must set user permissions for this folder if you want users to write agents.</I><!-- /CAPTION -->
</P>

<P>Locate this folder in your Exchange Administrator program, and 
select Properties from the File menu. Click the Client Permissions button, and in 
the Client Permissions dialog box shown in Figure 12-4, add users or 
distribution lists and assign them Author or higher permissions.</P>
<P>After you have assigned the proper permissions for the 
EventConfig_<I>servername</I> folder, the second step of the process is to configure the folder. To do 
this, start Outlook, right-click on a public folder or an Exchange Server folder, 
and select Properties. On the Agents tab, as shown in Figure 12-5, you can 
create, change, disable, or delete agents in your folder. For the Agents tab to 
appear, you must be the owner of the folder and the Server Scripting add-in must 
be installed. By default, Outlook 98 does not install the Server Scripting 
add-in. To install the Server Scripting add-in, select Options from the Tools menu, 
click on the Other tab, click Advanced Options, and then click Add-In 
Manager. Check the Server Scripting check box to add the Agents tab to the folders 
where you have permissions to create agents.</P>

<P>
<A HREF="javascript:fullSize('f12oh04x.htm')"> <img src="images/f12oh04.JPG" width=404 height=393 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 12-4</B> <I>In the Client Permissions dialog box, you assign users or distribution lists permissions to write agents. You must assign Author or higher permissions to these users before they can create agents.</I><!-- /CAPTION -->
</P>

<P>
<img src="images/f12oh05.GIF" width=367 height=502 border="0">
</P><P>
<!-- CAPTION --><B>Figure 12-5</B> <I>The Agents tab for the Expense Reports public folder. You must have appropriate EventConfig_</I>servername<I> permissions, be an owner of the folder, and the Server Scripting add-in must be installed to see the Agents tab in Outlook.</I><!-- /CAPTION -->
</P>

</BODY>
</HTML>





