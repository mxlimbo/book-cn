<HTML>
<HEAD>
<TITLE>Child Control Macros</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="chabb.htm">[Previous]</A> <A HREF="chabd.htm">[Next]</A><P>

<A NAME="386"><H1>Child Control Macros</H1></A>

<p>The child control macros make it easier to send messages to child
controls. They are very similar to the FORWARD_WM_* macros. Each macro
starts with the type of control you are sending the message to,
followed by an underscore and the name of the message. For example, to
send an LB_GETCOUNT message to a list box, you use the following macro
from WindowsX.h:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
#define ListBox_GetCount(hwndCtl) \
   ((int)(DWORD)SendMessage((hwndCtl), LB_GETCOUNT, 0, 0L))
</pre></td></tr></table></p>

<p>Let me point out a couple of things about this macro. First, it
takes only one parameter, <i>hwndCtl</i>, which is the window handle of
the list box. Because the LB_GETCOUNT message ignores the <i>wParam</i>
and <i>lParam</i> parameters, you don't need to bother with them.
The macro passes zeros, as you can see above. Second, when <i>
SendMessage</i> returns, the result is cast to an <i>int</i> so you
don't have to supply your own cast.</p>

<p>The one thing I don't like about the child control macros is that
they take the handle of the control window. Most of the time, the
controls you need to send messages to are children of a dialog box. So
you end up having to call <i>GetDlgItem</i> all the time, producing
code like this:</p>

<p><table cellpadding=5><tr><td>
<PRE>
int n = ListBox_GetCount(GetDlgItem(hDlg, ID_LISTBOX));
</pre></td></tr></table></p>

<p>This code doesn't run any slower than it would if you used <i>
SendDlgItemMessage</i>, but your application will contain some extra
code because of the additional call to <i>GetDlgItem</i>. If you need
to send several messages to the same control, you might want to call
<i>GetDlgItem</i> once, save the child window's handle, and then
call all the macros you need, as shown in the following code:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
HWND hwndCtl = GetDlgItem(hDlg, ID_LISTBOX);
int n = ListBox_GetCount(hwndCtl);
ListBox_AddString(hwndCtl, &quot;Another string&quot;);

<img src="images/grayvellip.JPG" width=3 height=13 border=0 >
</pre></td></tr></table></p>

<p>If you design your code in this way, your application will run
faster because it won't have to repeatedly call <i>GetDlgItem</i>.
<i>GetDlgItem</i> can be a slow function if your dialog box has many
controls and the control you are looking for is toward the end of the
z-order.</p>

</BODY>
</HTML>






