<HTML>
<HEAD>
<TITLE>Windows 98 and Unicode</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch02d.htm">[Previous]</A> <A HREF="ch02f.htm">[Next]</A><P>

<A NAME="11"><H1>Windows 98 and Unicode</H1></A>

<p>Windows 98 is not a completely new operating system. It has a 16-bit
Windows heritage that was not designed to handle Unicode. Adding
Unicode support would have been too large a task and was dropped from
the product's feature list. For this reason, Windows 98&#8212;like
its predecessors&#8212;does almost everything internally using ANSI
strings.</p>

<p>You can still write a Windows application that processes Unicode
characters and strings, but it is much harder to use the Windows
functions. For example, if you want to call <i>CreateWindowEx</i> and
pass it ANSI strings, the call is very fast; no buffers need to be
allocated from your process's default heap, and no string
conversions need to be done. However, if you want to call <i>
CreateWindowEx</i> and pass it Unicode strings, you must explicitly
allocate buffers and call functions to perform the conversion from
Unicode to ANSI. You can then call <i>CreateWindowEx</i>, passing the
ANSI strings. When <i>CreateWindowEx</i> returns, you can free the
temporary buffers. This is far less convenient than using Unicode on
Windows 2000. I will describe how you can perform these conversions
under Windows 98 later in this chapter.</p>

<p>Although it is true that most implementations of Unicode functions
do nothing in Windows 98, a few Unicode functions do have useful
implementations. These functions are</p>

<table cellpadding=5 width="95%"><tr>
<td class="columns" valign="top"><li>EnumResourceLanguagesW</li></td>
<td class="columns" valign="top"><li>GetTextExtentPoint32W</li></td>
</tr>
<tr>
<td class="columns" valign="top"><li>EnumResourceNamesW</li></td>
<td class="columns" valign="top"><li>GetTextExtentPointW</li></td>
</tr>
<tr>
<td class="columns" valign="top"><li>EnumResourceTypesW</li></td>
<td class="columns" valign="top"><li>lstrlenW</li></td>
</tr>
<tr>
<td class="columns" valign="top"><li>ExtTextOutW</li></td>
<td class="columns" valign="top"><li>MessageBoxExW</li></td>
</tr>
<tr>
<td class="columns" valign="top"><li>FindResourceW</li></td>
<td class="columns" valign="top"><li>MessageBoxW</li></td>
</tr>
<tr>
<td class="columns" valign="top"><li>FindResourceExW</li></td>
<td class="columns" valign="top"><li>TextOutW</li></td>
</tr>
<tr>
<td class="columns" valign="top"><li>GetCharWidthW</li></td>
<td class="columns" valign="top"><li>WideCharToMultiByte</li></td>
</tr>
<tr>
<td class="columns" valign="top"><li>GetCommandLineW</li></td>
<td class="columns" valign="top"><li>MultiByteToWideChar</li></td>
</tr></table>

<p>Unfortunately, many of these functions exhibit all kinds of bugs in
Windows 98. Some of them don't work with certain fonts, some of
them corrupt the heap, some of them crash printer drivers, and so on.
You're going to have to do a lot of testing if you use these. Even
then you might not be able to fix the problems&#8212;you'll just
have to tell your users about them.</p>

</BODY>
</HTML>






