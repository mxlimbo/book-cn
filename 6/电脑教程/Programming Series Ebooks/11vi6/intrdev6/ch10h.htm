<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>User-Defined Procedures and Functions</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch10g.htm", "ch10i.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="175"><H1>User-Defined Procedures and Functions</H1></A>
<P>As you saw earlier in this chapter, a procedure is a group of script 
commands that performs a specific task. Specific procedures can be defined and 
called repeatedly in the scripts. Procedure definitions can appear within &lt;SCRIPT&gt; 
and &lt;/SCRIPT&gt; tags and must follow the rules for the declared scripting 
language. You can define a procedure within the scripting delimiters &lt;% and %&gt; as 
long as the procedure is in the same scripting language as the primary script.

</P>
<P>You can place procedure definitions in the same .asp file that calls 
the procedures. You can place commonly used procedures in a shared .asp file 
and use them with the server-side include statement 
<I>&lt;!--#INCLUDE FILE= ...--&gt;</I> to include the statement in other .asp files that call the procedures.

</P>
<A NAME="176"><H2>Calling Procedures</H2></A><P>To call a procedure, include the name of the procedure in a command. 
For VBScript, use the <I>Call</I> keyword when calling a procedure, or just use the 
name of the procedure. The several methods that follow address conditions for 
calling a procedure:

</P>
<UL>
<P><LI>If the procedure that is called requires any arguments, you 
must enclose the argument list in parentheses.
</LI>
</P>
<P><LI>If you omit the <I>Call</I> keyword, you must also omit the 
parentheses around the argument list.
</LI>
</P>
<P><LI>If you use the <I>Call</I> syntax to call any built-in or user-defined 
function, the function's return value is discarded.
</LI>
</P>
<P><LI>If JScript procedures are called from VBScript, you must use 
parentheses after the procedure name.
</LI>
</P>
<P><LI>If a JScript procedure has no arguments, use empty parentheses.
</LI></P>
</UL>

<P>You can call procedures by simply using the procedure name inside 
a script block. For example, to call a procedure named 
<I>PrintDate</I>, simply code the following:

</P>
<P><PRE>PrintDate
</PRE>

</P>
<P>You can use the following syntax to call the same procedure inside HTML:

</P>
<P><PRE>&lt;% PrintDate %&gt;
</PRE>

</P>
<P>To continue the example, the proper syntax for passing parameters 
when you call a procedure is

</P>
<P><PRE>PrintFact &quot;IBM&quot;
</PRE>

</P>
<P>Functions are a special type of procedure that return a value. You can 
call functions using this type of syntax:

</P>
<P><PRE>OrderedQuantity = CalculateOrders(&quot;All&quot;)
</PRE>

</P>
<P>The following example illustrates creating and calling procedures 
using two different scripting languages, VBScript and JScript.

</P>
<P><PRE>&lt;HTML&gt; 
&lt;BODY&gt;
&lt;TABLE&gt; 
&lt;% Call Echo %&gt; 
&lt;/TABLE&gt; 
&lt;% Call PrintDate %&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
&lt;SCRIPT LANGUAGE=VBScript RUNAT=Server&gt; 
Sub Echo 
    Response.Write _ 
        &quot;&lt;TR&gt;&lt;TD&gt;Name&lt;/TD&gt;&lt;TD&gt;Value&lt;/TD&gt;&lt;/TR&gt;&quot; 
    Set Params = Request.QueryString 
    For Each p in Params 
        Response.Write &quot;&lt;TR&gt;&lt;TD&gt;&quot; &amp; p &amp; &quot;&lt;/TD&gt;&lt;TD&gt;&quot; &amp; _
            Params(p) &amp; &quot;&lt;/TD&gt;&lt;/TR&gt;&quot; 
    Next 
End Sub 
&lt;/SCRIPT&gt;
&lt;SCRIPT LANGUAGE=JavaScript RUNAT=Server&gt; 
function PrintDate() 
{ 
    var x 
    x = new Date() 
    Response.Write(x.toString()) 
}
&lt;/SCRIPT&gt;
</PRE>

</P>
<P>To pass an entire array to a procedure in VBScript, use the array 
name followed by empty parentheses. In JScript, enclose the array name in 
square brackets.

</P>
</BODY>
</HTML>




