<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Managing MSMQ</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch21c.htm", "ch21e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="380"><H1>Managing MSMQ</H1></A>
<P>MSMQ can be managed via the MSMQ Explorer. You can launch the 
MSMQ Explorer by choosing Programs|Windows NT 4.0 Option Pack|Microsoft 
Message Queue|Explorer from the Start menu on the taskbar. Figure 21-6 
shows the MSMQ Explorer window.

</P>
<P>
<A HREF="javascript:fullSize('f21LH06x.htm')"> <IMG SRC="images/f21LH06.JPG" width=404 height=287 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 21-6.</B> <I>The MSMQ Explorer.</I><!-- /CAPTION -->

</P>
<P>The MSMQ Explorer gives you a hierarchical view of the enterprise, 
sites, computers, queues, and messages within MSMQ. Figure 21-6 shows an 
enterprise named VI6; a site named VI6; a Primary Enterprise Controller 
named ntserver; and three queues, named Dead Letter, Journal, and Xact Dead Letter.

</P>
<A NAME="381"><H2>Creating a Queue</H2></A><P>To create a new queue within the MSMQ Explorer, follow these steps:

</P>
<OL>
<P><LI>Right-click the computer name, and choose New|Queue from the context menu.
</LI>
</P>
<P><LI>Enter the name of the queue in the Queue Name dialog box.
</LI>
</P>
<P><LI>Mark the check box to declare the queue transactional, if required.
</LI>
</P>
<P><LI>Click OK.
</LI>
</P>
</OL>




<P>The queue will now appear in the list of queues below the machine name.

</P>
<P>Figure 21-7 shows a queue named <I>myqueue</I> within the MSMQ Explorer.

</P>
<P>
<A HREF="javascript:fullSize('f21LH07x.htm')"> <IMG SRC="images/f21LH07.JPG" width=404 height=252 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 21-7.</B> <I>The MSMQ Explorer showing a queue named myqueue.</I><!-- /CAPTION -->

</P>
<A NAME="382"><H2>Property Windows</H2></A><P>The MSMQ Explorer provides you with property windows for the 
enterprise, sites, computers, queues, and messages. Using these property windows, 
you can view existing properties and modify certain properties as well. The 
available property windows are as follows:

</P>
<UL>
<P><LI>Enterprise Properties Window
</LI>
</P>
<P><LI>Site Properties Window
</LI>
</P>
<P><LI>Computer Properties Window
</LI>
</P>
<P><LI>Queue Properties Window
</LI>
</P>
<P><LI>Message Properties Window
</LI></P>
</UL>




<P>To access a property window, right-click the appropriate node within 
the MSMQ Explorer and choose Properties from the context menu.

</P>
<A NAME="383"><H3>The Enterprise Properties window</H3></A><P>The Enterprise Properties window allows you to view the Enterprise Name 
and Enterprise Server. It also allows you to specify certain global defaults such 
as the default lifetime of a message within the network. Other tabs within 
this property window allow you to specify default settings for MQIS and to 
configure security in terms of permissions, auditing, and ownership. The security 
is tied back to the Windows NT security model.

</P>
<A NAME="384"><H3>The Site Properties window</H3></A><P>The Site Properties window allows you to specify MQIS defaults and 
security on a finer granularity and to set the costs for various links between sites in 
your enterprise. By setting cost values, you can tell MSMQ about the relative 
costs of connecting to various sites in your enterprise in terms of bandwidth. 
For example, some sites might only be accessible via a slow WAN connection 
such as a dial-up line.

</P>
<A NAME="385"><H3>The Computer Properties window</H3></A><P>The Computer Properties window presents you with several tabs for 
configuring MSMQ. These tabs include Dependent Clients, Tracking, Security, 
General, Network, Events, Status, and IS Status.

</P>
<A NAME="386"><H3>The Queue Properties window</H3></A><P>The Queue Properties window presents four tabs: General, Advanced, 
Status, and Security. The General tab tells you the creation date of the queue, the 
queue label, and the queue ID. The Advanced tab includes options that allow you 
to specify whether journalling is enabled, the privacy level, and any limits in 
terms of message storage and journal storage. The Status tab provides a useful 
summary of the number of messages in the queue and the number of bytes in 
the queue. The Security tab again provides a finer level of granularity and ties 
back to the Windows NT 4.0 security model.

</P>
<A NAME="387"><H3>The Message Properties window</H3></A><P>The Message Properties window provides you with information about 
particular messages in a queue. It tells you the date and time the message was sent, 
the date and time the message arrived, the message priority, the message label, 
the body of the message, the size of the message body in bytes, and 
information about the sender.

</P>
</BODY>
</HTML>




