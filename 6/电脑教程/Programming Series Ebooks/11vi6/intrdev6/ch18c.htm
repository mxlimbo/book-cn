<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Deploying ActiveX Components</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch18b.htm", "ch18d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="339"><H1>Deploying ActiveX Components</H1></A>
<P>There are two methods of deploying ActiveX components: you can either 
deploy them using Regsvr32 or you can deploy them in a more automated fashion 
using Visual InterDev 6.0. The remote deployment capabilities for middle-tier 
COM server components is one of the exciting new features in Visual InterDev 
6.0. In this section, we'll see how both of these procedures are performed.

</P>
<A NAME="340"><H2>Using Regsvr32</H2></A><P>Regsvr32 is a program that allows you to register components from the 
command line. You can launch Regsvr32 either from within the Run dialog by 
choosing Start|Run or from within the DOS Command Prompt by 
choosing Start|Programs|MS-DOS Prompt. Regsvr32 has the following syntax:

</P>
<P><PRE>
    Regsvr32 [/u] [/s] [/n] [/i[:cmdline]] dllname

    Where

    dllname - Component to register
    cmdline - Optional command line parameters
    /u - Unregister server
    /s - Silent; display no message boxes
    /c - Console output
    /i - Call dllinstall passing it an optional [cmdline]; 
        when used with /u calls dlluninstall
    /n - Do not call dllregisterserver; 
        this option must be used with /i
</PRE>

</P>
<P>The most common usage of Regsvr32 is simply to call it and pass it the 
name of the component that you want to register, as shown in the following 
example.

</P>
<P><PRE>
    C:\regsvr32 vibank.dll
</PRE>

</P>
<P>Of course, Regsvr32 has to be run locally on the machine on which 
you want to register the component. You also have to manually copy the 
component DLL file to the machine prior to registration. Figure 18-9 shows the 
output message box after the component has been successfully registered.

</P>
<P>
<IMG SRC="images/f18LH09.GIF" width=275 height=119 BORDER=0>
</P>
<P>
<!-- CAPTION --><B>Figure 18-9.</B> <I>The message box displayed after a component has been 
successfully registered using Regsvr32.</I><!-- /CAPTION -->

</P>
<P>Using Visual InterDev 6.0 to remotely deploy the component can be 
much more convenient as we'll see in the next section.

</P>
<A NAME="341"><H2>Using Visual InterDev 6</H2></A><P>Now that we've seen how to deploy a component using Regsvr32, let's 
take a look at the equivalent operation within Visual InterDev 6.0. For 
developers, this is a much more straightforward approach&#8212;you develop your 
component on a workstation along with your Web project and then deploy the 
component to the server remotely.

</P>
<P><DIV CLASS="NOTE"><BLOCKQUOTE>
<B>NOTE</B><HR>
To register components through Visual InterDev on a remote Web server, the 
Web server must have IIS installed with the Visual InterDev RAD Remote Deployment 
Support option selected during custom installation.</BLOCKQUOTE></DIV>

</P>
<P>The first step is to add your component to a Web project:

</P>
<OL>
<P><LI>Open up your Web project.
</LI>
</P>
<P><LI>Create a folder named Components under your Web project. 
This step is not required but is good practice so that your 
middle-tier components are kept separate from your HTML and ASP code.
</LI>
</P>
<P><LI>Prepare to add the component to the Components folder by 
right-clicking the folder and choosing Add|Add Item.
</LI>
</P>
<P><LI>In the Add Item dialog box, choose the Existing tab.
</LI>
</P>
<P><LI>Locate your ActiveX DLL file, and then click Open.
</LI>
</P>
</OL>




<P>Your component will now be added to your Web project.

</P>
<P>Figure 18-10 shows the Project Explorer with an ActiveX DLL 
named vibank.dll added to the Components folder within the VI-Bank Web project.

</P>
<P>
<IMG SRC="images/f18LH10.GIF" width=224 height=480 BORDER=0>
</P>
<P>
<!-- CAPTION --><B>Figure 18-10.</B> <I>The Project Explorer within Visual InterDev 6.0 showing 
a component that has been registered remotely.</I><!-- /CAPTION -->

</P>
<P>Now that the component has been added to your Web project, you 
are ready to register it on the server. You can do this as follows:

</P>
<OL>
<P><LI>Right-click the component, and choose Properties from the 
context menu.
</LI>
</P>
<P><LI>Choose the Component Installation tab on the Properties dialog box.
</LI>
</P>
<P><LI>Check the Register On Server box. (See Figure 18-11.)
</LI>
</P>
<P><LI>Click OK.
</LI>
</P>
</OL>




<P>
<IMG SRC="images/f18LH11.GIF" width=401 height=338 BORDER=0>
</P>
<P>
<!-- CAPTION --><B>Figure 18-11.</B> <I>The Component Installation tab of the component 
Properties dialog box.</I><!-- /CAPTION -->

</P>
<P>After you select OK, the component will be registered on the server. 
You'll be able to see the sequence of events by watching the status bar in the 
lower left corner of the screen.

</P>
<P><DIV CLASS="NOTE"><BLOCKQUOTE>
<B>NOTE</B><HR>
If your master Web server and local project are on the same 
computer, the registry for that machine notes the component only once, 
not once each for the master and local version. If you remove the local 
copy, the registry entry for the component is also removed, even though 
the component is marked as a server component in the project.</BLOCKQUOTE></DIV>

</P>
<P>If you want to deploy your entire Web project, including components, 
to another destination Web server (that is, not your local or master Web server), 
you can use Visual InterDev to register the components. You can do this 
as follows:

</P>
<OL>
<P><LI>In the Project Explorer, select the Web project that you want 
to deploy.
</LI>
</P>
<P><LI>Choose Web Project|Copy Web Application from the Project menu.
</LI>
</P>
<P><LI>In the Copy Project dialog box, choose which copy of your 
application you want to deploy (local or master copy), enter the 
name of the Web server to which you want to deploy, and enter a 
name for the Web project.
</LI>
</P>
<P><LI>Select the Register Server Components check box to register 
your components on the new Web server. (See Figure 18-12.)
</LI>
</P>
</OL>




<P>Figure 18-12 shows the Copy Project dialog box with the Register 
Server Components check box marked. In this example, the VI-Bank Web project 
is being copied to a Web server named testserver.

</P>
<P>
<A HREF="javascript:fullSize('f18LH12x.htm')"> <IMG SRC="images/f18LH12.JPG" width=404 height=288 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 18-12.</B> <I>The Copy Project dialog box showing the Register Server 
Components check box. This dialog box is used to copy a Web project, 
including components, from one server to another.</I><!-- /CAPTION -->

</P>
</BODY>
</HTML>




