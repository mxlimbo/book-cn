<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>The Basics</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch08b.htm", "ch08d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="137"><H1>The Basics</H1></A>
<P>To demonstrate how to script the DTCs, I created a simple Inventory 
database. This database contains the structure shown in Figure 8-1.

</P>
<P>
<A HREF="javascript:fullSize('F08lh01x.htm')"> <IMG SRC="images/F08lh01.JPG" width=404 height=381 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 8-1.</B> <I>The Inventory database contains information for producing and maintaining inventory items and work orders.</I><!-- /CAPTION -->

</P>
<P>I used Microsoft SQL Server for the database engine, but you can 
use Oracle, Microsoft Access, or any other database supported by Visual 
InterDev. The database access in this chapter will be simple. It will demonstrate how 
to script DTCs&#8212;not how to use the database features. You can learn more 
about scripting database features in <A HREF="ch13a.htm">Chapter 13</A> and <A HREF="ch14a.htm">Chapter 14</A>.

</P>
<P>A number of properties, methods, and events are shared across 
multiple DTCs. For example, almost every DTC will have 
<I>show</I> and <I>hide</I> methods that can be used to show or hide the DTC at run time. Some DTCs have a 
<I>value</I> property that you can use to extract data from the DTC or to place data in 
the DTC at run time.

</P>
<P>Other DTCs have properties, methods, and events that are specific 
only to them. For instance, the Listbox and OptionGroup DTCs have an 
<I>addItem</I> method for adding items to the DTC at run time.

</P>
<P>You can access the properties and methods of a DTC at run time by 
using the dot syntax. For example, to load a Listbox DTC that has an ID 
of <I>ItemName</I>, you might use the following code:

</P>
<P><PRE>
ItemName.addItem &quot;Widget A&quot;
ItemName.addItem &quot;Widget B&quot;
ItemName.addItem &quot;Widget C&quot;
ItemName.addItem &quot;Widget D&quot;
</PRE>

</P>
<P>These commands add the Widget item names to <I>ItemName</I>.

</P>
<P>You must call the methods for a DTC from the scripting platform it 
uses. For example, if you define a DTC and specify that it uses the Client 
scripting platform, the DTC's properties, methods, and events are available only in 
script code on the client. Conversely, if you define a DTC and specify that it uses 
the Server scripting platform, the DTC's properties, methods, and events are 
available only in ASP code running on the server.

</P>
<P>To demonstrate how to call a method in the correct scripting platform, 
let's look at the following sample code:

</P>
<P><PRE>
&lt;SCRIPT ID=serverEventHandlersVBS LANGUAGE=vbscript RUNAT=Server&gt;
Sub thisPage_onenter()
    if thisPage.firstEntered then
        Listbox1.addItem &quot;Widget A&quot;
        Listbox1.addItem &quot;Widget B&quot;
        Listbox1.addItem &quot;Widget C&quot;
        Listbox1.addItem &quot;Widget D&quot;
    end if
End Sub
&lt;/SCRIPT&gt;
</PRE>

</P>
<P>This code runs whenever the page loads, whether the page is being 
accessed by a browser navigating to it or it is being entered by processing an HTML 
form. If the <I>thisPage.firstEntered</I> property is true, the user has navigated to the 
page and this code loads <I>Listbox1 </I>with data. The results are shown in Figure 8-2 
below.

</P>
<P>
<A HREF="javascript:fullSize('F08lh02x.htm')"> <IMG SRC="images/F08lh02.JPG" width=404 height=289 border=0 ALT="Click to view at full size."> </A>
</P>

<P>
<!-- CAPTION --><B>Figure 8-2.</B> <I>A server-side Listbox DTC.</I><!-- /CAPTION -->

</P>
<P>You can also implement this code on the client, but you must change 
the event that contains the code to an event that will be fired in the browser. 
This code executes the same <I>addItem</I> statements, but this time they execute in 
the <I>window_onload</I> event in the browser.

</P>
<P><PRE>&lt;SCRIPT ID=clientEventHandlersVBS LANGUAGE=vbscript&gt;
&lt;!--
Sub window_onload
    ListBox1.addItem &quot;Widget A&quot;
    ListBox1.addItem &quot;Widget B&quot;
    ListBox1.addItem &quot;Widget C&quot;
    ListBox1.addItem &quot;Widget D&quot;
End Sub
--&gt;
&lt;/SCRIPT&gt;
</PRE>

</P>
<P>Another issue you must correctly deal with involves the syntax of 
the various commands. Visual InterDev 6.0 implements the DTCs using the 
Script Library, which is composed of JScript routines. Service Pack 1 for 
Microsoft Visual Studio 6 will offer the option of using a set of COM components on 
the server in place of the JScript Script Library.

</P>
<P>At least until Service Pack 1 is released, you must get used to using 
the correct case in your programming. JScript is case-sensitive while Microsoft 
Visual Basic is not. Since the DTCs are implemented using the JScript Script 
Library, the run-time executes all your code in JScript. This is true even if you are 
developing in VBScript (Visual Basic, Scripting Edition). For example, the 
following line of code will work:

</P>
<P><PRE>
if thisPage.firstEntered then
</PRE>

</P>
<P>This line of code will fail:

</P>
<P><PRE>
if thispage.firstEntered then
</PRE>

</P>
<P>If you execute this last line of code, the following message will 
appear in the browser:

</P>
<P><PRE>
Microsoft VBScript runtime error '800a01a8' 
Object required: 'thispage' 
/VI6BookExamples/InventoryList.asp, line 13
</PRE>

</P>
<P>This error is generated because the 
&quot;<I>p</I>&quot; in '<I>thispage</I>' is not capitalized. 
Capitalize the <I>P</I>, and the script works fine.

</P>
</BODY>
</HTML>




