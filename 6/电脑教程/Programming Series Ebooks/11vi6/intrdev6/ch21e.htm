<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>MSMQ Components</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch21d.htm", "ch21f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="388"><H1>MSMQ Components</H1></A>
<P>MSMQ has several Microsoft ActiveX components that you can access 
within your Active Server Pages (ASP) code or other applications. These 
components support queue lookup, queue management, message management, queue 
administration, and transaction support. Four of these components can be found 
on the Server Objects tab in the Toolbox within Visual InterDev. The main 
four components in the Toolbox are:

</P>
<UL>
<P><LI>MSMQ Query
</LI>
</P>
<P><LI>MSMQ QueueInfo
</LI>
</P>
<P><LI>MSMQ Message
</LI>
</P>
<P><LI>MSMQ MailEMail
</LI></P>
</UL>




<P>In addition to these components, MSMQ also contains other objects 
that provide most of the MSMQ API functionality. These include 
<I>MSMQQueue</I>, <I>MSMQQueueInfos</I>, 
<I>MSMQEvent</I>, <I>MSMQTransaction</I>, 
<I>MSMQTransactionDispenser</I>, 
<I>MSMQApplication</I>, and 
<I>MSMQCoordinatedTransactionDispenser</I>. There are 
also many other MSMQ Mail ActiveX objects available for you to script against. 
For complete details on these objects and their properties and methods, see 
the MSMQ online documentation.

</P>
<P><DIV CLASS="NOTE"><BLOCKQUOTE>
<B>NOTE</B>
<HR>
MSMQ fires very few events. The only events fired are 
<I>Arrived</I> and <I>ArrivedError</I>. These are fired by the MSMQEvent component in 
response to a message or error arriving at a queue.
</BLOCKQUOTE></DIV>

</P>
<P>We'll now take a more in-depth look at MSMQ Query, MSMQ 
QueueInfo, MSMQ Message, and MSMQ MailEMail.

</P>
<A NAME="389"><H2>MSMQ Query</H2></A><P>The <I>MSMQQuery</I> object allows you to query MSMQ for existing public 
queues. The <I>LookupQueue</I> method returns a collection of public queues based on 
the following queue properties: queue identifier, service type, label, create time, 
and modify time.

</P>
<A NAME="390"><H2>MSMQ QueueInfo</H2></A><P>The <I>MSMQQueueInfo</I> object provides queue management. It allows you 
to create a queue (either a transaction or nontransaction queue), open an 
existing queue, change a queue's properties, and delete a queue.

</P>
<P><I>MSMQQueueInfo</I> objects are either returned by a query or created by 
you. There is a one-to-one relationship between each 
<I>MSMQQueueInfo</I> object and the queue it represents. However, there is also a one-to-many 
relationship between the queue's 
<I>MSMQQueueInfo</I> object and each open instance of 
the queue. (Each instance of a queue is referenced by an 
<I>MSMQQueue</I> object.)

</P>
<A NAME="391"><H2>MSMQ Message</H2></A><P>The <I>MSMQMessage</I> object provides properties to define MSMQ messages, 
plus a single <I>Send</I> method for sending the message to its destination queue. 
This single method is used for transaction and nontransaction messages.

</P>
<A NAME="392"><H2>MSMQ MailEMail</H2></A><P>The <I>MSMQMailEMail</I> object represents an e-mail message. The e-mail 
message can be a form with several fields, a text message with a single text body, a 
MAPI TNEF message, or a delivery or nondelivery report.

</P>
</BODY>
</HTML>




