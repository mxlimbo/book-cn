<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Preparing the Database</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch15b.htm", "ch15d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="278"><H1>Preparing the Database</H1></A>
<P>Obviously, before you can start working with stored procedures, you'll 
want to set up a database that enables you to create them. 

</P>
<A NAME="279"><H2>Creating the Database in SQL Server</H2></A><P>In this example, we'll use SQL Server 6.5. To create a new database within 
SQL Server, you first create a new database device and then create the database 
itself and assign it to the database device.

</P>
<P><div class="note"><blockquote>
<B>Note</B><hr>A database device is one of two types of files in which 
databases are stored; backup devices are the other type. More than one 
database can be stored on a device.
</blockquote></div>

</P>
<P>Take these steps to create a new database device within SQL Server:

</P>
<OL>
<P><LI> Choose Start|Microsoft SQL Server 6.5|SQL Enterprise Manager.
</LI>
</P>
<P><LI> Select the server you want to work with from within the 
Server Manager window, and expand the node.
</LI>
</P>
<P><LI> Right-click Database Devices, and choose New Device from 
the context menu.
</LI>
</P>
<P><LI> Enter a name for the new device in the New Database Device 
dialog box, and specify the location for the device and the device 
size in MB.
</LI>
</P>
<P><LI> Click the Create Now button to create the new device.
</LI>
</P>
</OL>




<P>Once you have created the new database device, it will appear under 
the Database Devices node within the Server Manager window. You can later 
edit the device properties by right-clicking the device and choosing Edit from 
the context menu. You can edit the size of the device and also specify 
whether the device is mirrored. Mirroring makes a continuous copy of the 
information in the device to another device. This can help recovery in the event of a 
media failure.

</P>
<P>Take the following steps to create a new database within SQL Server:

</P>
<OL>
<P><LI> Choose Start|Microsoft SQL Server 6.5|SQL Enterprise Manager.
</LI>
</P>
<P><LI>  Select the server you want to work with from within the 
Server Manager window, and expand the node.
</LI>
</P>
<P><LI>  Right-click Databases, and choose New Database from the 
context menu.
</LI>
</P>
<P><LI> Enter a name for the new database in the New Database dialog 
box, and specify the data device name and log device name for 
the database.
</LI>
</P>
<P><LI> Click the Create Now button to create the new database.
</LI>
</P>
</OL>




<P>Figure 15-1 shows the SQL Server Enterprise Manager with the New 
Database dialog box ready to create a new database named VI6Samples. 
Note that the database device has already been created and is displayed under 
the Database Devices node.

</P>
<P>
<A HREF="javascript:fullSize('f15lh01x.htm')"> <IMG SRC="images/f15lh01.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 15-1.</B> <I> The SQL Server Enterprise Manager showing the New Database dialog box.</I><!-- /CAPTION -->

</P>
<A NAME="280"><H2>Creating the ODBC Connection in Visual InterDev</H2></A><P>After you have created the database within SQL Server, the next step is to 
start Visual InterDev, create your web project, and add a data connection to 
the database. After opening the Web project you want to work with, right-click 
the global.asa file within the Project Explorer and choose Add Data 
Connection from the context menu. This will launch the Select Data Source dialog 
box, which will allow you to create a new File DSN (data source name) for 
your database.

</P>
<P>To configure the ODBC connection to your SQL Server database, take 
the following steps:

</P>
<OL>
<P><LI>   Click the New button in the Select Data Source dialog box.
</LI>
</P>
<P><LI>   Choose SQL Server as the driver name, and click Next in the 
Create New Data Source dialog box.
</LI>
</P>
<P><LI>   Type the name of the File DSN you want to save this connection 
to, and click Next. Click Finish on the next screen.
</LI>
</P>
<LI><P>  In the Create A New Data Source To SQL Server dialog box, enter 
a description for the data source and specify the name of the 
server that you wish to connect to. (See Figure 15-2.)

</P>
<P>
<A HREF="javascript:fullSize('f15lh02x.htm')"> <IMG SRC="images/f15lh02.jpg" width=404 height=256 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 15-2.</B> <I> The Create A New Data Source To SQL Server dialog box, in which you specify the name of the server to connect to.</I><!-- /CAPTION -->

</P>
</LI>

<LI><P>  On the next screen, specify how SQL Server should verify the 
authenticity of the login ID. Choose With SQL Server 
Authentication Using A Login ID And Password Entered By The User, enter 
<I>sa</I> as the login ID, and click Next. (See Figure 15-3.)

</P>
<P>
<A HREF="javascript:fullSize('f15lh03x.htm')"> <IMG SRC="images/f15lh03.jpg" width=404 height=256 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 15-3. </B> <I> The dialog box in which you specify how SQL Server should verify the authenticity of the login ID.</I><!-- /CAPTION -->

</P>
</LI>

<P><LI>  On the next screen, check the Change The Default Database 
To check box, and select your database name in the drop-down list 
box. Click Next.
</LI>
</P>
<P><LI>   Click Next and then Finish to get to the final screen. This 
screen allows you to test the connection. Click the Test Data Source 
button, and verify that the connection succeeds. Click OK to 
complete the ODBC Microsoft SQL Server Setup.
</LI>
</P>
</OL>




<P>After following the steps outlined above, you have created a File DSN 
for your SQL Server data source. You can now select this File DSN and click 
OK to begin establishing the data connection within Visual InterDev. Now 
click OK in the SQL Server Login dialog box to log in to the database. The next 
step is to specify a name for the data connection and to specify the 
authentication information for the data connection both in the design-time and 
run-time environment.

</P>
<P>Follow these steps to complete your definition of the 
database connection:

</P>
<OL>
<P><LI>  In the General tab of the Connection Properties dialog box, enter 
a name for the data connection and choose Use Connection String 
for the source of the connection.
</LI>
</P>
<P><LI>   Select the Authentication tab, and enter 
<I>sa</I> for both the design-time and run-time user name. Check both the Save Design-time 
Authentication and the Save Run-time Authentication check boxes. (See Figure 15-4.)
</LI>
</P>
</OL>




<P>
<IMG SRC="images/f15lh04.gif" width=401 height=338 border="0">

</P>
<P>
<!-- CAPTION --><B>Figure 15-4. </B> <I>The Authentication tab of the Data Connection Properties dialog box, where you specify both design-time and run-time authentication information.</I><!-- /CAPTION -->

</P>
</BODY>
</HTML>




