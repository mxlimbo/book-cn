<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>The CDONTS Session Object</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch17i.htm", "ch17k.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="330"><H1>The CDONTS <I>Session</I> Object</H1></A>
<P>The <I>Session</I> object is a top-level component used to establish a session 
with the SMTP server component of IIS. The <I>LogonSMTP</I> method is used to establish a session. This method must be called prior to using any of the other CDONTS Library objects (other than 
<I>NewMail</I>). Sessions can be terminated using the <I>Logoff</I> method. The following code shows the syntax for logging on to an SMTP session:

</P>
<P><PRE>&lt;OBJECT RUNAT=server PROGID=CDONTS.Session id=objSession&gt;
&lt;/OBJECT&gt;

&lt;%
objSession.LogonSMTP &quot;Nicholas D. Evans&quot;, _
    &quot;nick.evans@us.pwcglobal.com&quot;
%&gt;
</PRE>

</P>
<P>The advantage of using the <I>Session</I> object over the 
<I>NewMail</I> object is that you have access to richer functionality. The 
<I>NewMail</I> object is used to send e-mail messages with very few commands. The 
<I>Session</I> object allows you to gain access to folders, messages, attachments, and recipients within your mail application. This way you have fuller access to the mail within your 
application. For example, you can delete or send mail, delete attachments, 
navigate through messages, add or delete recipients, and so on.

</P>
<P>The <I>Session</I> object has several properties that you can access within 
your scripts, including <I>Inbox</I>,<I> 
Outbox</I>,<I> Application</I>,<I> 
MessageFormat</I>, <I>Version</I>, and so on. These are all read-only properties except 
<I>MessageFormat</I>. The <I>Inbox</I> and 
<I>Outbox</I> properties return <I>Folder</I> objects that represent the current user's 
Inbox folder and Outbox folder.

</P>
</BODY>
</HTML>




