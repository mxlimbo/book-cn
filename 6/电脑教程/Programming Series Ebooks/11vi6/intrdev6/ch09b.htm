<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Using the FormManager DTC</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch09a.htm", "ch09c.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="141"><H1>Using the FormManager DTC</H1></A>
<P>The FormManager DTC is designed to automate much of the coding 
required to construct a mode-based data-entry form. For instance, if you want a 
four-button form (Display, New, Modify, and Delete, for example) to control 
the form's mode, you can hook this form up with the FormManager DTC 
without writing any code.

</P>
<P>Let's look at an example of the FormManager DTC. This form has 
two actions:

</P>
<UL>
<P><LI><B>     New</B> Clears the form and lets you enter a new record
</LI>
</P>
<P><LI><B>     Modify</B> Lets you modify the current record
</LI></P>
</UL>




<P>You can scroll around the form in either mode. Figure 9-1 below shows the form in Modify mode. Notice that the Modify button 
is disabled.

</P>
<P>This form uses the RecordsetNavbar DTC to navigate through the 
recordset. The RecordsetNavbar DTC is located at the bottom of the form. You can 

change any one of the fields. After you have changed a field, you can save it by moving
to the next record with the RecordsetNavbar DTC or clicking the Save 
button. Figure 9-2 shows the same form in New mode, immediately after a new 
record has been entered and saved.


</P>
<P>
<A HREF="javascript:fullSize('f09lh01x.htm')"> <IMG SRC="images/f09lh01.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 9-1.</B> <I> Data Entry form in Modify mode.</I><!-- /CAPTION -->

</P>
<P>
<A HREF="javascript:fullSize('f09lh02x.htm')"> <IMG SRC="images/f09lh02.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 9-2.</B> <I>Data Entry form in New mode.</I><!-- /CAPTION -->

</P>
<P>The FormManager DTC is a type of &quot;super DTC&quot;&#8212;it works with the 
other DTCs on the page to map and control functional changes during mode 
switches. Here's how to use it:

</P>
<OL>
<P><LI>   Create an ASP Web page.
</LI>
</P>
<P><LI>   Insert the DTCs you will use for your data form. This normally 
includes a Recordset DTC, DTCs for each field you will display, 
a RecordsetNavbar DTC to control navigation, and buttons that 
will control switching from one mode to the next.
</LI>
</P>
<P><LI>   Insert a FormManager DTC. This FormManager interface wires 
the various modes and actions together.
</LI>
</P>
</OL>




<P>The first step in creating the data entry form is easy&#8212;you can use 
the standard techniques we have already covered to build the form and bind it 
to a recordset. Figure 9-3 shows the sample page in Design view. You can see 
the Recordset DTC at the top of the page. Next are the Button DTCs that will 
switch from one mode to the next. Next come the Textbox DTCs for the fields on 
the form. Finally the RecordsetNavbar DTC and the FormManager DTC come 
below the last Textbox DTC (off the screen).

</P>
<P>
<A HREF="javascript:fullSize('f09lh03x.htm')"> <IMG SRC="images/f09lh03.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 9-3.</B> <I>Data Entry form in Design view.</I><!-- /CAPTION -->

</P>
<P>After building the basic layout of the page with the controls just 
mentioned, your next step is to test it in the browser. Finally, you'll want to edit the 
FormManager DTC on the page and set its properties. Let's look at how to wire 
up the FormManager DTC with a few lines of ASP code.

</P>
<A NAME="142"><H2>Defining Modes, Actions, and Transitions in the FormManager DTC</H2></A><P>First a few terms used in conjunction with the FormManager DTC need to 
be defined:

</P>
<P><B>Table 9-1.</B> <I>FormManager modes.</I>

<TABLE CELLPADDING=5 WIDTH="95%">
<TR>
<TH VALIGN="TOP"><B><I>Term</I></B></TH>
<TH VALIGN="TOP"><B><I>Description</I></B></TH>
</TR>
<TR>
<TD VALIGN="TOP">Form Mode</TD>
<TD VALIGN="TOP">Defines an operational setting for the form. For instance, in New mode the user should be able to enter a new record but not delete a record. In Modify mode, the user can make changes to a record but not enter a new record or delete a record.</TD>
</TR>
<TR>
<TD VALIGN="TOP">Action</TD>
<TD VALIGN="TOP">Determines what happens at an execution point between modes. Actions occur when the form switches from one mode to another. For instance, when the 
user clicks the New button, we set the <I>disabled</I> property of the cmdNew button to True to turn off that button, and we set the <I>disabled</I> property of cmdModify to False 
to turn it on.</TD>
</TR>
<TR>
<TD VALIGN="TOP">Transition</TD>
<TD VALIGN="TOP">The period between one mode and another.  Transitions occur when the form changes from one mode to another. For instance, when the user clicks the New button, the transition period occurs between the time the New button is clicked and the New mode becomes active.</TD>
</TR>
</TABLE>


</P>
<P>     



</P>
<A NAME="143"><H3>Defining modes for the FormManager DTC</H3></A><P>Defining modes for the form is the first step in setting up the FormManager 
DTC. Figure 9-4 shows the Form Mode tab of the FormManager Properties dialog 
box. This figure shows two modes defined for our form: Modify and New.

</P>
<P>To define a mode:

</P>
<OL>
<P><LI>   Right-click the FormMode DTC and select Properties.
</LI>
</P>
<P><LI>   Click the Form Mode tab in the FormManager Properties dialog box.
</LI>
</P>
<P><LI>   Enter the new mode name in the New Mode text box.
</LI>
</P>
<P><LI>   Click the &gt; button to create the mode and add it to the Form 
Mode list.
</LI>
</P>
</OL>




<P>Figure 9-4 also shows the Default Mode set to Modify. The form will 
start in this mode.

</P>
<P>
<IMG SRC="images/f09lh04.gif" width=401 height=361 border="0">
</P>
<P>
<!-- CAPTION --><B>Figure 9-4.</B> <I>The Form Mode tab of the FormManager Properties dialog box.</I><!-- /CAPTION -->

</P>
<A NAME="144"><H3>Defining actions for the FormManager DTC</H3></A><P>Now that we have defined our modes, we can define the actions for them. 
Figure 9-5 shows the Form Mode tab of the FormManager Properties dialog 
box with actions defined for the Modify mode. You can display the actions for 
a mode by selecting the mode in the Form Mode list. The actions will display 
in the Actions Performed For Mode grid.

</P>
<P>
<IMG SRC="images/f09lh05.gif" width=401 height=361 border="0">
</P>
<P>
<!-- CAPTION --><B>Figure 9-5.</B> <I>The FormMode tab of the FormManager Properties dialog box 
with actions defined.</I><!-- /CAPTION -->

</P>
<P>The actions occur when the mode becomes active. For instance, when 
the Modify mode becomes active, the properties shown in Figure 9-5 are set.

</P>
<P>To define actions for a mode:

</P>
<OL>
<P><LI>   Select the mode in the Form Mode list.
</LI>
</P>
<P><LI>   Click in the first Object cell to activate it, and then select the 
object you wish to use from the drop-down list.
</LI>
</P>
<P><LI>   Tab to the Member cell.
</LI>
</P>
<P><LI>   Select the member (method or property) to use from the 
drop-down list.
</LI>
</P>
<P><LI>   Tab to the Value cell.
</LI>
</P>
<P><LI>   Enter the value for the property or method.
</LI>
</P>
</OL>




<A NAME="145"><H3>Defining transition actions for the FormManager DTC</H3></A><P>When our mode actions have been defined, we can define the transition 
actions. Your transition actions can do several things. First you will define a Form 
Mode Transition for each mode that performs the change to the new mode. For 
instance, Figure 9-6 shows the Action tab of the FormManager Properties 
dialog box for the FormManager DTC in our sample. You can see that we have a 
Form Mode Transition defined for each of our modes (New and Modify). In 
addition, we have a third and fourth transition defined for Modify and New mode 
when the user clicks the Save button.

</P>
<P>
<IMG SRC="images/f09lh06.gif" width=401 height=361 border="0">
</P>
<P>
<!-- CAPTION --><B>Figure 9-6.</B> <I>The Action tab of the FormManager Properties dialog box.</I><!-- /CAPTION -->

</P>
<P>You can also define actions that take place before the transition 
occurs. This is extremely useful in database operations. In Figure 9-6, notice that 
we have selected the first Modify mode line in the Form Mode Transitions grid. 
This displays the corresponding actions that occur before that transition occurs 
in the Actions Performed Before Transition grid. In this example, the 
<I>rsCustomer.addRecord</I> method will execute when the user clicks the New button. 
Clicking the second Modify mode line in the top grid would show that the 
<I>rsCustomer.updateRecord</I> method is executed when the user clicks the Save button. 
The same is true for the New mode line in the top grid when the user clicks 
the Save button.

</P>
<P>This example demonstrates the power of the FormManager DTC. No 
code actually has to be written on the page to achieve this type of 
functionality. Everything has been accomplished using the Recordset, Button, Textbox, 
RecordsetNavbar and FormManager DTCs. Of course, you can also add your 
own custom code to the ASP Web page to extend the functionality by adding 
data validation checks and so on. The FormManager DTC allows you to create 
the basic wiring for your dynamic, data-driven forms automatically and to 
concentrate on the specific business rules for your applications&#8212;thus increasing 
your productivity.

</P>
</BODY>
</HTML>




