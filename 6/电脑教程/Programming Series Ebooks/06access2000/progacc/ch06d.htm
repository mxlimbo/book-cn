<HTML>
<HEAD>
	<link rel="STYLESHEET" type="text/css" href="Library.css">
<TITLE>Sorting, Grouping, and Calculating</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch06c.htm", "ch06e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="212"><H1>Sorting, Grouping, and Calculating</H1></A>

<P>One of the major benefits of Design view is that it facilitates grouping and 
sorting records for display in a report. Two factors underlie this capability: the 
report bands and the Sorting And Grouping dialog box. The grouping capability 
simplifies computation of subtotals by group, and it also calculates grand totals.</P>


<P>Figure 6-8 presents a simple report that demonstrates basic sorting, grouping, and calculating functionality for a report. This two-page report shows the report title at the top of the first page only. The label control for the report's title is thus in the Report Header section. In contrast, the two column 
headings appear in the Page Header section because these headings appear at the top of the columns on both pages. The Detail section contains a pair of text boxes bound to fields in the report's record source. On the report, these text 
boxes repeat once for each record in the underlying record source. The sort order of these rows can be independent of the order of records in the underlying record source. This capability improves the overall usability of a record sources 
for multiple reports.</P>


<P><A HREF="javascript:fullSize('F06QH08x.htm')"> <img src="Images/F06QH08.JPG" width=404 height=442 border=0 ALT="Click to view at full size."> </A>
</P><P><!-- CAPTION --><B>Figure 6-8.</B> <I>A report that shows grouping by date.</I><!-- /CAPTION -->
</P>


<P>The rows in Figure 6-8 are grouped by quarter. You use the Grouping And Sorting dialog box in Design view to select one or more fields on which to group rows. Grouping on a field adds Report Header and Report Footer sections to a report for each new group. This built-in grouping capability automatically adapts to the field data type on which a report groups. For date fields, Access supports grouping by year, quarter, month, week, day, hour, and minute. AutoNumber, Currency, and Number fields enable you to group rows by a custom range. You can group product unit prices in $5 intervals for one report and in $10 intervals for another. You can also group Text fields based on their leading characters. This permits you to create a directory-style report that groups all 
products beginning with <I>A </I>followed by those beginning with <I>B</I>,<I> </I>and so on.</P>


<P>The built-in grouping capabilities support the calculation of 
subtotals. Notice that the report in Figure 6-8 summarizes sales orders by month and 
by quarter. You use an aggregate function, such as 
<I>SUM</I>, in a group footer section to compute a calculation for the items in a group. Other aggregate 
functions that can add value to a report include 
<I>AVG</I>, <I>COUNT</I>, <I>MAX</I>, and 
<I>MIN</I>. The aggregate function for the subtotal in Figure 6-8 appears in the text box in the 
Date Footer section. The Control Source expression for the text box is</P>


<p>
<table cellpadding=5>
<tr>
<td>
<pre>=Sum([CountOfOrderID])</pre>
</td>
</tr>
</table></P>


<P>The argument for this function points at an underlying field for a control in the Detail section. Using <I>txtCountOfOrderID 
</I>as the argument to point directly at the text box control generates an error.</P>


<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>Rules for calculating subtotals differ from other calculated 
fields on a report. With a standard calculated field, such as one to compute an extended price for an order, you can refer to the individual control values on the current record. Your expressions can also reference the underlying fields for controls. When you compute subtotals, you must reference the underlying field value.
</BLOCKQUOTE></DIV></P>


</BODY>
</HTML>




