<HTML>
<HEAD>
	<link rel="STYLESHEET" type="text/css" href="Library.css">
<TITLE>Switchboard Forms</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05b.htm", "ch05d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="177"><H1>Switchboard Forms</H1></A>

<P>Switchboard forms are a common way to facilitate navigation in an 
application. It is common for switchboard forms to contain several command buttons that users can click to open another form. This section offers two approaches to using switchboard forms: one based on hyperlinks and the other based on VBA procedures.</P>


<A NAME="178"><H2>Navigating with Hyperlinks</H2></A>

<P>Hyperlink navigation is particularly easy to create because you do not have to write any code (although you can manage hyperlinks with VBA). Hyperlinks can act as shortcuts to database objects in an application, documents on your hard drive, files on a network, or World Wide Web pages on the Internet or pages on an intranet. Access lets you use hyperlinks with labels, buttons, and images.</P>


<P>You can set and edit hyperlink properties from a form's Design view 
or programmatically using VBA. Using the manual procedures for setting 
and editing hyperlinks is not only easier but can yield faster-loading forms because forms with hyperlinks created in Design view do not require that a module contain VBA code. To deliver this benefit, a form must have its <I>Has Module</I> property set to <I>No</I>.</P>


<P>
<DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>The Hyperlink data type lets an Access application launch hyperlinks from table or query fields. While Hyperlink fields are in many ways like the hyperlink properties, you use them differently. See <a href="ch13a.htm">Chapter 13</a> for coverage of using hyperlinks for Web development.
</BLOCKQUOTE></DIV></P>
 

<P>Figure 5-2 shows four forms that use a simple navigation system. The main switchboard form on the left transfers focus to one of the other three forms when the user clicks a hyperlink on the main form. Once another form has the focus, the user can return the focus to the switchboard by clicking the hyperlink to the main form.</P>


<P><A HREF="javascript:fullSize('F05QH02x.htm')"> <img src="Images/F05QH02.JPG" width=404 height=244 border=0 ALT="Click to view at full size."> </A>
</P><P><!-- CAPTION --><B>Figure 5-2.</B> <I>A simple hyperlink navigation system.</I><!-- /CAPTION -->
</P>


<P>You can easily introduce more than two tiers into a navigation 
system. Typically, each child form can return focus to its parent form. Main forms often include a way to exit the application or exit Access.</P>


<P>To create a hyperlink using the Label control, follow these steps:</P>


<OL>
<P><LI>Click the Build button next to the <I>Hyperlink Address</I> property or the <I>Hyperlink SubAddress</I> property on the label's property sheet.
</LI></P>

<P><LI>In the Insert Hyperlink dialog box, select the type of object to link to from the Link To list.
</LI></P>

<P><LI>Enter the information for the type of object.
</LI></P>

<P><LI>Click OK.
</LI></P>
</OL>

<P>
<DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>By default, unfollowed hyperlinks in an Access session are blue and followed hyperlinks are maroon. You can change these colors by choosing Options from the Tools menu, clicking on the General tab, and then clicking Web Options. Use the two list boxes in the Web Options dialog box to set the colors.
</BLOCKQUOTE></DIV></P>
 

<P>Figure 5-3 shows the Insert Hyperlink dialog box for the label on 
the <I>frmGoHere</I> form in this chapter's sample database. The hyperlink simply transfers focus back to the switchboard form.</P>


<P><A HREF="javascript:fullSize('F05qh03x.htm')"> <img src="Images/F05qh03.JPG" width=404 height=277 border=0 ALT="Click to view at full size."> </A>
</P><P><!-- CAPTION --><B>Figure 5-3.</B> <I>The Insert Hyperlink dialog box for the label on the </I>frmGoHere <I>form.</I><!-- /CAPTION -->
</P>


<A NAME="179"><H2>Navigating with Code</H2></A>

<P>Another common way to implement switchboard navigation is with VBA 
code behind command button click events. This approach offers richer exposure to Access functionality than hyperlink-based navigation because you can mix navigation functions with other events, such as the closing of a form. (With a hyperlink, one form can open another, but returning to a switchboard leaves the child form open; VBA-based navigation lets an application programmatically close the child form when a user returns to the main form.) An event procedure also gives you greater control over multiple database objects. Hyperlink-based navigation merely transfers focus to another object, such as a form.</P>


<P>Figure 5-4 shows a pair of forms that use the VBA approach to 
navigation. This sample relies on button click events. When the user clicks one of the switchboard buttons, the code for the button's click event opens the target form and closes the main switchboard. Clicking the Return To Main button on the target form closes the form and opens the main switchboard form. (The sample uses command buttons, but you can use any other type of control that lets a user generate events.)</P>


<P><A HREF="javascript:fullSize('F05qh04x.htm')"> <img src="Images/F05qh04.JPG" width=404 height=118 border=0 ALT="Click to view at full size."> </A>
</P><P><!-- CAPTION --><B>Figure 5-4.</B> <I>These forms use code behind button click events to perform navigation.</I><!-- /CAPTION -->
</P>


<P>The following pair of event procedures shows the code for the click 
events of the two buttons in Figure 5-4. The first procedure switches control from the main switchboard form to the second form. It also closes the main form. The second procedure transfers control back to the main switchboard and then closes the second form. I used the Command Button wizard to create a first draft of each procedure; I then added a line of code to each procedure to close the appropriate form.</P>


<P>
<TABLE CELLPADDING=5 WIDTH="95%"><TR><TD>
<PRE>Private Sub cmdGoHere_Click()
On Error GoTo Err_cmdGoHere_Click

Dim stDocName As String

    stDocName = &quot;frmButtonGoHere&quot;
    DoCmd.OpenForm stDocName
    DoCmd.Close acForm, &quot;frmButtonSwitchboard&quot;

Exit_cmdGoHere_Click:
    Exit Sub

Err_cmdGoHere_Click:
    MsgBox Err.Description
    Resume Exit_cmdGoHere_Click
    
End Sub


Private Sub cmdReturnToMain_Click()
On Error GoTo Err_cmdReturnToMain_Click

Dim stDocName As String
Dim stLinkCriteria As String

stDocName = &quot;frmButtonSwitchboard&quot;
DoCmd.OpenForm stDocName
stDocName = &quot;frmButtonGoHere&quot;
DoCmd.Close acForm, stDocName, acSaveNo

Exit_cmdReturnToMain_Click:
    Exit Sub

Err_cmdReturnToMain_Click:
    MsgBox Err.Description
    Resume Exit_cmdReturnToMain_Click
    
End Sub
</PRE></TD></TR></TABLE></P>
 


</BODY>
</HTML>




