<HTML>
<HEAD>
<TITLE>The Animation Control</TITLE>
<LINK REL=STYLESHEET HREF="Library.css" TYPE="text/css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch11a.htm", "ch11c.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>


<A NAME="482"><h1>The Animation Control</h1></A>
<p>The Animation control can play back AVI files so that you can add simple 
animations to your program. This control supports only AVI files that don't include sound 
and that aren't in compressed form or that have been compressed using 
Run-Length Encoding (RLE). Any attempt to play back an AVI file that doesn't follow these 
rules brings up error message 35752, &quot;Unable to open AVI file.&quot; </p>

<p>The Animation control is especially useful for embedding simple 
animations, such as those that you find in the \Common\Graphics\AVIs subdirectory under 
the main Microsoft Visual Basic installation directory. For example, you can use 
this control to display sheets of paper that fly from one folder to another folder while 
you perform a file copy operation in the background, as shown in Figure 11-1.</p>

<p>
<A HREF="javascript:fullSize('F11ph01x.htm')"> <img src="images/F11ph01.JPG" width=404 height=152 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><B>Figure 11-1.</B> <i>A demonstration program provided on the companion CD-ROM lets you experiment with the Animation control.</i><!--/caption-->
</p>

<p>The Animation control exposes three main properties. Two of them, 
<I>Center</I> and <I>BackStyle</I>, can be set only at design time, and are read-only at run time. If the 
<I>Center </I>property is True, the AVI file is centered in the Animation control window 
(instead of being displayed near the upper left corner). The 
<I>BackStyle </I>property can be 0cc2BackstyleTransparent (the default setting, which displays the background 
color of the control) or 1-cc2BackstyleOpaque (displays the background of the AVI 
file). The third property, <I>AutoPlay</I>, can be set at any time. You set it to True to 
automatically start the playback of any AVI file as soon as it's loaded in the control. (If 
you make this setting, you must set <I>AutoPlay 
</I>to False through code to stop playback).</p>

<p>No design-time property determines which AVI file is loaded and displayed 
at run time. To start an animation through code, you must first open the AVI file, 
which you do using the <I>Open </I>method:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
Animation1.Open &quot;d:\vb6\Graphics\AVIs\filecopy.avi&quot;
</pre>
</td></tr>
</table></p>

<p>If the <I>AutoPlay </I>property is True, the AVI file starts as soon as it has been 
loaded in the control. Otherwise, you have to start it through code with the 
<I>Play </I>method, which has the following syntax:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
Play [RepeatCount], [StartFrame], [EndFrame]
</pre>
</td></tr>
</table></p>

<p><I>RepeatCount</I> is the number of times the animation must run. (The default is 
-1, which repeats the animation indefinitely.) 
<I>StartFrame</I> is the starting frame of the animation (the default is 0, the first frame). 
<I>EndFrame</I> is the ending frame of the animation (the default is -1, the last frame in the AVI file).</p>

<p>You can choose from two ways to stop an animation, and you must select 
one or the other according to the method you used to start it. If the animation is in 
AutoPlay mode, you can stop it only by setting the 
<I>AutoPlay</I> property to False; if you started the animation with the 
<I>Play </I>method, you can stop it with the <I>Stop 
</I>method. If you don't plan to restart the same AVI file immediately, you can release some memory by 
executing the <I>Close </I>method, as shown in the following code (which assumes that 
the <I>AutoPlay </I>property is False):</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub cmdStart_Click()
    Animation1.Open &quot;d:\vb5\graphics\AVIs\filecopy.avi&quot;
    Animation1.Play
End Sub
Private Sub cmdStop_Click()
    Animation1.Stop
    Animation1.Close
End Sub
</pre>
</td></tr>
</table></p>

<p>The Animation control doesn't expose any custom events. This means, 
for example, that you can't find out when an animation ends.</p>

</BODY>
</HTML>





