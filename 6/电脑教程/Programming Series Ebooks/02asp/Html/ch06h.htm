<HTML>
<HEAD>
<TITLE>Part VI: Taking the Order</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>Part VI: Taking the Order</h1>
<P>In this part of the project, you will take book orders over the network by 
simply recording orders in a text file. If you were creating a real-life Web site, 
you would want to provide a secure mechanism for taking orders, but this 
exercise gives you experience in using the text file components of Visual InterDev. 
<P><H2>Step 1</h2>
<P>If you don't already have the Bookstore project open in Visual InterDev, 
open it now. Add a new HTML file to your project by clicking the project title 
and choosing New from the File menu. In the New dialog box, insert a new 
ASP page, name the page ORDERFORM.ASP, and click the OK button.
<P>Right-click ORDERFORM.ASP on the FileView tab, and choose 
Open With from the pop-up menu. In the Open With dialog box, open the file 
with Microsoft FrontPage Editor. You will use FrontPage to design an order form 
for the Web site.
<P>Right-click the page, and choose Page Properties from the pop-up 
menu. Use the dialog box to change the background of the page to white.
<P><H2>Step 2</h2>
<P>Build the order form by adding form elements through the Form Field 
items on the Insert menu. Use the following elements:


<P><HR>
<TABLE>
<TR>
<TD VALIGN=top WIDTH=225><B>Control Type</b></td>
<TD VALIGN=top><B>Control Name</b></td>
</tr>
<TR>
<TD VALIGN=top>One-Line TextBox</td>
<TD VALIGN=top>txtName</td>
</tr>
<TR>
<TD VALIGN=top>One-Line TextBox</td>
<TD VALIGN=top>txtAddress1</td>
</tr>
<TR>
<TD VALIGN=top>One-Line TextBox</td>
<TD VALIGN=top>txtAddress2</td>
</tr>
<TR>
<TD VALIGN=top>One-Line TextBox</td>
<TD VALIGN=top>txtCity</td>
</tr>
<TR>
<TD VALIGN=top>One-Line TextBox</td>
<TD VALIGN=top>txtState</td>
</tr>
<TR>
<TD VALIGN=top>One-Line TextBox</td>
<TD VALIGN=top>txtZip</td>
</tr>
<TR>
<TD VALIGN=top>One-Line TextBox</td>
<TD VALIGN=top>txtCreditCard</td>
</tr>
<TR>
<TD VALIGN=top>Scrolling TextBox</td>
<TD VALIGN=top>txtBookTitle</td>
</tr>
<TR>
<TD VALIGN=top>Push Button</td>
<TD VALIGN=top>cmdSubmit</td>
</tr>
<TR>
<TD VALIGN=top>Push Button</td>
<TD VALIGN=top>cmdReset</td>
</tr>
</table>
<HR>                 
<P>Insert each of the elements into ORDERFORM.ASP by choosing 
Form Field from the Insert menu. Change the name of each element by 
right-clicking the element and typing in the name from the table above. For the 
Scrolling TextBox, set Rows to 2 and Columns to 20. Change the button properties 
for cmdSubmit and cmdReset to Submit and Reset.
<P><H2>Step 3</h2>
<P>Add an image to the top of the page by choosing Image from the Insert 
menu. In the From Location text box, type the following location:
<P>/BOOKSTORE/IMAGES/ORDER.GIF
<P>Right-click the form, and choose Form Properties from the pop-up 
menu. In the Form Properties dialog box, set Form Handler to Custom ISAPI, 
NSAPI, Or CGI Script. Click the Settings button, and enter ORDER.ASP in the 
Action text box. Click the OK button in both dialog boxes.
<P>Save the page, and close FrontPage Editor.
<P><H2>Step 4</h2>
<P>Open ORDERFORM.ASP in Visual InterDev. You need to add some 
server-side VBScript to automatically place the name of the ordered book in the 
form. Locate the &lt;TEXTAREA&gt; tag, which holds the book title, and insert the 
following code:
<P><PRE>&lt;P&gt;&lt;TEXTAREA&#160;NAME=&quot;txtBookTitle&quot;&#160;ROWS=&quot;2&quot;&#160;COLS=&quot;20&quot;&gt;
&#160;&#160;&#160;&#160;&lt;%=Request.QueryString(&quot;Title&quot;)%&gt;
&#160;&#160;&#160;&#160;&lt;/TEXTAREA&gt;&#160;Book&#160;Title&#160;&lt;/P&gt;</pre>
<P>In Visual InterDev, choose New from the File menu. In the New 
dialog box, add a new ASP page, name the page ORDER.ASP, and click OK.
<P>This page will acknowledge receipt of the order and print it in a text 
file. Use the text components of Visual InterDev to write instructions for the 
page. In the BODY section of ORDER.ASP, add the following code:
<P><PRE>&lt;H2&gt;&lt;CENTER&gt;Thanks&#160;for&#160;your&#160;order!&lt;/CENTER&gt;&lt;/H2&gt;

&lt;%
Dim&#160;objFile
Dim&#160;objStream

`&#160;Open&#160;ORDER.TXT&#160;for&#160;writing

Set&#160;objFile&#160;=&#160;Server.CreateObject(&quot;Scripting.FileSystemObject&quot;)
Set&#160;objStream&#160;=&#160;objFile.OpenTextFile(Server.MapPath&#160;(&quot;/Bookstore&quot;)&#160;+&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;\order.txt&quot;,&#160;8,&#160;True)


objStream.WriteLine&#160;Request.Form(&quot;txtName&quot;)
objStream.WriteLine&#160;Request.Form(&quot;txtAddress1&quot;)
objStream.WriteLine&#160;Request.Form(&quot;txtAddress2&quot;)
objStream.WriteLine&#160;Request.Form(&quot;txtCity&quot;)
objStream.WriteLine&#160;Request.Form(&quot;txtState&quot;)
objStream.WriteLine&#160;Request.Form(&quot;txtZip&quot;)
objStream.WriteLine&#160;Request.Form(&quot;txtCreditCard&quot;)
objStream.WriteLine&#160;Request.Form(&quot;txtBookTitle&quot;)

objStream.Close&#160;
Set&#160;objStream&#160;=&#160;Nothing
Set&#160;objFile&#160;=&#160;Nothing

%&gt;</pre>
<P><H2>Step 5</h2>
<P>Save your work, and test the order form by previewing ORDER.HTM in 
the Visual InterDev environment.
<P><H2>Step 6</h2>
<P>Write your own code to add a hyperlink from the body of DEFAULT.HTM 
to ORDER.HTM. Add new commands to the Agent so that the Agent can take 
a user to the order form from the home page.
<P>Save your work, and run the site. Test all the pieces.







<P>
</BODY>
</HTML>
