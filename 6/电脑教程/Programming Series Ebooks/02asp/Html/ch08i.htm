<HTML>
<HEAD>
<TITLE>Part VII: Tip of the Day</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>Part VII: Tip of the Day</H1>
<P>In this part, you will add a &quot;tip of the day&quot; feature to SEARCH.ASP, which 
will show a new Visual Basic tip each time a query is run. This feature uses 
the TextStream object of the File Access component to access a text file of tips 
and display one at random.
<H2>
<B>Step 1</B>
</H2>
<P>If you don't already have the Magazine project open, open it now. 
Add the text file TIPS.TXT to your project from the CD-ROM that accompanies this book.
<H2>
<B>Step 2</B>
</H2>
<P>Open TIPS.TXT, and examine the contents. Notice that the file structure 
has each tip on a separate line. You select a tip at random by reading a random 
line from the file. In SEARCH.ASP, add the following code below the 
&lt;/TABLE&gt; tag to present the tips:
<PRE WIDTH="0">&lt;H1&gt;Tip&#160;of&#160;the&#160;Day...&lt;/H1&gt;
&lt;%&#160;
`&#160;Tip&#160;of&#160;the&#160;day

`&#160;Variables
Dim&#160;objFile
Dim&#160;objStream
Dim&#160;TextNumber
Dim&#160;i

Set&#160;objFile&#160;=&#160;Server.CreateObject(&quot;Scripting.FileSystemObject&quot;)
Set&#160;objStream&#160;=&#160;objFile.OpenTextFile(Server.MapPath&#160;(&quot;/Magazine&quot;)&#160;_
&#160;&#160;&#160;&#160;+&#160;&quot;\tips.txt&quot;)

Randomize&#160;Timer
TextNumber&#160;=&#160;Int(Rnd*30)&#160;

For&#160;i&#160;=&#160;0&#160;to&#160;TextNumber
&#160;&#160;&#160;&#160;objStream.SkipLine&#160;
Next

strText&#160;=&#160;objStream.ReadLine&#160;
objStream.Close&#160;
%&gt;

&lt;H4&gt;&lt;%=strText%&gt;&lt;/H4&gt;
</PRE>
<P>Your result should look like Figure 8-9 on the following page.<P>
<img src="pictures/F08XF09.JPG" width=600 height=453 border=0><P>
<B>Figure 8-9.</B>


<I>Tip of the day.</I>








</BODY>
</HTML>
