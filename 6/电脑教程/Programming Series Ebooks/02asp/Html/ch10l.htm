<HTML>
<HEAD>
<TITLE>Part V: Creating the Web Pages</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>Part V: Creating the Web Pages</H1>
<H2>
<B>Step 1</B>
</H2>
<P>Start Visual InterDev. Create a new web project by choosing New from the 
File menu. When the New dialog box appears, click the Projects tab, and 
then choose the Web Project wizard. Locate your new project below the \MTS 
directory you created earlier, and then give your project the name 
NorthWind. Click OK.
<H2>
<B>Step 2</B>
</H2>
<P>The Web Project wizard will ask you for the name of the Web server on 
which the new project will be created. If this text box contains an entry, you can 
accept it; if the box is empty, type the name of the machine that is running 
Internet Information Server. Click Next. If you don't know the correct name of your 
Web server, look up the Identification information by using the Network applet 
in the Control Panel.
<P>The Web Project wizard will contact the selected Web server and 
present you with the step 2 dialog box. Choose the option Create A New Web. 
Make sure the name of the web is NorthWind. Check the option to enable 
full-text searching of the site, and click Finish. The Web Project wizard will create 
your new web and open the project.
<H2>
<B>Step 3</B>
</H2>
<P>This project will be built in a set of browser frames. Add a new HTML page 
for the frames by choosing New from the File menu. In the New dialog box, 
add a new HTML page and name the page DEFAULT.HTM. Click OK.
<P>Define the frame set for the application by altering the Web page to 
appear as follows:
<PRE WIDTH="0">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Transaction&#160;Server&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;FRAMESET&#160;COLS=&quot;27%,73%&quot;&gt;
&#160;&#160;&#160;&#160;&lt;FRAME&#160;SRC=&quot;categories.asp&quot;&#160;NAME=&quot;LIST&quot;&#160;SCROLLING=&quot;No&quot;&gt;
&#160;&#160;&#160;&#160;&lt;FRAME&#160;SRC=&quot;products.asp&quot;&#160;NAME=&quot;MAIN&quot;&#160;SCROLLING=&quot;No&quot;&gt;
&lt;/FRAMESET&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>
<P>Save the page.
<H2>
<B>Step 4</B>
</H2>
<P>Add a new ASP page to the project by choosing New from the File menu. 
In the New dialog box, select to add a new ASP page and name the page 
CATEGORIES.ASP. Click OK.
<P>This page will present a list of product categories to the user, who can 
then view the products by clicking hyperlinks. Add the following code to the 
BODY section of the page to create the categories from the NorthWind data source:
<PRE WIDTH="0">&lt;%
`&#160;Variables
Dim&#160;objQuery

`&#160;Create&#160;the&#160;business&#160;object
Set&#160;objQuery&#160;=&#160;Server.CreateObject(&quot;MTSObject.Query&quot;)

`&#160;Run&#160;the&#160;query
Dim&#160;strReturn
strReturn&#160;=&#160;objQuery.GetCategories

`&#160;Fill&#160;the&#160;list&#160;box
Dim&#160;intStart
Dim&#160;intCurrent

intStart&#160;=&#160;1
intCurrent&#160;=&#160;1

`&#160;Parse&#160;the&#160;returned&#160;string
Do&#160;While&#160;intCurrent&#160;&lt;&#160;Len(strReturn)
&#160;&#160;&#160;&#160;intCurrent&#160;=&#160;InStr(intStart,&#160;strReturn,&#160;&quot;|&quot;)
&#160;&#160;&#160;&#160;If&#160;intCurrent&#160;=&#160;0&#160;Then&#160;Exit&#160;Do
%&gt;
&lt;FONT&#160;FACE=&quot;Verdana&quot;&#160;SIZE=4&gt;
&lt;A&#160;TARGET=&quot;MAIN&quot;&#160;
HREF=&quot;products.asp?Product=&lt;%=Server.URLEncode(Mid(strReturn,&#160;intStart,&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;intCurrent&#160;-&#160;intStart))%&gt;&quot;&gt;
&#160;&#160;&#160;&#160;&lt;%=Mid(strReturn,&#160;intStart,&#160;intCurrent&#160;-&#160;intStart)%&gt;
&lt;/A&gt;
&lt;/FONT&gt;
&lt;%
&#160;&#160;&#160;&#160;intStart&#160;=&#160;intCurrent&#160;+&#160;1
Loop
%&gt;
</PRE>
<H2>
<B>Step 5</B>
</H2>
<P>Add a new ASP page to the project by choosing New from the File menu. 
In the New dialog box, select to add a new ASP page and name the page 
PRODUCTS.ASP. Click OK.<P>
This page will build a table of all products from the database in the 
selected category. Add the following code to the BODY section to create 
the HTML table:
<PRE WIDTH="0">&lt;%
'&#160;Create&#160;business&#160;object
Dim&#160;blnReturn
Dim&#160;objProducts
Set&#160;objProducts&#160;=&#160;Server.CreateObject(&quot;MTSObject.Query&quot;)

'&#160;Run&#160;query
Dim&#160;varReturn
blnReturn&#160;=&#160;_
&#160;&#160;&#160;&#160;objProducts.GetProducts(Request.QueryString(&quot;product&quot;),&#160;varReturn)
%&gt;

&lt;IMG&#160;SRC=&quot;banner.gif&quot;&gt;&lt;P&gt;

&lt;!--&#160;Begin&#160;table&#160;definition&#160;--&gt;
&lt;TABLE&#160;BORDER&#160;WIDTH=100%&gt;
&#160;&#160;&#160;&#160;&lt;TR&gt;
&#160;&#160;&#160;&#160;&lt;TD&gt;
&#160;&#160;&#160;&#160;Product
&#160;&#160;&#160;&#160;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&lt;TD&gt;
&#160;&#160;&#160;&#160;Company
&#160;&#160;&#160;&#160;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&lt;TD&gt;
&#160;&#160;&#160;&#160;Price
&#160;&#160;&#160;&#160;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&lt;/TR&gt;

&lt;%
'&#160;Fill&#160;the&#160;grid
Dim&#160;i
For&#160;i&#160;=&#160;0&#160;To&#160;UBound(varReturn,&#160;2)
%&gt;
&#160;&#160;&#160;&#160;&lt;TR&gt;
&#160;&#160;&#160;&#160;&lt;TD&gt;
&#160;&#160;&#160;&#160;&lt;%=varReturn(0,&#160;i)%&gt;
&#160;&#160;&#160;&#160;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&lt;TD&gt;
&#160;&#160;&#160;&#160;&lt;%=varReturn(1,&#160;i)%&gt;
&#160;&#160;&#160;&#160;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&lt;TD&gt;
&#160;&#160;&#160;&#160;&lt;%=varReturn(2,&#160;i)%&gt;
&#160;&#160;&#160;&#160;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&lt;/TR&gt;
&lt;%
Next
%&gt;
&lt;/TABLE&gt;
</PRE>
<H2>
<B>Step 6</B>
</H2>
<P>Save the project, and view DEFAULT.HTM in Internet Explorer. The 
result should look like the page in Figure 10-4. You will access Visual Basic 
business objects in MTS to perform the queries.<P>
<img src="pictures/F10XF04.JPG" width=600 height=451 border=0><P>
<B>Figure 10-4.</B>


<I>The completed exercise.</I>
</BODY>
</HTML>
