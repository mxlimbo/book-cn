<HTML>
<HEAD>
<TITLE>Part II: Creating the Home Page</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>Part II: Creating the Home Page</H1>
<P>In this part, you will create a home page for the catalog. Before you 
begin, however, you need to add some graphics files to your site.
<H2>
<B>Step 1</B>
</H2>
<P>If you don't already have the Catalog web open in Visual InterDev, open 
it now. On the FileView tab, click the IMAGES directory and 
then choose Add To Project/Files from the Project menu. Add the project images from 
the \CODE\CHAP07\CATALOG\ IMAGES directory.
<H2>
<B>Step 2</B>
</H2>
<P>Choose New from the File menu. When the New dialog box appears, click 
the Files tab and select HTML Page. In the File Name text box, type 
<I>default.htm</I>, and click OK. Visual InterDev will automatically add a new Web page to 
your site.
<H2>
<B>Step 3</B>
</H2>
<P>Right-click the file DEFAULT.HTM in the project window. Choose Open 
With from the pop-up menu. In the Open With dialog box, open the file with 
Microsoft FrontPage Editor (Visual InterDev Edition). 
<P>In FrontPage, choose Background from the Format menu. In the 
Page Properties dialog box, specify white as the background color for the page 
and click OK.
<P>To insert a page banner into the document, choose Image from the 
Insert menu. In the Image dialog box, add the new image by specifying its 
location. Use the following virtual directory:
<PRE WIDTH="0">/CATALOG/IMAGES/BANNER.JPG
</PRE>
<P>Hit the return key once to start a new line, and insert a horizontal 
rule by choosing Horizontal Line from the Insert menu. Save your page in 
FrontPage, and return to Visual InterDev.
<H2>
<B>Step 4</B>
</H2>
<P>In the following steps, you will use the Advanced Data Control (ADC) to 
build a list of product categories. The categories are kept in the database, so 
changes to the database will automatically update the Web page.
<P>To begin, open DEFAULT.HTM in the text editor in Visual InterDev. 
In DEFAULT.HTM, locate the horizontal rule (&lt;HR&gt;) tag that you inserted 
in FrontPage. Make some space below this tag, and add the ADC to the page 
by inserting the following code:
<PRE WIDTH="0">&lt;!--&#160;The&#160;Advanced&#160;Data&#160;Control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;datCategories&quot;&#160;HEIGHT=10&#160;WIDTH=10
&#160;&#160;&#160;&#160;CLASSID=&quot;clsid:BD96C556-65A3-11D0-983A-00C04FC29E33&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;SQL&quot;&#160;VALUE=&quot;SELECT&#160;*&#160;FROM&#160;Categories&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;SERVER&quot;&#160;VALUE=<B><I>[your&#160;site&#160;name]</I></B>&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;CONNECT&quot;&#160;VALUE=&quot;DSN=HomePage&quot;&gt;
&lt;/OBJECT&gt;
</PRE>
<P><HR><BLOCKQUOTE>
<B>WARNING:</b> The CLASSID attribute might be different for 
your version of the Advanced Data Control. Check it carefully.
</BLOCKQUOTE><HR><P>
<H2>
<B>Step 5</B>
</H2>
<P>Once the ADC is added, you can use it to retrieve category names, which 
will be placed in a special division of the Web page reserved only for 
categories. Create this division with the &lt;DIV&gt; tag. Add the following code to the 
BODY section of DEFAULT.HTM, just below the &lt;OBJECT&gt; tag that you added 
for the ADC:
<PRE WIDTH="0">&lt;!--&#160;The&#160;category&#160;list&#160;is&#160;built&#160;in&#160;this&#160;division&#160;--&gt;
&lt;SPAN&#160;ID=&quot;divCategories&quot;&#160;
STYLE=&quot;position:absolute;left:50;top:200;width:300;height:300;&quot;&gt;
&lt;/SPAN&gt;
</PRE>
<H2>
<B>Step 6</B>
</H2>
<P>The category division will be populated in the Window_OnLoad event 
handler. In the code's HEAD section, create a SCRIPT section and add code for 
the Window_OnLoad event. Create a Range object that points to the &lt;SPAN&gt; 
tag where the categories should be inserted. Then use the PasteHTML method 
of the Range object to paste records from the database into the division. Here 
is the code:
<PRE WIDTH="0">&lt;SCRIPT&#160;LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--

Sub&#160;Window_OnLoad
&#160;&#160;&#160;&#160;`&#160;**&#160;Create&#160;the&#160;product&#160;categories&#160;**
&#160;&#160;&#160;&#160;`&#160;Variables
&#160;&#160;&#160;&#160;Dim&#160;rngCategories
&#160;&#160;&#160;&#160;Dim&#160;objRecordset
&#160;&#160;&#160;&#160;Dim&#160;strID
&#160;&#160;&#160;&#160;Dim&#160;strCategory
&#160;&#160;&#160;&#160;Dim&#160;strStyle

&#160;&#160;&#160;&#160;`&#160;Create&#160;the&#160;Range&#160;object&#160;for
&#160;&#160;&#160;&#160;`&#160;adding&#160;new&#160;categories
&#160;&#160;&#160;&#160;Set&#160;rngCategories&#160;=&#160;Document.Body.CreateTextRange()
&#160;&#160;&#160;&#160;rngCategories.MoveToElementText(divCategories)
&#160;&#160;&#160;&#160;If&#160;rngCategories.Text&#160;&lt;&gt;&#160;&quot;&quot;&#160;Then&#160;Exit&#160;Sub

&#160;&#160;&#160;&#160;`&#160;Add&#160;the&#160;categories&#160;to&#160;the&#160;Range&#160;object
&#160;&#160;&#160;&#160;Set&#160;objRecordset&#160;=&#160;datCategories.Recordset
&#160;&#160;&#160;&#160;
&#160;&#160;&#160;&#160;objRecordset.MoveFirst
&#160;&#160;&#160;&#160;Do&#160;While&#160;Not&#160;objRecordset.EOF
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`&#160;Get&#160;category&#160;name&#160;and&#160;ID
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strCategory&#160;=&#160;objRecordset(&quot;CategoryName&quot;)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strID&#160;=&#160;objRecordset(&quot;CategoryID&quot;)MMM

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`&#160;Paste&#160;in&#160;new&#160;HTML
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strStyle&#160;=&#160;&quot;STYLE=font-style:normal;&#160;&quot;&#160;&amp;&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;background-color:transparent;&#160;font-size:20;&gt;&quot;

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;rngCategories.PasteHTML&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;&lt;P&gt;&lt;FONT&#160;&quot;&#160;&amp;&#160;&quot;ID='Category&quot;&#160;&amp;&#160;Trim(strID)&#160;&amp;&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;`&#160;FACE=Verdana&#160;COLOR=Blue&#160;&quot;&#160;&amp;&#160;strStyle&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&amp;&#160;strCategory&#160;&amp;&#160;&quot;&lt;/FONT&gt;&lt;/P&gt;&quot;

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`&#160;Move&#160;to&#160;next&#160;record
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;objRecordset.MoveNext
&#160;&#160;&#160;&#160;Loop
End&#160;Sub

--&gt;
&lt;/SCRIPT&gt;
</PRE>
<H2>
<B>Step 7</B>
</H2>
<P>Save the page, and preview it to verify that the categories are visible. Your 
page should look like the one shown in Figure 7-7.<P>
<img src="pictures/F07XF07.JPG" width=600 height=449 border=0><P>
<B>Figure 7-7.</B>


<I>Displaying categories.</I>
<H2>
<B>Step 8</B>
</H2>
<P>Now that you have the categories listed, you will want to display a 
description of each category when the mouse passes over its name. In order to 
accomplish this, create a second division in the page and write the category 
descriptions as hidden HTML text in the new division. Use Dynamic HTML to display 
a description when the mouse passes over its category title.
<P>Begin by adding the following division below the first division:
<PRE WIDTH="0">&lt;!--&#160;The&#160;category&#160;descriptions&#160;are&#160;shown&#160;here&#160;--&gt;
&lt;SPAN&#160;ID=&quot;divDescriptions&quot;&#160;
STYLE=&quot;position:absolute;left:350;top:200;width:300;height:300;&quot;&gt;
&lt;/SPAN&gt;
</PRE>
<P>Because the category descriptions are part of the database, you must 
add them to the new division dynamically at run time. The descriptions are 
added in the same manner as the category names&#151;by using a Range object. Add 
the following code to the Window_OnLoad event, after the code that generates 
the category listings:
<PRE WIDTH="0">`&#160;**&#160;Create&#160;the&#160;category&#160;descriptions&#160;**

'&#160;Variables
Dim&#160;rngDescriptions
Dim&#160;strDescription

'&#160;Create&#160;the&#160;style
strStyle&#160;=&#160;&quot;STYLE=position:container;&#160;left:0;&#160;top:0;&#160;&quot;&#160;&amp;&#160;_
&#160;&#160;&#160;&#160;&quot;visibility:hidden;&#160;font-size:16;&quot;

'&#160;Create&#160;the&#160;Range&#160;object
Set&#160;rngDescriptions&#160;=&#160;Document.Body.CreateTextRange()
rngDescriptions.MoveToElementText(divDescriptions)
If&#160;rngDescriptions.Text&#160;&lt;&gt;&#160;&quot;&quot;&#160;Then&#160;Exit&#160;Sub

'&#160;Add&#160;the&#160;descriptions&#160;to&#160;the&#160;division
objRecordset.MoveFirst
Do&#160;While&#160;Not&#160;objRecordset.EOF
&#160;&#160;&#160;&#160;`&#160;Get&#160;description&#160;and&#160;ID
&#160;&#160;&#160;&#160;strDescription&#160;=&#160;objRecordset(&quot;CategoryDescription&quot;)
&#160;&#160;&#160;&#160;strID&#160;=&#160;objRecordset(&quot;CategoryID&quot;)

&#160;&#160;&#160;&#160;`&#160;Paste&#160;in&#160;new&#160;HTML
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;rngDescriptions.PasteHTML&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;&lt;P&gt;&lt;FONT&#160;FACE='Viner&#160;Hand&#160;ITC'&#160;COLOR=Purple&#160;ID='Text&quot;&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&amp;&#160;Trim(strID)&#160;&amp;&#160;&quot;`&#160;&quot;&#160;&amp;&#160;strStyle&#160;&amp;&#160;&quot;&gt;&quot;&#160;&amp;&#160;strDescription&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&amp;&#160;&quot;&lt;/FONT&gt;&lt;/P&gt;&quot;

&#160;&#160;&#160;&#160;`Move&#160;to&#160;next&#160;record
&#160;&#160;&#160;&#160;objRecordset.MoveNext
Loop
</PRE>
<H2>
<B>Step 9</B>
</H2>
<P>When the descriptions are added to the page, they are invisible. The 
Visibility argument of the STYLE attribute is set to hidden. You will use the 
OnMouseOver and OnMouseOut events to display each description at the 
appropriate time&#151;that is, when the mouse passes over its catalog name. Place the 
event handlers in the same SCRIPT section you used for the Window_OnLoad 
event, and write them at the SPAN level, which will trap all events from the items 
in the division. When the OnMouseOver or OnMouseOut event of the 
division fires, the SrcElement property will determine exactly which category 
received the event and will fire the transition to show the text:
<PRE WIDTH="0">Sub&#160;divCategories_OnMouseOver()
&#160;&#160;&#160;&#160;`&#160;Mouse&#160;passes&#160;over&#160;a&#160;category

&#160;&#160;&#160;&#160;Dim&#160;objEvent
&#160;&#160;&#160;&#160;Dim&#160;strTarget

&#160;&#160;&#160;&#160;On&#160;Error&#160;Resume&#160;Next

&#160;&#160;&#160;&#160;`&#160;Get&#160;the&#160;target&#160;element
&#160;&#160;&#160;&#160;Set&#160;objEvent&#160;=&#160;Window.Event
&#160;&#160;&#160;&#160;strTarget&#160;=&#160;objEvent.SrcElement.ID

&#160;&#160;&#160;&#160;If&#160;strTarget&#160;&lt;&gt;&#160;&quot;divCategories&quot;&#160;Then
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`&#160;Change&#160;the&#160;category&#160;attributes
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;objEvent.SrcElement.Style.FontStyle&#160;=&#160;&quot;italic&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;objEvent.SrcElement.Color&#160;=&#160;&quot;Black&quot;

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`&#160;Show&#160;the&#160;category&#160;description
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Select&#160;Case&#160;strTarget
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category1&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text1.Style.Visibility&#160;=&#160;&quot;visible&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category2&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text2.Style.Visibility&#160;=&#160;&quot;visible&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category3&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text3.Style.Visibility&#160;=&#160;&quot;visible&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category4&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text4.Style.Visibility&#160;=&#160;&quot;visible&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;End&#160;Select
&#160;&#160;&#160;&#160;End&#160;If
End&#160;Sub

Sub&#160;divCategories_OnMouseOut()
&#160;&#160;&#160;&#160;`&#160;Mouse&#160;leaves&#160;a&#160;category

&#160;&#160;&#160;&#160;Dim&#160;objEvent
&#160;&#160;&#160;&#160;Dim&#160;strTarget

&#160;&#160;&#160;&#160;On&#160;Error&#160;Resume&#160;Next

&#160;&#160;&#160;&#160;`&#160;Get&#160;the&#160;target&#160;element
&#160;&#160;&#160;&#160;Set&#160;objEvent&#160;=&#160;Window.Event
&#160;&#160;&#160;&#160;strTarget&#160;=&#160;objEvent.SrcElement.ID

&#160;&#160;&#160;&#160;If&#160;strTarget&#160;&lt;&gt;&#160;&quot;divCategories&quot;&#160;Then
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`&#160;Change&#160;the&#160;category&#160;to&#160;normal
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;objEvent.SrcElement.Style.FontStyle&#160;=&#160;&quot;normal&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;objEvent.SrcElement.Color&#160;=&#160;&quot;Blue&quot;

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;`&#160;Hide&#160;the&#160;description
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Select&#160;Case&#160;strTarget
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category1&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text1.Style.Visibility&#160;=&#160;&quot;hidden&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category2&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text2.Style.Visibility&#160;=&#160;&quot;hidden&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category3&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text3.Style.Visibility&#160;=&#160;&quot;hidden&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Case&#160;&quot;Category4&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Text4.Style.Visibility&#160;=&#160;&quot;hidden&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;End&#160;Select
&#160;&#160;&#160;&#160;End&#160;If
End&#160;Sub
</PRE>
<H2>
<B>Step 10</B>
</H2>
<P>Save your work, and view the page in Internet Explorer. You should now 
see the categories and descriptions. The result should look like the 
page shown in Figure 7-8.<P>
<img src="pictures/F07XF08.JPG" width=600 height=449 border=0><P>
<B>Figure 7-8.</B>


<I>Displaying category descriptions.</I>








</BODY>
</HTML>
