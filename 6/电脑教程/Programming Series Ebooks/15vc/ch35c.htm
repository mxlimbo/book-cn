<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Microsoft IIS</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY>
<A NAME="923"><H1>Microsoft IIS</H1></A><P>Microsoft IIS is a high-performance Internet/intranet server that takes 
advantage of Windows NT features such as I/O completion ports, the Win32 
function <I>TransmitFile</I>, file-handle caching, and CPU scaling for threads.
<A NAME="924"><H2>Installing and Controlling IIS</H2></A><P>When you install Windows NT Server 4.0, you are given the option of 
installing IIS. If you selected IIS at setup, the server will be running whenever 
Windows NT is running. IIS is a special kind of Win32 program called a 
<U>service</U> (actually three services&#151;WWW, HTTP, and gopher&#151;in one program 
called inetinfo.exe), which won't appear in the taskbar. You can control IIS from 
the Services icon in the Control Panel, but you'll probably want to use the 
Internet Service Manager program instead.
<A NAME="925"><H2>Running Internet Service Manager</H2></A><P>You can run Internet Service Manager from the Microsoft Internet Server 
menu that's accessible on the Start menu.
<P>
<DIV CLASS=note>
<BLOCKQUOTE>
<IMG SRC="note.jpg" width=123 height=18 BORDER="0"><P>
You can also run an HTML-based version of 
Internet Service Manager remotely from a browser. That version allows 
you to change service parameters, but it won't let you turn services on 
and off.
</BLOCKQUOTE></DIV>
<P>Figure 35-1 shows the Microsoft Internet Service Manager screen with 
the World Wide Web (WWW) running and FTP services stopped.
<P>You can select a service by clicking on its icon at the left. The triangle 
and square buttons on the toolbar of the screen allow you to turn the selected 
service on or off.
<P><A HREF="javascript:fullSize('f35og01x.htm')"> <img src="f35og01.jpg" width=404 height=150 border=0 ALT = "Click to view at full size."> </A><P>
<!-- caption -->
<B>Figure 35-1.</B> <I>The Microsoft Internet Service Manager screen.</I>
<!-- /caption -->
<A NAME="926"><H3>IIS Security</H3></A><P>After you double-click on the WWW service icon of the Microsoft 
Internet Service Manager screen, you'll see a property sheet. The Service page lets 
you configure IIS security. When a client browser requests a file, the server 
impersonates a local user for the duration of the request and that user name 
determines which files the client can access. Which local user does the server 
impersonate? Most often, it's the one you see in the Username field, shown in 
Figure 35-2.
<P><A HREF="javascript:fullSize('f35og02x.htm')"> <img src="f35og02.jpg" width=404 height=393 border=0 ALT = "Click to view at full size."> </A><P>
<!-- caption -->
<B>Figure 35-2.</B> <I>The WWW Service Properties screen.</I>
<!-- /caption -->
<P>Most Web page visitors don't supply a user name and password, so 
they are considered <U>anonymous</U> <U>users</U>. Those users have the same rights they 
would have if they had logged on to your server locally as 
IUSR_MYMACHINENAME. That means that IUSR_MYMACHINENAME must appear in the 
list of users that is displayed when you run User Manager or User Manager 
For Domains (from the Administrative Tools menu), and the passwords must 
match. The IIS Setup program normally defines this anonymous user for you. You 
can define your own WWW anonymous user name, but you must be sure that 
the entry on the Service page matches the entry in the computer's (or Windows 
NT domain's) user list.
<P>Note also the Password Authentication options. For the time being, 
stick to the Allow Anonymous option only, which means that all Web users are 
logged on as IUSR_MYMACHINENAME. Later in this chapter, we'll explain 
Windows NT Challenge/Response.
<A NAME="927"><H3>IIS Directories</H3></A><P>Remember SlowSoft's Web site from <A HREF="ch34a.htm">Chapter 34</A>? If you requested the 
URL http://slowsoft.com/newproducts.html, the newproducts.html file would 
be displayed from the slowsoft.com <U>home</U> 
<U>directory</U>. Each server needs a home directory, even if that directory contains only subdirectories. The home directory does not need to be the server computer's root directory, however. 
As shown in Figure 35-3, the WWW home directory is really 
\WebHome, so 
clients read the disk file \WebHome\newproducts.html.
<P><A HREF="javascript:fullSize('f35og03x.htm')"> <img src="f35og03.jpg" width=404 height=393 border=0 ALT = "Click to view at full size."> </A><P>
<!-- caption -->
<B>Figure 35-3.</B> <I>The \WebHome WWW home directory screen.</I>
<!-- /caption -->
<P>Your server could get by with a home directory only, but the IIS 
<U>virtual directory</U> feature might be useful. Suppose SlowSoft wanted to allow Web 
access to the directory \BF on the D drive. The screen above shows a virtual 
/BugsFixed directory that maps to D:\BF. Clients would access files with a 
URL similar to this: http://slowsoft.com/BugsFixed/file1.html.
<P>
<DIV CLASS=note>
<BLOCKQUOTE>
<IMG SRC="note.jpg" width=123 height=18 BORDER="0"><P>
If your computer was configured for multiple IP 
addresses (see the Control Panel Network icon), IIS would allow you to 
define <U>virtual</U> <U>Web</U> <U>servers</U>. Each virtual server would have its own 
home directory (and virtual directories) attached to a specified IP 
address, making it appear as though you had several server computers. 
Unfortunately, the IIS Web server listens on all the computer's IP 
addresses, so you can't run IIS simultaneously with the EX34A 
server with both listening on port 80.
</BLOCKQUOTE></DIV>
<P>As described in <A HREF="ch34a.htm">Chapter 34</A>, browsers can issue a blind request. As 
Figure 35-3 shows, Internet Service Manager lets you specify the file that a blind 
request selects, usually Default.htm. If you select the Directory Browsing 
Allowed option of the Directories page on the service property screen, browser 
clients can see a hypertext list of files in the server's directory instead.
<A NAME="928"><H3>IIS Logging</H3></A><P>IIS is capable of making log entries for all connections. You control logging 
from the Internet Service Manager's Logging property page. You can specify text 
log files, or you can specify logging to an SQL/ODBC database. Log entries 
consist of date, time, client IP address, file requested, query string, and so forth.
<A NAME="929"><H2>Testing IIS</H2></A><P>It's easy to test IIS with a browser or with any of the EX35A clients. Just 
make sure that IIS is running and that the EX35A server is not running. The 
default IIS home directory is \Winnt\System32\inetsrv\wwwroot, and some HTML 
files are installed there. If you're running a single machine, you can use 
the localhost host name. For a network, use a name from the Hosts file. If you 
can't access the server from a remote machine, run ping to make sure the network 
is configured correctly. Don't try to build and run ISAPI DLLs until you have 
successfully tested IIS on your computer.
</BODY>
</HTML>



