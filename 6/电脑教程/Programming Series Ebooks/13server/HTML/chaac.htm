<HTML>
<HEAD>
<TITLE>Forcing the Linker to Look for a (<i>w</i>)<i>WinMain</i> Entry-Point Function</TITLE>
<link rel="STYLESHEET" type="text/css" href="prosrvwin.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<A HREF="chaab.htm">[Previous]</A> <A HREF="chaad.htm">[Next]</A><P>

<A NAME="300"><h1>Forcing the Linker to Look for a (<i>w</i>)<i>WinMain</i> Entry-Point Function</h1></A>
<p>After readers add my source code modules to a new Microsoft Visual C++ project and then try to build the project, they receive linker errors. The problem is that they created a Win32 Console Application project, causing the linker to look for a (<i>w</i>)<i>main</i> entry-point function. Since all the book's sample applications are GUI applications, my source code has a <i>_tWinMain</i> entry-point function instead, which causes the linker to complain.</p>

<p>My standard reply to readers is as follows: delete the project, create a new Win32 Application project (note that the word &quot;Console&quot; doesn't appear in this project type) with Visual C++, and then add my source code files to it. The linker looks for a (<i>w</i>)<i>WinMain</i> entry-point function, which I do supply in my code, and which allows the projects to build properly.</p>

<p>To reduce the amount of e-mail I get on this issue, I added a <i>pragma</i> to CmnHdr.h that forces the linker to look for the (<i>w</i>)<i>WinMain</i> entry-point function even if you create a Win32 Console Application project with Visual C++.</p>

<p>In Chapter 4 of <i>Programming Applications for Microsoft Windows, Fourth Edition</i> (Jeffrey Richter, Microsoft Press, 1999), I go into great detail about what the Visual C++ project types are all about, how the linker chooses which entry-point function to look for, and how to override the linker's default behavior.</p>

</BODY>
</HTML>




