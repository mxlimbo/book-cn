<HTML>
<HEAD>
<TITLE>Events</title>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</head>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch15c.htm" , "ch15e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>



<A NAME="462"><H1>Events</H1></A>

<p>Events are asynchronous routines that get called upon a specific event. In your Visual Basic application, you must handle the various events that might be generated by the Winsock control in order to successfully use the control. Generally, these events are triggered by actions that the peer initiates. For example, the TCP half-close is triggered when one side of a TCP connection closes the socket. The side initiating the close generates a FIN, and the peer responds with an ACK to acknowledge the close request. The peer receiving the FIN has the <i>Close</i> event triggered. This tells your Winsock application that the other side is no longer sending data. Your application then reads any remaining data and calls the <i>Close</i> method on your end to completely shut down the connection. Table 15-4 lists all possible Winsock events that can be triggered, along with a description of each event.</p>

<p><b>Table 15-4.</b> <i>Winsock control events</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th><i>Event</i></th>
			<th><i>Arguments</i></th>
			<th><i>Description</i></th>
		</tr>
		
		<tr>
			<td valign="top"><i>Close</i></td>
			<td valign="top">None</td>			
			<td valign="top">Occurs when the remote computer closes the connection</td>
		</tr>

		<tr>
			<td valign="top"><i>Connect</i></td>
			<td valign="top">None</td>			
			<td valign="top">Occurs after the <i>Connect</i> method completes successfully</td>
		</tr>

		<tr>
			<td valign="top"><i>ConnectionRequest</i></td>
			<td valign="top"><i>RequestID</i></td>			
			<td valign="top">Occurs when a remote machine requests a connection</td>
		</tr>

		<tr>
			<td valign="top"><i>DataArrival</i></td>
			<td valign="top"><i>bytesTotal</i></td>			
			<td valign="top">Occurs when new data arrives</td>
		</tr>

		<tr>
			<td valign="top"><i>Error</i></td>
			<td valign="top"><i>Number</i><br><i>Description</i><br><i>Scode</i><br>
<i>Source</i><br><i>HelpFile</i><br><i>HelpContext</i><br><i>CancelDisplay</i></td>			
			<td valign="top">Occurs whenever a Winsock error is generated</td>
		</tr>
		
		<tr>
			<td valign="top"><i>SendComplete</i></td>
			<td valign="top">None</td>			
			<td valign="top">Occurs upon completion of a send operation</td>
		</tr>

		<tr>
			<td valign="top"><i>SendProgress</i></td>
			<td valign="top"><i>bytesSent</i><br><i>bytesRemaining</i></td>			
			<td valign="top">Occurs while data is being sent</td>
		</tr>
		
	</table>
</p>

</BODY>
</HTML>




