<HTML>
<head>
<link rel="STYLESHEET" type="text/css" href="Progie5.css">
<TITLE>How Internet Explorer Starts a BHO</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch12a.htm">[Previous]</A> <A HREF="ch12c.htm">[Next]</A><P>

<A NAME="277"><H1>How Internet Explorer Starts a BHO</H1></A>

<p>Each time a new instance of Internet Explorer starts, it checks the Registry for 
the following key:</p>

<p><table cellpadding=5 width="95%"><TR><TD>
<PRE>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion
   \Explorer\Browser Helper Objects
</PRE>
</td></tr></table></p>

<p>If Internet Explorer finds this key in the Registry, it looks for one or more CLSIDs 
listed below the key, as shown in Figure 12-1.</p>

<p>
<A HREF="javascript:fullSize('F12ii01x.htm')"> <img src="images/F12ii01.JPG" width=404 height=188 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><B>Figure 12-1.</B> <I>Registry keys.</I><!-- /caption -->
</p>

<p>The CLSID keys under the <I>Browser Helper Objects 
</I>key tell Internet Explorer which BHOs to load. You can create a 
<I>CLSID</I> key for your BHO manually by editing the Registry yourself, or you can have the registration code for your BHO insert 
this key for you.</p>

<p>For each CLSID that is listed below the <I>Browser Helper 
Objects</I> key, Internet Explorer calls 
<I>CoCreateInstance</I> to start an instance of the Browser Helper Object 
in the same process space as the browser. In other words, Internet Explorer starts 
the BHO as an in-proc server. If the BHO has registered its CLSID and implements 
the <I>IObjectWithSite</I> interface, the BHO is started by Internet Explorer and is passed 
a pointer to the <I>IWebBrowser2</I> interface of Internet Explorer. Through this 
interface, the BHO can control and receive events from Internet Explorer in the same way 
that you've seen in earlier chapters.</p>

<p>Remember that as long as the BHO is built correctly, it will be loaded each 
time a new instance of Internet Explorer is started. So if you have the Microsoft 
Active Desktop installed, the BHO will be loaded each time you open a folder, a 
subfolder, or a browser window. If you no longer want the BHO to be loaded, you must 
remove the Registry keys that are associated with it. Again, you can do this 
manually by editing the Registry yourself, or you can have the unregistration code of 
your Browser Helper Object do it for you.</p>

</BODY>
</HTML>





