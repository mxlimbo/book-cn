<HTML>
<head>
<link rel="STYLESHEET" type="text/css" href="Progie5.css">
<TITLE>Creating Explorer Bars Using DHTML and Script</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch10b.htm">[Previous]</A> <A HREF="ch10d.htm">[Next]</A><P>

<A NAME="231"><H1>Creating Explorer Bars Using DHTML and Script</H1></A>

<P>Creating Explorer Bars for Internet Explorer 5 is relatively easy, especially if 
you already know how to create Web pages. You just need to add a few keys and 
values to the Registry to tell Internet Explorer where to obtain your Web page and how 
to display it&#8212;vertically, as an Explorer band, or horizontally, as a Comm band.</P>

<P>To show your Web page as an Explorer Bar in Internet Explorer, perform 
the following steps:</P>

<OL>
<P><LI>Create a globally unique identifier (GUID) that will be used for 
your Web page. Use the Guidgen.exe program that is included with 
Microsoft Visual Studio.</LI></P>
<P><LI>From the Create GUID dialog box, select the Registry Format radio 
button, as shown in Figure 10-6. Then click the 
Copy button to copy the new GUID to the clipboard.</LI></P>

<P>
<img src="images/F10ii06.GIF" width=375 height=339 border="0">
</P><P>
<!-- caption --><B>Figure 10-6.</B> <I>The Create GUID dialog box.</I><!-- /caption -->
</P>

<P><LI>Run the Regedit application, and create a new key under 
<I>HKEY_CLASSES_
ROOT\CLSID</I>. Name it by using the GUID you created in step 1. The 
new key should look like this:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>HKEY_CLASSES_ROOT\CLSID\&lt;GUID Created In Step 1&gt;</PRE>
</TD></TR></TABLE></P>
</LI></P>
<P><LI>Set the <I>Default</I> value of this key to the name of your Explorer Bar 
that you want to appear in Internet Explorer's View/Explorer Bar menu.</LI></P>
<P><LI>Create a new subkey beneath the key you created in step 3, and 
name this key <I>Implemented Categories</I>. This key will tell Internet Explorer 
how to display your Explorer Bar&#8212;vertically or horizontally. The new 
key should look like this:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>HKEY_CLASSES_ROOT\CLSID\&lt;GUID Created In Step 1&gt;\Implemented 
   Categories</PRE>
</TD></TR></TABLE></P>
</LI></P>
<P><LI>Create a subkey beneath the key you created in step 5, and name it by 
using the category ID (CATID) of the type of Explorer Bar you want to create.</LI></P>
<P>The following table shows the CATIDs that you can use to 
specify an Explorer band or a Comm band. (You can't specify a Desk band 
by using this technique.)</P>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR>
<TH><i>Category ID (CATID)</i></TH>
<TH><i>Purpose</i></TH>
</TR><TR>
<TD VALIGN="TOP">{00021493-0000-0000-C000-000000000046}</TD>
<TD VALIGN="TOP">Explorer band (vertical)</TD>
</TR><TR>
<TD VALIGN="TOP">{00021494-0000-0000-C000-000000000046}</TD>
<TD VALIGN="TOP">Comm band (horizontal)</TD>
</TR></TABLE></P>

     
<P>At this point, the keys you've created should look similar to 
those shown in Figure 10-7. Of course, the GUID you created in step 1 will 
be different.</P>

<P>
<A HREF="javascript:fullSize('F10ii07x.htm')"> <img src="images/F10ii07.JPG" width=404 height=279 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!-- caption --><B>Figure 10-7.</B> <I>New Registry keys after step 6.</I><!-- /caption -->
</P>

<P><LI>Create a new key under the key you created for your GUID in step 3, 
and name it <I>InProcServer32</I>. The new key should look like this:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>HKEY_CLASSES_ROOT\CLSID\&lt;GUID Created In Step 1&gt;
\InProcServer32</PRE>
</TD></TR></TABLE></P>
</LI></P>
<P><LI>The value of the key you created in step 7 will tell Internet 
Explorer how to start your Explorer Bar. Because you are creating an Explorer 
Bar to contain a Web page that you've created, set the 
<I>Default </I>value of the <I>InProcServer32</I> key to the full path of shdocvw.dll. (The 
shdocvw.dll file is located in the \Windows\System directory for Microsoft Windows 
95 and later versions, and the \WinNT\System32 directory for 
Microsoft Windows NT systems.)</LI></P>
<P>If you were creating an Explorer Bar in C++ and COM, you 
would set this value to the path of the Explorer Bar's DLL file. (More on this 
in the next section.)</P>
<P><LI>Create a new string value under the 
<I>InProcServer32</I> key named 
<I>ThreadingModel</I>. Set the value of 
<I>ThreadingModel</I> to <I>Apartment</I>. The Registry keys should look similar to those in Figure 10-8.</LI></P>

<P>
<A HREF="javascript:fullSize('F10ii08x.htm')"> <img src="images/F10ii08.JPG" width=404 height=279 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!-- caption --><B>Figure 10-8.</B> <I>Registry keys after step 9.</I><!-- /caption -->
</P>

<P><LI>Create a new key under the GUID key that you created in step 3, and 
name this key <I>Instance</I>. This key is required for Explorer Bars that display 
Web pages but is optional for Explorer Bars created by using C++ and 
COM. The new key should look like this:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>HKEY_CLASSES_ROOT\CLSID\&lt;GUID Created In Step 1&gt;\Instance</PRE>
</TD></TR></TABLE></P>
</LI></P>
<P><LI>Create a new string value named 
<I>CLSID</I> under the <I>Instance </I>key. Set 
the value of <I>CLSID</I> as follows:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>{4D5C8C2A-D075-11d0-B416-00C04FB90376}</PRE>
</TD></TR></TABLE></P>
</LI></P>

<P><LI>Create a new key named 
<I>InitPropertyBag</I> under the <I>Instance </I>key. 
Again, this key is required only if you are creating an Explorer Bar that 
displays a Web page. The new key should look like this:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>HKEY_CLASSES_ROOT\CLSID\&lt;GUID Created In Step 1&gt;
\Instance\InitPropertyBag</PRE>
</TD></TR></TABLE></P>
</LI></P>
<P><LI>Create a new string value under the 
<I>InitPropertyBag</I> key that you just created. Name this string 
<I>URL</I>, and set its value to the location of the 
Web page that you want displayed in the Explorer Bar. Now the Registry 
key structure should look similar to Figure 10-9.</LI></P>

<P>
<A HREF="javascript:fullSize('F10ii09x.htm')"> <img src="images/F10ii09.JPG" width=404 height=279 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!-- caption --><B>Figure 10-9.</B> <I>Registry key structure after step 13.</I><!-- /caption -->
</P>

<P>If you'd like to specify the default size of your Explorer Bar when 
it is first displayed, follow these additional steps:</P>

<P><LI>Create a new key by using the GUID you created in step 1. This key 
will be created beneath another branch of the Registry, and it should 
look like this:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>HKEY_LOCAL_MACHINE\Software\Microsoft\Internet 
   Explorer\Explorer Bars\&lt;GUID Created In Step 1&gt;</PRE>
</TD></TR></TABLE></P>
</LI></P>
<P><LI>Create a new binary value named 
<I>BarSize </I>under the key you created in the previous step. Set the value of 
<I>BarSize </I>to an 8-byte, binary value in hexadecimal notation that specifies the default size for your Explorer Bar.</LI></P>
<P>Internet Explorer interprets the value in pixels. For instance, 
setting the value to <I>41 00 00 00 00 00 00 
00</I> is equal to 65 pixels. To determine the hexadecimal value that you should use for 
<I>BarSize</I>, just convert from decimal to hexadecimal the number of pixels that you want your 
Explorer Bar to be.</P>
</OL>


<P>Now you have a working Explorer Bar that displays a Web page. 
Although performing all these steps might be cumbersome if you do it manually, you can 
easily create an ActiveX control that will do it for you. Then you can put this ActiveX 
control on a Web page so that your Explorer Bar will be installed when users 
navigate to your Web site.</P>
<P>To test your Explorer Bar, select the View/Explorer Bar menu. The name 
you provided in step 4 will appear on that menu. Just select it as you would any 
other Explorer Bar. You can also add a button to Internet Explorer's toolbar, as you'll 
see later in this chapter.</P>

<P><DIV CLASS="TIP"><BLOCKQUOTE><B>TIP</B><HR>
To initiate navigation in the main Internet Explorer window when users 
click a link on the Web page in your Explorer Bar, set 
<I>TARGET=_main</I> as follows:
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>&lt;A HREF=&quot;http://msdn.microsoft.com/workshop&quot; TARGET=_main&gt;</PRE>
</TD></TR></TABLE></P>
</BLOCKQUOTE></DIV></P>

</BODY>
</HTML>





