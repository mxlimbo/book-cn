<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>A Help Example -- No Programming Required</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY>
<A NAME="456"><H1><B>A Help Example&#151;No Programming Required</B></H1></A>
<P>If you followed the instructions for EX20D in <A HREF="ch20a.htm">Chapter 20</A>, you selected the AppWizard Context-Sensitive Help option. We'll now return to that example and explore the application framework's built-in help capability. You'll see how easy it is to link help topics to menu command IDs and frame window resource IDs. You edit RTF files, not CPP files.

<P>Here are the steps for customizing the help for EX20D:

<ol>
<P><LI><B>Verify that the help file was built correctly.</B> If you have built the EX20D project already, chances are that the help file was created correctly as part of the build process. Check this by running the application and then pressing the F1 key. You should see the generic Application Help screen with the title &quot;Modifying the Document,&quot; as shown below.

<P>If you do not see this screen, the MAKEHELP batch file did not 
run correctly. First check the last two lines of the ex20d.hpj file in the \hlp subdirectory. Are the paths correct for your Visual C++ installation? Next choose Options from the Tools menu, and click on the Directories tab. Make sure that the \VC98\bin subdirectory of your Visual C++ directory is one of the search directories for Executable Files.

<P><A HREF="javascript:fullSize('g21og11x.htm')"> <img src="g21og11.jpg" width=404 height=374 border=0 ALT = "Click to view at full size."> </A>

<P>To generate the help file, highlight the ex20d.hpj file in the 
Workspace FileView window, and then choose Compile Ex20d.hpj from the 
Build menu. This runs the MAKEHELP batch file that is in your project 
directory. (You can also run it directly from an MS-DOS prompt.) You 
should observe some &quot;file(s) copied&quot; messages but no error messages. Rerun the EX20D program, and press F1 again.


<DIV CLASS=note>
<BLOCKQUOTE>
<IMG SRC="note.jpg" width=123 height=18 BORDER=0><P>
The Visual C++ make processor doesn't always detect all the dependencies in your help system. Sometimes you must run the MAKEHELP batch file yourself to rebuild the HLP file after making changes.</blockquote>
</div>


<P><LI><B>Test the generic help file.</B>  Try the following experiments:

<UL>
<LI>Close the Help dialog, press Alt-F and then press F1. This 
should open the help topic for the File New command. You can also press F1 while holding down the mouse button on the File New menu 
item to see the same help topic.

<P><LI>Close the Help dialog, click the Context Help toolbar button 
(shown in &quot;<A HREF="ch21c.htm#453">Shift-F1 Help</A>&quot;), and then choose Save from the File menu. Do you 
get the appropriate help topic?

<P><LI>Click the Context Help toolbar button again, and then select 
the frame window's title bar. You should get an explanation of a 
Windows title bar.

<P><LI>Close all child windows and then press F1. You should see a 
main index page that is also an old-style table of contents.
</ul>

<P><LI><B>Change the application title.</B>  The file AfxCore.rtf, in 
the \vcpp32\ex20d\hlp directory, contains the string 
<I>&lt;&lt;YourApp&gt;&gt;</I> throughout. Replace it globally with 
<I>EX20D</I>.

<P><LI><B>Change the Modifying The Document Help screen.</B>  The file AfxCore.rtf in the \vcpp32\ex20d\hlp directory contains text for the generic Application Help screen. Search for <I>Modifying the Document</I>, and then change the text to something appropriate for the application. This topic has the help context ID <I>HIDR_DOC1TYPE</I>. The generated ex20d.hpj file provides the alias <I>HIDR_EX20DTYPE</I>.

<P><LI><B>Add a topic for the Window New String Window menu item.</B> The New String Window menu item was added to EX20D and thus didn't have associated help text. Add a topic to AfxCore.rtf, as shown here.


<P><A HREF="javascript:fullSize('g21og12x.htm')"> <img src="g21og12.jpg" width=404 height=273 border=0 ALT = "Click to view at full size."> </A>


<P>Notice the <I>#</I> footnote that links the topic to the context ID 
<I>HID_WINDOW_NEW_STRING</I> as defined in hlp\ex20d.hm. The program's command ID for the New String Window menu item is, of course, <I>ID_WINDOW_NEW_STRING</I>.

<P><LI><B>Rebuild the help file and test the application.</B> Run the MAKEHELP batch file again, and then rerun the EX20D program. Try the two new help links.
</ol>

</BODY>
</HTML>



