<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>初学者(13) (2千字)<br>
<font color=blue>发信人:</font>liutong<br>
<font color=blue>时 间:</font>2000-6-9 22:43:23 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 软件来源:软件世界2000年2A <br>
  软件用途: <br>
  WinOKE was created because I saw a need for a simple cheap way to do a Karaoke, 
  but without the expense or hassle of getting in the big Karaoke machines. Why 
  not set-up and run a karaoke from your home computer, a system where you could 
  put any text into the program in time to the music would be great. Well here 
  it is, WinOKE, and it's great! <br>
  <br>
  注册时需要输入以下内容(所有的内容都将用于计算注册码) <br>
  Customer Code <br>
  Name <br>
  Adress 1 <br>
  Adress 2 <br>
  Adress 3 <br>
  Adress 4 <br>
  Post/Zip Code <br>
  Country <br>
  Unlocking Code <br>
  <br>
  设中断bpx hmemcpy,点"注册"键 <br>
  按F12若干次可找到 <br>
  CALL 0047FC30 <br>
  MOV EAX,[00490EA4] <br>
  CMP BYTE PTR [EAX],00 &lt;----注册与否标志 <br>
  JZ 0047539C&nbsp; &lt;-----错误由此跳转 <br>
  追进0047FC30,找到 <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;CALL 00403F74 <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;JZ 0047FE6E <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;XOR EAX,EAX <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;JMP 0047FE70 <br>
  0047FE6E&nbsp; &nbsp;&nbsp;MOV AL,01 <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;MOV [0049294B],AL <br>
  0047FE70&nbsp; &nbsp;&nbsp;XOR EAX,EAX <br>
  因此只需将JMP改为90 90即可使此软件变为freeware <br>
  <br>
  以下是追踪注册码生成的过程: <br>
  设中断bpx hmemcpy,点"注册"键 <br>
  按F12待返回到WinOKE程序后,按F10可找到两个CALL <br>
  CALL 00403F74 &lt;----检测Customer Code <br>
  JNZ 0047FE6A <br>
  <br>
  CALL 00403F74 &lt;----检测Unlocking Code <br>
  JZ 0047FE6E&nbsp; &nbsp;&nbsp; <br>
  Customer Code的生成过程: <br>
  Customer Code共6位,前4位用户输入,后2位由前4位生成 <br>
  Unlocking Code的生成过程: <br>
  Unlocking Code共11位,前3位是固定的"OKE" <br>
  第4-9位由用户输入项计算生成 <br>
  最后两位则有前面的9位计算生成 <br>
  <br>
  举例说明: <br>
  Customer Code: 0003** <br>
  Name:&nbsp; LiuTong <br>
  Adress 1: HePing <br>
  Adress 2: <br>
  Adress 3: <br>
  Adress 4: <br>
  Post/Zip Code: 100028 <br>
  Country: China <br>
  Unlocking Code: *********** <br>
  <br>
  Customer Code的计算: <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 
  &nbsp; 0&nbsp; &nbsp; &nbsp; 3 <br>
  ASCII码&nbsp; &nbsp; &nbsp; 30&nbsp; &nbsp; &nbsp; 30&nbsp; &nbsp; 30&nbsp; &nbsp; 
  33 <br>
  系数&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; 3&nbsp; &nbsp; &nbsp; 
  4&nbsp; &nbsp; &nbsp; 1 <br>
  乘积&nbsp; &nbsp; &nbsp; &nbsp; 60&nbsp; &nbsp; &nbsp; 90&nbsp; &nbsp; c0&nbsp; 
  &nbsp; 33 <br>
  将乘积相加得1E3 <br>
  Customer Code中的第一个*的代码是3 <br>
  将1E3右移3位得3C <br>
  Customer Code中的第二个*的代码是C <br>
  从软件中的代码表中查到 <br>
  0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <br>
  B R F G D C H K L M&nbsp; E&nbsp; N&nbsp; S&nbsp; P&nbsp; A&nbsp; Z <br>
  故Customer Code应为0003GS <br>
  <br>
  Unlocking Code的计算: <br>
  第1-3位是固定的:OKE <br>
  第4和9位是根据输入数据的长度计算出来的: <br>
  软件将输入的数据整理变为: <br>
  ">0003GS|LIUTONG|HEPING||||100028|CHINA&lt;" <br>
  长度为(HEX)27 <br>
  第4位的代码是2,查代码得"F" <br>
  第9位的代码是7,查代码得"K" <br>
  第5-8位由用户输入项计算出来 <br>
  将">0003GS|LIUTONG|HEPING||||100028|CHINA&lt;"同Customer Code的计算过程 <br>
  得325D,则第5-8位的代码是GFCP <br>
  整理第1-9位是OKEFGFCPK <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; O&nbsp; &nbsp; &nbsp; K&nbsp; &nbsp; 
  E&nbsp; &nbsp; F&nbsp; &nbsp; G&nbsp; &nbsp; F&nbsp; &nbsp; C&nbsp; &nbsp; P&nbsp; 
  &nbsp; K <br>
  ASCII码&nbsp; &nbsp; &nbsp; 4F&nbsp; &nbsp; 4B&nbsp; &nbsp; 45&nbsp; &nbsp; 46&nbsp; 
  &nbsp; 47&nbsp; &nbsp; 46&nbsp; 43&nbsp; 50&nbsp; 4B <br>
  系数&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; 3&nbsp; &nbsp; 4&nbsp; 
  &nbsp; 1&nbsp; &nbsp; 2&nbsp; &nbsp; 3&nbsp; &nbsp; 4&nbsp; &nbsp; 1&nbsp; &nbsp; 
  2 <br>
  乘积&nbsp; &nbsp; &nbsp; &nbsp; 9E&nbsp; &nbsp; E1&nbsp; 114&nbsp; &nbsp; 46&nbsp; 
  &nbsp; 8E&nbsp; &nbsp; D2&nbsp; 10C&nbsp; 50&nbsp; 96 <br>
  将乘积相加得62B <br>
  第10位代码是B,查代码得"N" <br>
  将62B右移3位得C5 <br>
  第11位代码是5,查代码得"C" <br>
  整理Unlocking Code是OKEFGFCPKNC <br>
  <br>
  Customer Code: 0003GS <br>
  Name:&nbsp; LiuTong <br>
  Adress 1: HePing <br>
  Adress 2: <br>
  Adress 3: <br>
  Adress 4: <br>
  Post/Zip Code: 100028 <br>
  Country: China <br>
  Unlocking Code: OKEFGFCPKNC </span></blockquote>
<hr>
</body>
</html>
