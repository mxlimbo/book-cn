<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<p><span class="p9">各位高手，VB3.0的程序如何破解？ </span></p>
<p><span class="p9"><font color=blue>标 题:</font>找到注册码了 (2千字)<br>
  <font color=blue>发信人:</font>郭大志<br>
  <font color=blue>时 间:</font>2000-6-13 22:34:00 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 用bpx hmemcpy设断点，然后再用BPR断点监视你输入的注册码，它将你输入的注册码字符串转换成整数之后， 
  <br>
  就到了如下的地方，要装到浮点寄存器中去了（又是浮点数！）： <br>
  <br>
  5187:9067&nbsp; 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  PUSH&nbsp; &nbsp; &nbsp; BX <br>
  5187:9068&nbsp; 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  NOP <br>
  5187:9069&nbsp; DD06C00D&nbsp; &nbsp; &nbsp; FLD&nbsp; &nbsp; &nbsp; REAL8 PTR 
  [0DC0]&nbsp; &nbsp; //装入到浮点寄存器中去 <br>
  5187:906D&nbsp; E86807&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; &nbsp; 
  97D8 <br>
  5187:9070&nbsp; 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  POP&nbsp; &nbsp; &nbsp; BX <br>
  5187:9071&nbsp; 58&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  POP&nbsp; &nbsp; &nbsp; AX <br>
  5187:9072&nbsp; 803ED00D1A&nbsp; CMP&nbsp; &nbsp; &nbsp; BYTE PTR [0DD0],1A 
  <br>
  5187:9077&nbsp; 7504&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JNZ&nbsp; &nbsp; &nbsp; 907D <br>
  5187:9079&nbsp; 883ED00D&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp; 
  [0DD0],BH <br>
  5187:907D&nbsp; E8A4F0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; &nbsp; 
  8124 <br>
  5187:9080&nbsp; CD3D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INT&nbsp; 
  &nbsp; &nbsp; 3D <br>
  5187:9082&nbsp; 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; DI <br>
  5187:9083&nbsp; C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; RET <br>
  5187:9084&nbsp; 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; BP <br>
  5187:9085&nbsp; 8BEC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; BP,SP <br>
  5187:9087&nbsp; 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; SI <br>
  5187:9088&nbsp; B42C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; AH,2C <br>
  5187:908A&nbsp; 9AD9884701&nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; &nbsp; KERNEL!DOS3CALL 
  <br>
  <br>
  单步跟踪，发现最终在如下FCOMPP的地方进行注册码的比较。此时ST1寄存器中放的是你输入的假注册码， <br>
  ST0中存放的是另外一个数。它会把你的假注册码和好几个数相比，这些数中有一个是真正的注册码， <br>
  其它的数不能用，否则启动的时候它会说你的文件被破坏了 :-) <br>
  只需要在如下的FCOMPP处插入INT 3指令即可，这里应为VB3比较两个数的地方。 <br>
  <br>
  4B57:3C00&nbsp; FFE0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; &nbsp; AX <br>
  4B57:3C02&nbsp; 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; NOP <br>
  4B57:3C03&nbsp; D9C9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  FXCH&nbsp; &nbsp; &nbsp; ST(1) <br>
  4B57:3C05&nbsp; 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; NOP <br>
  4B57:3C06&nbsp; DED9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  FCOMPP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //比较注册码 <br>
  4B57:3C08&nbsp; 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; NOP <br>
  4B57:3C09&nbsp; DFE0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  FSTSW&nbsp; AX <br>
  4B57:3C0B&nbsp; CD3D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  INT&nbsp; &nbsp; &nbsp; 3D <br>
  4B57:3C0D&nbsp; 9E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; SAHF <br>
  4B57:3C0E&nbsp; C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; RET <br>
  4B57:3C0F&nbsp; 2800&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  SUB&nbsp; &nbsp; &nbsp; [BX+SI],AL <br>
  4B57:3C11&nbsp; B82600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AX,0026 <br>
  4B57:3C14&nbsp; B8A600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AX,00A6 <br>
  4B57:3C17&nbsp; E8E8FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 3C02 <br>
  4B57:3C1A&nbsp; B80000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AX,0000 <br>
  4B57:3C1D&nbsp; 7501&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; JNZ&nbsp; &nbsp; &nbsp; 3C20 <br>
  4B57:3C1F&nbsp; 48&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; DEC&nbsp; &nbsp; &nbsp; AX <br>
  4B57:3C20&nbsp; 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; AX <br>
  4B57:3C21&nbsp; 26AD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  LODSW&nbsp; &nbsp; ES: <br>
  4B57:3C23&nbsp; FFE0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; &nbsp; AX <br>
  <br>
  一个可用的cowsense.INI文件： <br>
  <br>
  [Registration] <br>
  SerialNumber=W401-9900558 <br>
  UserName=zhuxiaohua <br>
  UserCompany=zhuchen <br>
  Key=80467949 <br>
  OptionKey=850780 <br>
  DataEntryMode=False <br>
  Chronid=313500 <br>
  Version= <br>
  <br>
  [File Parameters] <br>
  DataPath= <br>
  DataFileName= <br>
  <br>
  [Settings] <br>
  TabStyle=Mac <br>
  ReportTitle=Cow Sense Sample Herd <br>
  ReportingYear=2000 <br>
  <br>
  [Options] <br>
  SystemDB=C:\temp\vb3\SYSTEM.MDA </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>VB3程序破解再总结 (1千字)<br>
  <font color=blue>发信人:</font>小牧童<br>
  <font color=blue>时 间:</font>2000-6-14 22:31:22 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> VB3程序破解再总结 <br>
  １、&nbsp; &nbsp;&nbsp;用字符比较 <br>
  －&nbsp; 开始运行ＶＢ３程序，输入假的序列号： <br>
  －&nbsp; 切换到softice下，bpx hmemcpy 设断点 <br>
  －&nbsp; 按Ｆ５键返回应用程序，按注册确定键，将被softice中断 <br>
  －&nbsp; S 0030:0 Ｌ FFFFFFFF&nbsp; 8B,CA,F3,A6,74,01,9F92,8D,5E,08,E8,06 <br>
  －&nbsp; 在返回地址设断如:&nbsp; bpx&nbsp; 0030:807019ef&nbsp; do “d si” <br>
  －&nbsp; 按F５将落在比较代码处 <br>
  &nbsp; : 8BCA&nbsp; &nbsp; &nbsp; &nbsp; mov cx, dx <br>
  &nbsp; : F3A6&nbsp; &nbsp; &nbsp; &nbsp; repz cmpsb&nbsp; ;&lt;-&nbsp; 这里字符串被比较&nbsp; 
  <br>
  &nbsp; : 7401&nbsp; &nbsp; &nbsp; &nbsp; je 8CB6&nbsp; &nbsp; ;&nbsp; <br>
  &nbsp; : 9F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lahf <br>
  &nbsp; : 92&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xchg ax,dx <br>
  &nbsp; : 8D5E08&nbsp; &nbsp; &nbsp; lea bx, [bp+08] <br>
  &nbsp; －&nbsp; 如发现输入的假序列号则下d&nbsp; es:di查看序列号 <br>
  -&nbsp; 没有发现继续按F5 <br>
  ２、&nbsp; &nbsp;&nbsp;用数值比较 <br>
  －&nbsp; 开始运行ＶＢ３程序，输入假的序列号： <br>
  －&nbsp; 切换到softice下，bpx hmemcpy 设断点 <br>
  －&nbsp; 下WF开浮点监视窗 <br>
  －&nbsp; 按Ｆ５键返回应用程序，按注册确定键，将被softice中断 <br>
  －&nbsp; S 0030:0 Ｌ FFFFFFFF&nbsp; 90,DE,D9,90DF,E0,CD,3D,9E,C3 <br>
  －&nbsp; 在返回地址设断如:&nbsp; bpx&nbsp; 0030:805B5CA5 <br>
  －&nbsp; 按F５将至此 <br>
  4B57:3C05&nbsp; 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; NOP <br>
  4B57:3C06&nbsp; DED9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  FCOMPP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //比较注册码 <br>
  4B57:3C08&nbsp; 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; NOP <br>
  4B57:3C09&nbsp; DFE0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  FSTSW&nbsp; AX <br>
  4B57:3C0B&nbsp; CD3D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  INT&nbsp; &nbsp; &nbsp; 3D <br>
  4B57:3C0D&nbsp; 9E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; SAHF <br>
  4B57:3C0E&nbsp; C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; RET <br>
  在浮点监视窗中将会出现注册码 <br>
  －&nbsp; 如没有继续按F5 <br>
  <br>
  感谢郭大侠及看雪版主的帮助！ </span></blockquote>
<hr>
<p>&nbsp; </p>
</body>
</html>
