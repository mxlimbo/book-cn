<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>一篇破文(Update Now 2.0)! (2千字)<br>
<font color=blue>发信人:</font>十三少<br>
<font color=blue>时 间:</font>2000-5-14 15:06:08 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 今天破掉了Update Now2.0(主页上传工具)，这次选了个最简单 <br>
  的name选1。 <br>
  Name:1 <br>
  RegisterKey:881cdceed7c4 <br>
  这个软件注册检验部分十有趣，注册码根据注册 <br>
  名运算得出，但注册码必须软件是12位，现在好 <br>
  多程序都要求注册码位是固定的哟，:) <br>
  好了，废话少说，程序破解于下，请注意听哟： <br>
  1、用ice载入Update Now2.0 <br>
  2、输入注册信息 <br>
  name:1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &amp;任意输入 <br>
  register key:123456789012&nbsp; &amp;任意输入，(此例中便于观察)。 <br>
  3、下 <br>
  :bpx hmemcpy <br>
  :g <br>
  回到程序界面时，按“OK” <br>
  4、程序被拦下来，按几下F12回到程序领空，见如下代码： <br>
  XXXX:00407643&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 000003F1 <br>
  XXXX:00407648&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, ebx&nbsp; &nbsp; | 
  <br>
  XXXX:0040764A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call 00416876 <br>
  XXXX:0040764F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp eax, 0000000C&nbsp; &amp;比较注册是否为12位 
  <br>
  XXXX:00407652&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne 00407862&nbsp; &nbsp; &nbsp; 
  &amp;不是12位，则死! <br>
  XXXX:00407658&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea edi, dword ptr [esp+00000124] 
  <br>
  XXXX:0040765F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or ecx, FFFFFFFF <br>
  XXXX:00407662&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor eax, eax <br>
  <br>
  程序继续。。。到 <br>
  :004076E0&nbsp; &nbsp; mov dl, byte ptr [esp+eax+29]&nbsp; &amp; d esp+eax+28便可看 
  <br>
  :004076E4&nbsp; &nbsp; mov cl, byte ptr [esp+eax+28]&nbsp; &amp; 到你输入的注册码： <br>
  :004076E8&nbsp; &nbsp; mov byte ptr [esp+eax+28], dl&nbsp; &amp; 123456789012 
  <br>
  :004076EC&nbsp; &nbsp; mov byte ptr [esp+eax+29], cl <br>
  :004076F0&nbsp; &nbsp; inc eax <br>
  :004076F1&nbsp; &nbsp; cmp eax, 00000006 <br>
  :004076F4&nbsp; &nbsp; jl 004076E0 <br>
  :004076F6&nbsp; &nbsp; dec esi <br>
  :004076F7&nbsp; &nbsp; jne 004076DE <br>
  :004076F9&nbsp; &nbsp; lea edi, dword ptr [esp+00000228] &amp;此时下d eax+esp+22 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &amp;可以看见你输入的注册码 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &amp;被变为712345689012 <br>
  以上段代码是你输入注册码的变形，我们此时输入的注册码为123456789012 被变为 <br>
  712345689012，也就是说将我们输入的注册码的第7位移到了第一位! <br>
  5、程序继续执行，(F10)下面到了如下代码： <br>
  :004077AE&nbsp; Call dword ptr [004194B4]&nbsp; &nbsp; &nbsp; &amp;注册码比较核心，F8追入哟! 
  <br>
  :004077B4&nbsp; add esp, 0000000C <br>
  :004077B7&nbsp; test eax, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &amp;检验注册标记 <br>
  :004077B9&nbsp; pop ebp <br>
  :004077BA&nbsp; jne 00407838&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &amp;不为0，则死! <br>
  :004077BC&nbsp; mov esi, dword ptr [esp+0C] <br>
  :004077C0&nbsp; push eax <br>
  <br>
  6、让我们看看注册码比较核心部分的代码： <br>
  XXXX:78010C8E&nbsp; &nbsp; PUSH EBP <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV EBP,ESP <br>
  ............................... <br>
  XXXX:78010CAF&nbsp; MOV AL,[ESI-01]&nbsp; &amp;下d esi-01 即可看见e881cdced7c4 <br>
  XXXX:78010CB2&nbsp; XOR ECX,ECX&nbsp; &nbsp; &nbsp; &amp;由你用户名算出来的注册码 <br>
  &nbsp; &nbsp; :78010CB4&nbsp; CMP AL,[EDI-01]&nbsp; &amp;下d edi-01 即可看见712345689012 
  <br>
  &nbsp; &nbsp; :78010CB7&nbsp; JA 78010CBD&nbsp; &nbsp; &nbsp; <br>
  &nbsp; &nbsp; :78010CB9&nbsp; JZ 78010CBF <br>
  &nbsp; &nbsp; &nbsp; &nbsp; ...................(略) <br>
  *****7、最后整理一下，重新注册，直接输入注册码e881cdced7c4，哇!怎么 <br>
  不对？？？哈哈，由于作者对你输入的注册码做了一个小变化，将第7位调到 <br>
  第1位了，所以我们输入注册码的时候，就要输入e881cdced7c4的第1位调到第 <br>
  7位，应该为881cdceed7c4，于是OK! <br>
  <br>
  <br>
  &nbsp; &nbsp; 破解者：十三少 <br>
  &nbsp; &nbsp; scyb@sina.com <br>
  http://scyb.yeah.net <br>
  &nbsp; &nbsp; 00.05.14 </span></blockquote>
<hr>
</body>
</html>
