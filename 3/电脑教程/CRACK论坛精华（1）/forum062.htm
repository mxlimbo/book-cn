<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>Namo WebEditor V3.0(Final beta)时间过期的解除(难度：简单） 
(2千字)<br>
<font color=blue>发信人:</font>cqzrd<br>
<font color=blue>时 间:</font>2000-5-25 20:22:42 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> WebEditor 3是一个很好的网页制作软件，它可以使新手作出很漂亮的网页来。但时间一过便不让人用，便就有点那个了;)。 
  <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 使用的工具：TRW2000121,十六进制文本编辑器 <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 步骤： <br>
  <br>
  &nbsp; &nbsp; 用TRW2k载入WebEditor 3，按F10至 <br>
  <br>
  &nbsp; &nbsp; 4F7F51 Call 00518BE4 <br>
  <br>
  &nbsp; &nbsp; 换F8进入Call内（按F10带过过期提示便会出现），此时看一下你所处的 <br>
  位置。按F10至 <br>
  <br>
  &nbsp; &nbsp; 518BF4&nbsp; Call Near [EAX+58] <br>
  <br>
  &nbsp; &nbsp; 换F8进入Call内，再看一下你所处的位置，会发现你又处于程式中了。按F10至 <br>
  <br>
  &nbsp; &nbsp; 475AEB&nbsp; Call 00476280 <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 换F8切入，该Call便是比较时间的程序段。下面是该Call的内容： <br>
  <br>
  &nbsp; &nbsp; 0167:00476280&nbsp; PUSH&nbsp; &nbsp; EBP <br>
  &nbsp; &nbsp; 0167:00476281&nbsp; MOV&nbsp; &nbsp; &nbsp; EBP,ESP <br>
  &nbsp; &nbsp; 0167:00476283&nbsp; PUSH&nbsp; &nbsp; ECX <br>
  &nbsp; &nbsp; 0167:00476284&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  &nbsp; &nbsp; 0167:00476287&nbsp; PUSH&nbsp; &nbsp; EAX <br>
  &nbsp; &nbsp; 0167:00476288&nbsp; CALL&nbsp; &nbsp; `MSVCRT!time` <br>
  &nbsp; &nbsp; 0167:0047628E&nbsp; ADD&nbsp; &nbsp; &nbsp; ESP,BYTE +04 <br>
  &nbsp; &nbsp; 0167:00476291&nbsp; LEA&nbsp; &nbsp; &nbsp; ECX,[EBP-04] <br>
  &nbsp; &nbsp; 0167:00476294&nbsp; PUSH&nbsp; &nbsp; ECX <br>
  &nbsp; &nbsp; 0167:00476295&nbsp; CALL&nbsp; &nbsp; `MSVCRT!localtime`&nbsp; 
  --->获得当前时间。 <br>
  &nbsp; &nbsp; 0167:0047629B&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,[EAX+14]&nbsp; 
  &nbsp; --->将年放入ECX, <br>
  &nbsp; &nbsp; 0167:0047629E&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EAX+10]&nbsp; 
  &nbsp; --->将月放入EDX, <br>
  &nbsp; &nbsp; 0167:004762A1&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EAX+0C]&nbsp; 
  &nbsp; --->将日放入EAX。 <br>
  &nbsp; &nbsp; 0167:004762A4&nbsp; ADD&nbsp; &nbsp; &nbsp; ESP,BYTE +04 <br>
  &nbsp; &nbsp; 0167:004762A7&nbsp; ADD&nbsp; &nbsp; &nbsp; ECX,076C <br>
  &nbsp; &nbsp; 0167:004762AD&nbsp; INC&nbsp; &nbsp; &nbsp; EDX <br>
  &nbsp; &nbsp; 0167:004762AE&nbsp; CMP&nbsp; &nbsp; &nbsp; ECX,07CF&nbsp; &nbsp; 
  --->？7CF 看看是多少？ <br>
  &nbsp; &nbsp; 0167:004762B4&nbsp; JG&nbsp; &nbsp; &nbsp; 004762CF&nbsp; &nbsp; 
  --->若年大于1999则去死。用code on看一下该处的代码并记下来。 <br>
  &nbsp; &nbsp; 0167:004762B6&nbsp; JNZ&nbsp; &nbsp; &nbsp; 004762BD <br>
  &nbsp; &nbsp; 0167:004762B8&nbsp; CMP&nbsp; &nbsp; &nbsp; EDX,BYTE +04 <br>
  &nbsp; &nbsp; 0167:004762BB&nbsp; JG&nbsp; &nbsp; &nbsp; 004762CF <br>
  &nbsp; &nbsp; 0167:004762BD&nbsp; CMP&nbsp; &nbsp; &nbsp; ECX,07CF&nbsp; &nbsp; 
  --->再比较一次年, <br>
  &nbsp; &nbsp; 0167:004762C3&nbsp; JNZ&nbsp; &nbsp; &nbsp; 004762E2&nbsp; &nbsp; 
  --->若二者不等（则肯定是小于过期年了），则正确执行。 <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 以下代码请自己分析： <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 0167:004762C5&nbsp; CMP&nbsp; &nbsp; &nbsp; EDX,BYTE +04&nbsp; 
  <br>
  &nbsp; &nbsp; 0167:004762C8&nbsp; JNZ&nbsp; &nbsp; &nbsp; 004762E2 <br>
  &nbsp; &nbsp; 0167:004762CA&nbsp; CMP&nbsp; &nbsp; &nbsp; EAX,BYTE +1E <br>
  &nbsp; &nbsp; 0167:004762CD&nbsp; JNG&nbsp; &nbsp; &nbsp; 004762E2 <br>
  &nbsp; &nbsp; 0167:004762CF&nbsp; PUSH&nbsp; &nbsp; DWORD CB38 <br>
  &nbsp; &nbsp; 0167:004762D4&nbsp; CALL&nbsp; &nbsp; 0044FF20 <br>
  &nbsp; &nbsp; 0167:004762D9&nbsp; ADD&nbsp; &nbsp; &nbsp; ESP,BYTE +04 <br>
  &nbsp; &nbsp; 0167:004762DC&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  &nbsp; &nbsp; 0167:004762DE&nbsp; MOV&nbsp; &nbsp; &nbsp; ESP,EBP <br>
  &nbsp; &nbsp; 0167:004762E0&nbsp; POP&nbsp; &nbsp; &nbsp; EBP <br>
  &nbsp; &nbsp; 0167:004762E1&nbsp; RET&nbsp; &nbsp; <br>
  <br>
  &nbsp; &nbsp; 总结一下，查找&nbsp; 81F9CF070000&nbsp; 7F 19 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- -- <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; 改为&nbsp; &nbsp; ==>90 90 <br>
  &nbsp; &nbsp; OK，收工！ </span></blockquote>
<hr>
</body>
</html>
