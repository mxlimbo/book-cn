<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>ACDSee3.0和ASPACK (3千字)<br>
<font color=blue>发信人:</font>SillyBird<br>
<font color=blue>时 间:</font>2000-6-22 13:28:26 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 初学破解,一点心得,希望与大家交流. <br>
  破解ACDSee3.0如下: <br>
  <br>
  使用TRW找到ACDSee!.ASPACK的最后地址为:5554CC <br>
  相关为： <br>
  005554B6 89 85 5C 2E 44 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; dword 
  ptr [ebp+442E5Ch],eax <br>
  005554BC 61&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; popad 
  <br>
  005554BD 75 08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne&nbsp; 
  &nbsp; &nbsp; &nbsp; 005554C7 <br>
  005554BF B8 01 00 00 00&nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; eax,1 
  <br>
  005554C4 C2 0C 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret&nbsp; &nbsp; 
  &nbsp; &nbsp; 0Ch <br>
  005554C7 68 DF 32 4A 00&nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; 
  4A32DFh <br>
  005554CC C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 
  <br>
  mov&nbsp; &nbsp; &nbsp; &nbsp; dword ptr [ebp+442E5Ch],eax将dword ptr [5554C8]从0改到4A32DF 
  <br>
  <br>
  ACDSee!.TEXT第一条指令为: <br>
  004A32DF 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; 
  &nbsp; &nbsp; &nbsp; ebp <br>
  004A32E0 8B EC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; 
  &nbsp; &nbsp; &nbsp; ebp,esp <br>
  004A32E2 6A FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; 
  &nbsp; &nbsp; &nbsp; 0FFh <br>
  004A32E4 68 A8 69 4D 00&nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; 
  4D69A8h <br>
  004A32E9 68 80 81 4A 00&nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; 
  4A8180h <br>
  <br>
  做以下修改: <br>
  1.修改5554B6为,RawAddress = 864B6（文件中静态地址） <br>
  005554B6 E9 15 A1 01 00&nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp; 0056F5D0 
  <br>
  <br>
  2.修改5550FD为,RawAddress = A05D0 <br>
  0056F5D0 89 85 5C 2E 44 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; dword 
  ptr [ebp+442E5Ch],eax <br>
  0056F5D6 BB 30 71 41 00&nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; ebx,417130h 
  <br>
  0056F5DB C7 03 B8 01 00 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; dword 
  ptr [ebx],1B8h <br>
  0056F5E1 BB 34 71 41 00&nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; ebx,417134h 
  <br>
  0056F5E6 C7 03 00 C3 90 90&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; dword 
  ptr [ebx],9090C300h <br>
  0056F5EC BB EA 3F 43 00&nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; ebx,433FEAh 
  <br>
  0056F5F1 66 C7 03 EB 17&nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; word 
  ptr [ebx],17EBh <br>
  0056F5F6 E9 C1 5E FE FF&nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp; 005554BC 
  <br>
  <br>
  3.其中417130使About弹出信息为注册 <br>
  原来是: <br>
  00417130 33 C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; 
  &nbsp; &nbsp; &nbsp; eax,eax&nbsp; &nbsp;&nbsp;;返回0认为没有注册 <br>
  00417132 C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 
  <br>
  00417133 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nop 
  <br>
  00417134 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nop 
  <br>
  00417135 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nop 
  <br>
  00417136 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nop 
  <br>
  改后为: <br>
  00417130 B8 01 00 00 00&nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp; eax,1&nbsp; 
  &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;;返回1认为已经注册 <br>
  00417135 C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 
  <br>
  00417136 90&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nop 
  <br>
  <br>
  4.433FEA使软件不过期 <br>
  原来是: <br>
  00433FEA 6A 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; 
  &nbsp; &nbsp; &nbsp; 0 <br>
  00433FEC 68 10 40 43 00&nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; 
  434010h <br>
  00433FF1 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00433FF2 68 07 04 00 00&nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; 
  407h <br>
  00433FF7 51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; 
  &nbsp; &nbsp; &nbsp; ecx <br>
  00433FF8 FF 15 A4 E7 4C 00&nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; dword 
  ptr ds:[4CE7A4h] <br>
  00433FFE 48&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dec&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00433FFF F7 D8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; neg&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00434001 1B C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sbb&nbsp; 
  &nbsp; &nbsp; &nbsp; eax,eax <br>
  00434003 40&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00434004 C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 
  <br>
  改后为: <br>
  00433FEA EB 17&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; 
  &nbsp; &nbsp; &nbsp; 00434003&nbsp; &nbsp;&nbsp;;跳过过期对话框 <br>
  00433FEC 68 10 40 43 00&nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; 
  434010h <br>
  00433FF1 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00433FF2 68 07 04 00 00&nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; 
  407h <br>
  00433FF7 51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; 
  &nbsp; &nbsp; &nbsp; ecx <br>
  00433FF8 FF 15 A4 E7 4C 00&nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; dword 
  ptr ds:[4CE7A4h] <br>
  00433FFE 48&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dec&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00433FFF F7 D8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; neg&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00434001 1B C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sbb&nbsp; 
  &nbsp; &nbsp; &nbsp; eax,eax <br>
  00434003 40&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; 
  &nbsp; &nbsp; &nbsp; eax <br>
  00434004 C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret 
  <br>
  <br>
  按照这种思路，基本上破解任何加壳的软件都不需要使用专门的脱壳软件。仅仅在壳对本体程序代码解密完成后，做JMP或CALL到自己代码，将相关的代码修改成自己想要的，然后再回到原来代码执行，就能完成任务。在ACDSee3.0的.text块的属性是可写的,所以不会产生写错误。 
  <br>
  <br>
  跳过过期画面的处理参考baoleigz的《也谈ACDSee V3.0破解》。 </span></blockquote>
<hr>
</body>
</html>
