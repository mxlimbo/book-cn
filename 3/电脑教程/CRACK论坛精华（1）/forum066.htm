<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>ok, cracked! (3千字)<br>
<font color=blue>发信人:</font>IceBird<br>
<font color=blue>时 间:</font>2000-5-24 16:46:42 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 破 PowerStrip 2.67 <br>
  <br>
  &nbsp; &nbsp; 本文作者：IceBird <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://nemc.yeah.net/ <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; icebird_crack@21cn.com <br>
  <br>
  &nbsp; &nbsp; 所用工具：Soft-ice405&nbsp; Procdump1.6.2&nbsp; Uedit32 <br>
  &nbsp; <br>
  &nbsp; &nbsp; PowerStrip 2.67 到这里下载: <br>
  &nbsp; &nbsp; http://202.102.249.231/ftproot/6/pstrip267.exe <br>
  <br>
  前言： <br>
  &nbsp; &nbsp; 这个软件用ASPack加壳，采用keyfile保护，因此我们先脱壳再破解 :) <br>
  <br>
  1. 脱壳 <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 因为软件用ASPack加壳，我也不知道用的是ASPack的什么版本，所以请先跟我一起编辑 <br>
  &nbsp; &nbsp; Procdump 的 Script.ini 文件。 <br>
  &nbsp; &nbsp; 在 Script.ini 文件中加上这些： <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; P??=Aspack&nbsp; （ ?? 是行号，注意是16进制的 ）&nbsp; <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; [Aspack] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; L1=OBJR <br>
  &nbsp; &nbsp; &nbsp; &nbsp; L2=LOOK EB,? <br>
  &nbsp; &nbsp; &nbsp; &nbsp; L3=JZ 5 <br>
  &nbsp; &nbsp;&nbsp;L4=QUIT <br>
  &nbsp; &nbsp;&nbsp;L5=BP <br>
  &nbsp; &nbsp;&nbsp;L6=WALK <br>
  &nbsp; &nbsp;&nbsp;L7=OBJR <br>
  &nbsp; &nbsp;&nbsp;L8=LOOK 61,75&nbsp; &nbsp;&nbsp; <br>
  &nbsp; &nbsp;&nbsp;L9=BP <br>
  &nbsp; &nbsp;&nbsp;LA=STEP <br>
  &nbsp; &nbsp;&nbsp;OPTL1=00000000 <br>
  &nbsp; &nbsp;&nbsp;OPTL2=01010001 <br>
  &nbsp; &nbsp;&nbsp;OPTL3=01010001 <br>
  &nbsp; &nbsp;&nbsp;OPTL4=00030000 <br>
  &nbsp; &nbsp;&nbsp;OPTL5=00000000&nbsp; <br>
  <br>
  &nbsp; &nbsp; 这样Procdump也就可以脱去到目前为止所有用ASPack加壳的软件了 :) <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 用Procdump脱去pstrip.exe（在windows目录下）的壳，然后将脱壳后的文件复制到Windows <br>
  &nbsp; &nbsp; 目录下覆盖原文件。 <br>
  <br>
  2. 破解 <br>
  <br>
  &nbsp; &nbsp; 软件好象用了keyfile的保护，可惜小弟这只菜鸟算不出它的注册码 :( <br>
  &nbsp; &nbsp; 如果能算出注册码，当然也不必脱壳了。 <br>
  &nbsp; &nbsp; ok,go... <br>
  &nbsp; <br>
  &nbsp; &nbsp; 启动 pstrip ，出现注册提示画面，ctrl-d 唤出 soft-ice ，下 bpx destroywindow ， 
  <br>
  &nbsp; &nbsp; 按 F5 返回 window ，点击一下 OK ，马上被拦下，这时按一下 F12 ，回到pstrip的领空， <br>
  &nbsp; &nbsp; 下 s 0 l 90000000 'demo' ，搜索到 xxx:yyyyyyyy 的地址，地址应该是每个人的不同， <br>
  &nbsp; &nbsp; 下 bpm yyyyyyyy ，按 F5 返回 window ，退出 pstrip ，再一次启动 pstrip ，拦下后 <br>
  &nbsp; &nbsp; 我们就开始按 F12 ，按多少次？我也不记得了，大概17次吧，反正也就是来到了这里： <br>
  <br>
  &nbsp; &nbsp;&nbsp;:004CB57D&nbsp; E84AF40000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  CALL&nbsp; &nbsp; &nbsp; 004DA9CC <br>
  &nbsp; &nbsp;&nbsp;:004CB582&nbsp; 8B45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  &nbsp; &nbsp;&nbsp;:004CB585&nbsp; 80B84805000000&nbsp; &nbsp; &nbsp; CMP&nbsp; 
  &nbsp; &nbsp; BYTE PTR [EAX+00000548],00 <br>
  &nbsp; &nbsp;&nbsp;:004CB58C&nbsp; 0F85A8000000&nbsp; &nbsp; &nbsp; &nbsp; JNZ&nbsp; 
  &nbsp; &nbsp; 004CB63A <br>
  &nbsp; &nbsp;&nbsp;:004CB592&nbsp; 8B45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  &nbsp; &nbsp;&nbsp;:004CB595&nbsp; 80B84805000000&nbsp; &nbsp; &nbsp; CMP&nbsp; 
  &nbsp; &nbsp; BYTE PTR [EAX+00000548],00 <br>
  &nbsp; &nbsp;&nbsp;:004CB59C&nbsp; 7433&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 004CB5D1 <br>
  &nbsp; &nbsp;&nbsp;:004CB59E&nbsp; 8D954CFEFFFF&nbsp; &nbsp; &nbsp; &nbsp; LEA&nbsp; 
  &nbsp; &nbsp; EDX,[EBP-01B4] <br>
  &nbsp; &nbsp;&nbsp;:004CB5A4&nbsp; B801000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,00000001 <br>
  &nbsp; &nbsp;&nbsp;:004CB5A9&nbsp; E80673F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  CALL&nbsp; &nbsp; &nbsp; 004028B4 <br>
  &nbsp; &nbsp;&nbsp;:004CB5AE&nbsp; 8B854CFEFFFF&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP-01B4] <br>
  &nbsp; &nbsp;&nbsp;:004CB5B4&nbsp; 8D9550FEFFFF&nbsp; &nbsp; &nbsp; &nbsp; LEA&nbsp; 
  &nbsp; &nbsp; EDX,[EBP-01B0] <br>
  &nbsp; &nbsp;&nbsp;:004CB5BA&nbsp; E899B3F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  CALL&nbsp; &nbsp; &nbsp; 00406958 <br>
  &nbsp; &nbsp;&nbsp;:004CB5BF&nbsp; 8B8550FEFFFF&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP-01B0] <br>
  &nbsp; &nbsp;&nbsp;:004CB5C5&nbsp; BA08C14C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EDX,004CC108 <br>
  &nbsp; &nbsp;&nbsp;:004CB5CA&nbsp; E8E982F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  CALL&nbsp; &nbsp; &nbsp; 004038B8 <br>
  &nbsp; &nbsp;&nbsp;:004CB5CF&nbsp; 7569&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; JNZ&nbsp; &nbsp; &nbsp; 004CB63A <br>
  &nbsp; &nbsp;&nbsp;:004CB5D1&nbsp; 8B0D7C954F00&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; ECX,[004F957C] <br>
  &nbsp; &nbsp;&nbsp;:004CB5D7&nbsp; B201&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp; DL,01 <br>
  &nbsp; &nbsp;&nbsp;:004CB5D9&nbsp; B8D8644B00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,004B64D8 <br>
  &nbsp; &nbsp;&nbsp;:004CB5DE&nbsp; E8FD7AF4FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  CALL&nbsp; &nbsp; &nbsp; 004130E0 <br>
  &nbsp; &nbsp;&nbsp;:004CB5E3&nbsp; A350DB4F00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; [004FDB50],EAX&nbsp; &nbsp; * we stop here * <br>
  &nbsp; &nbsp;&nbsp;:004CB5E8&nbsp; 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  &nbsp; &nbsp;&nbsp;:004CB5EA&nbsp; 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP <br>
  &nbsp; &nbsp;&nbsp;:004CB5EB&nbsp; 6833B64C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  PUSH&nbsp; &nbsp; &nbsp; 004CB633 <br>
  &nbsp; &nbsp;&nbsp;:004CB5F0&nbsp; 64FF30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; PUSH&nbsp; &nbsp; &nbsp; DWORD PTR FS:[EAX] <br>
  &nbsp; &nbsp;&nbsp;:004CB5F3&nbsp; 648920&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp; FS:[EAX],ESP <br>
  &nbsp; &nbsp;&nbsp;:004CB5F6&nbsp; A150DB4F00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,[004FDB50] <br>
  &nbsp; &nbsp;&nbsp;:004CB5FB&nbsp; E898A7F4FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  CALL&nbsp; &nbsp; &nbsp; 00415D98&nbsp; * 这里出现注册提示画面 * <br>
  &nbsp; &nbsp;&nbsp;:004CB600&nbsp; 83F802&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; CMP&nbsp; &nbsp; &nbsp; EAX,02 <br>
  &nbsp; &nbsp;&nbsp;:004CB603&nbsp; 750F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; JNZ&nbsp; &nbsp; &nbsp; 004CB614 <br>
  <br>
  &nbsp; &nbsp; 我们停在 004CB5E3 处，当光标经过 004CB5FB 这里也就出现注册提示画面，于是向上看 <br>
  &nbsp; &nbsp; 哪里可以跳过它。 <br>
  &nbsp; &nbsp; 我找到了 004CB58C 和 004CB5CF 都可以跳过，第1个比较好一些，所以在 004CB585 处 <br>
  &nbsp; &nbsp; 设断点，再来一次，在 004CB585 处拦下，这时 [EAX+00000548] 的值为 0 ，如果 <br>
  &nbsp; &nbsp; [EAX+00000548] 的值为 1 ，也就行了，因此我们把 <br>
  <br>
  &nbsp; &nbsp;&nbsp; :004CB585&nbsp; CMP&nbsp; BYTE PTR [EAX+00000548],00 <br>
  &nbsp; &nbsp; 改成： <br>
  &nbsp; &nbsp; &nbsp; &nbsp; :004CB585&nbsp; INC&nbsp; BYTE PTR [EAX+00000548] 
  <br>
  <br>
  &nbsp; &nbsp; 因为少了一个 byte ，所以加一个 nop ，别忘了下 code on 指令 <br>
  <br>
  3. 用 Uedit32 打开已脱壳的 pstrip.exe 文件， <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; 查找：80B848050000000F85A8000000 <br>
  &nbsp; &nbsp; 改成：FE804805000090------------ <br>
  <br>
  &nbsp; &nbsp; 运行 pstrip ，没有的干挠画面，看一下 ‘关于 PowerStrip’， <br>
  &nbsp; &nbsp; 在我的机上显示着：License #84653 <br>
  &nbsp; &nbsp; 破解成功！ <br>
  <br>
  the end </span></blockquote>
<hr>
</body>
</html>
