<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>Lockdown2000_7.0.0.1破解手记 (3千字)<br>
<font color=blue>发信人:</font>十夜<br>
<font color=blue>时 间:</font>2000-5-26 12:02:17 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> Lockdown2000_7.0.0.1破解手记 <br>
  本人属懒派狂人，自下载Lockdown2000_7.0.0.1后一直等待破解的出现，但是始终不见其踪影。 <br>
  本着你不烦我我不破你的原则平静的度过了十天，终于，讨厌的东西出现了，看来只有按原则 <br>
  办事了，不想这东西加了壳，又臭又硬，还好在吴朝相的主页找到了脱壳后的汉化版本，省了 <br>
  一道工序，可以开始工作了。 <br>
  <br>
  用W32Dasm反编译Lockdown2000.exe，找那个让我讨厌的东西(过期提示)，如下所示： <br>
  :004C313D E8321CFEFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004A4D74 
  <br>
  :004C3142 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test al, al <br>
  :004C3144 7546&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 004C318C <br>
  :004C3146 E8B516FEFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004A4800 
  <br>
  :004C314B 48&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; dec eax <br>
  :004C314C 7D27&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jge 004C3175 <br>
  :004C314E A14C9E4D00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, 
  dword ptr [004D9E4C] <br>
  :004C3153 8B00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov eax, dword ptr [eax] <br>
  :004C3155 E82AC5F8FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0044F684 
  <br>
  <br>
  * Possible StringData Ref from Code Obj ->"The trial period on this demo " <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ->"of LockDown 
  2000 has expired." <br>
  往上看看004C3144那一行能跳过过期提示，改为jmp 004C318C就不会过期了，但这也太那个…… <br>
  <br>
  注意一下call 004A4D74，看起来好像很有意思，到004A4D74去看看： <br>
  * Referenced by a CALL at Addresses: <br>
  |:004B5127&nbsp; , :004B524E&nbsp; , :004B56FC&nbsp; , :004B5C0F&nbsp; , :004BD36D&nbsp; 
  <br>
  |:004BE723&nbsp; , :004C313D&nbsp; , :004C6AF4&nbsp; , :004CBA42&nbsp; , :004CCFAB&nbsp; 
  <br>
  |:004CF4A3&nbsp; , :004CF5FF&nbsp; <br>
  | <br>
  :004A4D74 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebp <br>
  :004A4D75 8BEC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov ebp, esp <br>
  :004A4D77 B905000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  00000005 <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:004A4D81(C) <br>
  | <br>
  :004A4D7C 6A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push 00000000 <br>
  :004A4D7E 6A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push 00000000 <br>
  :004A4D80 49&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; dec ecx <br>
  :004A4D81 75F9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 004A4D7C <br>
  :004A4D83 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebx <br>
  :004A4D84 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push esi <br>
  :004A4D85 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; xor eax, eax <br>
  :004A4D87 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebp <br>
  :004A4D88 68E0514A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 004A51E0 
  <br>
  :004A4D8D 64FF30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  push dword ptr fs:[eax] <br>
  :004A4D90 648920&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov dword ptr fs:[eax], esp <br>
  <br>
  * Possible StringData Ref from Code Obj ->"LD2KReg.ini" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004A4D93 B9F8514A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  004A51F8 <br>
  :004A4D98 B201&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov dl, 01 <br>
  :004A4D9A A1C8A14700&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, 
  dword ptr [0047A1C8] <br>
  :004A4D9F E8CC54FDFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0047A270 
  <br>
  :004A4DA4 8BD8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov ebx, eax <br>
  :004A4DA6 6A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push 00000000 <br>
  :004A4DA8 8D45E0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-20] <br>
  :004A4DAB 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  <br>
  * Possible StringData Ref from Code Obj ->"Register" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004A4DAC B90C524A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  004A520C <br>
  <br>
  * Possible StringData Ref from Code Obj ->"Register" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004A4DB1 BA0C524A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edx, 
  004A520C <br>
  :004A4DB6 8BC3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov eax, ebx <br>
  :004A4DB8 8B30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov esi, dword ptr [eax] <br>
  :004A4DBA FF16&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call dword ptr [esi] <br>
  :004A4DBC 8D45DC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-24] <br>
  :004A4DBF E8B4F9FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004A4778 
  <br>
  :004A4DC4 8B55DC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov edx, dword ptr [ebp-24] <br>
  :004A4DC7 8B45E0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-20] <br>
  :004A4DCA E8BDF2F5FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0040408C 
  <br>
  :004A4DCF 7537&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 004A4E08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  ………………………………………………………… <br>
  好像很受欢迎的样子，而且它还提到了LD2KReg.ini，再看看后面的代码，应该是判断注册的地方，程序很简单，将004A4DCF的jne 004A4E08改为je 
  004A4E08即可成为注册版。 <br>
  LD2KReg.ini 文件内容变为： <br>
  [Register] <br>
  Register=C5VPQ1;=SMQ <br>
  我想用没改过的汉化版做一下测试，可它显示已经是注册版了，不知这个文件在别的机器上管不管用？我用的是WIN2000，该文件在C:\WINNT下，WIN98我就不清楚了。 
  <br>
  <br>
  另：我最爱用的EXPLOR2000到了1.52.2版本，我将其脱壳后在WIN2000中不能运行，WHY? <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tennight.C&nbsp; &nbsp; 
  2000/5/26 </span></blockquote>
<hr>
</body>
</html>
