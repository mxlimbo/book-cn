<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><span class="p9"><font color=blue>标 题:</font>PicaView 1.32破解实战 
(3千字)<br>
<font color=blue>发信人:</font>冰毒<br>
<font color=blue>时 间:</font>2000-3-3 22:02:41 <br>
<font color=blue>详细信息:</font><br>
</span> </span>
<blockquote><span class="p9"><span class="p9"> 用过ACDSee的朋友,可能也知道同一公司出品的Picaview. 
  今天从ACD公司的主页下载了Picaview 1.32,是个60天试用版本. 下面是破解过程,用时大约30分钟. <br>
  <br>
  1. Picaview.dll是用aspack1.084压过的,所以先用unaspack脱壳(我用版本的是1.0.5.0),OK! 感谢毕卫国先生. :) 
  <br>
  2. 用W32dasm反汇编picaview.dll. <br>
  3. 在Picaview菜单上大家可以见到"Purchase PicaView..."的字样,寻找它. <br>
  4. 见到下面的代码 <br>
  <br>
  * Reference To: USER32.InsertMenuA, Ord:0174h <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :10001160 8B3DD8C40910&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edi, dword 
  ptr [1009C4D8] <br>
  :10001166 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebp <br>
  :10001167 8BAC2418020000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ebp, dword ptr 
  [esp+00000218] <br>
  :1000116E 8D4E01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [esi+01] <br>
  :10001171 6A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push 00000000 <br>
  :10001173 8BC3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov eax, ebx <br>
  :10001175 51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ecx <br>
  :10001176 68000C0000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 00000C00 
  <br>
  :1000117B 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  :1000117C 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebp <br>
  :1000117D 43&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; inc ebx <br>
  :1000117E FFD7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call edi <br>
  :10001180 B908A10B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  100BA108 <br>
  :10001185 E8B6870100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 10019940 
  &lt;- ??? <br>
  :1000118A 85C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test eax, eax <br>
  :1000118C 752B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 100011B9 &lt;- 如果eax不等于0, hehe <br>
  :1000118E 8B0D5CA20B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, dword 
  ptr [100BA25C] <br>
  :10001194 8D442454&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea 
  eax, dword ptr [esp+54] <br>
  :10001198 6A64&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push 00000064 <br>
  :1000119A 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  <br>
  * Possible Reference to String Resource ID=00040: "Purchase PicaView..." <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :1000119B 6A28&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push 00000028 &lt;- 我们在这 <br>
  :1000119D 51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ecx <br>
  <br>
  5. 仔细看看那个可疑的CALL,调用的地方有多处 <br>
  <br>
  * Referenced by a CALL at Addresses: <br>
  |:10001108&nbsp; , :10001185&nbsp; , :10002135&nbsp; , :100022A8&nbsp; , :100076FB&nbsp; 
  <br>
  |:100385EE&nbsp; <br>
  | <br>
  :10019940 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; xor eax, eax <br>
  :10019942 C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; ret <br>
  <br>
  6. 挨个看一看,都是哪些地方调用这个CALL,又会发现下面这段代码 <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:10002291(C) <br>
  | <br>
  :100022A3 B908A10B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  100BA108 <br>
  :100022A8 E893760100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 10019940 
  &lt;-这里 <br>
  :100022AD 85C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test eax, eax &lt;-若eax不为0 <br>
  :100022AF 0F85BD000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne 10002372 
  &lt;-跳过过期检查 <br>
  :100022B5 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebp <br>
  :100022B6 B908A10B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  100BA108 <br>
  :100022BB E8D02C0800&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 10084F90 
  <br>
  <br>
  * Reference To: USER32.GetDlgItemTextA, Ord:0104h <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :100022C0 8B2D70C40910&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ebp, dword 
  ptr [1009C470] <br>
  :100022C6 8BF8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov edi, eax <br>
  :100022C8 85FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test edi, edi <br>
  :100022CA 7F21&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jg 100022ED &lt;-未过期,跳走 <br>
  :100022CC 8B155CA20B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edx, dword 
  ptr [100BA25C]&lt;-否则 <br>
  :100022D2 8D8C2498000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea ecx, dword ptr 
  [esp+00000098] <br>
  :100022D9 6896000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 00000096 
  <br>
  :100022DE 51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ecx <br>
  <br>
  * Possible Reference to String Resource ID=00209: "Your evaluation period is 
  over. <br>
  Please register this softwar" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :100022DF 68D1000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 000000D1 
  <br>
  :100022E4 52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push edx <br>
  <br>
  7. 打补丁,将xor eax, eax改成mov al,01. <br>
  8. 再试试看,高兴了吧. :) <br>
  9. 程序的时间标志在注册表HKLM\software\acd systems\picaview项.你要程序显示你的大名,也请自己动手吧. </span></span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>Picaview 1.32破解补充 (845字)<br>
  <font color=blue>发信人:</font>冰毒<br>
  <font color=blue>时 间:</font>2000-3-4 0:36:10 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 一时粗心,忘记试一下时间限制是否去除,结果... :) <br>
  <br>
  BPX dialogboxparama, 点右键选图片,softice拦住,F12,F10 <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:100010AE(C) <br>
  | <br>
  :100010E0 83F8FB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp eax, FFFFFFFB <br>
  :100010E3 7516&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 100010FB &lt;-改成EB16 <br>
  :100010E5 E846150000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 10002630 
  <br>
  :100010EA 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; pop edi &lt;-我们在这里 <br>
  :100010EB 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; pop esi <br>
  :100010EC B811000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, 
  00000011 <br>
  :100010F1 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; pop ebx <br>
  :100010F2 81C400020000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add esp, 00000200 
  <br>
  :100010F8 C21800&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  ret 0018 <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:100010E3(C) <br>
  | <br>
  :100010FB 85C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test eax, eax <br>
  :100010FD 0F8530070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne 10001833 
  &lt;-改成6个90 </span></blockquote>
<hr>
</body>
</html>
