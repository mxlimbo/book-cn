<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>这个软件真可恶!大家都来看看吧! (127字)<br>
<font color=blue>发信人:</font>十三少<br>
<font color=blue>时 间:</font>2000-6-10 22:36:45 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 这是一个游戏程序，即防ICE又防TRW，而且还加了壳，我真是拿它没办法! <br>
  软件下载：http://go.163.com/~szycool/crackme/mmxbricksht.zip </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>普通的Asprotect保护，你用TRW2000前先：faults 
  off。Import表就在idata里：464000.你也可按我以前的方法定... (159字)<br>
  <font color=blue>发信人:</font>看雪<br>
  <font color=blue>时 间:</font>2000-6-10 23:29:11<br>
  <font color=blue>阅读次数:</font>66<br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 普通的Asprotect保护，你用TRW2000前先：faults off。Import表就在idata里：464000.你也可按我以前的方法定位，得到结果一至。今天我要休息，到此为止。 
  </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>代码是动态变化的，每次都不一样。另外你自己还需要dump取正确的Import表替换旧的才行。 
  (2千字)<br>
  <font color=blue>发信人:</font>看雪<br>
  <font color=blue>时 间:</font>2000-6-11 10:55:35 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote>
  <p><span class="p9"> 前面的代码每次不一样，你只能以机器码和后面的指令来参考。</span></p>
  <p><span class="p9"> :bpx loadlibrarya<br>
    <br>
    0137:005693D8 EB13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; 
    &nbsp; 005693ED <br>
    0137:005693DA E9A907FFFF&nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 00559B88 
    <br>
    0137:005693DF 66B80E00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
    AX,000E <br>
    0137:005693E3 E814F2FFFF&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 005685FC 
    <br>
    0137:005693E8 E80709FFFF&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 00559CF4 
    <br>
    0137:005693ED 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
    EAX,[EBP+08] <br>
    0137:005693F0 8D4818&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEA&nbsp; &nbsp; 
    ECX,[EAX+18] <br>
    0137:005693F3 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
    EAX,[EBP+08] <br>
    0137:005693F6 8B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
    &nbsp; EDX,[EAX] <br>
    0137:005693F8 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
    EAX,[EBP+08] <br>
    0137:005693FB 8B401C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
    EAX,[EAX+1C] <br>
    0137:005693FE E881F7FFFF&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 00568B84―――――进去 
    <br>
    0137:00569403 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; EDI <br>
    0137:00569404 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; ESI <br>
    0137:00569405 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; EBX <br>
    0137:00569406 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; ECX <br>
    0137:00569407 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; ECX <br>
    0137:00569408 5D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; EBP <br>
    <br>
    来到： <br>
    0137:005652CC 61&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POPAD 
    <br>
    0137:005652CD EB01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; 
    &nbsp; 005652D0 <br>
    0137:005652CF E850EB02E9&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; E9593E24 
    <br>
    0137:005652D4 17&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; SS <br>
    0137:005652D5 E802000000&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 005652DC―――进去 
    <br>
    0137:005652DA E91758C35B&nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 5C19AAF6 
    <br>
    0137:005652DF 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; ECX <br>
    0137:005652E0 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; ECX <br>
    0137:005652E1 5D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; 
    &nbsp; EBP <br>
    <br>
    来到： <br>
    0137:0045FA1C 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; 
    &nbsp; EBP―――――入口点 <br>
    0137:0045FA1D 8BEC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
    &nbsp; EBP,ESP <br>
    0137:0045FA1F 83C4F4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; &nbsp; 
    ESP,FFFFFFF4 <br>
    0137:0045FA22 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; 
    &nbsp; EBX <br>
    0137:0045FA23 B87CF84500&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; EAX,0045F87C 
    <br>
    0137:0045FA28 E83765FAFF&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 00405F64 
    <br>
    0137:0045FA2D 8B1D7C0F4600&nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; EBX,[00460F7C] 
    <br>
    0137:0045FA33 8B03&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
    &nbsp; EAX,[EBX] <br>
    0137:0045FA35 E8EA58FEFF&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 00445324 
    <br>
    0137:0045FA3A 8B03&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
    &nbsp; EAX,[EBX] <br>
    0137:0045FA3C BA00FB4500&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; EDX,0045FB00 
    <br>
    0137:0045FA41 E80255FEFF&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 00444F48 
    <br>
    0137:0045FA46 8B0DAC0E4600&nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; ECX,[00460EAC] 
    </span></p>
</blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>重建Import表的一些步骤提示： (413字)<br>
  <font color=blue>发信人:</font>看雪<br>
  <font color=blue>时 间:</font>2000-6-17 12:24:23 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 程序入口地址：0045fa1c <br>
  需要重建import表 RAV:00064000&nbsp; <br>
  <br>
  <br>
  先用bpx loadlibrarya do "dd*(esp+4)" <br>
  两三下后，数据区显示为KERNEL32.DLL <br>
  此时dump取Import表。 <br>
  w 64000 l 3000 <br>
  <br>
  来到入口点0045fa1c dump取整个程序。 <br>
  然后用 Procdump打开这个程序，看到idata的RAW office=60400 RAW size=221c <br>
  用Hex Workshop打开刚dump的Import表，选取大小221c.替换到主程序的60400处，大小221c,并修正Import表的值为64000 
  <br>
  这样程序完全可运行。 </span></blockquote>
<hr>
<p>&nbsp;</p>
</body>
</html>
