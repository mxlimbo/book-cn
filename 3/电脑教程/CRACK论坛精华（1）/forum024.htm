<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>解除 Dun Meter Millennium Pro 1.0的延迟画面 
(4千字)<br>
<font color=blue>发信人:</font>sunwk（小楼）<br>
<font color=blue>时 间:</font>2000-3-15 23:23:50 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 解除 Dun Meter Millennium Pro 1.0的延迟画面 <br>
  <br>
  &nbsp; &nbsp; Dun Meter Millennium Pro 1.0是一个“能测试上网速度，并且用图形和文本建立下载速度表”的软件。你能自《软件》光盘2000年第三期中或从其作者主页http://dmmillennium.cjb.net/处得到。使用时无日期限制，但有延迟画面。 
  <br>
  <br>
  &nbsp; &nbsp; Let's try to get rid of the NAG. <br>
  <br>
  &nbsp; &nbsp; 用Typ_d32发现此软件用ASPACK 1.083压缩。首先 <br>
  <br>
  第一步：解压缩 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 用TRW2000 LOAD DmMillennium.exe，程序自动停在入口 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167：004D0000&nbsp; &nbsp; PUSHA <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167：004D0001&nbsp; &nbsp; CALL 004DE006 &lt;---用F10带过后程序主画面就显示出来。 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  故F8追入 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 以后用F10走,......这样一直走到 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167:004DE559&nbsp; &nbsp; JNZ&nbsp; 004DE563 &lt;---JUMP 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167:004DE55B&nbsp; &nbsp; MOV&nbsp; EAX, 01 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167:004DE560&nbsp; &nbsp; RET&nbsp; 0C <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167:004DE563&nbsp; &nbsp; PUSH EAX <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167:004DE564&nbsp; &nbsp; RET&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &lt;---走过这一步,就跳到 <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 0167:004A1C18&nbsp; &nbsp; ......&nbsp; &nbsp; &nbsp; 
  &nbsp; &lt;---开始执行解压缩后的真正的程序代码&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; . <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; . <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; . <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; . <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; . <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 所以在 0167:004DE564&nbsp; &nbsp; RET 
  这一步，可以脱壳了。TRW2000共享版未&nbsp; &nbsp; &nbsp; &nbsp; 提供PEDUMP与MAKEPE这两条命令，但我有TRW 
  0.75版，虽然很不稳定，却有上&nbsp; &nbsp; &nbsp; &nbsp; 述两条命令。所以改用TRW 0.75，载入后到 0167:004DE564&nbsp; 
  &nbsp; RET， <br>
  &nbsp; &nbsp; &nbsp; 下命令 PEDUMP（回车） <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; G（回车） <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 你会在DESKTOP OR TRW0.75目录下 OR C盘根目录下找到DUMP1.EXE文件 
  ，&nbsp; &nbsp; &nbsp; &nbsp; 这就是解压缩后的DmMillennium.exe文件。但此时执行DUMP1.EXE，它会告诉你&nbsp; 
  &nbsp; &nbsp; &nbsp; 执行了非法程序。WHY？因为它的Entry Point 是 000DE564，所以用PROCDUMP&nbsp; 
  &nbsp; &nbsp; &nbsp; 1.62，选&nbsp; PE Editor /DUMP1.EXE,将Entry Point 由000DE564 
  改为&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 000A1C18,即真正的程序入口处,OK!程序执行了。 
  <br>
  <br>
  第二步：去除延迟画面 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 用TRW2000再次载入DUMP1.EXE <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; //******************** Program Entry Point ******** 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C18 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push ebp <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C19 8BEC&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ebp, esp <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C1B 83C4F4&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add esp, FFFFFFF4 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C1E 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push ebx <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C1F B818174A00&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; mov eax, 004A1718 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C24 E8AF46F6FF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 004062D8 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C29 8B1D08384A00&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; mov ebx, dword ptr [004A3808] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C2F 8B03&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C31 E83A68FAFF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 00448470 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C36 8B03&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C38 BAA01C4A00&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; mov edx, 004A1CA0 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C3D E85264FAFF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 00448094 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C42 8B0DE4344A00&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; mov ecx, dword ptr [004A34E4] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C48 8B03&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C4A 8B15D4F64900&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; mov edx, dword ptr [0049F6D4] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C50 E83368FAFF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 00448488 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C55 8B0D64354A00&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; mov ecx, dword ptr [004A3564] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C5B 8B03&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C5D 8B1594C24900&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; mov edx, dword ptr [0049C294] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C63 E82068FAFF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 00448488 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C68 8B0D9C354A00&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; mov ecx, dword ptr [004A359C] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C6E 8B03&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C70 8B1514F44900&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; mov edx, dword ptr [0049F414] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C76 E80D68FAFF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 00448488 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C7B A19C354A00&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [004A359C] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C80 8B00&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [eax] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C82 8B10&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edx, dword ptr [eax] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C84 FF92CC000000&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; call dword ptr [edx+000000CC]&nbsp; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C8A 8B03&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C8C E87768FAFF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 00448508 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C91 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop ebx <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C92 E8051DF6FF&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; call 0040399C <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C97 00FF&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add bh, bh <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :004A1C99 FFFFFF&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BYTE&nbsp; 3 DUP(0ffh) <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 注意到:004A1C84 FF92CC000000&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; call dword ptr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; [edx+000000CC]，由此延迟画面出现了，强迫程序跳过去即可。故 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 将&nbsp; &nbsp; &nbsp; FF92CC000000 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 改为&nbsp; &nbsp; 909090909090 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OK！ <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  孙悟空七十二变之第二变&nbsp; 牛魔王 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  sunwk@sohu.com <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  2000.03.15 </span></blockquote>
<hr>
</body>
</html>
