<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>The Bat! 1.39脱壳笔记 (1千字)<br>
<font color=blue>发信人:</font>冰毒<br>
<font color=blue>时 间:</font>2000-3-12 9:04:01 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 1. 主程序的脱壳 <br>
  <br>
  014F:00990B35&nbsp; 8B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; EDX,[EAX] <br>
  014F:00990B37&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EAX,[EBP+08] <br>
  014F:00990B3A&nbsp; 035018&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; 
  &nbsp; EDX,[EAX+18] <br>
  014F:00990B3D&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EAX,[EBP+08] <br>
  014F:00990B40&nbsp; 8B401C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EAX,[EAX+1C] <br>
  014F:00990B43&nbsp; E880F9FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; 009904C8 &lt;-这里! F8进入 <br>
  <br>
  014F:009904C8&nbsp; 89C4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; ESP,EAX <br>
  014F:009904CA&nbsp; 89D0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; EAX,EDX <br>
  014F:009904CC&nbsp; 8B1D34569900&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  EBX,[00995634] <br>
  014F:009904D2&nbsp; 89041C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; [EBX+ESP],EAX <br>
  014F:009904D5&nbsp; 61&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POPAD <br>
  014F:009904D6&nbsp; 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; EAX &lt;-记下EAX的值(61C528) <br>
  014F:009904D7&nbsp; C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; RET &lt;-这里用Procdump脱壳 <br>
  <br>
  2. 获得完整的.idata section <br>
  <br>
  如上得到的脱壳后的程序,在你改过EIP后仍无法运行. 还有工作要做,你得用Icedump. <br>
  <br>
  014F:009909FF&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EAX,[EBP+08] <br>
  014F:00990A02&nbsp; 8D4824&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEA&nbsp; 
  &nbsp; ECX,[EAX+24] <br>
  014F:00990A05&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EAX,[EBP+08] <br>
  014F:00990A08&nbsp; 8B500C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EDX,[EAX+0C] <br>
  014F:00990A0B&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EAX,[EBP+08] <br>
  014F:00990A0E&nbsp; 8B4008&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; EAX,[EAX+08] <br>
  014F:00990A11&nbsp; E8FAF6FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; 00990110 <br>
  014F:00990A16&nbsp; 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  XOR&nbsp; &nbsp; EAX,EAX &lt;-这里! <br>
  014F:00990A18&nbsp; 5A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; EDX <br>
  014F:00990A19&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; ECX <br>
  014F:00990A1A&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; ECX <br>
  014F:00990A1B&nbsp; 648910&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; FS:[EAX],EDX <br>
  014F:00990A1E&nbsp; EB13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; 00990A33 <br>
  <br>
  在00990A16行, Pagein D 62e000 3000 c:\thebat.bin <br>
  <br>
  3. 运行Hex编辑程序,用完整的.idata替换掉脱壳后主程序中.idata部分. Job done. </span></blockquote>
<hr>
</body>
</html>
