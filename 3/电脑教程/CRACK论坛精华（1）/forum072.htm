<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>各位老师请指教。movsx,cdq是什么意思。另外这段程序的密码算法。谢谢 
(2千字)<br>
<font color=blue>发信人:</font>guest<br>
<font color=blue>时 间:</font>2000-5-28 6:27:23 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> :bpx hmemcpy <br>
  Break due to BPX KERNEL!HMEMCPY&nbsp; (ET=517.75 milliseconds) <br>
  :bc * <br>
  :u cs:eip l 200 <br>
  0167:0043B5C0&nbsp; 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP <br>
  0167:0043B5C1&nbsp; 8BEC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EBP,ESP <br>
  0167:0043B5C3&nbsp; 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; ESI <br>
  0167:0043B5C4&nbsp; 8B7508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; ESI,[EBP+08]----输入密码 <br>
  0167:0043B5C7&nbsp; 57&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EDI <br>
  0167:0043B5C8&nbsp; BF3412C72F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; EDI,2FC71234 <br>
  0167:0043B5CD&nbsp; 85F6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  TEST&nbsp; &nbsp; &nbsp; ESI,ESI <br>
  0167:0043B5CF&nbsp; 743A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JZ&nbsp; &nbsp; &nbsp; &nbsp; 0043B60B <br>
  0167:0043B5D1&nbsp; 8A06&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; AL,[ESI] <br>
  0167:0043B5D3&nbsp; 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  TEST&nbsp; &nbsp; &nbsp; AL,AL <br>
  0167:0043B5D5&nbsp; 7434&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JZ&nbsp; &nbsp; &nbsp; &nbsp; 0043B60B <br>
  0167:0043B5D7&nbsp; 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EBX <br>
  0167:0043B5D8&nbsp; BBF8110000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; EBX,000011F8 <br>
  0167:0043B5DD&nbsp; 0FBEC0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVSX&nbsp; 
  &nbsp; EAX,AL <br>
  0167:0043B5E0&nbsp; 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:0043B5E1&nbsp; E83F550600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004A0B25 <br>
  0167:0043B5E6&nbsp; 8BC8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; ECX,EAX <br>
  0167:0043B5E8&nbsp; 8BC3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,EBX <br>
  0167:0043B5EA&nbsp; 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; CDQ <br>
  0167:0043B5EB&nbsp; F7F9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  IDIV&nbsp; &nbsp; &nbsp; ECX <br>
  0167:0043B5ED&nbsp; 83C404&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; 
  &nbsp; &nbsp; ESP,04 <br>
  0167:0043B5F0&nbsp; 81C390010000&nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; &nbsp; 
  &nbsp; EBX,00000190 <br>
  0167:0043B5F6&nbsp; 40&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; INC&nbsp; &nbsp; &nbsp; EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  0167:0043B5F7&nbsp; 0FAFF8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMUL&nbsp; 
  &nbsp; &nbsp; EDI,EAX <br>
  0167:0043B5FA&nbsp; 8A4601&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AL,[ESI+01] <br>
  0167:0043B5FD&nbsp; 46&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; INC&nbsp; &nbsp; &nbsp; ESI&nbsp; <br>
  0167:0043B5FE&nbsp; 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  TEST&nbsp; &nbsp; &nbsp; AL,AL <br>
  0167:0043B600&nbsp; 75DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JNZ&nbsp; &nbsp; &nbsp; 0043B5DD <br>
  0167:0043B602&nbsp; 8BC7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,EDI <br>
  0167:0043B604&nbsp; 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EBX <br>
  0167:0043B605&nbsp; 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  0167:0043B606&nbsp; 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ESI <br>
  0167:0043B607&nbsp; 5D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EBP <br>
  0167:0043B608&nbsp; C20400&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RET&nbsp; 
  &nbsp; &nbsp; 0004 <br>
  0167:0043B60B&nbsp; 8BC7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,EDI <br>
  0167:0043B60D&nbsp; 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  0167:0043B60E&nbsp; 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ESI <br>
  0167:0043B60F&nbsp; 5D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EBP <br>
  0167:0043B610&nbsp; C20400&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RET&nbsp; 
  &nbsp; &nbsp; 0004 </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>回答 (2千字)<br>
  <font color=blue>发信人:</font>冰毒<br>
  <font color=blue>时 间:</font>2000-5-28 8:48:28 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 你好,希望这些注释对你有帮助. <br>
  <br>
  0167:0043B5C1&nbsp; 8BEC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EBP,ESP <br>
  0167:0043B5C3&nbsp; 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; ESI <br>
  0167:0043B5C4&nbsp; 8B7508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; ESI,[EBP+08] <br>
  0167:0043B5C7&nbsp; 57&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EDI <br>
  0167:0043B5C8&nbsp; BF3412C72F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; EDI,2FC71234 &lt;-EDI初始化 <br>
  0167:0043B5CD&nbsp; 85F6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  TEST&nbsp; &nbsp; &nbsp; ESI,ESI <br>
  0167:0043B5CF&nbsp; 743A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JZ&nbsp; &nbsp; &nbsp; &nbsp; 0043B60B <br>
  0167:0043B5D1&nbsp; 8A06&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; AL,[ESI] &lt;-取密码的第一个字 <br>
  0167:0043B5D3&nbsp; 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  TEST&nbsp; &nbsp; &nbsp; AL,AL <br>
  0167:0043B5D5&nbsp; 7434&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JZ&nbsp; &nbsp; &nbsp; &nbsp; 0043B60B &lt;-如果空白,则跳出 <br>
  0167:0043B5D7&nbsp; 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EBX <br>
  0167:0043B5D8&nbsp; BBF8110000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; EBX,000011F8 &lt;-EBX初始化 <br>
  0167:0043B5DD&nbsp; 0FBEC0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVSX&nbsp; 
  &nbsp; EAX,AL &lt;- 将所取字移入EAX <br>
  0167:0043B5E0&nbsp; 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX &lt;-保存 <br>
  0167:0043B5E1&nbsp; E83F550600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004A0B25 &lt;-估计是对该字进行一些操作 <br>
  0167:0043B5E6&nbsp; 8BC8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; ECX,EAX <br>
  0167:0043B5E8&nbsp; 8BC3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,EBX <br>
  0167:0043B5EA&nbsp; 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; CDQ &nbsp; &nbsp;&nbsp;&lt;-EDX清零 <br>
  0167:0043B5EB&nbsp; F7F9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  IDIV&nbsp; &nbsp; &nbsp; ECX &lt;-EAX除以ECX,商放在EAX,余数在EDX <br>
  0167:0043B5ED&nbsp; 83C404&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; 
  &nbsp; &nbsp; ESP,04 <br>
  0167:0043B5F0&nbsp; 81C390010000&nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; &nbsp; 
  &nbsp; EBX,00000190 &lt;-EBX+190h <br>
  0167:0043B5F6&nbsp; 40&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; INC&nbsp; &nbsp; &nbsp; EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;-EAX+1 
  <br>
  0167:0043B5F7&nbsp; 0FAFF8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMUL&nbsp; 
  &nbsp; &nbsp; EDI,EAX &lt;- EDI*EAX 积在EDI <br>
  0167:0043B5FA&nbsp; 8A4601&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AL,[ESI+01] &lt;-取下一个字 <br>
  0167:0043B5FD&nbsp; 46&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; INC&nbsp; &nbsp; &nbsp; ESI&nbsp; &lt;-ESI+1 指向下一字 <br>
  0167:0043B5FE&nbsp; 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  TEST&nbsp; &nbsp; &nbsp; AL,AL &lt;- 是否已取完所有字 <br>
  0167:0043B600&nbsp; 75DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JNZ&nbsp; &nbsp; &nbsp; 0043B5DD &lt;-否,则继续对下一个进行运算 <br>
  0167:0043B602&nbsp; 8BC7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,EDI &lt;-运算结果放入EAX <br>
  0167:0043B604&nbsp; 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EBX <br>
  0167:0043B605&nbsp; 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  0167:0043B606&nbsp; 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ESI&nbsp; <br>
  0167:0043B607&nbsp; 5D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EBP <br>
  0167:0043B608&nbsp; C20400&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RET&nbsp; 
  &nbsp; &nbsp; 0004 &lt;- 返回程序调用处 <br>
  0167:0043B60B&nbsp; 8BC7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,EDI <br>
  0167:0043B60D&nbsp; 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  0167:0043B60E&nbsp; 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ESI <br>
  0167:0043B60F&nbsp; 5D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EBP <br>
  0167:0043B610&nbsp; C20400&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RET&nbsp; 
  &nbsp; &nbsp; 0004 <br>
  <br>
  MOVSX 将字节(Byte)或字(Word)操作数分别扩展成Word或Dword,并保留该值的符号(正负). <br>
  <br>
  CDQ 是一个让很多初学者感到困惑的指令. 它大多出现在除法运算之前. 它实际的作用只是把EDX的所有位都设成EAX最高位的值. 也就是说,当EAX &lt;80000000, 
  EDX 00000000; 当EAX >= 80000000, EDX 则为FFFFFFFF). <br>
  <br>
  冰毒于2000年5月28日 </span></blockquote>
<hr>
</body>
</html>
