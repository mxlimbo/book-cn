<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Microsoft OLE DB Persistence Provider</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdrefmspersist"></a>Microsoft OLE DB Persistence Provider</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdrefmspersist_C">
</object></p>
<p>
Microsoft OLE DB Persistence Provider 允许将 <b>Recordset</b> 对象保存到文件中，并在随后从文件恢复 <b>Recordset</b> 对象。模式信息、数据和挂起更改将被保存下来。</p>
<p>
用于保存 <b>Recordset </b>的格式既可以是高级数据图表 (ADTG) 格式，也可以是可扩展标记语言 (XML) 格式。</p>
<p class=label>
<b>提供者关键字</b></p>
<p>
要调用该提供者，请在连接字符串中指定如下关键字和值。</p>
<pre>"Provider=<span class=cfe><b>MSPersist</b></span>"
</pre>
<p class=label>
<b>错误</b></p>
<p>
在应用程序中可检测到由该提供者发出的如下错误。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>常量</b></td>
<td class=label width=50%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=50%>E_BADSTREAM</td>
<td width=50%>正在打开的文件没有使用有效格式（即，格式不是 ADTG 或 XML）。</td>
</tr>
<tr valign=top>
<td width=50%>E_CANTPERSISTROWSET</td>
<td width=50%>正在保存的 <b>Recordset</b> 对象设置有防止被保存的特性。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
Microsoft OLE DB Persistence Provider 不显露动态属性。</p>
<p>
当前，不能保存参数化分级 <b>Recordset</b> 对象。</p>
<p>
有关持久 <b>Recordset</b> 对象的详细信息，请参阅<a href="mdmscrecordsetpersistence.htm">记录集持久性</a>。</p>
</BODY>
</HTML>
