<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Resync Command 属性 _ 动态</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdprodynresynccommand"></a>Resync Command 属性 ― 动态</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdprodynResyncCommand_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdprodynResyncCommand_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdprodynResyncCommand_A">
</object></p>
<p>
指定用户提供的命令字符串，<a href="mdmthadoresync.htm">Resync</a> 方法发出该字符串用于刷新在由 <a href="mdprodynuniquetable.htm">Unique Table</a> 动态属性所命名的表中的数据。</p>
<p class=label>
<b>设置和返回值</b></p>
<p>
设置或返回字符串，是命令字符串。</p>
<p class=label>
<b>说明</b></p>
<p>
<b>Recordset</b> 对象是对多个基本表执行 JION 操作的结果。受影响的行取决于 <b>Resync</b> 方法的 <b>AffectRecords</b> 参数。如果没有设置 <b>Unique Table</b> 和 <b>Resync Command</b> 属性，将执行标准的 <b>Resync</b> 方法。</p>
<p>
<b>Resync Command</b> 属性的命令字符串是唯一标识正在被刷新的行的参数化命令或存储过程，并返回包含相同列的数目和顺序的单个行作为要刷新的行。命令字符串包含在 <b>Unique Table </b>中每个主键列的参数，否则将返回运行时错误。参数将以要刷新行的主键值自动填充。</p>
<p>
两个基于 SQL 的范例如下：</p>
<p>
1) <b>Recordset </b>由命令定义：</p>
<pre>SELECT * FROM Customers JOIN Orders ON 
Customers.CustomerID = Orders.CustomerID
WHERE city = <code>‘</code>Seattle<code>’</code>
ORDER BY CustomerID</pre>
<p>
<b>Resync Command</b> 属性设置为：</p>
<pre>"SELECT * FROM 
(SELECT * FROM Customers JOIN Orders 
ON Customers.CustomerID = Orders.CustomerID
city = <code>‘</code>Seattle<code>’</code> ORDER BY CustomerID)
WHERE Orders.OrderID = ?"</pre>
<p>
<b>Unique Table</b> 为 <b><i>Orders</i></b>，其主键 <b><i>OrderID</i></b> 被参数化。子选择提供简单的方法，在程序中确保返回的列具有与使用原始命令相同的数目和顺序。</p>
<p>
2) <b>Recordset</b> 由存储过程定义：</p>
<pre>CREATE PROC Custorders @CustomerID char(5) AS 
SELECT * FROM Customers JOIN Orders ON 
Customers.CustomerID = Orders.CustomerID 
WHERE Customers.CustomerID = @CustomerID
</pre>
<p>
&nbsp;<b>Resync</b> 方法应该执行如下存储过程：</p>
<pre>CREATE PROC CustordersResync @ordid int AS 
SELECT * FROM Customers JOIN Orders ON 
Customers.CustomerID = Orders.CustomerID    
WHERE Orders.ordid&nbsp; = @ordid
</pre>
<p>
<b>Resync Command</b> 属性设置为：</p>
<pre>"{call CustordersResync (?)}"</pre>
<p>
又一次，<b>Unique Table</b> 为 <b><i>Orders</i></b>，其主键 <b><i>OrderID </i></b>被参数化。</p>
<p>
当把 <a href="mdprocursorlocation.htm">CursorLocation</a> 属性设置为 <b>adUseClient</b> 时，<b>Resync Command</b> 是追加到 <b>Recordset</b> 对象的 <b>Properties </b>集合的动态属性。</p>
</BODY>
</HTML>
