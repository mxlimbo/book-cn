<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Error 对象</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdobjerror"></a>Error 对象</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjError_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjError_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:属性">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjError_P">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:方法">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjError_M">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:集合">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjError_CO">
</object></p>
<p>
<b>Error</b> 对象包含与单个操作（涉及提供者）有关的数据访问错误的详细信息。</p>
<p>
<a href="mdobjconnection.htm"><img src="objconn.gif" border=0></a><br>
<img src="parchild.gif" border=0><a href="mdcolerrors.htm"><img src="colerror.gif" border=0></a><img src="paracros.gif" border=0><img src="objerror.gif" border=0></p>
<p class=label>
<b>说明</b></p>
<p>
任何涉及 ADO 对象的操作都会生成一个或多个提供者错误。每个错误出现时，一个或多个 <b>Error</b> 对象将被放到 <a href="mdobjconnection.htm">Connection</a> 对象的 <b>Errors</b> 集合中。当另一个 ADO 操作产生错误时，<b>Errors</b> 集合将被清空，并在其中放入新的 <b>Error</b> 对象集。</p>
<p class=indent>
<B><b>注意</b></B>&nbsp;&nbsp;&nbsp;每个 <b>Error</b> 对象都代表特定的提供者错误而不是 ADO 错误，ADO 错误被记载到运行时的例外处理机制中。例如，在 Microsoft Visual Basic 中，产生特定 ADO 的错误将触发<b> On Error </b>事件并出现在 <b>Err</b> 对象中。关于 ADO 错误的完整列表，请参阅 <a href="mdrefadoerror.htm">ADO 错误代码</a>主题。</p>
<p>
通过 <b>Error</b> 对象的属性可获得每个错误的详细信息，其中包括以下内容：
<ul type=disc>
<li>
<b>Description</b> 属性，包含错误的文本。<br><br></li>
<li>
<b>Number</b> 属性，包含错误常量的<b>长整型</b>整数值。<br><br></li>
<li>
<b>Source</b> 属性，标识产生错误的对象。在向数据源发出请求之后，如果 <b>Errors</b> 集合中有多个 <b>Error</b> 对象，则将会用到该属性。<br><br></li>
<li>
<b>SQLState</b> 和 <b>NativeError</b> 属性，提供来自 SQL 数据源的信息。</li>
</ul>
<p>
出现提供者错误时，<b>Error</b> 对象将被放在 <a href="mdobjconnection.htm">Connection</a> 对象的 <a href="mdcolerrors.htm">Errors</a> 集合中。ADO 支持由单个 ADO 操作返回多个错误，以便显示特定提供者的错误信息。要在错误处理程序中获得丰富的错误信息，可使用相应的语言或所在工作环境下的错误捕获功能，然后使用嵌套循环枚举出 <b>Errors</b> 集合的每个 <b>Error</b> 对象的属性。</p>
<p class=indent>
<B><b>Microsoft Visual Basic 及 VBScript</b></B>&nbsp;&nbsp;&nbsp;如果没有有效的 <b>Connection</b> 对象，则需要检索 <b>Err</b> 对象的错误信息。</p>
<p>
与提供者一样，ADO 在进行可能引发新的提供者错误的调用前将清除<b> OLE Error Info </b>对象。但是，只有当提供者产生新的错误或 <b>Clear</b> 方法被调用时，才能清空并充填 <b>Connection</b> 对象的 <b>Errors</b> 集合。</p>
<p>
某些属性和方法返回的警告以 <b>Errors</b> 集合中的 <b>Error</b> 对象的方式出现，但并不中止程序的执行。在调用 <a href="mdobjodbrec.htm">Recordset</a> 对象的 <a href="mdmthadoresync.htm">Resync</a>、<a href="mdmthupdatebatch.htm">UpdateBatch</a>、或 <a href="mdmthcancelbatch.htm">CancelBatch</a> 方法，或 <b>Connection</b> 对象的 <a href="mdmthcnnopen.htm">Open</a> 方法，或者在设置 <b>Recordset</b> 对象的 <a href="mdprofilter.htm">Filter</a> 属性之前，可通过调用 <b>Errors</b> 集合的 <b>Clear</b> 方法。这样就可以读取 <b>Errors</b> 集合的 <a href="mdprocount.htm">Count</a> 属性，以测试返回的警告。</p>
</BODY>
</HTML>
