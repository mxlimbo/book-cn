<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Count 属性范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdprocountx"></a>Count 属性范例</h3>
<p>
该范例使用雇员数据库中的两个集合说明 <b>Count</b> 属性。该属性获得每个集合中的对象数并对枚举这些集合的循环设置上限。另一种不通过使用 <b>Count</b> 属性来枚举这些集合的方法是使用 For Each...Next 语句。</p>
<pre>Public Sub CountX()

   Dim rstEmployees As ADODB.Recordset
   Dim strCnn As String
   Dim intloop As Integer

   ' 使用雇员表中的数据打开记录集。
   strCnn = "Provider=sqloledb;" &amp; _
      "Data Source=srv;Initial Catalog=pubs;User Id=sa;Password=; "
   Set rstEmployees = New ADODB.Recordset
   rstEmployees.Open "employee", strCnn, , , adCmdTable

   ' 打印有关字段集合的信息。
   Debug.Print rstEmployees.Fields.<span class=cfe><b>Count</b></span> &amp; _
      " Fields in Employee"
   For intloop = 0 To rstEmployees.Fields.<span class=cfe><b>Count</b></span> - 1
      Debug.Print "   " &amp; rstEmployees.Fields(intloop).Name
   Next intloop

   ' 打印属性集合的信息。
   Debug.Print rstEmployees.Properties.<span class=cfe><b>Count</b></span> &amp; _
      " Properties in Employee"
   For intloop = 0 To rstEmployees.Properties.<span class=cfe><b>Count</b></span> - 1
      Debug.Print "   " &amp; rstEmployees.Properties(intloop).Name
   Next intloop

   rstEmployees.Close

End Sub</pre>
</BODY>
</HTML>
