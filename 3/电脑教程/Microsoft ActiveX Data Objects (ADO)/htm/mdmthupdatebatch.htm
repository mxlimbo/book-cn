<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>UpdateBatch 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthupdatebatch"></a>UpdateBatch 方法 </h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthUpdateBatch_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthUpdateBatch_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthUpdateBatch_A">
</object></p>
<p>
将所有挂起的批更新写入磁盘。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset</i><b>.UpdateBatch</b> <b><i>AffectRecords</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>AffectRecords&nbsp;&nbsp;&nbsp;</i></b>可选，<b>AffectEnum</b> 值。决定<b> UpdateBatch</b> 方法所影响的记录数目。可以为如下常量之一。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>常量</b></td>
<td class=label width=69%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=31%><b>adAffectCurrent</b></td>
<td width=69%>只写入当前记录的挂起更改。</td>
</tr>
<tr valign=top>
<td width=31%><b>adAffectGroup</b></td>
<td width=69%>写入满足当前 <a href="mdprofilter.htm">Filter</a> 属性设置的记录所发生的挂起更改。必须将 <b>Filter</b> 属性设置为某个有效的预定义常量才能使用该选项。</td>
</tr>
<tr valign=top>
<td width=31%><b>adAffectAll</b></td>
<td width=69%>（默认值）。写入<b> Recordset</b> 对象中所有记录的挂起更改，包括由于当前 <b>Filter</b> 属性设置而隐藏的任何记录。</td>
</tr>
<tr valign=top>
<td width=31%><b>adAffectAllChapters</b></td>
<td width=69%>写入所有子集的挂起更改。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
按批更新模式修改 <b>Recordset </b>对象时，使用 <b>UpdateBatch </b>方法可将 <b>Recordset </b>对象中的所有更改传递到基本数据库。</p>
<p>
如果<b> Recordset</b> 对象支持批更新，那么可以将一个或多个记录的多重更改缓存在本地，然后再调用<b> UpdateBatch</b> 方法。如果在调用 <b>UpdateBatch</b> 方法时正在编辑当前记录或者添加新的记录，那么在将批更新传送到提供者之前，ADO 将自动调用 <a href="mdmthupdate.htm">Update</a> 方法保存对当前记录的所有挂起更改。</p>
<p class=indent>
<B><b>注意&nbsp;&nbsp;&nbsp;</b></B>只能对键集或静态游标使用批更新。</p>
<p>
如果由于与基本的数据冲突而导致对所有或任意记录的传送更改失败（如其他用户已将记录删除），那么提供者将把警告返回给 <a href="mdcolerrors.htm">Errors</a> 集合，并发生运行时错误。使用 <b>Filter</b> 属性 (<b>adFilterAffectedRecords</b>) 和 <a href="mdprostatus.htm">Status</a> 属性可以找到发生冲突的记录。</p>
<p>
要取消所有挂起的批更新，请使用 <a href="mdmthcancelbatch.htm">CancelBatch</a> 方法。</p>
<p>
如果设置了 <a href="mdprodynuniquetable.htm">Unique Table</a> 和 <a href="mdprodynupdateresync.htm">Update Resync</a> 动态属性，并且 <b>Recordset</b> 是对多个表执行 JOIN 操作的结果，那么，取决于 <b>Update Resync </b>属性，执行 <b>UpdateBatch</b> 方法会隐性导致 <a href="mdmthadoresync.htm">Resync</a> 方法。</p>
</BODY>
</HTML>
