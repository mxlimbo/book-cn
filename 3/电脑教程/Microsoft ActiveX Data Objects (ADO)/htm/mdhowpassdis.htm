<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>使用 DataControl 将更新的未连接 Recordset 对象传送回中间层</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h4><a name="mdhowpassdis"></a>使用 DataControl 将更新的未连接 Recordset 对象传送回中间层</h4>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowPassDis_C">
</object></p>
<p>
数据绑定控件允许用户进行可视化编辑、添加或删除记录。用户在显式提交或取消更新之前所做的所有更改将在本地保存。 </p>
<p>
一般情况下，用户将窗格控件绑定到 <a href="mdobjdatacontrol.htm">RDS.DataControl</a> 对象，然后通过用户接口添加、编辑和删除客户端<b> Recordset</b> 中的记录。在更新客户端记录后，需要使用 <b>RDS.DataControl</b> 对象中的 <a href="mdmthsubchanges.htm">SubmitChanges</a> 方法将更改的信息保存到数据库中。<b>SubmitChanges</b> 方法将把在本地缓存中可更新的、被挂起的 <b>Recordset</b> 的更改提交给 <b>OLE DB</b> 数据源，该数据源在 <b>RDS.DataControl</b> 对象 <a href="mdproconnectprop.htm">Connect</a> 属性中指定。</p>
<p>
下面的代码范例显示如何完成这项工作：</p>
<pre>Sub Update_OnClick
   ADC1.SubmitChanges
End Sub
</pre>
<p>
只有更改的记录才被发送以便进行修改，所有改动只能同时成功或同时失败。</p>
<p>
也可以将“取消”按钮包括进来以取消对 <b>Recordset</b> 的更改：</p>
<pre>Sub Cancel_OnClick
   ADC1.CancelUpdate
End Sub
</pre>
<p>
<b>注意 </b></p>
<ul type=disc>
<li>
在使用 <b>RDS.DataControl</b> 对象的 <b>SubmitChanges</b> 方法之前必须设置 <b>Connect</b>、<a href="mdproserverprop.htm">Server</a> 和 <a href="mdprosqlprop.htm">SQL</a> 属性。这些属性用于重新连接到数据源。<br><br></li>
<li>
如果在调用相同<b> Recordset </b>对象的<b> SubmitChange</b> 后调用 <a href="mdmthrdscancel.htm">CancelUpdate</a> 方法，那么<b> CancelUpdate</b> 调用将失败，因为此时更改结果已经提交。</li>
</ul>
</BODY>
</HTML>
