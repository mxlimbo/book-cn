<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Source 属性范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdprosourcex"></a>Source 属性范例</h3>
<p>
该范例通过打开三个基于不同数据源的 <b>Recordset</b> 对象演示 <b>Source</b> 属性。</p>
<pre>Public Sub SourceX()

   Dim cnn1 As ADODB.Connection
   Dim rstTitles As ADODB.Recordset
   Dim rstPublishers As ADODB.Recordset
   Dim rstPublishersDirect As ADODB.Recordset
   Dim rstTitlesPublishers As ADODB.Recordset
   Dim cmdSQL As ADODB.Command
   Dim strCnn As String
   Dim strSQL As String

   ' 打开连接。
   Set cnn1 = New ADODB.Connection
   strCnn = "Provider=sqloledb;" &amp; _
      "Data Source=srv;Initial Catalog=pubs;User Id=sa;Password=; "
   cnn1.Open strCnn
   
   ' 打开基于命令对象的记录集。
   Set cmdSQL = New ADODB.Command
   Set cmdSQL.ActiveConnection = cnn1
   cmdSQL.CommandText = "Select title, type, pubdate " &amp; _
      "FROM titles ORDER BY title"
   Set rstTitles = cmdSQL.Execute()
   
   ' 打开基于表的记录集。
   Set rstPublishers = New ADODB.Recordset
   rstPublishers.Open "publishers", strCnn, , , adCmdTable
   
   ' 打开基于表的记录集。
   Set rstPublishersDirect = New ADODB.Recordset
   rstPublishersDirect.Open "publishers", strCnn, , , adCmdTable<b>Direct</b>
   

   ' 打开基于 SQL 字符串的记录集。
   Set rstTitlesPublishers = New ADODB.Recordset
   strSQL = "SELECT title_ID AS TitleID, title AS Title, " &amp; _
      "publishers.pub_id AS PubID, pub_name AS PubName " &amp; _
      "FROM publishers INNER JOIN titles " &amp; _
      "ON publishers.pub_id = titles.pub_id " &amp; _
      "ORDER BY Title"
   rstTitlesPublishers.Open strSQL, strCnn, , , adCmdText

   ' 使用 Source 属性显示每个记录集的资源。
   MsgBox "rstTitles source: " &amp; vbCr &amp; _
      rstTitles.<span class=cfe><b>Source</b></span> &amp; vbCr &amp; vbCr &amp; _
      "rstPublishers source: " &amp; vbCr &amp; _
      rstPublishers.<span class=cfe><b>Source</b></span> &amp; vbCr &amp; vbCr &amp; _
      "rstPublishersDirect source: " &amp; vbCr &amp; _
      rstPublishersDirect.<span class=cfe><b>Source</b></span> &amp; vbCr &amp; vbCr &amp; _
      "rstTitlesPublishers source: " &amp; vbCr &amp; _
      rstTitlesPublishers.<span class=cfe><b>Source</b></span>

   rstTitles.Close
   rstPublishers.Close
   rstTitlesPublishers.Close
   cnn1.Close

End Sub</pre>
</BODY>
</HTML>
