<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>CreateRecordset 方法 (RDS)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthcreaterec"></a>CreateRecordset 方法 (RDS)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCreateRec_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCreateRec_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCreateRec_A">
</object></p>
<p>
创建未连接的空记录集。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>object</i>.<b>CreateRecordset(</b><i>ColumnInfos</i><b>)</b></p>
<p class=label>
<b>参数</b></p>
<p>
<i>Object&nbsp;&nbsp;&nbsp;</i><a href="mddefobjectvariable.htm">对象变量</a>，代表 <b>RDSServer.DataFactory</b> 或 <a href="mdobjdatacontrol.htm">RDS.DataControl</a> 对象。</p>
<p>
<i>ColumnsInfos&nbsp;&nbsp;&nbsp;</i>数组的<b>变体型</b>数组，用于定义所创建的<b> Recordset</b> 的每列。每列的定义都包含具有以下四个所需属性的数组。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>属性</b></td>
<td class=label width=62%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=38%>Name</td>
<td width=62%>列标头的名称。</td>
</tr>
<tr valign=top>
<td width=38%>Type</td>
<td width=62%>整型数据类型。</td>
</tr>
<tr valign=top>
<td width=38%>Size</td>
<td width=62%>以字符为单位的整型宽度，与数据类型无关。</td>
</tr>
<tr valign=top>
<td width=38%>Nullability</td>
<td width=62%>布尔值。</td>
</tr>
</table><br>
<p>
随后列数组的集合被组合为一个数组，用以定义 <b>Recordset</b>。</p>
<p class=label>
<b>说明</b></p>
<p>
服务器端业务对象可以使用来自非 OLE DB 数据提供者的数据充填所产生的 <b>ADODB.Recordset</b>，例如包含股票份额的操作系统文件。</p>
<p>
下表列出了 <b>RDSServer.DataFactory </b>对象的 <b>CreateRecordset </b>方法支持的数据类型，所列编号为用于定义字段的引用编号。</p>
<p>
每种数据类型可以是固定长度或可变长度。固定长度类型的大小应定义为 -1，因为其大小已预先确定而此处仍需要其大小的定义。可变长度数据类型大小的允许范围从 1 到 32767。</p>
<p>
对于某些可变数据类型，其类型可以强制为在“替换”列中注明的类型。只有在创建和填写 <b>Recordset</b> 之后才能看到替换情况，此后如有必要，可以检查实际数据类型。</p>
<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=17%><b>长度</b></td>
<td class=label width=33%><b>常量</b></td>
<td class=label width=20%><b>编号</b></td>
<td class=label width=30%><b>替换</b></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adTinyInt</b></td>
<td width=20%>16</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adSmallInt</b></td>
<td width=20%>2</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adInteger</b></td>
<td width=20%>3</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adBigInt</b></td>
<td width=20%>20</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adUnsignedTinyInt</b></td>
<td width=20%>17</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adUnsignedSmallInt</b></td>
<td width=20%>18</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adUnsignedInt</b></td>
<td width=20%>19</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adUnsignedBigInt</b></td>
<td width=20%>21</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adSingle</b></td>
<td width=20%>4</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adDouble</b></td>
<td width=20%>5</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adCurrency</b></td>
<td width=20%>6</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adDecimal</b></td>
<td width=20%>14</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adNumeric</b></td>
<td width=20%>131</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adBoolean</b></td>
<td width=20%>11</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adError</b></td>
<td width=20%>10</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adGuid</b></td>
<td width=20%>72</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adDate</b></td>
<td width=20%>7</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adDBDate</b></td>
<td width=20%>133</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adDBTime</b></td>
<td width=20%>134</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>固定</td>
<td width=33%><b>adDBTimestamp</b></td>
<td width=20%>135</td>
<td width=30%>7</td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adBSTR</b></td>
<td width=20%>8</td>
<td width=30%>130</td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adChar</b></td>
<td width=20%>129</td>
<td width=30%>200</td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adVarChar</b></td>
<td width=20%>200</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adLongVarChar</b></td>
<td width=20%>201</td>
<td width=30%>200</td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adWChar</b></td>
<td width=20%>130</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adVarWChar</b></td>
<td width=20%>202</td>
<td width=30%>130</td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adLongVarWChar</b></td>
<td width=20%>203</td>
<td width=30%>130</td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adBinary</b></td>
<td width=20%>128</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adVarBinary</b></td>
<td width=20%>204</td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=17%>可变</td>
<td width=33%><b>adLongVarBinary</b></td>
<td width=20%>205</td>
<td width=30%>204</td>
</tr>
</table><br>
</BODY>
</HTML>
