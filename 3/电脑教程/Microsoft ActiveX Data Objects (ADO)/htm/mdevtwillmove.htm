<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>WillMove and MoveComplete (RecordsetEvent) 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdevtwillmove"></a>WillMove and MoveComplete (RecordsetEvent) 方法</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdevtWillMove_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdevtWillMove_A">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdevtWillMove_X">
</object></p>
<p>
<b>WillMove </b>方法在挂起操作更改 <b>Recordset </b>中的当前位置前调用。<b>MoveComplete </b>方法则在 <b>Recordset </b>的当前位置更改后调用。</p>
<p class=label>
<b>语法</b></p>
<p>
<b>WillMove</b> <b><i>adReason, adStatus, pRecordset</i></b></p>
<p>
<b>MoveComplete</b> <b><i>adReason, pError, adStatus, pRecordset</i></b> </p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>adReason</i></b>&nbsp;&nbsp;&nbsp;<b>EventReasonEnum </b>值，指定该事件的原因。它的值可以是 <b>adRsnMoveFirst</b>、<b>adRsnMoveLast</b>、<b>adRsnMoveNext</b>、<b>adRsnMovePrevious</b>、<b>adRsnMove </b>或 <b>adRsnRequery</b>。</p>
<p>
<b><i>pError</i></b>&nbsp;&nbsp;&nbsp;<b>Error</b> 对象，说明当<b> adStatus</b> 值为<b> adStatusErrorsOccurred</b> 时所发生的错误，否则将不对它进行设置。</p>
<p>
<b><i>adStatus</i></b>&nbsp;&nbsp;&nbsp;<b>EventStatusEnum</b> 状态值。</p>
<p>
当调用 <b>WillMove </b>时，如果引发事件的操作成功，则该参数设置为 <b>adStatusOK</b>。如果该方法无法请求取消挂起的操作，则设置为 <b>adStatusCantDeny</b>。</p>
<p>
当调用<b> MoveComplete </b>时，如果引发事件的操作成功，则该参数设置为<b> adStatusOK</b>。如果操作失败，则设置为<b> adStatusErrorsOccurred</b>。</p>
<p>
在 <b>WillMove </b>返回前，将该参数设置为 <b>adStatusCancel </b>可请求取消挂起的操作。在 <b>MoveComplete </b>返回前，将该参数设置为 <b>adStatusUnwantedEvent </b>可避免后续的通知。</p>
<p>
<b><i>pRecordset</i></b>&nbsp;&nbsp;&nbsp;<b>Recordset</b> 对象。发生该事件所针对的记录集。</p>
<p class=label>
<b>说明</b></p>
<p>
<b>WillMove</b> 或 <b>MoveComplete</b> 事件可因下列 <b>Recordset</b> 操作而发生：<b>Open</b>、<b>Move</b>、<b>MoveFirst</b>、<b>MoveLast</b>、<b>MoveNext</b>、<b>MovePrevious</b>、<b>Bookmark</b>、<b>AddNew</b>、<b>Delete</b>、<b>Requery</b> 和 <b>Resync</b>。这些事件可能因下列属性而发生：<b>Filter</b>、<b>Index</b>、<b>AbsolutePage</b> 和 <b>AbsolutePosition</b>。如果子 <b>Recordset</b> 使 <b>Recordset</b> 事件被连接并且父 <b>Recordset</b> 被移动，则也会发生这些事件。</p>
</BODY>
</HTML>
