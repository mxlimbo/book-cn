<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>步骤 1：打开连接（ADO 教程）</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdhowopenconnection"></a>步骤 1：打开连接（ADO 教程）</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowOpenConnection_C">
</object></p>
<p class=label>
<b>您所在的步骤...</b>
<ul type=disc>
<li>
<b>连接数据源。</b><br><br></li>
<li>
可选择创建表示 SQL 查询命令的对象。<br><br></li>
<li>
可选择在 SQL 命令中将值指定为变量参数。<br><br></li>
<li>
执行命令。如果命令以行返回，将行存储在存储对象中。<br><br></li>
<li>
可选择对数据进行定位、检查、操作和编辑。<br><br></li>
<li>
适当情况下，可以使用存储对象中的变更对数据源进行更新。可选择在事务处理中嵌入更新数据。<br><br></li>
<li>
在使用事务之后，可以接受或拒绝在事务中所做的更改。结束事务。 </li>
</ul>
<p class=label>
<b>讨论</b></p>
<p>
如果需要一种途径以建立交换数据所必须的条件，那就是“连接”。所连接的数据源可在“连接字符串”中指定，但是对于不同的提供者和数据源而言，连接字符串中指定的参数会有所不同。 </p>
<p>
ADO 打开连接的主要方法是使用 <b>Connection.Open </b>方法。另外也可在同一个操作中调用快捷方法 <b>Recordset.Open </b>打开连接并在该连接上发出命令。以下是 Visual Basic 中用于两种方法的语法：</p>
<pre>connection.<span class=cfe><b>Open</b></span> <i>ConnectionString</i>, <i>UserID</i>, <i>Password</i>, <i>OpenOptions</i>
recordset.<span class=cfe><b>Open</b></span> <i>Source</i>, <i>ActiveConnection</i>, <i>CursorType</i>, <i>LockType</i>, <i>Options</i>
</pre>
<p>
比较这两种方法将有益于加深对 ADO 方法操作数的总体了解。</p>
<p>
ADO 提供了多种指定操作数的简便方式。例如：<b>Recordset.Open </b>带有 <b>ActiveConnection</b> 操作数，该操作数可以是文字字符串（表示字符串的变量），或者是代表一个已打开的连接的 <b>Connection</b> 对象。</p>
<p>
对象中的多数方法具有属性，当操作数缺省时属性可以提供参数。使用 <b>Connection.Open</b>，可以省略显式 <b>ConnectionString </b>操作数并通过将 <b>ConnectionString </b>的属性设置为“DSN=pubs;uid=sa;pwd=;database=pubs”隐式地提供信息。</p>
<p>
与此相反，连接字符串中的关键字操作数 <b>uid</b> 和 <b>pwd</b> 可为 <b>Connection</b> 对象设置 <b>UserID</b> 和 <b>Password</b> 参数。</p>
<p>
本教程使用显式连接字符串调用<b> Connection.Open </b>方法，数据源是“开放式数据库连接”(ODBC) <b>pubs</b> 数据库，它作为测试数据库与 Microsoft SQL Server 一同发布。（数据源的实际位置，如本地驱动器或远程服务器，在定义“数据源名称”(DSN) 时进行指定。）</p>
<pre>connection.<span class=cfe><b>Open</b></span> "DSN=pubs;uid=sa;pwd=;database=pubs"
</pre>
<p>
<b>下一页<B>&nbsp;&nbsp;&nbsp;</B></b><a href="mdhowcreatecommand.htm">步骤 2</a></p>
</BODY>
</HTML>
