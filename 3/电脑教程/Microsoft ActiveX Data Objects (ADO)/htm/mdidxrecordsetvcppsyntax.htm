<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>_Recordset (ADO for VC++ 语法)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdidxrecordsetvcppsyntax"></a>_Recordset (ADO for VC++ 语法)</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdidxRecordsetVCppSyntax_C">
</object></p>
<h3>方法</h3>
<p>
<a href="mdmthaddnew.htm">AddNew</a>(VARIANT <i>FieldList,</i> VARIANT <i>Values</i>)</p>
<p>
<a href="mdmthadocancel.htm">Cancel</a>(void)</p>
<p>
<a href="mdmthcancelbatch.htm">CancelBatch</a>(AffectEnum <i>AffectRecords</i>)</p>
<p>
<a href="mdmthcancelupdate.htm">CancelUpdate</a>(void)</p>
<p>
<a href="mdmthclone.htm">Clone</a>(LockTypeEnum <i>LockType,</i> _ADORecordset **<i>ppvObject</i>)</p>
<p>
<a href="mdmthclose.htm">Close</a>(void)</p>
<p>
<a href="mdmthcomparebookmarks.htm">CompareBookmarks</a>(VARIANT <i>Bookmark1</i>, VARIANT <i>Bookmark2</i>, <br>
CompareEnum *<i>pCompare</i>)</p>
<p>
<a href="mdmthrstdelete.htm">Delete</a>(AffectEnum <i>AffectRecords</i>)</p>
<p>
<a href="mdmthfindmethodado.htm">Find</a>(BSTR <i>Criteria,</i> LONG <i>SkipRecords,</i> SearchDirectionEnum <i>SearchDirection,</i> <br>
VARIANT <i>Start</i>)</p>
<p>
<a href="mdmthgetrows.htm">GetRows</a>(long <i>Rows,</i> VARIANT <i>Start,</i> VARIANT <i>Fields,</i> VARIANT *<i>pvar</i>)</p>
<p>
<a href="mdmthgetstringmethod(recordset)ado.htm">GetString</a>(StringFormatEnum <i>StringFormat,</i> long <i>NumRows,</i> BSTR <i>ColumnDelimeter,</i> <br>
BSTR <i>RowDelimeter,</i> BSTR <i>NullExpr,</i> BSTR *<i>pRetString</i>)</p>
<p>
<a href="mdmthmove.htm">Move</a>(long <i>NumRecords,</i> VARIANT <i>Start</i>)</p>
<p>
<a href="mdmthmovefirst.htm">MoveFirst</a>(void)</p>
<p>
<a href="mdmthmovefirst.htm">MoveLast</a>(void)</p>
<p>
<a href="mdmthmovefirst.htm">MoveNext</a>(void)</p>
<p>
<a href="mdmthmovefirst.htm">MovePrevious</a>(void)</p>
<p>
<a href="mdmthnextrec.htm">NextRecordset</a>(VARIANT *<i>RecordsAffected,</i> _ADORecordset **<i>ppiRs</i>)</p>
<p>
<a href="mdmthrstopen.htm">Open</a>(VARIANT <i>Source,</i> VARIANT <i>ActiveConnection,</i> CursorTypeEnum <i>CursorType,</i> <br>
LockTypeEnum <i>LockType,</i> LONG <i>Options</i>)</p>
<p>
<a href="mdmthadorequery.htm">Requery</a>(LONG <i>Options</i>)</p>
<p>
<a href="mdmthadoresync.htm">Resync</a>(AffectEnum <i>AffectRecords,</i> ResyncEnum <i>ResyncValues</i>)</p>
<p>
<a href="mdmthrstsave.htm">Save</a>(BSTR <i>FileName,</i> PersistFormatEnum <i>PersistFormat</i>)</p>
<p>
<a href="mdmthsupports.htm">Supports</a>(CursorOptionEnum <i>CursorOptions,</i> VARIANT_BOOL *<i>pb</i>)</p>
<p>
<a href="mdmthupdate.htm">Update</a>(VARIANT <i>Fields,</i> VARIANT <i>Values</i>)</p>
<p>
<a href="mdmthupdatebatch.htm">UpdateBatch</a>(AffectEnum <i>AffectRecords</i>)</p>
<h3>属性</h3>
<p>
<a href="mdproabpage.htm">get_AbsolutePage</a>(PositionEnum *<i>pl</i>)<br>
<b>put_AbsolutePage</b>(PositionEnum <i>Page</i>)</p>
<p>
<a href="mdproabpos.htm">get_AbsolutePosition</a>(PositionEnum *<i>pl</i>)<br>
<b>put_AbsolutePosition</b>(PositionEnum <i>Position</i>)</p>
<p>
<a href="mdproactivecommand.htm">get_ActiveCommand</a>(IDispatch **<i>ppCmd</i>)</p>
<p>
<a href="mdproactivecon.htm">get_ActiveConnection</a>(VARIANT *<i>pvar</i>)<br>
<b>put_ActiveConnection</b>(VARIANT <i>vConn</i>)<br>
<b>putref_ActiveConnection</b>(IDispatch *<i>pconn</i>)</p>
<p>
<a href="mdprobof.htm">get_BOF</a>(VARIANT_BOOL *<i>pb</i>)</p>
<p>
<a href="mdprobookmark.htm">get_Bookmark</a>(VARIANT *<i>pvBookmark</i>)<br>
<b>put_Bookmark</b>(VARIANT <i>vBookmark</i>)</p>
<p>
<a href="mdprocachesize.htm">get_CacheSize</a>(long *<i>pl</i>)<br>
<b>put_CacheSize</b>(long <i>CacheSize</i>)</p>
<p>
<a href="mdprocursorlocation.htm">get_CursorLocation</a>(CursorLocationEnum *<i>plCursorLoc</i>)<br>
<b>put_CursorLocation</b>(CursorLocationEnum <i>lCursorLoc</i>)</p>
<p>
<a href="mdprocursortype.htm">get_CursorType</a>(CursorTypeEnum *<i>plCursorType</i>)<br>
<b>put_CursorType</b>(CursorTypeEnum <i>lCursorType</i>)</p>
<p>
<a href="mdprodatamember.htm">get_DataMember</a>(BSTR *<i>pbstrDataMember</i>)<br>
<b>put_DataMember</b>(BSTR <i>bstrDataMember</i>)</p>
<p>
<a href="mdprodatasource.htm">get_DataSource</a>(IUnknown **<i>ppunkDataSource</i>)<br>
<b>putref_DataSource</b>(IUnknown *<i>punkDataSource</i>)</p>
<p>
<a href="mdproeditmode.htm">get_EditMode</a>(EditModeEnum *<i>pl</i>)</p>
<p>
<a href="mdprobof.htm">get_EOF</a>(VARIANT_BOOL *<i>pb</i>)</p>
<p>
<a href="mdprofilter.htm">get_Filter</a>(VARIANT *<i>Criteria</i>)<br>
<b>put_Filter</b>(VARIANT <i>Criteria</i>)</p>
<p>
<a href="mdprolocktype.htm">get_LockType</a>(LockTypeEnum *<i>plLockType</i>)<br>
<b>put_LockType</b>(LockTypeEnum <i>lLockType</i>)</p>
<p>
<a href="mdpromarshaloptions.htm">get_MarshalOptions</a>(MarshalOptionsEnum *<i>peMarshal</i>)<br>
<b>put_MarshalOptions</b>(MarshalOptionsEnum <i>eMarshal</i>)</p>
<p>
<a href="mdpromaxrecords.htm">get_MaxRecords</a>(long *<i>plMaxRecords</i>)<br>
<b>put_MaxRecords</b>(long <i>lMaxRecords</i>)</p>
<p>
<a href="mdpropagecount.htm">get_PageCount</a>(long *<i>pl</i>)</p>
<p>
<a href="mdpropagesize.htm">get_PageSize</a>(long *<i>pl</i>)<br>
<b>put_PageSize</b>(long <i>PageSize</i>)</p>
<p>
<a href="mdprorecordcount.htm">get_RecordCount</a>(long *<i>pl</i>)</p>
<p>
<a href="mdprosortpropertyado.htm">get_Sort</a>(BSTR *<i>Criteria</i>)<br>
<b>put_Sort</b>(BSTR <i>Criteria</i>)</p>
<p>
<a href="mdprorstsource.htm">get_Source</a>(VARIANT *<i>pvSource</i>)<br>
<b>put_Source</b>(BSTR <i>bstrConn</i>)<br>
<b>putref_Source</b>(IDispatch *<i>pcmd</i>)</p>
<p>
<a href="mdprostate.htm">get_State</a>(LONG *<i>plObjState</i>)</p>
<p>
<a href="mdprostatus.htm">get_Status</a>(long *<i>pl</i>)</p>
<p>
<a href="mdprostayinsync.htm">get_StayInSync</a>(VARIANT_BOOL *<i>pbStayInSync</i>)<br>
<b>put_StayInSync</b>(VARIANT_BOOL <i>bStayInSync</i>)</p>
<p>
<a href="mdcolfields.htm">get_Fields</a>(ADOFields **<i>ppvObject</i>)</p>
<h3>杂项</h3>
<p>
<b>get_Collect</b>(VARIANT <i>Index,</i> VARIANT *<i>pvar</i>)<br>
<b>put_Collect</b>(VARIANT <i>Index,</i> VARIANT <i>value</i>)</p>
<h3>事件</h3>
<p>
<a href="mdevtendofrecordset.htm">EndOfRecordset</a>(VARIANT_BOOL *<i>fMoreData,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtfetchcomplete.htm">FetchComplete</a>(ADOError *<i>pError,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtfetchprogress.htm">FetchProgress</a>(long <i>Progress,</i> long <i>MaxProgress,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillchangefield.htm">FieldChangeComplete</a>(LONG <i>cFields,</i> VARIANT <i>Fields,</i> ADOError *<i>pError,</i> <br>
EventStatusEnum *<i>adStatus,</i> _ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillmove.htm">MoveComplete</a>(EventReasonEnum <i>adReason,</i> ADOError *<i>pError,</i> <br>
EventStatusEnum *<i>adStatus,</i> _ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillchangerecord.htm">RecordChangeComplete</a>(EventReasonEnum <i>adReason,</i> LONG <i>cRecords,</i> <br>
ADOError *<i>pError,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillchangerecordset.htm">RecordsetChangeComplete</a>(EventReasonEnum <i>adReason,</i> ADOError *<i>pError,</i> <br>
EventStatusEnum *<i>adStatus,</i> _ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillchangefield.htm">WillChangeField</a>(LONG <i>cFields,</i> VARIANT <i>Fields,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillchangerecord.htm">WillChangeRecord</a>(EventReasonEnum <i>adReason,</i> LONG <i>cRecords,</i> <br>
EventStatusEnum *<i>adStatus,</i> _ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillchangerecordset.htm">WillChangeRecordset</a>(EventReasonEnum <i>adReason,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADORecordset *<i>pRecordset</i>)</p>
<p>
<a href="mdevtwillmove.htm">WillMove</a>(EventReasonEnum <i>adReason,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADORecordset *<i>pRecordset</i>)</p>
</BODY>
</HTML>
