<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Index 属性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdproindex"></a>Index 属性</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproIndex_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproIndex_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproIndex_A">
</object></p>
<p>
指示对 <a href="mdobjodbrec.htm">Recordset</a> 对象当前生效的索引的名称。</p>
<p class=label>
<b>设置和返回值</b></p>
<p>
设置或返回字符串值，该值为索引名。</p>
<p class=label>
<b>说明</b></p>
<p>
由 <b>Index</b> 属性命名的索引必须针对基本表基本 <b>Recordset</b> 对象已在前面声明过。即索引必须已在程序中声明为 ADOX <a href="adobjindex.htm">Index</a> 对象，或在创建基本表时声明。</p>
<p>
如果无法设置索引，则会发生运行时错误。无法在 <b>WillRecordsetChange</b> 或 <b>RecordsetChangeComplete</b> 事件处理程序内设置 <b>Index</b> 属性。如果 <b>Recordset</b> 正在执行操作，也无法对它进行设置。如果 <b>Recordset </b>是关闭的，则总能成功设置 <b>Index </b>属性，但如果基本提供者不支持索引，则 <b>Recordset</b> 将无法成功打开，或者索引将无法使用。</p>
<p>
如果可以设置索引，则可以更改当前行的位置。这将导致对 <a href="mdproabpos.htm">AbsolutePosition</a> 属性的更新，并产生 <a href="mdevtwillchangerecordset.htm">WillRecordsetChange</a>、<a href="mdevtwillchangerecordset.htm">RecordsetChangeComplete</a>、<a href="mdevtwillmove.htm">WillMove</a> 和 <a href="mdevtwillmove.htm">MoveComplete</a> 事件。</p>
<p>
如果可以设置索引，而 <a href="mdprolocktype.htm">LockType</a> 属性是 <b>adLockPessimistic</b> 或 <b>adLockOptimistic</b>，那么，将执行隐式 <a href="mdmthupdatebatch.htm">UpdateBatch</a> 操作，并释放当前的和受影响的组。任何现有的 <a href="mdprofilter.htm">filter</a> 被释放，并且当前行位置更改为重排序后 <b>Recordset</b> 的第一行。</p>
<p>
<b>Index</b> 属性与 <a href="mdmthseek.htm">Seek</a> 方法连通使用。如果基本提供者不支持 <b>Index</b> 属性和 <b>Seek</b> 方法，请考虑使用 <a href="mdmthfindmethodado.htm">Find</a> 方法替代。使用 <a href="mdmthsupports.htm">Supports</a><b>(adIndex)</b> 方法可判定 <b>Recordset</b> 对象是否支持索引。</p>
<p>
尽管二者均处理索引，但内置的 <b>Index</b> 属性与动态的 <a href="mdprooptimizepropertyrds.htm">Optimize</a> 属性无关。</p>
</BODY>
</HTML>
