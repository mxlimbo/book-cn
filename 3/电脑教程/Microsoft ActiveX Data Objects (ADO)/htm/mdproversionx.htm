<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Version 属性范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdproversionx"></a>Version 属性范例</h3>
<p>
该范例使用 <b>Connection</b> 对象的 <b>Version</b> 属性显示当前的 ADO 版本。同时还使用几个动态属性显示当前的 DBMS 名称和版本、OLE DB 的版本、提供者名称和版本、驱动程序名称和版本以及驱动程序 ODBC 的版本。</p>
<pre>Public Sub VersionX()

   Dim cnn1 As ADODB.Connection

   ' 打开连接。
   Set cnn1 = New ADODB.Connection
   strCnn = “driver={SQL Server};server=srv;” &amp; _
      “user id=sa;password=;database=pubs;”
   cnn1.Open strCnn
   
   strVersionInfo = "ADO Version: " &amp; cnn1.<span class=cfe><b>Version</b></span> &amp; vbCr &amp; _
   "DBMS Name: " &amp; cnn1.Properties("DBMS Name") &amp; vbCr &amp; _
   "DBMS Version: " &amp; cnn1.Properties("DBMS Version") &amp; vbCr &amp; _
   "OLE DB Version: " &amp; cnn1.Properties("OLE DB Version") &amp; vbCr &amp; _
   "Provider Name: " &amp; cnn1.Properties("Provider Name") &amp; vbCr &amp; _
   "Provider Version: " &amp; cnn1.Properties("Provider Version") &amp; vbCr &amp; _
   "Driver Name: " &amp; cnn1.Properties("Driver Name") &amp; vbCr &amp; _
   "Driver Version: " &amp; cnn1.Properties("Driver Version") &amp; vbCr &amp; _
   "Driver ODBC Version: " &amp; cnn1.Properties("Driver ODBC Version")

   MsgBox strVersionInfo

   cnn1.Close

End Sub</pre>
</BODY>
</HTML>
