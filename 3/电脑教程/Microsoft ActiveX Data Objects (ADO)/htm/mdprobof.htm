<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>BOF、EOF 属性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdprobof"></a>BOF、EOF 属性</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproBOF_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproBOF_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproBOF_A">
</object>
<ul type=disc>
<li>
<b>BOF</b> 指示当前记录位置位于 <b>Recordset</b> 对象的第一个记录之前。<br><br></li>
<li>
<b>EOF</b> 指示当前记录位置位于 <b>Recordset</b> 对象的最后一个记录之后。</li>
</ul>
<p class=label>
<b>返回值</b></p>
<p>
<b>BOF</b> 和 <b>EOF</b> 属性返回布尔型值。</p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>BOF</b> 和 <b>EOF</b> 属性可确定 <a href="mdobjodbrec.htm">Recordset</a> 对象是否包含记录，或者从一个记录移动到另一个记录时是否超出 <b>Recordset</b> 对象的限制。</p>
<p>
如果当前记录位于第一个记录之前，<b>BOF</b> 属性将返回 <b>True</b> (-1)，如果当前记录为第一个记录或位于其后则将返回 <b>False</b> (0)。</p>
<p>
如果当前记录位于 <b>Recordset</b> 对象的最后一个记录之后 <b>EOF</b> 属性将返回 <b>True</b>，而当前记录为 <b>Recordset</b> 对象的最后一个记录或位于其前，则将返回 <b>False</b>。</p>
<p>
如果 <b>BOF</b> 或 <b>EOF</b> 属性为 <b>True</b>，则没有当前记录。</p>
<p>
如果打开没有记录的 <b>Recordset</b> 对象，<b>BOF</b> 和 <b>EOF</b> 属性将设置为 <b>True</b>，而 <b>Recordset</b> 对象的 <a href="mdprorecordcount.htm">RecordCount</a> 属性设置为零。打开至少包含一条记录的 <b>Recordset</b> 对象时，第一条记录为当前记录，而 <b>BOF</b> 和 <b>EOF</b> 属性为 <b>False</b>。</p>
<p>
如果删除 <b>Recordset </b>对象中保留的最后记录，<b>BOF</b> 和 <b>EOF</b> 属性将保持 <b>False</b>，直到重新安排当前记录。</p>
<p>
以下表格说明不同 <b>BOF</b> 和 <b>EOF</b> 属性组合所允许的 <b>Move</b> 方法。</p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows>
<tr valign=top>
<td class=label width=21%></td>
<td class=label width=21%><b>MoveFirst,<br>
MoveLast</b></td>
<td class=label width=24%><b>MovePrevious,<br>
Move &lt; 0</b></td>
<td class=label width=14%><b><br>
Move 0</b></td>
<td class=label width=20%><b>MoveNext,<br>
Move &gt; 0</b></td>
</tr>
<tr valign=top>
<td width=21%><b>BOF=True,</b><br>
<b>EOF=False</b></td>
<td width=21%>允许</td>
<td width=24%>错误</td>
<td width=14%>错误</td>
<td width=20%>允许</td>
</tr>
<tr valign=top>
<td width=21%><b>BOF=False,</b><br>
<b>EOF=True</b></td>
<td width=21%>允许</td>
<td width=24%>允许</td>
<td width=14%>错误</td>
<td width=20%>错误</td>
</tr>
<tr valign=top>
<td width=21%>同时为 <b>True</b></td>
<td width=21%>错误</td>
<td width=24%>错误</td>
<td width=14%>错误</td>
<td width=20%>错误</td>
</tr>
<tr valign=top>
<td width=21%>同时为 <b>False</b></td>
<td width=21%>允许</td>
<td width=24%>允许</td>
<td width=14%>允许</td>
<td width=20%>允许</td>
</tr>
</table><br>
<p>
允许使用 <b>Move</b> 方法并不能保证该方法成功定位记录，只是意味着调用指定的 <b>Move</b> 方法不会产生错误。</p>
<p>
下表说明当调用各种 <b>Move</b> 方法但未成功定位记录时 <b>BOF </b>和 <b>EOF</b> 属性设置所发生的情况。</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=45%></td>
<td class=label width=26%><b>BOF</b></td>
<td class=label width=29%><b>EOF</b></td>
</tr>
<tr valign=top>
<td width=45%><b>MoveFirst</b>, <b>MoveLast</b></td>
<td width=26%>设置为 <b>True</b></td>
<td width=29%>设置为 <b>True</b> </td>
</tr>
<tr valign=top>
<td width=45%><b>Move</b> 0</td>
<td width=26%>没有变化</td>
<td width=29%>没有变化</td>
</tr>
<tr valign=top>
<td width=45%><b>MovePrevious</b>, <b>Move</b> &lt; 0</td>
<td width=26%>设置为<b> True</b></td>
<td width=29%>没有变化</td>
</tr>
<tr valign=top>
<td width=45%><b>MoveNext</b>, <b>Move</b> &gt; 0</td>
<td width=26%>没有变化</td>
<td width=29%>设置为<b> True</b></td>
</tr>
</table><br>
</BODY>
</HTML>
