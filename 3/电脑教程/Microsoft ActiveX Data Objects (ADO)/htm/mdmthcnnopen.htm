<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Open 方法 (ADO Connection)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthcnnopen"></a>Open 方法 (ADO Connection)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCnnOpen_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCnnOpen_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCnnOpen_A">
</object></p>
<p>
打开到数据源的连接。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>connection</i><b>.Open</b> <b><i>ConnectionString</i>,</b> <b><i>UserID</i>,</b> <b><i>Password, Options</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>ConnectionString&nbsp;&nbsp;&nbsp;</i></b>可选，<b>字符串</b>，包含连接信息。参阅 <a href="mdproconnectionstring.htm">ConnectionString</a> 属性可获得有效设置的详细信息。</p>
<p>
<b><i>UserID&nbsp;&nbsp;&nbsp;</i></b>可选，<b>字符串</b>，包含建立连接时所使用用户名。</p>
<p>
<b><i>Password&nbsp;&nbsp;&nbsp;</i></b>可选，<b>字符串</b>，包含建立连接时所使用密码。</p>
<p>
<b><i>Options&nbsp;&nbsp;&nbsp;</i></b>可选，<b>ConnectOptionEnum</b> 值。决定该方法是在连接建立之后（异步）还是连接建立之前（同步）返回。可以是如下某个常量：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=31%><b>常量</b></td>
<td class=label width=69%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=31%><b>adConnectUnspecified</b></td>
<td width=69%>（默认）同步打开连接。</td>
</tr>
<tr valign=top>
<td width=31%><b>adAsyncConnect</b></td>
<td width=69%>异步打开连接。<a href="mdevtconnectconnectionevents.htm">ConnectComplete</a> 事件可以用于决定连接何时可用。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>Connection </b>对象的 <b>Open </b>方法可建立到数据源的物理连接。在该方法成功完成后连接是活跃的，可以对它发出命令并且处理结果。</p>
<p>
使用可选的<b><i> ConnectionString</i></b> 参数指定连接字符串，它包含由分号分隔的一系列<i> argument = value</i> 语句。<b>ConnectionString </b>属性自动继承用于<b> <i>ConnectionString </i></b>参数的值，因此可在打开之前设置<b> Connection</b> 对象的<b> ConnectionString</b> 属性，或在<b> Open</b> 方法调用时使用<b><i> ConnectionString</i></b> 参数设置或覆盖当前连接参数。</p>
<p>
如果在 <b><i>ConnectionString</i></b> 参数和可选的<b><i> UserID</i></b> 及<b><i> Password</i></b> 参数中传送用户和密码信息，那么 <b><i>UserID</i></b> 和 <b><i>Password</i></b> 参数将覆盖<b><i> ConnectionString</i></b> 中指定的值。</p>
<p>
在对打开的 <b>Connection </b>的操作结束后，可使用 <a href="mdmthclose.htm">Close</a> 方法释放所有关联的系统资源。关闭对象并非将它从内存中删除；可以更改它的属性设置并在以后再次使用 <b>Open</b> 方法打开它。要将对象完全从内存中删除，可将对象变量设置为 <i>Nothing</i>。</p>
<p class=indent>
<B><b>远程数据服务用法&nbsp;&nbsp;&nbsp;</b></B> 当在客户端的<b> Connection</b> 对象上使用<b> Open</b> 方法时，在<b> Connection</b> 对象上打开 <b>Recordset</b> 之前<b> Open</b> 方法其实并未建立到服务器的连接。</p>
</BODY>
</HTML>
