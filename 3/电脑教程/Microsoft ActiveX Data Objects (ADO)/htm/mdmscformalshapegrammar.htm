<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>形状语法格式</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdmscformalshapegrammar"></a>形状语法格式</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscFormalShapeGrammar_C">
</object></p>
<p>
以下是创建 Shape 命令的规范语法。
<ul type=disc>
<li>
必需的语法项为尖括号 (“&lt;&gt;”) 界定的文本字符串。<br><br></li>
<li>
可选项由方括号 (“[ ]”) 界定。<br><br></li>
<li>
任选其一项用竖线 (“|”) 隔开。<br><br></li>
<li>
重复的可选项用省略号 (“...”) 表示。<br><br></li>
<li>
Alpha 表示字母字符串。<br><br></li>
<li>
Digit 表示数字字符串。<br><br></li>
<li>
Unicode-digit 表示由 unicode 数字组成的字符串。</li>
</ul>
<p>
所有其他项目均为文字。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>项目</b></td>
<td class=label width=67%><b>定义</b></td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;shape-command&gt;</pre>
</td>
<td width=67%><pre>SHAPE [&lt;table-exp&gt; [[AS] &lt;alias&gt;]][&lt;shape-action&gt;]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;table-exp&gt;</pre>
</td>
<td width=67%><pre>{&lt;native-sql-statement&gt;} |<pre>(&lt;shape-command&gt;) |
TABLE &lt;quoted-name&gt; |
&lt;quoted-name&gt;</pre>
</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;shape-action&gt;</pre>
</td>
<td width=67%><pre>APPEND &lt;aliased-field-list&gt; | <pre>COMPUTE &lt;aliased-field-list&gt; 
   [BY &lt;field-list&gt; [[AS] &lt;alias&gt;]] </pre>
</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;aliased-field-list&gt;</pre>
</td>
<td width=67%><pre>&lt;aliased-field&gt; [, &lt;aliased-field...]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;aliased-field&gt;</pre>
</td>
<td width=67%><pre>&lt;field-exp&gt; [[AS] &lt;alias&gt;]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;field-exp&gt;</pre>
</td>
<td width=67%><pre>(&lt;relation-exp&gt;) |<pre>&lt;calculated-exp&gt;</pre>
</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;relation_exp&gt;</pre>
</td>
<td width=67%><pre>&lt;table-exp&gt; [[AS] &lt;alias&gt;] <pre>   RELATE &lt;relation-cond-list&gt;</pre>
</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;relation-cond-list&gt;</pre>
</td>
<td width=67%><pre>&lt;relation-cond&gt; [, &lt;relation-cond&gt;...]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;relation-cond&gt;</pre>
</td>
<td width=67%><pre>&lt;field-name&gt; TO &lt;child-ref&gt;</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;child-ref&gt;</pre>
</td>
<td width=67%><pre>&lt;field-name&gt; | <pre>PARAMETER &lt;param-ref&gt;</pre>
</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;param-ref&gt;</pre>
</td>
<td width=67%><pre>&lt;number&gt;</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;field-list&gt;</pre>
</td>
<td width=67%><pre>&lt;field-name [, &lt;field-name&gt;]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;calculated-exp&gt;</pre>
</td>
<td width=67%><pre>SUM(&lt;qualified-field-name&gt;) |<pre>AVG(&lt;qualified-field-name&gt;) |
MIN(&lt;qualified-field-name&gt;) |
MAX(&lt;qualified-field-name&gt;) |
COUNT(&lt;alias&gt; | &lt;qualified-field-name&gt;) |
STDEV(&lt;qualified-field-name&gt;) |
ANY(&lt;qualified-field-name&gt;) |
CALC(&lt;expresion&gt;)</pre>
</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;qualified-field-name&gt;</pre>
</td>
<td width=67%><pre>&lt;alias&gt;<b>.</b>[&lt;alias&gt;...]&lt;field-name&gt; </pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;alias&gt;</pre>
</td>
<td width=67%><pre>&lt;quoted-name&gt;</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;field-name&gt;</pre>
</td>
<td width=67%><pre>&lt;quoted-name&gt;</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;quoted-name&gt;</pre>
</td>
<td width=67%><pre>"&lt;string&gt;" | <pre>'&lt;string&gt;' | 
<b>[</b>&lt;string&gt;<b>]</b> |
&lt;name&gt;</pre>
</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;name&gt;</pre>
</td>
<td width=67%><pre><i>alpha</i> [ <i>alpha</i> | <i>digit</i> | _ | # ...]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;number&gt;</pre>
</td>
<td width=67%><pre><i>digit</i> [<i>digit</i>...]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;string&gt;</pre>
</td>
<td width=67%><pre><i>unicode-char</i> [<i>unicode-char</i>...]</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>&lt;expression&gt;</pre>
</td>
<td width=67%>Visual Basic for Applications 表达式，其操作数是相同行中其他非 CALC 列。</td>
</tr>
</table><br>
</BODY>
</HTML>
