<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Microsoft OLE DB Provider for Microsoft Active Directory Service</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdrefadsprovspec"></a>Microsoft OLE DB Provider for Microsoft Active Directory Service</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdrefADSProvSpec_C">
</object></p>
<p>
Microsoft&reg; Active Directory Service Interface (ADSI) 提供者允许 ADO 通过 ADSI 连接到不同种类的目录服务。它向 ADO 应用程序提供对 Microsoft Windows NT&reg; 4.0 目录服务以及任何适合 LDAP 目录服务和 Novell 目录服务的只读访问权。ADSI 本身基于一种提供者模式，所以如果有新的提供者提供对其他目录的访问权，ADO 应用程序将可以对其进行无缝访问。ADSI 提供者将不受线程控制并允许使用 unicode。 </p>
<p>
<b>连接字符串参数</b></p>
<p class=label>
</p>
<pre>要连接到该提供者，请将（<b>ConnectionString</b> 属性的参数）“<b>Provider</b>=”设置为：ADSDSOObject
</pre>
<p>
读取 <b>Provider</b> 属性也将返回该字符串。</p>
<p>
<b>命令文本</b></p>
<p class=label>
</p>
<p>
提供者识别下列语法中由四部分组成的命令文本字符串：</p>
<p>
<b>"</b><i>Root</i><b>;</b> <i>Filter</i><b>;</b> <i>Attributes</i>[<b>;</b> <i>Scope</i>]<b>"</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=20%><b>值</b></td>
<td class=label width=80%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=20%><i>Root</i> </td>
<td width=80%>搜索启动（即搜索的根）处的 <b>ADsPath</b> 对象。</td>
</tr>
<tr valign=top>
<td width=20%><i>Filter</i> </td>
<td width=80%>RFC 960 格式的搜索筛选。</td>
</tr>
<tr valign=top>
<td width=20%><i>Attributes</i> </td>
<td width=80%>要返回的用逗号分隔的属性列表</td>
</tr>
<tr valign=top>
<td width=20%><i>Scope</i></td>
<td width=80%>可选。指定搜索范围的字符串。可以是以下的一种：<ul type=disc>
<li>
Base ― 只搜索基本对象（搜索的根）。<br><br></li>
<li>
OneLevel ― 只搜索一级<br><br></li>
<li>
Subtree ― 搜索整个子目录树。</li>
</ul>
</td>
</tr>
</table><br>
<p>
提供者不接受存储的过程调用或简单的表名（例如，<b>CommandType</b> 属性将总是 <b>adCmdText</b>）。要获得命令文本元素的完整说明，请参阅 Active Directory Service 文档。</p>
<p>
<b>Recordset 行为</b></p>
<p class=label>
</p>
<p>
以下表格列出了由该提供者打开的 <b>Recordset</b> 对象的可用功能。只有静态游标类型 (<b>adOpenStatic</b>) 是可用的。</p>
<p>
要获得有关提供者配置的 <b>Recordset</b> 行为的详细信息，请运行 <b>Supports</b> 方法并列举 <b>Recordset</b> 的 <b>Properties</b> 集合以确定特定提供者的动态属性是否存在。</p>
<p>
标准 ADO<b> Recordset </b>属性的可用性：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=54%><b>属性</b></td>
<td class=label width=46%><b>可用性</b></td>
</tr>
<tr valign=top>
<td width=54%><b>AbsolutePage</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>AbsolutePosition</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>ActiveConnection</b></td>
<td width=46%>只读</td>
</tr>
<tr valign=top>
<td width=54%><b>BOF</b></td>
<td width=46%>只读</td>
</tr>
<tr valign=top>
<td width=54%><b>Bookmark</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>CacheSize</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>CursorLocation</b></td>
<td width=46%>总是&nbsp; <b>adUseServer</b></td>
</tr>
<tr valign=top>
<td width=54%><b>CursorType</b></td>
<td width=46%>总是&nbsp; <b>adOpenStatic</b></td>
</tr>
<tr valign=top>
<td width=54%><b>EditMode</b></td>
<td width=46%>总是&nbsp; <b>adEditNone</b></td>
</tr>
<tr valign=top>
<td width=54%><b>EOF</b></td>
<td width=46%>只读</td>
</tr>
<tr valign=top>
<td width=54%><b>Filter</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>LockType</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>MarshalOptions</b></td>
<td width=46%>不可用</td>
</tr>
<tr valign=top>
<td width=54%><b>MaxRecords</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>PageCount</b></td>
<td width=46%>只读</td>
</tr>
<tr valign=top>
<td width=54%><b>PageSize</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>RecordCount</b></td>
<td width=46%>只读</td>
</tr>
<tr valign=top>
<td width=54%><b>Source</b></td>
<td width=46%>读/写</td>
</tr>
<tr valign=top>
<td width=54%><b>State</b></td>
<td width=46%>只读</td>
</tr>
<tr valign=top>
<td width=54%><b>Status</b></td>
<td width=46%>只读</td>
</tr>
</table><br>
<p>
标准 ADO<b> Recordset </b>方法的可用性：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=54%><b>方法</b></td>
<td class=label width=46%><b>可用性</b></td>
</tr>
<tr valign=top>
<td width=54%><b>AddNew</b></td>
<td width=46%>否</td>
</tr>
<tr valign=top>
<td width=54%><b>Cancel</b></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=54%><b>CancelBatch</b></td>
<td width=46%>否</td>
</tr>
<tr valign=top>
<td width=54%><b>CancelUpdate</b></td>
<td width=46%>否</td>
</tr>
<tr valign=top>
<td width=54%><b>Clone</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Close</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Delete</b></td>
<td width=46%>否</td>
</tr>
<tr valign=top>
<td width=54%><b>GetRows</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Move</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>MoveFirst</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>MoveLast</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>MoveNext</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>MovePrevious</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>NextRecordset</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Open</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Requery</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Resync</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Supports</b></td>
<td width=46%>是</td>
</tr>
<tr valign=top>
<td width=54%><b>Update</b></td>
<td width=46%>否</td>
</tr>
<tr valign=top>
<td width=54%><b>UpdateBatch</b></td>
<td width=46%>否</td>
</tr>
</table><br>
<p>
<b>参阅<B>&nbsp;&nbsp;&nbsp;</B></b>有关常规 ADSI 和提供者说明的详细信息，请查阅 Active Directory Service Interface SDK 中提供的文档。可以从 http://www.microsoft.com/ntserver/info/adsi.htm 处的 ADSI Web 页安装 SDK。</p>
</BODY>
</HTML>
