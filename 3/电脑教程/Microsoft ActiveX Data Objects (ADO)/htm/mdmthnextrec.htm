<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>NextRecordset 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthnextrec"></a>NextRecordset 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthNextRec_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthNextRec_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthNextRec_A">
</object></p>
<p>
清除当前 <a href="mdobjodbrec.htm">Recordset</a> 对象并通过提前执行命令序列返回下一个记录集。</p>
<p class=label>
<b>语法</b></p>
<p>
<b>Set</b> <i>recordset2</i> = <i>recordset1</i><b>.NextRecordset(</b> <b><i>RecordsAffected </i>)</b></p>
<p class=label>
<b>返回值</b></p>
<p>
返回 <b>Recordset </b>对象。在语法模型中，recordset1 和 recordset2 可以是相同的 <b>Recordset </b>对象，或者可以使用不同的对象。</p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>RecordsAffected&nbsp;&nbsp;&nbsp;</i></b> 可选，<b>长整型</b>变量，提供者向其返回当前操作所影响的记录数目。</p>
<p>
<B><b>注意</b></B>&nbsp;&nbsp;&nbsp;该参数仅返回受操作影响的记录的数目；它不会从用于生成 <b>Recordset </b>的选择语句返回记录的计数。</p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>NextRecordset </b>方法返回复合命令语句中下一条命令的结果，或者是返回多个结果的已存储过程结果。如果使用 <b>Command </b>的 <a href="mdmthcmdexecute.htm">Execute</a> 方法或者 <b>Recordset </b>的 <a href="mdmthrstopen.htm">Open</a> 方法打开基于复合命令语句（例如“SELECT * FROM table1;SELECT * FROM table2”）的 <b>Recordset </b>对象，则 ADO 仅执行第一条命令并将结果返回到“记录集”。要访问语句中后续命令的结果，请调用 <b>NextRecordset </b>方法。</p>
<p>
只要有其他的结果，并且包含复合语句的 <b>Recordset</b> 未被跨进程边界调度，则 <b>NextRecordset </b>方法将继续返回 <b>Recordset </b>对象。如果行返回命令没有返回记录，则返回的 <b>Recordset </b>对象将为空；在确认 <a href="mdprobof.htm">BOF</a> 和 <a href="mdprobof.htm">EOF</a> 都为 <b>True </b>的情况下可验证这种情况。如果非按行返回命令成功执行，则返回的 Recordset 对象将关闭，通过测试 <b>Recordset</b> 的 <a href="mdprostate.htm">State</a> 属性可以测试这种情况。如果没有其他的结果，“记录集”将设置为 <i>Nothing</i>。</p>
<p>
<b><B>远程数据服务用法&nbsp;&nbsp;&nbsp;</B>NextRecordset</b> 方法对客户端的 <b>Recordset</b> 对象不可用。</p>
<p>
如果在立即更新模式下进行编辑，调用 <b>NextRecordset</b> 方法将产生错误。应首先调用 <a href="mdmthupdate.htm">Update</a> 或 <a href="mdmthcancelupdate.htm">CancelUpdate</a> 方法。</p>
<p>
如果需要通过填写 <a href="mdcolparameters.htm">Parameters</a> 集合或者通过使用原有的 <b>Open</b> 或 <b>Execute</b> 调用传送数组为复合语句中的多个命令传送参数，则参数在集合或数组中的次序必须与它们在命令序列中各自命令的次序相同。在读取输出参数值之前必须读取所有结果。</p>
<p>
在调用<b> NextRecordset</b> 方法时，ADO 仅执行语句中的下一条命令。如果在单步执行整个命令语句之前显式关闭 <b>Recordset</b> 对象，则 ADO 不执行其余的命令。</p>
</BODY>
</HTML>
