<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>步骤 3: 服务器获得 Recordset（RDS 教程）</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdhowstep3serverobtainsrecordset"></a>步骤 3: 服务器获得 Recordset（RDS 教程）</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowStep3ServerObtainsRecordset_C">
</object></p>
<p>
<b>您所在的步骤... </b>
<ul type=disc>
<li>
指定在服务器上调用的程序，并获得代理。<br><br></li>
<li>
调用服务器程序，将参数传递给标识数据源和所发命令的服务器程序。 <br><br></li>
<li>
<b>典型情况下通过使用 ADO，服务器程序从数据源获得 Recordset 对象。</b><br><br></li>
<li>
服务器程序将最终的<b> Recordset </b>对象返回客户端应用程序。<br><br></li>
<li>
在客户端，可选择将<b> Recordset</b> 对象设置为可视控件易于使用的形式。<br><br></li>
<li>
将对 <b>Recordset</b> 对象的更改返回服务器，并用来更新数据源。</li>
</ul>
<p>
<b>讨论</b></p>
<p class=label>
</p>
<p>
服务器程序使用连接字符串和命令文本在数据源查询所需的行。尽管也可以使用其他 Microsoft 数据访问接口如 OLE DB 等，但一般使用 ADO 检索该<b> Recordset</b>。有关执行查询操作的详细信息，请参阅 <a href="mdhowadotutorial.htm">ADO 教程</a>。</p>
<p>
自定义服务器程序可参照如下：</p>
<pre>Public Function ServerProgram(conn as String, qry as String) as Object
Dim rs as New ADODB.Recordset
rs.CursorLocation = adUseClient
rs.Open cn, qry, adOpenUnspecified, adLockUnspecified, _
  adCmdUnspecified
Set ServerProgram = rs
End Function
</pre>
<p>
<B><b>下一页</b></B>&nbsp;&nbsp;&nbsp;<a href="mdhowstep4serverreturnsrecordset.htm">步骤4</a></p>
</BODY>
</HTML>
