<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Refresh 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthadorefresh"></a>Refresh 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthADORefresh_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthADORefresh_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthADORefresh_A">
</object></p>
<p>
更新集合中的对象以便反映来自提供者的可用对象和特定于提供者的对象。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>collection</i>.<b>Refresh</b></p>
<p class=label>
<b>说明</b></p>
<p>
<b>Refresh</b> 方法根据从中调用的不同集合而完成不同的任务。</p>
<p class=label>
<b>参数</b></p>
<p>
使用 <a href="mdobjcommand.htm">Command</a> 对象的<b> Parameters</b> 集合上的<b> Refresh</b> 方法可为在<b> Command</b> 对象中指定的存储过程或者参数化查询检索提供者端参数信息。对于不支持存储过程调用或参数化查询的提供者来说，集合将为空。</p>
<p>
在调用<b> Refresh</b> 方法之前应该将<b> Command</b> 对象的 <a href="mdproactivecon.htm">ActiveConnection</a> 属性设置为有效 <a href="mdobjconnection.htm">Connection</a> 对象，将 <a href="mdprocommandtext.htm">CommandText</a> 属性设置为有效命令，并且将 <a href="mdprocommandtype.htm">CommandType</a> 属性设置为 <b>adCmdStoredProc</b>。</p>
<p>
如果在调用<b> Refresh</b> 方法之前访问<b> Parameters</b> 集合，ADO 将自动调用方法并填充集合。</p>
<p class=indent>
<B><b>注意&nbsp;&nbsp;&nbsp;</b></B>如果使用 <b>Refresh </b>方法从提供者获取参数信息而它返回一个或多个变长数据类型 <a href="mdobjparameter.htm">Parameter</a> 对象，则 ADO 可能根据其大小的最大可能值为参数分配内存，这在执行期间将会导致错误。在调用 <a href="mdmthcmdexecute.htm">Execute</a> 方法之前应显式设置这些参数的 <a href="mdprosize.htm">Size</a> 属性以防止错误发生。</p>
<p class=label>
<b>Fields</b></p>
<p>
在<b> Fields</b> 集合上使用 <b>Refresh</b> 方法没有可见的效果。要从基本数据库结构中对更改进行检索，必须使用 <a href="mdmthadorequery.htm">Requery</a> 方法；如果 <b>Recordset</b> 对象不支持书签，则使用 <a href="mdmthmovefirst.htm">MoveFirst</a> 方法。</p>
<p class=label>
<b>Properties</b></p>
<p>
在某些对象的<b> Properties</b> 集合上使用<b> Refresh</b> 方法可使用提供者提供的动态属性填写集合，这些属性只将功能性信息提供给 ADO 支持的内置属性之外的提供者。</p>
</BODY>
</HTML>
