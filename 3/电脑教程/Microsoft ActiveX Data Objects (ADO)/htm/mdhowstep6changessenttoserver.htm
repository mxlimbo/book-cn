<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>步骤 6: 将更改返回服务器（RDS 教程）</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdhowstep6changessenttoserver"></a>步骤 6: 将更改返回服务器（RDS 教程）</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowStep6ChangesSentToServer_C">
</object></p>
<p class=label>
<b>您所在的步骤...</b>
<ul type=disc>
<li>
指定在服务器上调用的程序，并获得代理。<br><br></li>
<li>
调用服务器程序，将参数传递给表明数据源和所发命令的服务器程序。<br><br></li>
<li>
较为典型的是通过使用 ADO，服务器程序从数据源获得 <b>Recordset</b> 对象。<br><br></li>
<li>
服务器程序将最终的<b> Recordset</b> 对象返回客户端应用程序。<br><br></li>
<li>
在客户端，可选择将 <b>Recordset</b> 对象置为易于可视控件使用的形式。<br><br></li>
<li>
<b>将对 Recordset 对象的更改返回服务器并用来更新数据源。</b></li>
</ul>
<p>
<b>讨论</b></p>
<p>
如果对 <b>Recordset</b> 对象进行编辑，任何更改（即对行的增加、修改或删除）都可以返回服务器。</p>
<p class=indent>
<b>注意</b>&nbsp;&nbsp;&nbsp;TRDS 的默认行为可通过 ADO 对象和 Microsoft OLE DB Remoting Provider 隐式调用。查询可返回记录集，而被编辑的记录集则可更新数据源。本教程不通过 ADO 对象调用 RDS，但在这里给出它的形式。</p>
<pre>Dim rs as New ADODB.Recordset
rs.<span class=cfe><b>Open</b></span> "SELECT * FROM authors", "<span class=cfe><b>Provider</b></span>=MS Remote;<span class=cfe><b>Data Source</b></span>=pubs;<span class=cfe><b>Remote Server</b></span>=http://YourServer"
...            '编辑记录集
rs.<span class=cfe><b>UpdateBatch</b></span>    '等值于 <span class=cfe><b>SubmitChanges</b></span>
...</pre>
<p>
<b>A 部分</b>&nbsp;&nbsp;&nbsp;假设在这里只使用了 <b>RDS.DataControl</b> 并且 <b>Recordset </b>对象现在已与 <b>RDS.DataControl</b> 关联。如果 <a href="mdproserverprop.htm">Server</a> and <a href="mdproconnectprop.htm">Connect</a> 属性已设置，<b>SubmitChanges</b> 方法将把对<b> Recordset </b>对象的任何改动更新到数据源。</p>
<pre>Sub RDSTutorial6A()
Dim DC as New RDS.DataControl
Dim RS as New ADODB.Recordset   '可选择 ADOR.Recordset
DC.<span class=cfe><b>Server</b></span> = "http://yourServer"
DC.<span class=cfe><b>Connect</b></span> = "DSN=pubs"
DC.<span class=cfe><b>SQL</b></span> = "SELECT * FROM authors"
DC.<span class=cfe><b>Refresh</b></span>
...
Set RS = DC.<span class=cfe><b>Recordset</b></span>
...                           '编辑 Recordset
...
DC.<span class=cfe><b>SubmitChanges</b></span>
...
</pre>
<p>
<b>B 部分</b>&nbsp;&nbsp;&nbsp;另外，您也可以通过指定连接和 <b>Recordset</b> 对象，使用 <b>RDSServer.DataFactory </b>对象更新服务器。</p>
<pre>Sub RDSTutorial6B()
Dim DS as New RDS.DataSpace
Dim RS as New ADODB.Recordset   '可选择 ADOR.Recordset
Dim DC as New RDS.DataControl
Dim DF as Object
Set DF = DS.<span class=cfe><b>CreateObject</b></span>("RDSServer.DataFactory", "http://yourServer")
Set RS = DF.<span class=cfe><b>Query</b></span> ("DSN=pubs", "SELECT * FROM authors")
DC.<span class=cfe><b>SourceRecordset</b></span> = RS         '可视控件现在可绑定到 DC.
...                           '编辑 Recordset
blnStatus = DF.<span class=cfe><b>SubmitChanges </b></span>"DSN=pubs", RS
</pre>
<p>
<b>本教程到此结束。</b></p>
</BODY>
</HTML>
