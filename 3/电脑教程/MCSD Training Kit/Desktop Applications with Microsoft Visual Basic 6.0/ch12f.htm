<HTML>
<HEAD>
<TITLE>Lab: Using Help Files and the Package and Deployment Wizard</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12e.htm", "ch12g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="658"><H1>Lab: Using Help Files and the Package and Deployment Wizard</H1></A>

<P>In this lab, you will implement such help features as context-sensitive help, ToolTips, and What's This Help? You will also compile the Chateau St. Mark hotel application and use the Package and Deployment Wizard to create setup files. You can continue to work with the files you created in Lab 11, or you can use the files provided for you in the \Labs\Lab12\Partial folder. The solution code can be found in the \Labs\Lab12\Solution folder. </P>

<P>
<img src="images/video.gif" width=78 height=54 border="0">
</P>

<P>To see a demonstration of the solution, run the Lab12.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>


<A NAME="659"><H3>Estimated lesson time: 60 minutes</H3></A>


<A NAME="660"><H2>Exercise 1: Applying Help Files </H2></A>

<P>In this exercise you will add help features to the Chateau St. Mark hotel reservation system. These help features include context-sensitive help, ToolTips, and What's This Help?</P>

<P><LI><B>To open the hotel reservation application project</B></LI></P>
<UL>
<p><li>Open the Chateau St. Mark hotel reservation system project.</li></p>
</UL>
<P><LI><B>To add context-sensitive help</B></LI></P>

<OL>
<P><LI>In the Project's Properties, set the Help File Name property to \Labs\Lab12<B>\</B>Helpfile.hlp.</LI></P>

<P><LI>The following table contains the entire list of context IDs for the help file you added to the Reservation project. Do not set all of the following HelpContextIDs on <B>frmReservation</B>. Set only the HelpContextIDs for the user-input controls (TextBoxes, OptionButtons, CommandButtons, and MaskEdBox). Not all of the controls have been given a context ID. For example, <B>txtFirstName</B>'s HelpContextID property would be set to <B>21</B>.</LI></P>

<P><TABLE CELLPADDING="5" WIDTH="95%">
<TR>
<TH>Topic
</TH>
<TH>HelpContextID
</TH></TR>
<TR>
<TD VALIGN="TOP">About the Buttons
</TD>
<TD VALIGN="TOP">2
</TD></TR>
<TR>
<TD VALIGN="TOP">About the guest Menu
</TD>
<TD VALIGN="TOP">7
</TD></TR>
<TR>
<TD VALIGN="TOP">About the Status bar
</TD>
<TD VALIGN="TOP">4
</TD></TR>
<TR>
<TD VALIGN="TOP">About the Text Entries
</TD>
<TD VALIGN="TOP">3
</TD></TR>
<TR>
<TD VALIGN="TOP">Add Reservation
</TD>
<TD VALIGN="TOP">20
</TD></TR>
<TR>
<TD VALIGN="TOP">Address
</TD>
<TD VALIGN="TOP">23
</TD></TR>
<TR>
<TD VALIGN="TOP">Cancel Reservation
</TD>
<TD VALIGN="TOP">18
</TD></TR>
<TR>
<TD VALIGN="TOP">Cash
</TD>
<TD VALIGN="TOP">14
</TD></TR>
<TR>
<TD VALIGN="TOP">Check
</TD>
<TD VALIGN="TOP">13
</TD></TR>
<TR>
<TD VALIGN="TOP">Check-In
</TD>
<TD VALIGN="TOP">16
</TD></TR>
<TR>
<TD VALIGN="TOP">Check-in Date
</TD>
<TD VALIGN="TOP">26
</TD></TR>
<TR>
<TD VALIGN="TOP">Check-out Date
</TD>
<TD VALIGN="TOP">28
</TD></TR>
<TR>
<TD VALIGN="TOP">Credit Card
</TD>
<TD VALIGN="TOP">12
</TD></TR>
<TR>
<TD VALIGN="TOP">Done Button
</TD>
<TD VALIGN="TOP">10
</TD></TR>
<TR>
<TD VALIGN="TOP">First Name
</TD>
<TD VALIGN="TOP">21
</TD></TR>
<TR>
<TD VALIGN="TOP">Guest Menu
</TD>
<TD VALIGN="TOP">11
</TD></TR>
<TR>
<TD VALIGN="TOP">Last Name
</TD>
<TD VALIGN="TOP">22
</TD></TR>
<TR>
<TD VALIGN="TOP">Number of Days
</TD>
<TD VALIGN="TOP">27
</TD></TR>
<TR>
<TD VALIGN="TOP">Number of People
</TD>
<TD VALIGN="TOP">25
</TD></TR>
<TR>
<TD VALIGN="TOP">Payment Type
</TD>
<TD VALIGN="TOP">9
</TD></TR>
<TR>
<TD VALIGN="TOP">Phone
</TD>
<TD VALIGN="TOP">24
</TD></TR>
<TR>
<TD VALIGN="TOP">Rate
</TD>
<TD VALIGN="TOP">30
</TD></TR>
<TR>
<TD VALIGN="TOP">Room Number
</TD>
<TD VALIGN="TOP">29
</TD></TR></TABLE></P>

<P><LI>Save and run the application.</LI></P>
</OL>

<P><LI><B>To test the context-sensitive help</B></LI></P>

<OL>
<P><LI>Run the application.</LI></P>

<P><LI>On the <B>Guest</B> menu, select <B>Reservation</B>, then click <B>Add</B>.</LI></P>

<P><LI>Click in the <B>First Name</B> text box, then press <B>F1</B> to open the context-sensitive help.</LI></P>

<P>The <B>Help</B> dialog box that describes the text box appears.</P>
<P><LI>Close the application.</LI></P>
</OL>
<P><LI><B>To create a ToolTip in Visual Basic</B></LI></P>

<OL>
<P><LI>In the <B>frmReservation_Load </B>event, type the following code:</LI></P>
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
 txtFirstName.ToolTipText = &quot;Enter the guest's first name.&quot;
 txtLastName.ToolTipText = &quot;Enter the guest's last name.&quot;
 </PRE></TD></TR></TABLE></P>

  <P>Add any additional ToolTips to the load event or the control's ToolTip properties that you want displayed.</P>

<P><LI>Run the application.</LI></P>

<P><LI>From the <B>Guest</B> menu, select <B>Reservation</B>, then click <B>Add</B>.</LI></P>

<P><LI>Position your mouse pointer over <B>txtFirstName</B> on the<B> frmReservation</B> form.</LI></P>

<P>A ToolTip displays a message describing the functionality of the textbox.</P>
<P><LI>Close the application.</LI></P>
</OL>

<A NAME="661"><H2>Exercise 2: Setting Compile Options in your Application</H2></A>

<P>In this exercise you will create an executable file for the Chateau St. Mark hotel reservation system application.</P>

<P><LI><B>To set compile properties</B></LI></P>

<OL>
<P><LI>On the <B>Project</B> menu, click <B>HotelReservation</B> <B>Properties</B>.</LI></P>

<P>The <B>Project Properties</B> dialog box appears.</P>
<P><LI>Click the <B>Compile</B> tab.</LI></P>

<P><LI>Click <B>Compile to Native Code</B>.</LI></P>

<P><LI>Click <B>Ok</B>.</LI></P>
</OL>

<P><LI><B>To add final touches to the application</B></LI></P>

<OL>
<P><LI>On the <B>Project</B> menu, click <B>Components</B>, and remove all unused controls from the project.</LI></P>
</OL>

<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>
Visual Basic will not allow you to remove a control or reference that is being used by the project.
</BLOCKQUOTE></DIV></P>
<OL>
<P><LI VALUE="2">On the <B>Project</B> menu, click <B>References</B>, and remove all unused references from the project.</LI></P>

<P><LI>Define the application title and create an executable file.</LI></P>

<P> The application title is the default text displayed in the title bar of message boxes and input boxes when a specific string is not supplied.</P>
<OL TYPE="a">
<P><li>On the <B>File</B> menu, click <B>Make HotelRes.exe</B>.</li></P>

  <P><LI> Click <B>Options</B> and set the Application Title to <B>Chateau St. Mark</B>.</LI></P>

  <P><LI>Click <B>OK</B> to create the .exe file.</LI></P>
</OL>

<P><LI>Save your project and exit Visual Basic.</LI></P>

<P><LI>Test your compiled application by running the .exe file.</LI></P>
</OL>

<A NAME="662"><H2>Exercise 3: Using the Package and Deployment Wizard</H2></A>

<P>In this exercise, you will use the Package and Deployment Wizard to create a setup program for distributing your application.</P>

<P><LI><B>To create a setup application</B></LI></P>

<OL>
<P><LI>On the <B>Start</B> menu, click <B>Microsoft Visual Basic 6.0</B>, then click <B>Microsoft Visual Basic 6.0 Tools</B>, and then click <B>Package &amp; Deployment Wizard</B>.</LI></P>

<P><LI>In the <B>Package &amp; Deployment Wizard</B>, click <B>Browse</B>, open the Hotel Reservation project provided in the \Labs\Lab12 folder, then click <B>Package</B>.</LI></P>

<P> Because you saved the project files after compiling the executable, the Package &amp; Deployment Wizard detects a difference and prompts you to recompile. Click <B>No </B>to use the executable you created in the previous procedure.</P>
</OL>
<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>
If you have previously run the Package &amp; Deployment Wizard, the Packaging Script screen appears. This screen lists previously saved scripts for the current project and (None) if you do not want to use an existing script. The default is the last script that was run for the current project.
</BLOCKQUOTE></DIV></P>
<OL>
<P><LI VALUE="3">On the <B>Package Type</B> screen, select <B>Standard Setup Package</B> as the Package Type, then click <B>Next</B>.</LI></P>

<P><LI>On the <B>Package Folder</B> screen, select the \Labs\Lab12\Setup folder for the location of the distribution files, then click <B>Next</B>.</LI></P>

<P><LI>On the <B>Included Files</B> screen, browse through the list of included files, then click <B>Add</B>. </LI></P>

<P><LI>Locate the file Readme.txt in the \Labs\Lab12 folder, click <B>Open</B>, then click <B>Next</B>.</LI></P>
</OL>
<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>
If there are any files that Visual Basic did not include, use the Find utility on the Start menu to locate the files. There should only be one control dependency, Mscomctl.ocx. If there are any other file dependencies, clear their check boxes.
</BLOCKQUOTE></DIV></P>
<OL>
<P><LI VALUE="7">On the <B>Cab Options</B> screen, select <B>Single Cab</B> from the <B>Cab</B> options, then click <B>Next</B>.</LI></P>

<P><LI>On the <B>Installation Title</B> screen, leave the default title, then click <B>Next</B>.</LI></P>

<P><LI>On the <B>Start Menu Items</B> screen, note the default menu location, then click <B>Next</B>.</LI></P>

<P><LI>On the <B>Install Locations</B> screen, notice that you can modify the install location for each of the files listed. Without making changes, click <B>Next</B>.</LI></P>

<P><LI>On the <B>Shared Files</B> screen, click <B>Next</B>.</LI></P>

<P><LI>In the <B>Finished!</B> dialog box, name the script <B>Lab 12 Setup Package 1</B>, then click <B>Finish</B>.</LI></P>

<P><LI>The Setup Wizard creates the setup program for your application. Click <B>Close</B> in the <B>Report</B> dialog box.</LI></P>

<P><LI>When the Package &amp; Deployment Wizard is finished, click <B>Close</B>.</LI></P>
</OL>

<P><LI><B>To run the setup program</B></LI></P>

<OL>
<P><LI>Start Windows Explorer.</LI></P>

<P><LI>Open the setup folder (\Labs\Lab12\Setup).</LI></P>

<P><LI>Run the <B>Setup.exe</B> program by double-clicking it.</LI></P>
</OL>


<P><LI><B>To run your application</B></LI></P>
<UL>
<p><li>After setup is complete, run your application from the Programs group on the <B>Start</B> menu.</li></p>
</UL>
<P><LI><B>To uninstall your application</B></LI></P>

<OL>
<P><LI>On the <B>Start</B> menu, point to <B>Settings</B>, then click <B>Control Panel</B>.</LI></P>

<P><LI>Run the <B>Add/Remove Programs</B> application, then click the <B>Install/Uninstall</B> tab.</LI></P>

<P><LI>Select the application you installed in the previous exercise, then click <B>Add/Remove</B>.</LI></P>

<P><LI>If prompted to remove shared files, choose not to remove them.</LI></P>
</OL>
<P><LI><B>To run your application</B></LI></P>

<OL>
<P><LI>Check the Programs group on the <B>Start</B> menu. Has your application been removed?</LI></P>

<P><LI>Look for the folder that was created by the Setup program. Has it been removed?</LI></P>
</OL>

</BODY>
</HTML>





