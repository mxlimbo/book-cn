<HTML>
<HEAD>
<TITLE>Lab: Creating ActiveX Documents</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch11e.htm", "ch11g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="618"><H1>Lab: Creating ActiveX Documents</H1></A>

<P>In this lab, you will convert the existing forms in the hotel reservation project into ActiveX Documents. You will then run the application from Internet Explorer. You can continue to work with the files you created in Lab 10, or you can use the files provided for you in the \Labs\Lab11\Partial folder. The solution code can be found in the \Labs\Lab11\Solution folder.</P>

<p>
<img src="images/video.gif" width=78 height=54 border="0">
</p>

<P>To see a demonstration of the solution, run the Lab11.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>

<b>Estimated lesson time: 20 minutes</b>


<A NAME="619"><H2>Exercise 1: Converting Forms to ActiveX Documents</H2></A>

<P>In this exercise, you will use the ActiveX Document Migration Wizard to convert forms in your application to ActiveX Documents.</P>

<P><LI><B>To open the hotel reservation application project</B></LI></P>

<ul><p><li>Open either the reservation application project that you have been working on or the <B>Hotelres.vbp</B> project located in the \Labs\Lab11\Partial folder.</li></p></ul>

<P><LI><B>To convert forms to ActiveX documents</B></LI></P>

<OL>
<P><LI>Load the <B>VB 6 ActiveX Doc Migration Wizard</B> item using the Add-In Manager.</LI></P>

<P><LI>On the <B>Add-Ins</B> menu, click <B>ActiveX Document Migration Wizard&#8230;</B> </LI></P>

<P>The <B>ActiveX Document Migration Wizard</B> opens.</P>
<P><LI>Click <B>frmReservation</B> in the <B>Form Selection</B> dialog box.</LI></P>

<P><LI>Click <B>Next</B>.</LI></P>

<P>The <B>Options</B> dialog box appears.</P>
<P><LI>Select the <B>Comment out invalid code?</B>, <B>Remove original forms after conversion?</B>, and <B>Convert to ActiveX EXE?</B> check boxes.</LI></P>

<P><LI>Click <B>Next</B>.</LI></P>

<P>The <B>Finished!</B> dialog box appears.</P>

<P><LI>Verify the request for a summary report is set to <B>Yes</B>.</li></P>

<P><LI>Click <B>Finish</B> to convert <B>frmReservation</B> into an ActiveX Document.</LI></P>

<P>A dialog box notifies you that comments have been added to flag invalid code for frmReservation, as illustrated in Figure 11.12.</P>

<P>
<A HREF="javascript:fullSize('F11xx12x.htm')"> <img src="images/F11xx12.JPG" width=404 height=99 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><B>Figure 11.12</B> <i>Notification of invalid code that was commented</i>  <!--/caption-->
</P>


<P><LI>Click <B>OK </B>to the Migration Wizard message box.</LI></P>

<P><LI>Review the summary report provided by Visual Basic and click <B>OK</B>.</LI></P>
</ol>

<P><LI><B>To test your ActiveX Document</B></LI></P>

<OL>
<P><LI>On the Visual Basic <B>Run</B> menu, click <B>Start</B>.</LI></P>

<P>A <B>Project Properties</B> dialog box appears allowing you to set debugging options.</P>
<P><LI>Click <B>OK</B> to accept the default debugging values.</LI></P>

<P>Your application opens in Internet Explorer, as illustrated in Figure 11.13.</P>

<P>
<A HREF="javascript:fullSize('F11xx13x.htm')"> <img src="images/F11xx13.JPG" width=404 height=326 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><B>Figure 11.13</B> <i>The Chateau St. Mark hotel reservation application in Internet Explorer</i>  <!--/caption-->
</P>


<P><LI>Navigate through the reservation records.</LI></P>

<P><LI>Close your application and save your project files.</LI></P>
</ol>

</BODY>
</HTML>





