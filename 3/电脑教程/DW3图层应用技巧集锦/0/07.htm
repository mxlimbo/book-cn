<html>
<head>
<title>DW3 图 层 应 用 技 巧 集 锦 （七）</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<link rel="stylesheet" href="all.css">
<script language="JavaScript">
<!--
function MM_timelinePlay(tmLnName, myID) { //v1.2
  //Copyright 1997 Macromedia, Inc. All rights reserved.
  var i,j,tmLn,props,keyFrm,sprite,numKeyFr,firstKeyFr,propNum,theObj,firstTime=false;
  if (document.MM_Time == null) MM_initTimelines(); //if *very* 1st time
  tmLn = document.MM_Time[tmLnName];
  if (myID == null) { myID = ++tmLn.ID; firstTime=true;}//if new call, incr ID
  if (myID == tmLn.ID) { //if Im newest
    setTimeout('MM_timelinePlay("'+tmLnName+'",'+myID+')',tmLn.delay);
    fNew = ++tmLn.curFrame;
    for (i=0; i<tmLn.length; i++) {
      sprite = tmLn[i];
      if (sprite.charAt(0) == 's') {
        if (sprite.obj) {
          numKeyFr = sprite.keyFrames.length; firstKeyFr = sprite.keyFrames[0];
          if (fNew >= firstKeyFr && fNew <= sprite.keyFrames[numKeyFr-1]) {//in range
            keyFrm=1;
            for (j=0; j<sprite.values.length; j++) {
              props = sprite.values[j]; 
              if (numKeyFr != props.length) {
                if (props.prop2 == null) sprite.obj[props.prop] = props[fNew-firstKeyFr];
                else        sprite.obj[props.prop2][props.prop] = props[fNew-firstKeyFr];
              } else {
                while (keyFrm<numKeyFr && fNew>=sprite.keyFrames[keyFrm]) keyFrm++;
                if (firstTime || fNew==sprite.keyFrames[keyFrm-1]) {
                  if (props.prop2 == null) sprite.obj[props.prop] = props[keyFrm-1];
                  else        sprite.obj[props.prop2][props.prop] = props[keyFrm-1];
        } } } } }
      } else if (sprite.charAt(0)=='b' && fNew == sprite.frame) eval(sprite.value);
      if (fNew > tmLn.lastFrame) tmLn.ID = 0;
  } }
}

function MM_timelineGoto(tmLnName, fNew, numGotos) { //v2.0
  //Copyright 1997 Macromedia, Inc. All rights reserved.
  var i,j,tmLn,props,keyFrm,sprite,numKeyFr,firstKeyFr,lastKeyFr,propNum,theObj;
  if (document.MM_Time == null) MM_initTimelines(); //if *very* 1st time
  tmLn = document.MM_Time[tmLnName];
  if (numGotos != null)
    if (tmLn.gotoCount == null) tmLn.gotoCount = 1;
    else if (tmLn.gotoCount++ >= numGotos) {tmLn.gotoCount=0; return}
  jmpFwd = (fNew > tmLn.curFrame);
  for (i = 0; i < tmLn.length; i++) {
    sprite = (jmpFwd)? tmLn[i] : tmLn[(tmLn.length-1)-i]; //count bkwds if jumping back
    if (sprite.charAt(0) == "s") {
      numKeyFr = sprite.keyFrames.length;
      firstKeyFr = sprite.keyFrames[0];
      lastKeyFr = sprite.keyFrames[numKeyFr - 1];
      if ((jmpFwd && fNew<firstKeyFr) || (!jmpFwd && lastKeyFr<fNew)) continue; //skip if untouchd
      for (keyFrm=1; keyFrm<numKeyFr && fNew>=sprite.keyFrames[keyFrm]; keyFrm++);
      for (j=0; j<sprite.values.length; j++) {
        props = sprite.values[j];
        if (numKeyFr == props.length) propNum = keyFrm-1 //keyframes only
        else propNum = Math.min(Math.max(0,fNew-firstKeyFr),props.length-1); //or keep in legal range
        if (sprite.obj != null) {
          if (props.prop2 == null) sprite.obj[props.prop] = props[propNum];
          else        sprite.obj[props.prop2][props.prop] = props[propNum];
      } }
    } else if (sprite.charAt(0)=='b' && fNew == sprite.frame) eval(sprite.value);
  }
  tmLn.curFrame = fNew;
  if (tmLn.ID == 0) eval('MM_timelinePlay(tmLnName)');
}

function MM_findObj(n, d) { //v3.0
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document); return x;
}

function MM_dragLayer(objName,x,hL,hT,hW,hH,toFront,dropBack,cU,cD,cL,cR,targL,targT,tol,dropJS,et,dragJS) { //v3.0
  //Copyright 1998 Macromedia, Inc. All rights reserved.
  var i,j,aLayer,retVal,curDrag=null,NS=(navigator.appName=='Netscape'), curLeft, curTop;
  if (!document.all && !document.layers) return false;
  retVal = true; if(!NS && event) event.returnValue = true;
  if (MM_dragLayer.arguments.length > 1) {
    curDrag = MM_findObj(objName); if (!curDrag) return false;
    if (!document.allLayers) { document.allLayers = new Array();
      with (document) if (NS) { for (i=0; i<layers.length; i++) allLayers[i]=layers[i];
        for (i=0; i<allLayers.length; i++) if (allLayers[i].document && allLayers[i].document.layers)
          with (allLayers[i].document) for (j=0; j<layers.length; j++) allLayers[allLayers.length]=layers[j];
      } else for (i=0;i<all.length;i++) if (all[i].style&&all[i].style.position) allLayers[allLayers.length]=all[i];}
    curDrag.MM_dragOk=true; curDrag.MM_targL=targL; curDrag.MM_targT=targT;
    curDrag.MM_tol=Math.pow(tol,2); curDrag.MM_hLeft=hL; curDrag.MM_hTop=hT;
    curDrag.MM_hWidth=hW; curDrag.MM_hHeight=hH; curDrag.MM_toFront=toFront;
    curDrag.MM_dropBack=dropBack; curDrag.MM_dropJS=dropJS;
    curDrag.MM_everyTime=et; curDrag.MM_dragJS=dragJS;
    curDrag.MM_oldZ = (NS)?curDrag.zIndex:curDrag.style.zIndex;
    curLeft= (NS)?curDrag.left:curDrag.style.pixelLeft; curDrag.MM_startL = curLeft;
    curTop = (NS)?curDrag.top:curDrag.style.pixelTop; curDrag.MM_startT = curTop;
    curDrag.MM_bL=(cL<0)?null:curLeft-cL; curDrag.MM_bT=(cU<0)?null:curTop -cU;
    curDrag.MM_bR=(cR<0)?null:curLeft+cR; curDrag.MM_bB=(cD<0)?null:curTop +cD;
    curDrag.MM_LEFTRIGHT=0; curDrag.MM_UPDOWN=0; curDrag.MM_SNAPPED=false; //use in your JS!
    document.onmousedown = MM_dragLayer; document.onmouseup = MM_dragLayer;
    if (NS) document.captureEvents(Event.MOUSEDOWN|Event.MOUSEUP);
  } else {
    var theEvent = ((NS)?objName.type:event.type);
    if (theEvent == 'mousedown') {
      var mouseX = (NS)?objName.pageX : event.clientX + document.body.scrollLeft;
      var mouseY = (NS)?objName.pageY : event.clientY + document.body.scrollTop;
      var maxDragZ=null; document.MM_maxZ = 0;
      for (i=0; i<document.allLayers.length; i++) { aLayer = document.allLayers[i];
        var aLayerZ = (NS)?aLayer.zIndex:aLayer.style.zIndex;
        if (aLayerZ > document.MM_maxZ) document.MM_maxZ = aLayerZ;
        var isVisible = (((NS)?aLayer.visibility:aLayer.style.visibility).indexOf('hid') == -1);
        if (aLayer.MM_dragOk != null && isVisible) with (aLayer) {
          var parentL=0; var parentT=0;
          if (!NS) { parentLayer = aLayer.parentElement;
            while (parentLayer != null && parentLayer.style.position) {
              parentL += parentLayer.offsetLeft; parentT += parentLayer.offsetTop;
              parentLayer = parentLayer.parentElement; } }
          var tmpX=mouseX-(((NS)?pageX:style.pixelLeft+parentL)+MM_hLeft);
          var tmpY=mouseY-(((NS)?pageY:style.pixelTop +parentT)+MM_hTop);
          var tmpW = MM_hWidth;  if (tmpW <= 0) tmpW += ((NS)?clip.width :offsetWidth);
          var tmpH = MM_hHeight; if (tmpH <= 0) tmpH += ((NS)?clip.height:offsetHeight);
          if ((0 <= tmpX && tmpX < tmpW && 0 <= tmpY && tmpY < tmpH) && (maxDragZ == null
              || maxDragZ <= aLayerZ)) { curDrag = aLayer; maxDragZ = aLayerZ; } } }
      if (curDrag) {
        document.onmousemove = MM_dragLayer; if (NS) document.captureEvents(Event.MOUSEMOVE);
        curLeft = (NS)?curDrag.left:curDrag.style.pixelLeft;
        curTop = (NS)?curDrag.top:curDrag.style.pixelTop;
        MM_oldX = mouseX - curLeft; MM_oldY = mouseY - curTop;
        document.MM_curDrag = curDrag;  curDrag.MM_SNAPPED=false;
        if(curDrag.MM_toFront) {
          eval('curDrag.'+((NS)?'':'style.')+'zIndex=document.MM_maxZ+1');
          if (!curDrag.MM_dropBack) document.MM_maxZ++; }
        retVal = false; if(!NS) event.returnValue = false;
    } } else if (theEvent == 'mousemove') {
      if (document.MM_curDrag) with (document.MM_curDrag) {
        var mouseX = (NS)?objName.pageX : event.clientX + document.body.scrollLeft;
        var mouseY = (NS)?objName.pageY : event.clientY + document.body.scrollTop;
        newLeft = mouseX-MM_oldX; newTop  = mouseY-MM_oldY;
        if (MM_bL!=null) newLeft = Math.max(newLeft,MM_bL);
        if (MM_bR!=null) newLeft = Math.min(newLeft,MM_bR);
        if (MM_bT!=null) newTop  = Math.max(newTop ,MM_bT);
        if (MM_bB!=null) newTop  = Math.min(newTop ,MM_bB);
        MM_LEFTRIGHT = newLeft-MM_startL; MM_UPDOWN = newTop-MM_startT;
        if (NS) {left = newLeft; top = newTop;}
        else {style.pixelLeft = newLeft; style.pixelTop = newTop;}
        if (MM_dragJS) eval(MM_dragJS);
        retVal = false; if(!NS) event.returnValue = false;
    } } else if (theEvent == 'mouseup') {
      document.onmousemove = null;
      if (NS) document.releaseEvents(Event.MOUSEMOVE);
      if (NS) document.captureEvents(Event.MOUSEDOWN); //for mac NS
      if (document.MM_curDrag) with (document.MM_curDrag) {
        if (typeof MM_targL =='number' && typeof MM_targT == 'number' &&
            (Math.pow(MM_targL-((NS)?left:style.pixelLeft),2)+
             Math.pow(MM_targT-((NS)?top:style.pixelTop),2))<=MM_tol) {
          if (NS) {left = MM_targL; top = MM_targT;}
          else {style.pixelLeft = MM_targL; style.pixelTop = MM_targT;}
          MM_SNAPPED = true; MM_LEFTRIGHT = MM_startL-MM_targL; MM_UPDOWN = MM_startT-MM_targT; }
        if (MM_everyTime || MM_SNAPPED) eval(MM_dropJS);
        if(MM_dropBack) {if (NS) zIndex = MM_oldZ; else style.zIndex = MM_oldZ;}
        retVal = false; if(!NS) event.returnValue = false; }
      document.MM_curDrag = null;
    }
    if (NS) document.routeEvent(objName);
  } return retVal;
}

function MM_initTimelines() {
    //MM_initTimelines() Copyright 1997 Macromedia, Inc. All rights reserved.
    var ns = navigator.appName == "Netscape";
    document.MM_Time = new Array(1);
    document.MM_Time[0] = new Array(3);
    document.MM_Time["Timeline1"] = document.MM_Time[0];
    document.MM_Time[0].MM_Name = "Timeline1";
    document.MM_Time[0].fps = 2;
    document.MM_Time[0][0] = new String("behavior");
    document.MM_Time[0][0].frame = 32;
    document.MM_Time[0][0].value = "MM_timelineGoto('Timeline1','1')";
    document.MM_Time[0][1] = new String("sprite");
    document.MM_Time[0][1].slot = 1;
    if (ns)
        document.MM_Time[0][1].obj = document["Layer1"] ? document["Layer1"].document["Layer2"].document["Layer3"] : document["Layer2"].document["Layer3"];
    else
        document.MM_Time[0][1].obj = document.all ? document.all["Layer3"] : null;
    document.MM_Time[0][1].keyFrames = new Array(1, 31);
    document.MM_Time[0][1].values = new Array(3);
    document.MM_Time[0][1].values[0] = new Array(14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14);
    document.MM_Time[0][1].values[0].prop = "left";
    document.MM_Time[0][1].values[1] = new Array(113,105,97,90,82,74,66,58,50,43,35,27,19,11,3,-5,-12,-20,-28,-36,-44,-52,-59,-67,-75,-83,-91,-99,-106,-114,-122);
    document.MM_Time[0][1].values[1].prop = "top";
    if (!ns) {
        document.MM_Time[0][1].values[0].prop2 = "style";
        document.MM_Time[0][1].values[1].prop2 = "style";
    }
    document.MM_Time[0][1].values[2] = new Array(120,119,118,117,116,115,114,113,112,111,110,109,108,107,106,105,104,103,102,101,100,99,98,97,96,95,94,93,92,91,90);
    document.MM_Time[0][1].values[2].prop = "height";
    if (!ns)
        document.MM_Time[0][1].values[2].prop2 = "style";
    document.MM_Time[0][2] = new String("behavior");
    document.MM_Time[0][2].frame = 1;
    document.MM_Time[0][2].value = "MM_dragLayer('Layer1','',0,0,0,0,true,false,-1,-1,-1,-1,false,false,0,'',false,'')";
    document.MM_Time[0].lastFrame = 32;
    for (i=0; i<document.MM_Time.length; i++) {
        document.MM_Time[i].ID = null;
        document.MM_Time[i].curFrame = 0;
        document.MM_Time[i].delay = 1000/document.MM_Time[i].fps;
    }
}
//-->
</script>
</head>

<body bgcolor="#FFFFFF" onLoad="MM_timelinePlay('Timeline1')"　background="bar.gif" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<table width="776" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td valign="top" width="73"><img src="up1.gif" width="73" height="45"><a href="content.htm"><img src="top.gif" width="73" height="18" border="0"></a><a href="06.htm"><img src="last.gif" width="73" height="28" border="0"></a><img src="next1.gif" width="73" height="22" border="0"></td>
    <td><img src="up2.gif" width="495" height="113"></td>
  </tr>
</table>
<table width="776" border="0" cellspacing="0" cellpadding="0" background="bg.gif">
  <tr valign="top" align="center"> 
    <td class="h"> 
      <p><b class="h">DW3 图 层 应 用 技 巧 集 锦 （七）</b> <br>
      </p>
      <table width="550" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td> 
            <p><font color="#8000ff"><b>十一.可以用鼠标拖动的滚动板</b></font><br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              　　前些天我转载了一篇有关DW做滚动板的文章，我按照他的步骤往下做的时候有点问题，于是我今天就在他文章的基础上写了这个例子，我讲的更详细一些，并辅助一些图片，让你更加容易搞定这个例子，今天我讲的是一个可以用鼠标到处拖动的滚动板。先看看下面的例子，用鼠标拖拖看拖不拖的动，拖不动要跟我说一声：）</p>
            <div id="Layer1" style="position:absolute; left:223px; top:380px; width:120px; height:210px; z-index:3"> 
              <div id="Layer2" style="position:absolute; width:228px; height:119px; z-index:1; left: 14px; top: 74px; clip: rect(0 220 110 0)"> 
                <div id="Layer3" style="position:absolute; width:209px; height:120px; z-index:1; left: 14px; top: 113px">◎本站第一期杂志已经发给网友了<br>
                  ◎本站在2000/8/1日加入蚁盟<br>
                  ◎本站的DW教程已达17个，DW插件近百个，还有20个DW模板 <br>
                  ◎由于我个人精力有限，若你有好的DW文章请邮给我，我不胜感激 <br>
                  ◎本站现在诚征友情链接不限访问量只要制作精良<br>
                  ◎你若愿意同本站合作“酷页-网页制作杂志”请来信联系 </div>
              </div>
              <img src="images/pic-37.GIF" width="260" height="191"> </div>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <p> &nbsp;&nbsp;&nbsp;&nbsp;这是本教程的最后一个例子，也可以说是压轴戏，我会讲得很详细，这个例子我花了一点时间想，为把它做好看一点，还加了一个图片背景。下面我就以这个例子的实现来讲步骤，你在具体操作时要会举一反三。<br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              1.你得先找一个背景图片，把这个图片放在一个图层中，此图层名为layer1，这图层就是滚动板的样式。<br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              2.在layer1中插入一个子层layer2。按住Ctrl键不放，点击Object对象浮动条中的<img src="images/pic-38.gif" width="22" height="22"> 
              ，在layer1中画个图层，大小如下图，这个图层就是用来控制播放文本区域大小的。<br>
              <br>
              <img src="images/pic-39.gif" width="200" height="169"> <br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              3.再在layer2中用同样的办法插入一个子图层layer3，这个图层的宽度一定要小于layer2的宽度，它的高度不限。现在为止已在layer1中插入2个子层。按F11调出layers浮动窗口，看看是不是与下图相同。<br>
              <br>
              <img src="images/pic-40.gif" width="282" height="169"><br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              4.在图层layer3中写入你想要发布的消息。按Ctrl+F3调出图层属性编辑器，clip项的L和T填0，R填228，B填119。先填上再来解释，Clip它控制着你滚动板的显示区域，L，T，R，B分别是left,top,right,bottom的缩写，R，B这两个参数你就填该层的宽与高，当然你也可以改，根据后来显示的效果。如下图：<br>
              <br>
              <img src="images/pic-41.gif" width="519" height="97"> <br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              5.现在该让图层layer3动起来了，怎样动？用Timeline来搞定，按Ctul+F9调出Timeline浮动面板。用鼠标拖layer3到时间轨道来。<br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              6.本例中图层是从下往上滚动，在第一帧处把图层layer3拖到layer2下端的边缘。再在最后一帧处，把图层拖到layer2的上端边缘，就这样做了两个关键帧，你可以拖动时间轴中的红色播放块，看图层layer3是不是运动的。<br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              7.由于系统默认的动画长度为30帧，播放速度是15帧每秒，这样的参数显然不适合滚动板，移动的太快了，在本例中，我把动画长度延长了，并把帧的播放速度该为2Fps，如下图。到现在为止滚动板已基本做完，有些参数你一定要耐心多设几遍，来达到最佳效果。<br>
              <br>
              <img src="images/pic-42.gif" width="415" height="170"> <br>
              &nbsp;&nbsp;&nbsp;&nbsp;<br>
              8.现在该让此图层可以用鼠标拖动，在第一帧Behaviors轨道处双击鼠标，会出现一个大家熟悉的Behaviors窗口，点击<img src="images/pic-33.gif" width="24" height="19"> 
              选Drag layer项即可。完工了，你可以按F12预览。</p>
            <p>　　本站的此教程已全部写完， 现已打包提供下载，如果你有什么更好的效果，请给我<a href="mailto:kupage@elong.com">来信</a>，让我学习学习。</p>
      </td>
        </tr>
      </table>
      <p>&nbsp;</p>
      <table width="540" cellspacing="0" cellpadding="0" border="0">
        <tr> 
          <td> 
            <table border=0 align=center>
              <tr> 
                <td width=101 height="21"> 
                  <div align="center"><a href='06.htm'>上一页 </a></div>
                </td>
                <td width=99 height="21"> 
                  <div align="center"><a href="content.htm">目　录</a></div>
                </td>
                <td width=100 height="21"> 
                  <div align="center"></div>
                </td>
              </tr>
            </table>
            <p align=center>□ 资料来源：<a href="http://www.163.com">www.163.com</a><br>
            
            <p align=center>本书由“<a href="http://www.eshunet.com/">E书时空</a>”免费制作； 
              <br>
              想要更多的免费电子图书，请光临 <br>
              <a href="http://www.eshunet.com/">http://www.eshunet.com/</a> 
            <p align=center>&nbsp; 
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
</body>
</html>
