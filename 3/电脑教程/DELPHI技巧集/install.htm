<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>如何制作Delphi程序安装盘</title>
</head>

<body>

<table>
  <tr>
    <td vAlign="top"><font color="#0000ff"><h2 align="center">Delphi 的 分 发 工 具 ─ 
    ─InstallShield </font></h2>
    <h3 align="center">深 圳 特 发 黎 明 光 电 集 团 <font color="#ffffff">-- </font>吴 
    怡 敏 </h3>
    <hr align="center">
    <p><font color="#ffffff">----</font> Delphi 是 颇 受 程 序 员 欢 迎 的 软 件 
    开 发 工 具。 如 果 您 用Delphi 编 写 了 一 个 软 件， 并 且 想 对 
    外 发 行， 那 您 就 需 要 一 个 安 装 程 序。 安 装 程 序 并 不 只 
    是 把 软 件 拷 贝 到 硬 盘 上 这 么 简 单， 它 还 必 须 提 供 友 好 
    的 界 面、 多 样 的 安 装 选 择（ 如 目 标 路 径、 安 装 选 件 
    等）， 显 示 必 要 的 文 字 或 图 像 信 息。 在Windows NT 或Windows 95 
    环 境 下， 您 还 得 考 虑 到 卸 载 的 问 题， 即 当 用 户 觉 得 不 
    再 需 要 时， 他 能 简 单 便 捷 地 把 该 软 件 从 硬 盘 上 彻 底 清 
    除 掉。 </p>
    <p><font color="#ffffff">----</font> 如 果 您 要 分 发 的 软 件 是 数 据 库 
    应 用 程 序， 那 么 情 况 将 更 复 杂。 因 为Delphi 是 通 过 其 数 
    据 库 引 擎BDE 与 数 据 库 打 交 道 的， 在 分 发 时， 您 还 得 考 
    虑 哪 些 链 接 文 件 是 必 需 的， 并 作 适 当 的 配 置。 可 想 而 
    知， 编 写 一 个 安 装 程 序 并 不 是 一 件 轻 松 的 事 情， 而InstallShield 
    的 出 现 为 程 序 员 解 决 了 以 上 烦 恼。InstallShield 是 一 种 开 
    发 安 装 程 序 的 软 件， 已 为 大 多 数 软 件 公 司 所 接 受。 与InstallShield 
    专 业 版 相 比， 其Delphi 版 功 能 稍 弱， 但 却 更 简 单 易 用。 它 
    完 全 是 可 视 化 的， 开 发 一 个 安 装 程 序， 您 需 要 做 的 仅 
    是 回 答 一 些 问 题、 填 写 一 些 数 据， 剩 下 的 事 情 都 由InstallShield 
    完 成。 <font color="#ff0000"></p>
    <h3>使 用InstallShield 前 的 准 备 工 作 </font><font color="#ffffff">----</font> 
    在 使 用InstallShield 前， 应 该 对 产 品 的 形 象 进 行 充 分 的 构 
    思， 撰 写 必 要 的 文 档 并 设 计 图 案、 图 像 等。 这 包 括 版 
    权 说 明、 帮 助 文 件、Readme 文 件、 公 司 商 标、 安 装 界 面 的 
    背 景、 应 用 程 序 图 标 等 等。 随 后 以 相 应 的 格 式 保 存 这 
    些 文 件， 如.txt、.hlp、.bmp、.ico 等。 </h3>
    <p><font color="#ffffff">----</font> 另 外， 组 织 好 将 要 安 装 拷 贝 的 
    文 件。 把 同 类 型 的 文 件 安 排 在 同 一 个 子 目 录 下， 这 些 
    在 同 一 子 目 录 下 的 文 件 称 为 群(Group)， 您 可 以 把 一 些 意 
    义 相 近 或 相 关 的 群 组 成 组 件(Component)， 组 件 构 成 了 安 装 
    类 型(Setup Type)。 通 常 情 况 下， 用 户 在 安 装 软 件 时 应 有 三 
    种 选 择， 即 典 型 安 装、 最 小 安 装 和 用 户 自 定 义 安 装。 
    典 型 安 装 包 括 了 所 有 的 组 件， 最 小 安 装 只 包 含 那 些 能 
    使 系 统 运 行 的 必 要 组 件， 自 定 义 安 装 则 由 用 户 来 挑 选 
    应 安 装 的 组 件。 <font color="#ff0000"></p>
    <h3>制 作 过 程 </font><font color="#ffffff">----</font> 在Windows 95 下 运 行InstallShield， 
    选 取 菜 单“File” 下 的“New”， 创 建 一 个 新 项 目。 在 弹 出 
    的 对 话 框 中 输 入 项 目 名、 所 在 目 录， 如 果 您 想 提 供 多 
    种 安 装 类 型， 请 在“Include a custom setup type” 选 择 框 中 打 上 
    标 记， 单 击“Create” 后 即 可 进 入 编 辑 状 态 了。 这 里 顺 序 
    列 出 了 九 个 制 作 步 骤， 相 当 于 在 这 九 个 栏 目 中 填 写 必 
    要 的 参 数。 以 下 就 其 中 一 些 主 要 的 步 骤 作 一 个 简 单 的 
    说 明。 </h3>
    <p><font color="#ffffff">----</font> 1. 设 置 界 面(Set the Visual Design) </p>
    <p><font color="#ffffff">----</font> 这 里 可 以 设 置 三 类 参 数： <ul
    type="square">
      <li>安 装 程 序 名( 缺 省 为 项 目 名)、 版 本 号、 公 司 名 称 和 安 
        装 时 的 缺 省 路 径 等。InstallShield 使 用 的 路 径 有 两 类， 一 类 
        是 实 际 路 径， 如“C:\PROGRAM”， 另 一 类 是 指 定 路 径。 指 定 
        路 径 根 据 安 装 的 实 际 环 境 代 表 相 应 的 路 径， 如<WINDIR> 代 表Windows 
        所 在 的 路 径。 <br>
      </li>
      <li>安 装 程 序 运 行 时 的 背 景 标 题( 可 以 是 文 字 也 可 以 是 图 
        像)、 公 司 标 记 和 背 景 颜 色 等。 <br>
      </li>
      <li>是 否 包 含 卸 载 程 序， 若 选 择“ 是”( 缺 省)， 则InstallShield 
        会 自 动 把 卸 装 程 序UnInstallShield 加 入 到 安 装 程 序 中， 若 无 
        特 殊 原 因， 请 接 受 系 统 的 建 议。 </li>
    </ul>
    <p><font color="#ffffff">----</font> 2. 为 驱 动Delphi 数 据 库 应 用 挑 选 必 
    要 的 对 象(Select InstallShield Objects for Delphi) </p>
    <p><font color="#ffffff">----</font> 正 如 上 面 提 到 的，Delphi 应 用 程 序 
    通 过BDE 与 数 据 库 打 交 道。 因 此 如 果 您 的 程 序 涉 及 到 数 
    据 库， 请 在 安 装 程 序 中 包 含BDE。 在 这 里，InstallShield 会 提 
    示 您 输 入 一 些 必 要 的BDE 参 数， 包 括 数 据 库 别 名、 数 据 
    库 类 型(DBASE、PARADOX、ORACLE 等) 以 及 安 装 后 数 据 库 所 在 的 路 
    径 等 等。 </p>
    <p><font color="#ffffff">----</font> 3. 安 排 群、 组 件、 安 装 类 型(Specify 
    Components and Files) </p>
    <p><font color="#ffffff">----</font> 您 可 以 建 立 多 个 群， 并 通 过Windows 
    的 资 源 管 理 器 为 群 指 定 其 包 含 的 文 件， 为 每 个 群 安 排 
    一 个 安 装 目 录。 若 干 个 相 关 的 群 构 成 组 件， 你 可 以 为 
    每 种 安 装 类 型 指 定 相 应 的 组 件。 </p>
    <p><font color="#ffffff">----</font> 此 外， 还 可 以 为 安 装 程 序 制 作 
    一 些 必 要 的 信 息( 如 欢 迎 信 息、 版 权 声 明、 告 示 栏 等)； 
    指 定 应 用 程 序 的 图 标 并 决 定 包 含 这 些 图 标 的 文 件 夹； 
    确 认 安 装 结 束 后 立 即 启 动 主 程 序 或 是 显 示 一 个Readme 文 
    件； 为 您 的 软 件 设 定 一 些 关 键 字。Windows 95 和Windows NT 已 经 
    屏 弃 了 由 应 用 软 件 修 改Win.ini 的 旧 方 式， 取 而 代 之 的 是 
    更 为 合 理 的 登 记 系 统 ― ― 一 个 被 称 为“Registry” 的 数 据 
    库， 应 在 该 数 据 库 中 为 新 装 载 的 软 件 建 立 必 要 的 关 键 
    字。 当 然， 如 果 您 对 该 登 记 系 统 了 解 不 深， 也 不 必 过 
    分 担 心，InstallShield 会 自 动 为 您 设 定 一 些 必 要 的 关 键 字。 
    </p>
    <p><font color="#ffffff">----</font> 单 击“Disk Builder ”， 选 取 分 发 软 件 
    的 介 质( 软 盘 或CD)， 再 单 击“Build”，InstallShield 马 上 为 您 生 
    成 一 个 描 述 程 序 ― ―InstallShield 编 译 器 所 能 接 受 的 语 
    言。 再 单 击“Copy to Floppy” 即 可 生 成 最 终 的 安 装 盘。 在 此 
    之 前， 您 可 以 单 击“Test Run” 来 测 试 安 装 效 果， 如 不 满 
    意， 可 回 过 头 来 对 项 目 作 一 番 修 改。 </p>
    <p><font color="#ffffff">----</font> 从 以 上 可 看 出， 一 个 标 准 的 安 
    装 程 序 在 弹 指 间 即 告 完 成。InstallShield3 的Delphi 版 与Delphi 3.0 
    的Client/Server 版 捆 绑 在 一 起， 当 然， 它 也 是 一 个 独 立 的 程 
    序。 值 得 一 提 的 是， 您 要 分 发 的 应 用 软 件 也 不 必 非 得 
    是 用Delphi 开 发 的， 只 要 您 的 程 序 不 涉 及 数 据 库 部 分 即 
    可。 </p>
    <hr>
    <p><small><em>中国计算机世界出版服务公司版权所有</em></small> </td>
  </tr>
</table>
</body>
</html>
