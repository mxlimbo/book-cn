<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>Win95/98下监控运行的其他程序</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<p>[本文摘自BBS, 不能保证绝对的正确, 仅供参考，请小心测试]<br>
<br>
Win95/98下监控运行的其他程序<br>
<br>
参照下面这段程序，就搞定了啦。^-^<br>
==================================<br>
uses ... TLHelp32, ...<br>
<br>
type<br>
TForm1 = class(TForm)<br>
...<br>
end;<br>
<br>
var<br>
Form1: TForm1;<br>
l : Tlist; ////返回的东东在&quot;L&quot;这个TList中。<br>
<br>
type<br>
TProcessInfo = Record<br>
ExeFile : String;<br>
ProcessID : DWORD;<br>
end;<br>
pProcessInfo = ^TProcessInfo;<br>
<br>
implementation<br>
<br>
{$R *.DFM}<br>
<br>
procedure TForm1.FormCreate(Sender: TObject);<br>
var p : pProcessInfo;<br>
i : integer;<br>
ContinueLoop:BOOL;<br>
var<br>
FSnapshotHandle:THandle;<br>
FProcessEntry32:TProcessEntry32;<br>
begin<br>
l := TList.Create;<br>
l.Clear;<br>
FSnapshotHandle:=CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS,0);<br>
FProcessEntry32.dwSize:=Sizeof(FProcessEntry32);<br>
ContinueLoop:=Process32First(FSnapshotHandle,FProcessEntry32);<br>
while integer(ContinueLoop)&lt;&gt;0 do<br>
begin<br>
New(p);<br>
p.ExeFile := FProcessEntry32.szExeFile;<br>
p.ProcessID := FProcessEntry32.th32ProcessID;<br>
l.Add(p);<br>
ContinueLoop:=Process32Next(FSnapshotHandle,FProcessEntry32);<br>
end;<br>
end;<br>
<br>
procedure TForm1.FormDestroy(Sender: TObject);<br>
var p : pProcessInfo;<br>
i : integer;<br>
begin<br>
With l do<br>
for i := Count - 1 DownTo 0 do<br>
begin p := items[i]; Dispose(p); Delete(i); end;<br>
end;<br>
<br>
...<br>
end. <br>
</p>
</body>
</html>
