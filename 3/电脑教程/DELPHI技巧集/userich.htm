<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>Delphi中RichEdit的奥妙</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<table>
  <tr>
    <td vAlign="top" width="672"><p align="center"><font color="#004080" face="黑体"><strong>Delphi中RichEdit的奥妙</strong></font></td>
  </tr>
  <tr>
    <td vAlign="top" width="672"><p align="left" class="ourfont"><font color="#000000">&nbsp; 
    &nbsp;&nbsp; <strong>一、如何得知当前行号</strong><br>
    　　用RichEdit（或者memo）控件制作文本编辑器时，通过访问linescount属性可以得到总行数，但是若想知道光标当前所在行的行号就麻烦了，因为delphi没有提供这个属性。要实现这个编辑器必备功能，就须调用em_ 
    LineFromChar。请试试下面的程序。<br>
    　　先在窗口中布置一个RichEdit或者memo（命名为editor），以及一个button。在button的onclick事件中写入下列代码。<br>
    　　var<br>
    　　CurrentLine:Integer;<br>
    　　begin<br>
    　　CurrentLine:=EditorPerform(em_ LineFromChar,SFFFF,0);<br>
    　　ApplicationMessageBox(PChar(′当前行号是′＋IntToStr(CurrentLine)),′消息′,mb_ 
    iconinformation);<br>
    　　end;<br>
    　　需要注意的是，第一行的行号为零。<br>
    　　<strong>二、如何撤消操作（undo）</strong><br>
    　　对于memo来说，实现undo是不需编程的，只要让popupmenu属性为空，运行时就能用鼠标右键激活一个常用操作菜单，其中包括撤消、剪切、复制、粘贴、删除和全选六项。<br>
    　　但可惜的是，这一招对于功能强大的RichEdit控件居然行不通，害得我们还要自己设计一个popupmemu。当你用CutToClipBoard等语句轻松而顺利地完成了“剪切”等功能，接着便会无奈地发现，竟找不到undo或cancel之类的语句来执行“撤消”。<br>
    　　这时你需要这样处理：<br>
    　　RichEdit1Perform(EM_UNDO,0,0);<br>
    　　另外还应检查是否允许撤消，从而开启或关闭弹出菜单中的“撤消”项：<br>
    　　Undo1Enabled:=RichEditPerform(EM_CANUNDO,0,0)&lt;&gt;0;<br>
    　　以上程序在Delphi3中调试通过。　　<strong>(上海　汪　箴)</strong></font></td>
  </tr>
</table>
</body>
</html>
