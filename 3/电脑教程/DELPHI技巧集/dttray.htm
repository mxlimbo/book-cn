<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
   <META NAME="Author" CONTENT="FuGui">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (Win95; I) [Netscape]">
   <TITLE>ÈçºÎ´´½¨ÈÎÎñÀ¸µÄÓ¦ÓÃ³ÌĞò</TITLE>
</HEAD>
<BODY BACKGROUND="../../bgimage/pink_fabric.gif" NOSAVE>

<H1>
ÔõÑù½¨Á¢¼òµ¥µÄÈÎÎñÀ¸Ó¦ÓÃ³ÌĞò:</H1>
&nbsp;

<P>&nbsp;&nbsp;&nbsp; Windows 95 ºÍ Windows NT 4.0°üº¬Ò»¸öÁîÈËĞË·ÜµÄÌØĞÔ£ºÈÎÎñÀ¸¡£Õâ¸öÍ¨³£Î»ÓÚÇøÓòÈÎÎñÌõÓÒÃæµÄÇøÓòÄÜ°üº¬Ğ¡µÄÍ¼±ê£¬ÕâĞ©Í¼±êÄÜÒı³ö´óµÄÓ¦ÓÃ³ÌĞò»òÕß²Ëµ¥¡£±¾ÆªÎÄÕÂÖ÷ÒªÌÖÂÛÈçºÎÊ¹ÓÃDelphi½¨Á¢ÕâÑùµÄÓ¦ÓÃ³ÌĞò¡£

<P>&nbsp;&nbsp;&nbsp; ÔÚ¿ªÊ¼Ö®Ç°£¬Çë¿´ÏÂÃæµÄĞèÒªµÄ½Ó¿Ú·½ÃæµÄÄÚÈİ£º

<P>&nbsp;&nbsp;&nbsp; ´Ó¼¼Êõ·½ÃæÀ´Ëµ£¬Ò»¸öÈÎÎñÀ¸Ó¦ÓÃ³ÌĞò·Ç³£ÏóÆÕÍ¨µÄÓ¦ÓÃ³ÌĞò£¬ËüÓĞÒ»¸öÏûÏ¢Ñ­»·£¬ÏàÓ¦WindowsµÄÏûÏ¢À´Íê³ÉÏàÓ¦µÄ¹¦ÄÜ¡£
<UL>
<PRE>Procedure RunTrayApplication;
Var Msg : TMsg;
Begin
&nbsp; CreateWindow;
&nbsp; AddTrayIcon;
&nbsp; While GetMessage(Msg,0,0,0) do Begin
&nbsp;&nbsp;&nbsp; TranslateMessage(Msg);
&nbsp;&nbsp;&nbsp; DispatchMessage(Msg);
&nbsp; End;
&nbsp; DeleteTrayIcon;
End;</PRE>
</UL>
&nbsp;&nbsp;&nbsp; ÄãÄÜ¿´µ½£ºËùÓĞĞèÒª×öµÄ¹¤×÷ÊÇ´´½¨Ò»¸ö´°¿Ú£¬×¢²áÒ»¸öÍ¼±êµ½ÈÎÎñÀ¸£¬ÉèÖÃËüµÄÏûÏ¢Ñ­»·£¬×îºó¹Ø±ÕËü¡£µ±È»£¬±ØĞë»¹ÓĞÔö¼ÓÆäËû´úÂëÍê³ÉÏàÓ¦µÄ¹¦ÄÜ£¬µ«ÊÇ£¬ËüÊÇÕæµÄ²»ĞèÒªµ£ĞÄ¡£

<P>&nbsp;&nbsp;&nbsp; ÈÃÎÒÃÇ´Ó´°¿ÚµÄ´´½¨¿ªÊ¼¡£Êµ¼ÊÉÏ£¬Õâ¸ö´°¿ÚÊÇ²»ÊÇÄÜÔÚÈÎÎñÀ¸ÉÏÄÜ¼ûµ½µÄ´°¿Ú¡£ÏàÓ¦µÄ£¬Õâ¸ö´°¿ÚÖ»ÊÇ´¦ÀíÏûÏ¢Ñ­»·¡¢ÆäËü¸¸ÀàµÄ¹¤×÷¡£ÈÎÎñ´°¿Ú(Windows
95 &amp; NT)¾ä±ú´´½¨ÏûÏ¢£¨ÀıÈçÊó±êµ¥»÷µÈ£©ºÍ½«ÏûÏ¢·¢µ½ÎÒÃÇµÄ´°¿Ú¡£
<UL>
<PRE>Procedure CreateWindow;
Var
&nbsp; WC : TWndClass;
&nbsp; W&nbsp; : hWnd;
Begin
&nbsp; With WC do Begin
&nbsp;&nbsp;&nbsp; Style := 0;
&nbsp;&nbsp;&nbsp; lpfnWndProc := @WndProc;
&nbsp;&nbsp;&nbsp; cbClsExtra := 0;
&nbsp;&nbsp;&nbsp; cbWndExtra := 0;
&nbsp;&nbsp;&nbsp; hIcon := 0;
&nbsp;&nbsp;&nbsp; hCursor := 0;
&nbsp;&nbsp;&nbsp; hbrBackground := 0;
&nbsp;&nbsp;&nbsp; lpszMenuName := nil;
&nbsp;&nbsp;&nbsp; lpszClassName := 'MyTrayIconClass';
&nbsp;&nbsp;&nbsp; hInstance := System.hInstance;
&nbsp; end;
&nbsp; RegisterClass(WC);
&nbsp; W := Windows.CreateWindow('MyTrayIconClass','MyVeryOwnTrayIconWindow',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws_OverlappedWindow,0,0,0,0,0,0,hInstance,nil);
&nbsp; ShowWindow(W,sw_Hide);
&nbsp; UpdateWindow(W);
&nbsp; MainWindow := W;
End;</PRE>
</UL>
<FONT SIZE=+0>&nbsp;&nbsp;&nbsp; Õâ¸ö´°¿ÚÊ¹ÓÃÆÕÍ¨µÄ´°¿Úº¯Êı´´½¨¡£×¢ÒâÕâ¸ö´°¿ÚµÄÀàĞÍÊÇ¡°ws_OverlappedWindow¡±£¬µ«ÊÇÕâ¸ö³ß´çÊÇ0£¬²¢ÇÒËüÊÇÒş²ØµÄ£¬ËùÓĞ£¬Ëü½«²»»áÏÔÊ¾³öÀ´¡£</FONT>

<P>&nbsp;&nbsp;&nbsp; ÏÂÒ»²½ÊÇ¼Ó(×¢²á)ÎÒÃÇµÄÍ¼±ê¡£Õâ½«ĞèÒªÊ¹ÓÃ<FONT SIZE=+0>Shell_NotifyIconÕâ¸öAPIº¯Êı£¬Õâ¸öº¯ÊıÊµ¼ÊÉÏ¿ÉÒÔÍê³ÉÈı¸ö¹¦ÄÜ£¬ÕâÀïÖ»ĞèÒªËüµÄÔö¼ÓµÄÌØĞÔ¡£</FONT>
<UL>
<PRE>Procedure AddTrayIcon;
Var IconData : TNotifyIconData;
Begin
&nbsp; With IconData do Begin
&nbsp;&nbsp;&nbsp; cbSize := SizeOf(IconData);
&nbsp;&nbsp;&nbsp; Wnd := MainWindow;
&nbsp;&nbsp;&nbsp; uID := 0;
&nbsp;&nbsp;&nbsp; uFlags := nif_Icon Or nif_Message Or nif_Tip;
&nbsp;&nbsp;&nbsp; uCallBackMessage := wm_MyCallBack;
&nbsp;&nbsp;&nbsp; hIcon := LoadIcon(hInstance,'MYICON');
&nbsp;&nbsp;&nbsp; StrCopy(szTip,PChar(TrayIconTip));
&nbsp; End;
&nbsp; Shell_NotifyIcon(nim_Add,@IconData);
End;</PRE>
</UL>
<FONT SIZE=+0>&nbsp;&nbsp;&nbsp; Õâ¸ö×îÖØÒªµÄÊÂÇéÊÇTNotifyIconDataµÄÊı¾İ½á¹¹£¬ËüÊÇÒ»¸öÉèÖÃWindow¾ä±úµÄÊı¾İ½á¹¹£¬ÊÇÒ»¸ö¼ÇÂ¼²ÎÊı£¬¶ÔÎÒÃÇÀ´Ëµ£¬ÎÒÃÇĞèÒªÉèÖÃÕâ¸öÍ¼±êµÄ´°¿Ú¾ä±ú(Õâ½«¶¨ÒåÄÄ¸ö´°¿Ú´¦ÀíÏûÏ¢Ñ­»·)£¬»Øµ÷ÏûÏ¢ºÅ£¬Í¼±ê£¬¹¤¾ßÌáÊ¾µÈ¡£Ò»µ©Õâ¸öÊı¾İÉèÖÃÁË£¬ÎÒÃÇ¾Í¿ÉÒÔÔö¼ÓÒ»¸öÍ¼±êµ½ÈÎÎñÀ¸ÉÏÁË¡£ÎªÁËÍê³ÉÕâ¸ö¹¤×÷£¬Ê¹ÓÃnim_Add³ÌĞò¡£</FONT>

<P><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; ÏÖĞĞÎÒÃÇÒÑ¾­¼ÓÁËÎÒÃÇµÄÍ¼±êµ½ÈÎÎñÀ¸£¬ÏÂÃæĞèÒª¾ö¶¨ÈçºÎ´¦ÀíÏûÏ¢¡£</FONT>
<UL>
<PRE>Const
&nbsp; wm_MyCallback = wm_User+1000;
&nbsp; cm_Exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 100; { we worry about... }
&nbsp; cm_About&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 101; { ...these later&nbsp;&nbsp;&nbsp; }</PRE>
</UL>
<FONT SIZE=+0>&nbsp;&nbsp;&nbsp; Õâ¸öÊµ¼ÊµÄ´°¿Ú´¦Àí¹ı³ÌÒ²ÊÇÏàµ±ÆÕÍ¨¡£¼¸¸ö´°¿ÚÏûÏ¢(Èçwm_NCCreate)±ØĞë´¦Àí¡£È»¶ø£¬¶ÔÎÒÃÇÀ´Ëµ£¬¸üÖØÒªµÄÊÂÇéÊÇ´¦Àíwm_MyCallbackºÍwm_CommandÏûÏ¢£º</FONT>
<UL>
<PRE>Function WndProc(Window : hWnd; Msg,WParam,LParam : Integer): Integer; StdCall;
Begin
&nbsp; Result := 0;
&nbsp; Case Msg of
&nbsp;&nbsp;&nbsp; wm_NCCreate&nbsp;&nbsp; : Result := 1;
&nbsp;&nbsp;&nbsp; wm_Destroy&nbsp;&nbsp;&nbsp; : PostQuitMessage(0);
&nbsp;&nbsp;&nbsp; wm_Command&nbsp;&nbsp;&nbsp; : Begin { a command was chosen from the popup menu }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (WParam = cm_Exit) Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PostMessage(Window,wm_Destroy,0,0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else If (WParam = cm_About) Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox(0,'Shell Test Copyright © '+
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Jani Järvinen 1996.',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'About Shell Test',mb_OK)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else OpenDesktopIcon(WParam-cm_About);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End;
&nbsp;&nbsp;&nbsp; wm_MyCallback : Begin { our icon was clicked }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (LParam = wm_LButtonDown) Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ShowIconPopupMenu
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else If (LParam = wm_RButtonDown) Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ShowAboutPopupMenu;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End;
&nbsp;&nbsp;&nbsp; Else Result := DefWindowProc(Window,Msg,WParam,LParam);
&nbsp; End;
End;</PRE>
</UL>
<FONT SIZE=+0>&nbsp;&nbsp;&nbsp; ¾ÍÏóÄã¿´µ½µÄÒ»Ñù£¬µ±ÓÃ»§µ¥»÷Í¼±êÊ±£¬WindowsÌáÊ¾ÎÒÃÇ¡£×¢ÒâÎÒÃÇ²»Ê¹ÓÃÍ¨³£Ê¹ÓÃµÄwm_LButtonDown
ÏûÏ¢£¬¶øÊ¹ÓÃwm_MyCallback message£¬ÏêÏ¸µÄÏûÏ¢ĞÅÏ¢´æ´¢ÔÚLParam²ÎÊıÖĞ¡£</FONT>

<P><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; µ±ÓÃ»§µ¥»÷Êó±êÓÒ¼ü£¬ÎÒÃÇ´´½¨Ò»¸ö²Ëµ¥ÔÚ×ÀÃæÉÏ¡£</FONT>
<UL>
<PRE>Type
&nbsp; TIconData = Array[1..100] of String;
Var
&nbsp; IconData&nbsp;&nbsp; : TIconData;
Procedure ShowIconPopupMenu;
Var
&nbsp; ShellFolder : IShellFolder;
&nbsp; EnumIDList&nbsp; : IEnumIDList;
&nbsp; Result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : hResult;
&nbsp; Dummy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : ULong;
&nbsp; ItemIDList&nbsp; : TItemIDList;
&nbsp; Pntr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : PItemIDList;
&nbsp; StrRet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : TStrRet;
&nbsp; PopupMenu&nbsp;&nbsp; : hMenu;
&nbsp; ItemID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Integer;
&nbsp; Pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : TPoint;
&nbsp; Procedure AddToMenu(Item : String);
&nbsp; Var S : String;
&nbsp; Begin
&nbsp;&nbsp;&nbsp; IconData[ItemID-cm_About] := Item;
&nbsp;&nbsp;&nbsp; S := ExtractFileName(Item);
&nbsp;&nbsp;&nbsp; If (System.Pos('.',S) &lt;> 0) Then SetLength(S,System.Pos('.',S)-1);
&nbsp;&nbsp;&nbsp; AppendMenu(PopupMenu,mf_Enabled Or mf_String,ItemID,PChar(S));
&nbsp;&nbsp;&nbsp; Inc(ItemID);
&nbsp; End;
begin
&nbsp; PopupMenu := CreatePopupMenu;
&nbsp; ItemID := cm_About+1;
&nbsp; SHGetDesktopFolder(ShellFolder);
&nbsp; ShellFolder.EnumObjects(MainWindow,SHCONTF_NONFOLDERS,EnumIDList);
&nbsp; Pntr := @ItemIDList;
&nbsp; Result := EnumIDList.Next(1,Pntr,Dummy);
&nbsp; While (Result = NoError) do Begin
&nbsp;&nbsp;&nbsp; ShellFolder.GetDisplayNameOf(Pntr,SHGDN_FORPARSING,@StrRet);
&nbsp;&nbsp;&nbsp; With StrRet do AddToMenu(String(CStr));
&nbsp;&nbsp;&nbsp; Result := EnumIDList.Next(1,Pntr,Dummy);
&nbsp; End;
&nbsp; EnumIDList.Release;
&nbsp; ShellFolder.Release;
&nbsp; GetCursorPos(Pos);
&nbsp; AppendMenu(PopupMenu,mf_Separator,0,'');
&nbsp; AppendMenu(PopupMenu,mf_Enabled Or mf_String,cm_Exit,'E&amp;xit');
&nbsp; SetForegroundWindow(MainWindow);
&nbsp; TrackPopupMenu(PopupMenu,tpm_LeftAlign Or tpm_LeftButton,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pos.X,Pos.Y,0,MainWindow,nil);
&nbsp; DestroyMenu(PopupMenu);
end;</PRE>
</UL>
<FONT SIZE=+0>&nbsp;&nbsp;&nbsp; ÉÏÃæµÄ³ÌĞò¿´ÆğÀ´ÓĞµã¸´ÔÓ£¬Äã¿ÉÒÔ½«Ëü·Ö³ÉÁ½¸ö²¿·ÖÀ´¿´£º´´½¨ºÍÏÔÊ¾²Ëµ¥¡£</FONT>

<P><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; ÁĞ¾Ù´´½¨²Ëµ¥ÊÇÓÃWindowsµÄÍâ¿Ç½Ó¿ÚÍê³ÉµÄ¡£Ê×ÏÈ£¬ÎÒÃÇÊ¹ÓÃSHGetDesktopForlderº¯ÊıµÃµ½Ê¹ÓÃ×ÀÃæµÄIShellFolder½Ó¿Ú¡£Ê¹ÓÃÕâ¸ö½Ó¿Ú£¬ÎÒÃÇÄÜµÃµ½ÁíÒ»¸ö½Ó¿ÚµÄÊµÀı£ºIEnumIDList¡£Õâ¸ö½Ó¿ÚÍ¨³£ÊµÏÖÊµ¼ÊµÄÁĞ¾Ù¹¤×÷¡£ÎÒÃÇ¼òµ¥µÄÖØ¸´µ÷ÓÃÕâ¸öº¯ÊıÖ±µ½´íÎóÖµ·µ»Ø(ÀıÈç£ºËùÓĞµÄ²Ëµ¥±»ÁĞ¾Ù)¡£µ±ÎÒÃÇµÃµ½Ò»¸ö²Ëµ¥£¬ÎÒÃÇÊ¹ÓÃAddToMenuº¯Êı¼ÓËü¡£</FONT>

<P><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; µ±ËùÓĞµÄ²Ëµ¥±»ÁĞ¾ÙºÍ´´½¨ºó£¬ÏÖÔÚÎÒÃÇĞèÒªÔËĞĞÕâ¸ö²Ëµ¥¡£ÎÒÃÇ½«ÕÒµ½µÄ²Ëµ¥±£´æµ½Ò»¸öÈ«¾ÖµÄList±äÁ¿ÖĞ£¬Ã¿Ò»¸ö²Ëµ¥¶¼ÓµÓĞËüµÄ²Ëµ¥ºÅ¡£ÕâÈ·±£ÎÒÃÇÄÜµÃµ½ËüµÄË÷Òı¡£</FONT>
<BR><FONT SIZE=+0>&nbsp;</FONT>
<BR><FONT SIZE=+0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OpenDesktopIcon(WParam-cm_About)</FONT><FONT SIZE=+0></FONT>

<P><FONT SIZE=+0>µ±È»£¬WParamÖĞ´¢´æÁËÓÃ»§µ¥»÷Êó±êµÄ²Ëµ¥µÄ²Ëµ¥ºÅ(ID)¡£</FONT>

<P><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; ÏÂÃæÎÒÃÇ½«´¦ÀíÔËĞĞÓÃ»§Ñ¡ÔñµÄ²Ëµ¥¡£</FONT>
<UL>
<PRE>Procedure OpenDesktopIcon(Number : Integer);
Var
&nbsp; S : String;
&nbsp; I : Integer;
begin
&nbsp; S := IconData[Number];
&nbsp; I := ShellExecute(0,nil,PChar(S),nil,nil,sw_ShowNormal);
&nbsp; If (I &lt; 32) Then Begin
&nbsp;&nbsp;&nbsp; S := 'Could not open selected item "'+S+'". '+
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Result was: '+IntToStr(I)+'.';
&nbsp;&nbsp;&nbsp; MessageBox(0,PChar(S),'Shell Test',mb_OK);
&nbsp; End;
end;</PRE>
</UL>
<FONT SIZE=+0></FONT>

<P><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; ÉÏÃæ£¬Win 32 APIº¯ÊıShellExecute×öÁËËùÓĞµÄ¹¤×÷¡£</FONT>

<P><FONT SIZE=+0>&nbsp;&nbsp;&nbsp; ÏÖÔÚÄãÓ¦¸ÃÄÜÓÃDelphi´´½¨¼òµ¥µÄÈÎÎñÀ¸µÄ³ÌĞòÁË¡£</FONT>
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp; Êµ¼ÊÉÏ£¬ÓĞÒ»Ğ©<A HREF="../com/tray.zip">Ãâ·ÑµÄÔª¼ş</A>¿ÉÒÔ¹©ÄúÖ±½ÓÊ¹ÓÃ£¬²»¹ı£¬ÒòÎªÊ¹ÓÃVCL£¬ÎÄ¼şµÄ´óĞ¡½«±È½Ï´ó£¬Èç¹ûÊ¹ÓÃÉÏÃæµÄ·½·¨£¬ÎÄ¼şµÄ´óĞ¡½«Ö»Òª20K¡£µ±È»£¬ÏÖÔÚÎÄ¼şµÄ´óĞ¡ÒÑ¾­²»ÊÇÎÒÃÇ¸ÃÊ®·Ö¹Ø×¢µÄÎÊÌâÁË¡£

<P>×ÊÁÏÀ´Ô´£ºInternet
<BR>·­Òë£º¸µ¹ó
<BR>ÈÕÆÚ£º98.3.2
<BR>&nbsp;
<BR>&nbsp;

<P>±¾Ò³°æÖ÷£º<A HREF="mailto:fgui@usa.net">¸µ¹ó</A>£¬×îºóĞŞ¸ÄÈÕÆÚ£º98.3.2
</BODY>
</HTML>
