<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>Delphi如何实现在一个Dbgrid中显示多数据库</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<p align="center"><font color="#000000"><font size="5"><strong>Delphi如何实现在一个Dbgrid中显示多数据库</strong></font><big> 
<br>
<br>
</big><font size="4"><em>檀革新</em></font><big> </big></font></p>

<p><br>
　　在数据库编程中，不必要也不可能将应用程序操作的所有数据库字段放入一个数据库文件中。正确的数据库结构应是：将数据库字段放入多个数据库文件，相关的数据库都包含一个唯一的关键字段，在多数据库结构里可以建立联系。<br>
<br>
　　例如：要编制一个人事管理程序，为简化演示程序，只建立两个数据库，每个数据库都只建立两个字段。<br>
<br>
　　个人简介 jianjie.dbf，由人事处维护；工资情况 gongzi.dbf，由财务处维护。<br>
<br>
　　一、数据库的建立<br>
<br>
　　进入DataBase Desktop，建立数据库结构如下：<br>
<br>
　　jianjie.dbf<br>
<br>
　　编号 字段名:bianhao size:4 type:number<br>
<br>
　　姓名 字段名:xingming size:10 type:character<br>
<br>
　　gongzi.dbf<br>
<br>
　　编号 字段名:bianhao size:4 type:number<br>
<br>
　　工资 字段名:gongzi size:4 Dec 2 type:number<br>
<br>
　　注意：两个数据库的bianhao字段的size、type必须一致。实际上，两数据库文件可以分布在网络的不同计算机上，为便于演示，分别存为″c:\test\jianjie.dbf″和″c:\test\gongzi.dbf″。<br>
<br>
　　二、应用程序的编制<br>
<br>
　　启动Delphi，新建一个工程，在窗体中加入Query控件Query1，databasename属性设为c:\test；<br>
<br>
　　加入DataSource控件datasource1，DataSet属性设为Query1；加入DbGrid控件dbgrid1，DataSource属性设为DataSource1，将Query1.sql属性设为<br>
<br>
　　 SELECT DISTINCT A.bianhao,a.xingming, b.gongzi<br>
<br>
　　FROM ″jianjie.dbf″ A, ″gongzi.DBF″ b<br>
<br>
　　WHERE A.bianhao=b.bianhao<br>
<br>
　　再将Query1.enabled属性设为True，不用编译，DbGrid1就会显示:bianhao，xingming，gongzi三个字段。如果jianjie.dbf和gongzi.dbf中有记录，则记录会显示出来。因篇幅所限，此文只介绍了Dbgrid中显示多个数据库内容的一般方法，读者可在此基础上进行完善，使该方法更好地适应您的需要。</p>
</body>
</html>
