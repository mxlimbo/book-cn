<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>让彩色光标出现在Delphi程序中</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<table>
  <tr>
    <td vAlign="top" width="672"><p align="center"><font color="#004080" face="黑体"><strong>让彩色光标出现在Delphi程序中<br>
    </strong></font></td>
  </tr>
  <tr>
    <td vAlign="top" width="672"><p align="left" class="ourfont"><font color="#000000">&nbsp; 
    　在Delphi中用Loadcursor()得到的光标只有黑白两色，怎样在程序中得到彩色光标呢？笔者尝试制作了以下程序：<br>
    　<strong>　方法一　用Loadcursorfromfile()从外部调入图标作为光标</strong><br>
    　　Loadcursorfromfile()函数可以读＊CUR，＊ICO，＊ANI为后缀的文件作为光标，其中ICO为彩色图标格式（可用Image 
    Editor制作），ANI为动画光标格式。以下为打开一图标作为光标的演示程序段，当光标移动到测试区域内光标会变成选定的图案；<br>
    　　{设：opendialog1:Topendialog;Bitbtn1:Tbitbtn}<br>
    　　procedure TForm1.BitBtn1Click(Sender:TObject);<br>
    　　var tt:pchar;size:integer;s:string;<br>
    　　begin<br>
    　　if opendialog1.Execute then<br>
    　　begin<br>
    　　size:=length(opendialog1.filename);<br>
    　　getmem(tt,size);<br>
    　　s:=opendialog1.filename;<br>
    　　strpcopy(tt,s);<br>
    　　screen.cursors[2]:=loadcursorfromfile(tt);<br>
    　　bf.cursor:=2;<br>
    　　freemem(tt,size);<br>
    　　end;<br>
    　　end;<br>
    　　<strong>方法二　从资源文件加载彩色光标</strong><br>
    　　用方法一发送程序时必须包含＊CUR文件，因而从资源文件中加载彩色光标是更可行的方法。用图标存放彩色光标，使用时把图标存入临时文件，用Loadcursorfromfile（）从临时文件读出彩色光标。<br>
    　　程序段：<br>
    　　procedure ZloadfromResourse(screenindex:integer;name:Pchar);<br>
    　　var td:ticon;<br>
    　　begin<br>
    　　try<br>
    　　td:=ticon.Create;<br>
    　　td.Handle:=LoadIcon(Hinstance,name);<br>
    　　td.SaveToFile(′temp.cur′);<br>
    　　screen.Cursors[screenindex]:=loadcursorfromfile(′temp.cur′);<br>
    　　deletefile(′temp.cur′);<br>
    　　finally<br>
    　　td.free;<br>
    　　end;<br>
    　　end;<br>
    　　此程序把名字为name的图标变为序号为screenindex的光标;<br>
    　　例：<br>
    　　ZloadfromResourse(2,′myicon′);<br>
    　　Form1.cursor:=2;<br>
    　　注意：′myicon′这个图标一定要在资源文件中，否则会出现异常。　<strong>　(四川　张　杰)</strong></font></td>
  </tr>
</table>
</body>
</html>
