<HTML>
<HEAD>
<TITLE>Lesson 3: Managing Certificates</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmnet.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch13c.htm">[Previous]</A> <A HREF="ch13e.htm">[Next]</A><P>



<A NAME="593"><H1>Lesson 3: Managing Certificates</H1></A>

<p>Once you start issuing certificates, or clients request that you issue certificates, management of them becomes an important issue. In this lesson, you will learn how to manage certificates, revoke a certificate, and implement an Encrypting File System (EFS) recovery policy.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Describe the steps to revoke a certificate</li></p>

<p><li>Describe how to issue an EFS recovery policy</li></p>
</ul>

<p><b>Estimated lesson time: 30 minutes</b></p>
</blockquote></div></p>

<A NAME="594"><H2>Revoked Certificates</H2></A>

<p>When a certificate is marked as revoked, it is moved to the Revoked Certificates folder. The revoked certificate will appear on the CRL the next time it is published. Certificates revoked with the reason code Certificate Hold can be unrevoked, left on Certificate Hold until they expire, or have their revocation reason code changed. This is the only reason code that allows you to change the status of a revoked certificate. It is useful if the status of the certificate is questionable, and is meant to provide some flexibility to the CA administrator.</p>

<A NAME="595"><H2>Issued Certificates</H2></A>

<p>In the details pane, examine the certificate request by noting the values for requester name, requester e-mail address, and any other fields that you consider critical information for issuing the certificate.</p>

<A NAME="596"><H2>Pending Requests</H2></A>

<p>In the details pane, examine the certificate request by noting the values for requester name, requester e-mail address, and any other fields that you consider critical information for issuing the certificate.</p>

<A NAME="597"><H2>Failed Requests</H2></A>

<p>Failed certificate requests should only occur when a member of the Cert Publishers or Administrators groups denies a certificate request.</p>

<A NAME="598"><H2>How a Certificate Is Issued</H2></A>

<p>When a certificate is presented to an entity as a means of identifying the certificate holder (the subject of the certificate), it is useful only if the entity receiving the certificate trusts the issuing CA. Certificates are issued under the following processes:</p>

<ul>
<p><li><b>Key generation.</b> The individual or applicant requesting certification generates key pairs of public and private keys. The exception to this is personal digital certificates, in which case the CA generates the public and private keys and sends them to the end user.</li></p>

<p><li><b>Matching of policy information.</b> The applicant packages up the additional information necessary for the CA to issue the certificate (for example, proof of identity, tax ID number, e-mail address, and so on). The precise definition of this information is up to the CA.</li></p>

<p><li><b>Sending of public keys and information.</b> The applicant sends the public keys and information (often encrypted using the CA's public key) to the CA.</li></p>

<p><li><b>Verification of information.</b> The CA applies whatever policy rules it might require to verify that the applicant should receive a certificate.</li></p>

<p><li><b>Certificate creation.</b> The CA creates a digital document with the appropriate information (public keys, expiration date, and other data) and signs it using the CA's private key.</li></p>

<p><li><b>Sending or posting of certificate.</b> The CA may send the certificate to the applicant or post it publicly. The certificate is loaded onto the individual's system.</li></p>
</ul>

<A NAME="599"><H2>Certificate Revocation</H2></A>

<p>Certificate authorities publish CRLs containing certificates that have been revoked by the CA. The certificate holder's private key may become compromised, or false information may be used to apply for the certificate. CRLs provide a way of withdrawing a certificate after it has been issued. CRLs are made available for downloading or online viewing by client applications.</p>

<p>To verify a certificate, all that is necessary is the public key of the CA and a check against the revocation list published by that CA. Certificates and CAs reduce the public key distribution problem of verifying and trusting one (or more) public keys per individual. Instead, only the CA's public key must be trusted and verified, and then that can be relied on to allow verification of other certificates.</p>

<p>
<img src="images/practic.JPG" width=90 height=72 border="0">
</p>

<A NAME="600"><H2>Practice: Revoking a Certificate</H2></A>

<p><li><b>To revoke the certificate from Lesson 2</b></li></p>

<ol>
<p><li>Open the Certificate Authority Manager.</li></p>

<p><li>Right-click your request under Issued Certificates, point to All Tasks, then click Revoke Certificate.</li></p>

<p><li>When prompted for a reason code, select Cease Of Operation. Click Yes.</li></p>

<p><li>In the left pane, click Revoke Certificates.</li></p>

<p>Notice your request has been revoked, as illustrated in Figure 13.5.</p>
</ol>

<p>
<A HREF="javascript:fullSize('13ntk05x.htm')"> <img src="images/13ntk05.JPG" width=404 height=230 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 13.5</b> <i>Certificate Authority revoked certificates</i><!-- /caption -->
</p>

<A NAME="601"><H2>EFS Recovery Policy</H2></A>

<p>Data recovery is available for the EFS as a part of the overall security policy for the system. For example, if you should ever lose your file encryption certificate and associated private key (through disk failure or any other reason), data recovery is available through the person who is the designated recovery agent. Or, in a business environment, an organization can recover data encrypted by an employee after the employee leaves.</p>

<p>EFS recovery policy specifies the data recovery agent accounts that are used within the scope of the policy. EFS requires an encrypted data recovery agent policy before it can be used, and uses a default recovery agent account (the Administrator) if none has been chosen. In a domain, only members of the Domain Admins group can designate another account as the recovery agent account. In a small business or home environment where there are no domains, the computer's local Administrator account is the default recovery agent account. Only the Administrator account can change local recovery policy for a computer.</p>

<p>A recovery agent account is used to restore data for all computers covered by the policy. If a user's private key is lost, a file protected by that key can be backed up, and the backup sent by means of secure e-mail to a recovery agent administrator. The administrator restores the backup copy, opens it to read the file, copies the file in plaintext, and returns the plaintext file to the user using secure e-mail again.</p>

<p>As an alternative, the administrator can go to the computer that has the encrypted file, import his or her recovery agent certificate and private key, and perform the recovery there. However, this might not be safe and is not recommended because of the sensitivity of the recovery key&#8212;the administrator cannot afford to leave the recovery key on another computer.</p>

<p>
<img src="images/practic.JPG" width=90 height=72 border="0">
</p>

<A NAME="602"><H2>Practice: Changing a Recovery Policy</H2></A>

<p>In this procedure, you will change the recovery policy for the local computer. Before changing the recovery policy in any way, you should first back up the recovery keys to a floppy disk. In a domain, a default recovery policy is implemented for the domain when the first domain controller is set up. The domain administrator is issued the self-signed certificate, which designates the domain administrator as the recovery agent. To change the default recovery policy for a domain, log on to the first domain controller as an administrator.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>
To complete this procedure, you must have the appropriate permissions to request the certificate and the CA must be configured to issue this type of certificate.
</blockquote></div></p>

<p><li><b>To change the recovery policy for the local computer</b></li></p>

<ol>
<p><li>Click Start, click Run, type <b>mmc /a</b>, then click OK.</li></p>

<p><li>On the Console menu, click Add/Remove Snap-In, then click Add.</li></p>

<p><li>Under Snap-In, click Group Policy, then click Add.</li></p>

<p><li>Under Group Policy Object, make sure that Local Computer is displayed, click Finish, click Close, then click OK.</li></p>

<p><li>In Navigate Local Computer Policy\Computer Configuration\Windows Settings\Security Settings\Public Key Policies, right-click Encrypted Data Recovery Agents, then click one of the following options:</li></p>

<p>The Add command designates a user as an additional recovery agent using the Add Recovery Agent Wizard. The Delete Policy command deletes this EFS policy and every recovery agent. The effect of deleting the EFS policy and every recovery agent is that users will not be able to encrypt files on this computer. The computer issues a default self-signed certificate that designates the local administrator as the default recovery agent. If you delete this certificate without another policy in place, the computer has an empty recovery policy. An empty recovery policy means that no one is a recovery agent. This turns EFS off, thereby not allowing users to encrypt files on this computer.</p>

<p><li>To make changes to the File Recovery certificate, start by selecting Encrypted Data Recovery Agents in the left pane, as shown in Figure 13.6. Right-click the certificate in the right pane, then click Properties. For example, you can give the certificate a friendly name and enter a text description.</li></p>
</ol>

<p>
<A HREF="javascript:fullSize('13ntk06x.htm')"> <img src="images/13ntk06.JPG" width=404 height=228 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 13.6</b> <i>Group Policy for EFS recovery</i><!-- /caption -->
</p>

<A NAME="603"><H2>Lesson Summary</H2></A>

<p>You can manage certificates using the Certification Authority snap-in for the Microsoft Management Console. Certificates revoked with the reason code Certificate Hold can be unrevoked. They can also be left on Certificate Hold until they expire or have their revocation reason code changed. Data recovery is available for the EFS as a part of the overall security policy for the system.</p>

</BODY>
</HTML>





