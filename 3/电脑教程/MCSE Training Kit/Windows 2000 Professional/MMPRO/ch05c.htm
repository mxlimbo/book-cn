<HTML>
<HEAD>
<TITLE>Lesson 2: Using Registry Editor</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05b.htm", "ch05d.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="184"><H1>Lesson 2: Using Registry Editor</H1></A>

<p>Most Windows 2000 users never need to access the registry. However, management of the registry is an important part of the system administrator's job and includes viewing, editing, backing up, and restoring the registry. You use Registry Editor to view and change the registry configuration.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Edit the registry with Registry Editor.</li></p>
</ul>

<p><b>Estimated lesson time: 40 minutes</b></p>
</blockquote></div></p>

<A NAME="185"><H2>Regedt32.exe</H2></A>

<p>Setup installs Registry Editor (Regedt32.exe) in the <i>systemroot</i>\System32 folder during installation. However, because most users don't need to use Registry Editor, it doesn't appear on the Start menu. You start Registry Editor by clicking Run on the Start menu.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>Setup also installs a second Registry Editor (Regedit.exe). Regedit.exe doesn't have a security menu or a read-only mode and doesn't support REG_EXPAND_SZ or REG_MULTI_SZ, so it is not the recommended Registry Editor for Windows 2000.</blockquote></div></p>

<p>Although Registry Editor allows you to perform manual edits on the registry, it is intended for troubleshooting and problem resolution. You should make most configuration changes through either Control Panel or Administrative Tools. However, some configuration settings can be made only directly through the registry.</p>

<p><div class="caution"><blockquote><b>CAUTION</b><hr>Using Registry Editor incorrectly can cause serious, system-wide problems that could require reinstallation of Windows 2000. When using Registry Editor to view data, save a backup copy of the registry file before viewing, and click Read Only Mode on the Options menu to prevent accidental updating or deleting of configuration data.</blockquote></div></p>

<p>Registry Editor saves data automatically as you make entries or corrections. 
New registry data takes effect immediately. You can find some of the most useful Registry Editor commands on the Registry menu and the View menu in Registry Editor. Table 5.4 describes the commands on these menus.</p>

<p><b>Table 5.4</b> <i>Registry Editor Commands</i></p>

<p><table cellpadding=5 width="95%">
<tr><th>Command</th><th>Menu</th><th>Description</th></tr>

<tr><td valign="top">Save Key</td>
<td valign="top">Registry</td>
<td valign="top">Saves part of the registry in binary format. It saves the currently selected key and all subkeys. You can then use this file with the Restore command to reload a set of values after testing a change.</td></tr>

<tr><td valign="top">Restore</td>
<td valign="top">Registry</td>
<td valign="top">Loads the data in the selected file under the currently selected key. If the selected key was saved in the data file, Registry Editor will overwrite the key with the values in the file.</td></tr>

<tr><td valign="top">Save Subtree As</td>
<td valign="top">Registry</td>
<td valign="top">Saves the selected key and all subkeys in a text file. You can then use a text editor to search for a specific value or key that was added or modified. Note that you can't convert this text file back to registry data.</td></tr>

<tr><td valign="top">Select Computer</td>
<td valign="top">Registry</td>
<td valign="top">Opens the registry on a remote computer. Windows 2000 Server restricts remote access to the Administrators group, but Windows 2000 Professional allows remote access by any valid user account. To modify remote access permissions for either operating system, create this registry key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers \winreg, of type REG_DWORD, with a value of 1. Permissions on this key define who can have remote access to the registry.</td></tr>

<tr><td valign="top">Find Key</td>
<td valign="top">View</td>
<td valign="top">Searches the registry for a specific key. Key names appear in the left pane of Registry Editor. The search begins at the currently selected key and parses all descendant keys for the specified key name. The search is local to the subtree in which the search begins. For example, a search for a key in the HKEY_LOCAL_MACHINE subtree doesn't include keys under HKEY_CURRENT_USER.</td></tr></table></p>

<p>
<img src="images/practic.JPG" width=92 height=74 border=0>
</p>

<A NAME="186"><H2>Practice: Using Registry Editor</H2></A>

<p>In this practice, you will use Registry Editor to view the information in the registry. You will determine information such as the BIOS, the processor on your computer, and the version of the operating system. You use Registry Editor's Find Key command to search the registry for a specific word with key names. You modify the registry by adding a value to it, and you save a subtree as a file so that you can use an editor, like Notepad, to search the file.</p>

<A NAME="187"><H3>Exercise 1: Exploring the Registry</H3></A>

<p>In this exercise, you will use Registry Editor to view information in the registry.</p>

<p><li><b>To view information in the registry</b></li></p>

<ol>
<p><li> Ensure that you are logged on as Administrator.</li></p>

<p><li> Start Registry Editor (Regedt32.exe).</li></p>

<p><li> On the Options menu, click Read Only Mode to place a check mark to the left of the option.</li></p>

<p><li> On the View menu, ensure that Tree And Data is selected.</li></p>

<p><li> Maximize the Registry Editor window, and then maximize the window titled HKEY_LOCAL_MACHINE On Local Machine.</li></p>

<p><li> Double-click the HARDWARE\DESCRIPTION\System subkey to expand it, and then answer the following questions:</li></p>

<p>What is the basic input/output system (BIOS) version of your computer and its date?</p>

<p><a href="chaaa.htm#896">Answer</a></p>

<p>What is the computer type of your local machine according to the Identifier entry?</p>

<p><a href="chaaa.htm#896">Answer</a></p>

<p><li> Expand the SOFTWARE\Microsoft\Windows NT\CurrentVersion subkey, and then fill in the following information.</li></p>

<p><table cellpadding=5 width="95%">
<tr><th>Software configuration</th><th>Value and string</th></tr>

<tr><td valign="top">Current build number</td>
<td valign="top">&nbsp;</td></tr>

<tr><td valign="top">Current version</td>
<td valign="top">&nbsp;</td></tr>

<tr><td valign="top">Registered organization</td>
<td valign="top">&nbsp;</td></tr>

<tr><td valign="top">Registered owner</td>
<td valign="top">&nbsp;</td></tr></table></p>

</ol>

<A NAME="188"><H3>Exercise 2: Using the Find Key</H3></A>

<p>In this exercise, you will use Registry Editor's Find Key command to search the registry to find a specific word in the key names in the registry.</p>

<p><li><b>To use the find key</b></li></p>

<ol>
<p><li> Click the HKEY_LOCAL_MACHINE subkey to ensure that the entire subtree is searched.</li></p>

<p><li> On the View menu, click Find Key.</li></p>

<p>The Find dialog box appears.</p>

<p><li> In the Find What box, type <b>serial</b></li></p>

<p><li> Click Find Next and wait for the first matching entry to appear.</li></p>

<p><li> Continue clicking Find Next until a Warning dialog box appears, indicating that Registry Editor can't find the desired key.</li></p>

<p>Notice that this key appears in multiple locations in the registry.</p>

<p><li> Click OK to close the Warning dialog box.</li></p>

<p><li> Click Cancel to close the Find dialog box.</li></p>
</ol>

<A NAME="189"><H3>Exercise 3: Modifying the Registry</H3></A>

<p>In this exercise, you will add a value to the registry.</p>


<p><li><b>To add a value to the registry</b></li></p>

<ol>
<p><li> On the Options menu, click Read Only Mode.</li></p>

<p>This will disable Read Only Mode, which was enabled in Exercise 1.</p>

<p><li> On the Window menu, click HKEY_CURRENT_USER On Local Machine.</li></p>

<p>The HKEY_CURRENT_USER window appears in Registry Editor.</p>

<p><li> In the left pane of the Registry Editor window, click Environment.</li></p>

<p>The values in the Environment key appear in the right pane of the Registry Editor window.</p>

<p><li> On the Edit menu, click Add Value.</li></p>
</ol>

<p><div class="note"><blockquote><b>NOTE</b><HR>If Add Value is unavailable, make sure Read Only Mode is not selected on the Options menu. If you are having problems deselecting Read Only Mode, exit Registry Editor and then restart it.</blockquote></div></p>

<ol>
<p>The Add Value dialog box appears.</p>

<p><li value="5"> In the Value Name box, type <b>test</b></li></p>

<p><li> In the Data Type list, click REG_EXPAND_SZ, and then click OK.</li></p>

<p>The String Editor dialog box appears.</p>

<p><li> In the String box, type <b>%windir%\system32</b> and then click OK.</li></p>

<p>test:REG_EXPAND_SZ : %windir%\system32 should appear in the right pane of the Registry Editor window.</p>

<p><li> Minimize the Registry Editor window.</li></p>
</ol>

<p><li><b>To verify the new registry value</b></li></p>

<ol>
<p><li> Right-click My Computer, and then click Properties.</li></p>

<p>The System Properties dialog box appears.</p>

<p><li> Click the Advanced tab, and then click Environment Variables.</li></p>

<p>The Environment Variables dialog box appears.</p>

<p><li> Close the Environment Variables dialog box, and then close the System Properties dialog box.</li></p>
</ol>

<A NAME="190"><H3>Exercise 4: Saving a Subtree as a File</H3></A>

<p>In this exercise, you will save a subtree as a file. Saving a subtree as a file allows you to use Notepad or some other editor to search the file. The file can also be stored or printed as a record of the contents of the subtree and might come in handy for troubleshooting a problem, should something accidentally get changed in the registry.</p>

<p><li><b>To save a subtree as a file</b></li></p>

<ol>
<p><li> Restore the Registry Editor window.</li></p>

<p><li> On the Window menu, click HKEY_LOCAL_MACHINE On Local Machine.</li></p>

<p><li> Click HKEY_LOCAL_MACHINE\ SOFTWARE.</li></p>

<p><li> On the Registry menu, click Save Subtree As.</li></p>

<p>The Save As dialog box appears.</p>

<p><li> In the Save In box, click Desktop.</li></p>

<p><li> In the File Name box, type <b>Software.txt</b> and then click Save.</li></p>
</ol>

<p><div class="note"><blockquote><b>NOTE</b><HR>You might experience a long delay while Registry Editor saves the subtree.</blockquote></div></p>

<ol>
<p><li value="7"> Exit Registry Editor.</li></p>

<p><li> On your desktop, double-click Software.</li></p>

<p>Notepad opens the Software file.</p>

<p><li> On the Edit menu, click Find.</li></p>

<p>The Find dialog box appears.</p>

<p><li>In the Find What box, type <b>CurrentBuildNumber</b> and then click Find Next.</li></p>

<p><li>Click Cancel to close the Find dialog box.</li></p>

<p><li>Scroll down (if necessary) to see the data for CurrentBuildNumber.</li></p>

<p><li>Close Notepad.</li></p>
</ol>

<A NAME="191"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that you use Registry Editor (Regedt32.exe) to view and change the registry configuration. However, Registry Editor is primarily 
intended for troubleshooting. For most configuration changes, you should use either Control Panel or Administrative Tools, not Registry Editor. You also learned that some configuration settings can be made only directly through the registry, and for these you use Registry Editor.</p>

<p>You learned that you find some of the most useful Registry Editor commands 
on the Registry menu and the View menu. These commands include Find Key, which allows you to search the registry for a specific key. The Save Key command allows you to save part of the registry in binary format. The Save Subtree As command allows you to save the selected key and all subkeys in a text file, and the Select Computer command allows you to open the registry on a remote computer.</p>

</BODY>
</HTML>






