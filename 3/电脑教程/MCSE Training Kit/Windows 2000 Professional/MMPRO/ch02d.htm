<HTML>
<HEAD>
<TITLE>Lesson 3: Installing Windows 2000 over the Network</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch02c.htm", "ch02e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="78"><H1>Lesson 3: Installing Windows 2000 over the Network</H1></A>

<p>In addition to installing from a CD-ROM, you can install Windows 2000 over the network. This lesson demonstrates the similarities and differences between installing from a CD-ROM and installing over the network. The major difference is the location of the source files needed to install Windows 2000. This lesson also lists the requirements for a network installation.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Identify the steps for completing a network installation of Windows 2000.</li></p>
</ul>

<p><b>Estimated lesson time: 10 minutes</b></p>
</blockquote></div></p>

<A NAME="79"><H2>Preparing for a Network Installation</H2></A>

<p>In a network installation, the Windows 2000 installation files reside in a shared location on a network file server, which is called a <i>distribution server.</i> From the computer on which you want to install Windows 2000 (the target computer), you connect to the distribution server and then run the Setup program.</p>

<p>The basic environment requirement for a network installation is shown in Figure 2.7. The pre-Setup requirements for a network installation are explained in more detail in the list that follows.</p>

<p>
<A HREF="javascript:fullSize('F02tk07x.htm')"> <img src="images/F02tk07.JPG" width=404 height=275 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 2.7</b> <i>A network installation's basic environment</i><!-- /caption -->
</p>

<ul>
<p><li><b>Locate a distribution server.</b> The distribution server contains the installation files from the i386 folder on the Windows 2000 Professional CD-ROM. These files must reside in a common network location in a shared folder. This shared folder allows computers on the network to gain access to the installation files. Contact a network administrator to obtain the path to the installation files on the distribution server.</li></p>
</ul>

<p><div class="note"><blockquote><b>NOTE</b><HR>
Once you have created or located a distribution server, you can use the over-the-network installation method to concurrently install Windows 2000 on multiple computers.
</blockquote></div></p>

<ul>
<p><li><b>Create a FAT partition on the target computer.</b> The target computer requires a formatted partition on which to copy the installation files. Create a 650-MB (1-GB or larger recommended) partition and format it with the FAT file system.</li></p>

<p><li><b>Install a network client.</b> A network client is software that allows the target computer to connect to the distribution server. On a computer without an operating system, you must boot from a client disk that includes a network client that enables the target computer to connect to the distribution server.</li></p>
</ul>

<A NAME="80"><H2>Creating a Distribution Server</H2></A>

<p>A distribution server stores the distribution folder structure. The distribution folder structure contains the files necessary to install Windows 2000 Professional over the network. If you have a lot of computers on which to install Windows 2000 or if you will be doing multiple Windows 2000 installations simultaneously, create more than one set of distribution folders. Having distribution folders set up on several computers will make the file copy portion of Windows 2000 Setup faster. Even if you have several different types of hardware configurations on which to install Windows 2000, you create one set of distribution folders and use them with different answer files to install to all the different hardware types.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>
If you are installing Windows 2000 on a computer running Windows 95, Windows 98, Windows NT, or an earlier version of Windows 2000, the Winnt32.exe program allows you to specify up to eight locations for the distribution folders.
</blockquote></div></p>

<p>To create a distribution server, follow these steps:</p>

<ol>
<p><li>Log on to the server as administrator or connect to the server on which you want to create a distribution file structure.</li></p>

<p><li>Create a folder on the server named W2000P.</li></p>
</ol>

<p><div class="note"><blockquote><b>NOTE</b><HR>
The name W2000P is for a distribution folder structure containing the source files for Windows 2000 Professional. You can use W2000S for Windows 2000 Server and W2000AS for Windows 2000 Advanced Server. If you're creating distribution folder structures on more than one server, you can name them W2000P1, W2000P2, W2000P3, W2000P4, and so on.
</blockquote></div></p>

<ol start=3>
<p><li>Copy the contents of the i386 folder from the Windows 2000 Professional CDROM to the folder you created on the distribution server.</li></p>

<p><li>In the W2000P folder you created, create an $OEM$ subfolder.</li></p>
</ol>

<p><div class="note"><blockquote><b>NOTE</b><HR>
The $OEM$ subfolder is used to hold applications, drivers, or utilities you want Setup to copy to the target computer.
</blockquote></div></p>

<p>If Setup finds the $OEM$ folder in the root of the distribution folder, it copies all of the files found in this directory to the temporary directory created during the text portion of Setup.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>
The OEMFILESPATH key in the answer file allows you to create the $OEM$ subfolder outside of the distribution folder.
</blockquote></div></p>

<A NAME="81"><H2>Performing an Installation over the Network</H2></A>

<p>The Windows 2000 Setup program copies the installation files to the target computer. After copying the installation files, Setup restarts the target computer. From this point on, you install Windows 2000 in the same way that you install from a CD-ROM.</p>

<p>The following steps describe the process for installing Windows 2000 over the network (see Figure 2.8):</p>

<ol>
<p><li>On the target computer, boot from the network client.</li></p>

<p><li>Connect to the distribution server. After you start the network client on the target computer, connect to the shared folder on the distribution server that contains the Windows 2000 Professional installation files.</li></p>

<p><li>Run Winnt.exe or Winnt32.exe to start the Setup program. Use Winnet.exe for an installation using Windows 3.<i>x</i> on the source system, and use Winnet32.exe for an installation using Windows 95, 98, NT 4 (or NT 3.5), or 2000 on the source system. Winnt.exe and Winnt32.exe reside in the shared folder on the distribution server. When you run Winnt.exe from the shared folder, it does the following:</li></p>

<ul>
<p><li>Creates the $Win_nt$.~ls temporary folder on the target computer.</li></p>

<p><li>Copies the Windows 2000 installation files from the shared folder on the distribution server to the $Win_nt$.~ls folder on the target computer.</li></p>
</ul>

<p><li>Install Windows 2000. Setup restarts the target computer and begins installing Windows 2000.</li></p>

<p>
<A HREF="javascript:fullSize('F02tk08x.htm')"> <img src="images/F02tk08.JPG" width=404 height=199 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 2.8</b> <i>Installing Windows 2000 over the network</i><!-- /caption -->
</p>

</ol>

<A NAME="82"><H2>Modifying the Setup Process</H2></A>

<p>You can modify a server-based installation by changing how Winnt.exe runs the setup process. Table 2.2 describes the switches that you can use with Winnt.exe to control the setup process.</p>

<p><b>Table 2.2</b> <i>Available Switches for Winnt.exe</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th>Switch</th>
			<th>Description</th>
		</tr>

		<tr>
			<td valign="top">/a</td>
			<td valign="top">Enables accessibility options.</td>
		</tr>

		<tr>
			<td valign="top">/e[:<i>command</i>]</td>
			<td valign="top">Specifies a command to be executed at the end of Setup's GUI mode.</td>
		</tr>

		<tr>
			<td valign="top">/r[:<i>folder</i>]</td>
			<td valign="top">Specifies an optional folder to be installed. The folder is retained after installation.</td>
		</tr>

		<tr>
			<td valign="top">/rx[:<i>folder</i>]</td>
			<td valign="top">Specifies an optional folder to be copied. Setup deletes the folder after installation.</td>
		</tr>

		<tr>
			<td valign="top">/s[:<i>sourcepath</i>]</td>
			<td valign="top">Specifies the source location of Windows 2000 files. The location must be a full path of the form x:\ [path] or \\server\share\  [path]. The default is the current folder.</td>
		</tr>
		
		<tr>
			<td valign="top">/t[:<i>tempdrive</i>]</td>
			<td valign="top">Specifies a drive to contain temporary setup files. If not specified, Setup attempts to locate a drive for you.</td>
		</tr>

		<tr>
			<td valign="top">/u[:<i>answer file</i>]</td>
			<td valign="top">Performs an unattended setup using an answer file. The answer file provides answers to some or all of the prompts that you normally respond to during Setup. (Requires /s.)</td>
		</tr>

		<tr>
			<td valign="top">/udf:<i>id</i>[,<i>UDF_file</i>]</td>
			<td valign="top">Establishes an identifier (ID) that Setup uses to specify how a Uniqueness Database File (UDF) modifies an answer file. This switch overrides answer-file values, and the identifier determines the values in the UDB file that are used. If you don't specify a UDB file, Setup prompts for the disk containing the $Unique$.udb file.</td>
		</tr>
		
	</table>
</p>

<A NAME="83"><H2>Modifying the Setup Process Using Winnt32.exe</H2></A>

<p>You can modify a server-based installation by changing how Winnt32.exe runs the setup process. Table 2.3 describes the switches that you can use with Winnt32.exe to control the setup process.</p>

<p><b>Table 2.3</b> <i>Available Switches for Winnt32.exe</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th>Switch</th>
			<th>Description</th>
		</tr>

		<tr>
			<td valign="top">/checkupgradeonly</td>
			<td valign="top">Checks the computer for upgrade compatibility with Windows 2000; for upgrade installations, it creates a report.</td>
		</tr>

		<tr>
			<td valign="top">/copydir:<i>folder_name</i></td>
			<td valign="top">Creates an additional folder within the <i>systemroot</i> folder (the folder that contains the Windows 2000 system files). For example, if your source folder contains a folder called My_drivers, type <b>/copydir:My_drivers</b> to copy the My_drivers folder to your system folder. You can use the /copydir switch to create as many additional folders as you like.</td>
		</tr>

		<tr>
			<td valign="top">/copysource:<i>folder_name</i></td>
			<td valign="top">Creates an additional folder within the <i>systemroot</i> folder. Setup deletes files created with /copysource after installation completes.</td>
		</tr>

		<tr>
			<td valign="top">/cmd: <i>command_line</i></td>
			<td valign="top">Executes a command before the final phase of Setup.</td>
		</tr>

		<tr>
			<td valign="top">/cmdcons</td>
			<td valign="top">Adds a Recovery Console option to the operating system selection screen.</td>
		</tr>
		
		<tr>
			<td valign="top">/debug[<i>level</i>] [:<i>file_name</i>]</td>
			<td valign="top">Creates a debug log at the specified level. By default, it creates C:\Winnt32.log at level 2 (the warning level).</td>
		</tr>

		<tr>
			<td valign="top">/m:<i>folder_name</i></td>
			<td valign="top">Forces Setup to copy replacement files from another location and to look in that location first. If files are present, this switch tells Setup to use those files instead of files from the default location.</td>
		</tr>

		<tr>
			<td valign="top">/makelocalsource</td>
			<td valign="top">Forces Setup to copy all installation files to the local hard disk. Use this switch when installing Windows 2000 from a CD-ROM if you want to access installation files when the CD-ROM drive isn't available later in the installation.</td>
		</tr>

		<tr>
			<td valign="top">/noreboot</td>
			<td valign="top">Forces Setup to not restart the computer following the file copy phase, which enables a command to be entered by the user prior to completing setup.</td>
		</tr>

		<tr>
			<td valign="top">/s:<i>source_path</i></td>
			<td valign="top">Specifies the source location of Windows 2000 installation files. To simultaneously copy files from multiple paths, use a separate /s switch for each source path.</td>
		</tr>
		
		<tr>
			<td valign="top">/syspart:<i>drive_letter</i></td>
			<td valign="top">Copies Setup startup files to a hard disk and marks the drive as active. You can then install the drive on another computer. When you start that computer, Setup starts at the next phase. Use of /syspart requires use of the /tempdrive switch.</td>
		</tr>

		<tr>
			<td valign="top">/tempdrive:<i>drive_letter</i></td>
			<td valign="top">Places temporary files on the specified drive and installs Windows 2000 on that drive.</td>
		</tr>

		<tr>
			<td valign="top">/unattend [number][:<i>answer_file</i>]</td>
			<td valign="top">Performs an unattended installation. The answer file provides your custom specifications to Setup. If you don't specify an answer file, all user settings are taken from the previous installation.<p>You can specify the number of seconds between the time that Setup finishes copying the files and when it restarts. You can specify the number of seconds only on a computer running Windows 2000 that is upgrading to a later version of Windows 2000.</p></td>

		</tr>

		<tr>
			<td valign="top">/udf:id[,<i>udf_file</i>]</td>
			<td valign="top">Indicates an identifier (ID) that Setup uses to specify how a Uniqueness Database File (UDF) modifies an answer file. The .UDF file overrides values in the answer file, and the identifier determines which values in the .UDF file are used. For example, /udf:RAS_user, Our_company.udf overrides settings that are specified for the RAS_user identifier in the Our_company.udf file. If you don't specify a .UDF file, Setup prompts the user to insert a disk that contains the $Unique$.udf file.</td>
		</tr>
		
	</table>
</p>

<A NAME="84"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that the main difference between an over-the-network installation and an installation from a CD-ROM is the location of the source files. Once you connect to the shared folder containing the source files and start Winnt.exe or Winnt32.exe, the installation proceeds like an installation from a CD-ROM. Several switches are available for Winnt.exe and for Winnt32.exe to modify the installation process.</p>

</BODY>
</HTML>






