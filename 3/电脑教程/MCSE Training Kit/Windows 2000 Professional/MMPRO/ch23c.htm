<HTML>
<HEAD>
<TITLE>Lesson 2: Using Disk Duplication to Deploy Windows 2000</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch23b.htm", "ch23d.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="784"><H1>Lesson 2: Using Disk Duplication to Deploy Windows 2000</H1></A>

<p>When you install Windows 2000 on several computers with identical hardware configurations, the most efficient installation method to use is disk duplication. By creating a disk image of a Windows 2000 installation and copying that image to multiple destination computers, you save time in the rollout of Windows 2000. This method also creates a convenient baseline that you can easily copy again to a computer that is experiencing significant problems.</p>

<p>Disk imaging and duplication technologies are improved in Windows 2000. 
One of the tools that you will use for disk duplication is the improved System Preparation tool (Sysprep.exe) that now ships with Windows 2000. Knowing 
how to use this tool can help support professionals prepare master disk images for efficient mass installations. You can use a number of third-party disk-imaging tools to copy the image to other computers. This lesson explains how to use the System Preparation tool to prepare the master image.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Install and use the Windows 2000 System Preparation tool to deploy Windows 2000 Professional.</li></p>
</ul>

<p><b>Estimated lesson time: 25 minutes</b></p>
</blockquote></div></p>

<A NAME="785"><H2>Examining the Disk Duplication Process</H2></A>

<p>To install Windows 2000 by using disk duplication, you first need to install 
and configure Windows 2000 on a test computer. After you have done this, you need to install and configure any applications and application update packs on the test computer. Then you run Sysprep.exe on the test computer to prepare the computer for duplication.</p>

<A NAME="786"><H2>Extracting the Windows 2000 System Preparation Tool</H2></A>

<p>Before you can use the Windows 2000 System Preparation tool, you must copy the necessary files onto the computer you are using to create the master image. To copy the System Preparation tool, you must extract the files from the Deploy.cab file in the Support\Tools folder on the Windows 2000 Professional CD-ROM. For the steps to do this, see Exercise 1, &quot;<A HREF="ch23b.htm#781">Extracting the Windows 2000 Deployment Tools</A>,&quot; in Lesson 1 of this chapter.</p>

<A NAME="787"><H2>Using the System Preparation Tool to Prepare the Master Image</H2></A>

<p>The System Preparation tool was developed to eliminate several problems you might encounter when copying disks. First of all, every computer must have a unique security ID (SID). If you copied an existing disk image to other computers, every computer on which the image was copied would have the same SID. To prevent this problem, the System Preparation tool adds a system service to the master image that will create a unique local domain SID the first time the computer to which the master image is copied is started.</p>

<p>The System Preparation tool also adds a Mini-Setup wizard to the master copy. The Mini-Setup wizard runs the first time the computer to which the master 
image is copied is started. The Mini-Setup wizard guides the user through entering such user-specific information as the following:</p>

<ul>
<p><li>End-user license agreement</li></p>

<p><li>Product ID</li></p>

<p><li>Regional settings</li></p>

<p><li>User name</li></p>

<p><li>Company name</li></p>

<p><li>Network configuration</li></p>

<p><li>Whether the computer is joining a workgroup or domain</li></p>

<p><li>Time zone selection</li></p>
</ul>

<p><div class="note"><blockquote><b>NOTE</b><HR>The Mini-Setup wizard can be scripted so that this user-specific information can be entered automatically.</blockquote></div></p>

<p>The System Preparation tool causes the master image to force the computer on which the master image is copied to run a full Plug and Play device detection. The hard disk controller device driver and the hardware abstraction layer (HAL) on the computer on which the disk image was generated and on the computer to which the disk image was copied must be identical. The other peripherals, such as the network adapter, the video adapter, and sound cards on the computer on which the disk image was copied, need not be identical to the ones on the computer on which the image was generated.</p>

<p>The System Preparation tool can also be customized; Table 23.1 describes the switches that you can use to customize Sysprep.exe.</p>

<p><b>Table 23.1</b> <i>Available Switches for Sysprep.exe</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>Switch</th>
<th>Description</th>
</tr>
<tr>
<td valign="top">/quiet</td>
<td valign="top">Runs with no user interaction</td>
</tr>
<tr>
<td valign="top">/pnp</td>
<td valign="top">Forces Setup to detect Plug and Play devices on the destination computers</td>
</tr>
<tr>
<td valign="top">/reboot</td>
<td valign="top">Restarts the source computer</td>
</tr>
<tr>
<td valign="top">/nosidgen</td>
<td valign="top">Doesn't regenerate SIDs on the destination computers</td>
</tr>
</table>
</p>

<p>
<img src="images/practic.JPG" width=92 height=74 border="0">
</p>

<A NAME="788"><H2>Practice: Using the System Preparation Tool to Create a Master Disk Image</H2></A>

<p>In this practice, you will use the Windows 2000 System Preparation tool to prepare a master image for disk duplication.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>If you haven't completed <a href="ch23b.htm#781">Exercise 1</a> of Lesson 1 in this chapter, you must complete that exercise and extract the System Preparation tool from the Windows 2000 CD-ROM before you can complete the following exercise.</blockquote></div></p>

<p><div class="caution"><blockquote>
<b>CAUTION</b><hr>If you complete the following exercise, you will have to reinstall 
Windows 2000 Professional on your computer.
</blockquote></div></p>



<p><li> <b>To use the System Preparation tool</b></li></p>
<ol>

<p><li> Log on as Administrator.</li></p>

<p><li> In Windows Explorer, double-click the Sysprep.exe file in the Deploy folder.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you didn't extract the deployment tools to the Deploy folder on your system drive (C), use the correct path to Sysprep.
</blockquote></div>
</p>

<ol>
<p>A Windows 2000 System Preparation Tool message box appears, warning you that running Sysprep might modify some of the security parameters of this system.</p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you run Sysprep on your computer, you will lose some of the security parameters on your computer.
</blockquote></div>
</p>

<ol>
<p><li value="3"> If you are certain that you don't mind having to reinstall Windows 2000 Professional, click OK to continue.</li></p>

<p><li> Your computer shuts down and prompts you to turn it off.</li></p>

<p><li> Turn your computer off.</li></p>
</ol>

<p><div class="note"><blockquote><b>NOTE</b><HR>You can run the Setup Manager Wizard to create a Sysprep.inf file. Sysprep.inf provides answers to the Mini-Setup wizard on the destination 
computers. You can also use this file to specify customized drivers. The Setup 
Manager Wizard creates a Sysprep folder at the root of the drive image and places Sysprep.inf in this folder. The Mini-Setup wizard checks for Sysprep.inf in the Sysprep folder at the root of the drive in which Windows 2000 is being 
installed.</blockquote></div></p>


<A NAME="789"><H2>Installing Windows 2000 from a Master Disk Image</H2></A>

<p>After running Sysprep on your test computer, you are ready to run a third-party disk image copying tool to create a master disk image. Save the new disk image on a shared folder or CD-ROM. Copy this image to the multiple destination 
computers.</p>

<p>End users can then start the destination computers. The Mini-Setup wizard 
will prompt the user for computer-specific variables, such as the administrator password for the computer and the computer name. If a Sysprep.inf file was 
provided, the Mini-Setup wizard will be bypassed and the system will load 
Windows 2000 without user intervention. You can also automate the completion of the Mini-Setup wizard further by creating a Sysprep.inf file.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>When you use disk duplication, the mass storage controllers and HALs for the test computer and all destination computers must be identical.</blockquote></div></p>


<p>
<img src="images/practic.JPG" width=92 height=74 border="0">
</p>
<A NAME="790"><H2>Practice: Using the System Preparation Tool to Install Windows 2000 Professional</H2></A>

<p>In this practice, you will use a master disk image to install Windows 2000 
Professional. You have just created a master disk image. Normally you would 
use a third-party tool to copy this disk image to another computer. For the purposes of this practice, you will reinstall using the master disk image as if it were a computer that had the disk image copied to it.</p>

<p><li> <b>To install Windows 2000 from a master disk image</b></li></p>
<ol>

<p><li> Power on your computer.</li></p>

<p>After a few minutes, the Welcome To The Windows 2000 Professional Setup Wizard appears.</p>

<p><li> Click Next.</li></p>

<p>The License Agreement page appears.</p>

<p><li> Read through the license agreement, click I Accept This Agreement, and then click Next.</li></p>

<p>The Regional Settings page appears.</p>

<p><li> Ensure that the System Locale, the User Locale, and the Keyboard Layout are correct, and then click Next.</li></p>

<p>The Personalize Your Software page appears.</p>

<p><li> In the Name box, type your name; in the Organization box, type your organization name, and then click Next.</li></p>

<p>The Your Product Key Page appears.</p>

<p><li> Enter your product key, and then click Next.</li></p>

<p>The Computer Name And Administrator Password page appears.</p>

<p><li> In the Computer Name box, type <b>PRO1</b> (or type the name of your computer, if you are using another valid name for your network).</li></p>

<p><li> In the Password and Confirm Password boxes, type <b>password</b> and then click Next.</li></p>

<p>The Modem Dialing Information page appears.</p>

<p><li> Select the appropriate setting for the What Country/Region Are You In Now? option.</li></p>

<p><li> Type the appropriate code for the What Area Code (Or City Code) Are You In Now? setting.</li></p>

<p><li> Type the appropriate number for the If You Dial A Number To Get An Outside Line, What Is It? setting.</li></p>

<p><li> Select the appropriate option for The Phone System At This Location Uses, and then click Next.</li></p>

<p>The Date And Time Settings page appears.</p>

<p><li> Ensure that the Date, Time, and Time Zone settings are correct and that the Automatically Adjust Clock For Daylight Saving Changes check box is selected, if you want Windows 2000 to adjust the clock. Then click Next.</li></p>

<p>The Networking Settings page appears. This might take a few minutes.</p>

<p><li> Ensure that the default option, Typical Settings, is selected, and then click Next.</li></p>

<p>The Workgroup Or Computer Domain page appears.</p>

<p><li> Ensure that the No, This Computer Is Not On A Network Or Is On A Network Without A Domain option is selected.</li></p>

<p><li> Ensure that WORKGROUP appears in the Workgroup Or Computer Domain box, and then click Next.</li></p>

<p>The Performing Final Tasks page appears briefly, and then the Completing The Windows 2000 Setup Wizard page appears. This might take a few minutes while Setup completes.</p>

<p><li> Click Finish.</li></p>

<p>The computer restarts, and the Welcome To The Network Identification 
Wizard appears.</p>

<p><li> Click Next.</li></p>

<p>The Users Of This Computer Page appears.</p>

<p><li> Click Users Must Enter A User Name And Password To Use This Computer, and then click Next.</li></p>

<p>The Completing The Network Identification Wizard appears.</p>

<p><li> Click Finish.</li></p>

<p><li> Log on as Administrator with a password of <i>password.</i></li></p>
</ol>

<A NAME="791"><H2>Lesson Summary</H2></A>

<p>The System Preparation tool (Sysprep.exe) described in this lesson prepares the master computer to be duplicated. One of the primary functions of the System Preparation tool is to delete SIDs and all other user-specific or computer-specific information. You can use four switches to customize Sysprep.exe.</p>

<p>This lesson also showed you that after you run Sysprep.exe on the master computer, you can use a third-party tool to capture the image and copy it to the 
destination computers. When the user restarts the destination computer, the 
Mini-Setup wizard appears but requires little input to complete. You can also 
automate the completion of the Mini-Setup wizard further by creating a Sysprep.inf file.</p>

</BODY>
</HTML>






