<HTML>
<HEAD>
<TITLE>Lesson 5: Microsoft Windows 2000 Auditing</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmserver.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch11e.htm", "ch11g.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="652"><h1>Lesson 5: Microsoft Windows 2000 Auditing</h1></A>
<p>In this lesson, you will learn about Windows 2000 auditing, which is a tool for maintaining network security. Auditing allows you to track user activities and system-wide events. In addition, you will learn about audit policies and what you need to consider before you set up a policy. You will also learn how to set up auditing on resources and how to maintain security logs.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Plan an audit strategy and determine which events to audit</li></p>

<p><li>Set up auditing on Active Directory objects and on files, folders, and printers</li></p>

<p><li>Use Event Viewer to view a log and locate events</li></p>
</ul>

<b>Estimated lesson time: 75 minutes</b> 
</blockquote></div>
</p>

<A NAME="653"><h2>Overview of Windows 2000 Auditing</h2></A>
<p>Auditing in Microsoft Windows 2000 is the process of tracking both user activities and Windows 2000 activities, called events, on a computer. Through auditing, you can specify that Windows 2000 writes a record of an event to the security log. The security log maintains a record of valid and invalid logon attempts and events related to creating, opening, or deleting files or other objects. An audit entry in the security log contains the following information:</p>

<ul>
<p><li>The action that was performed</li></p>

<p><li>The user who performed the action</li></p>

<p><li>The success or failure of the event and then the event occurred</li></p>
</ul>

<A NAME="654"><h3>Using an Audit Policy</h3></A>
<p>An audit policy defines the types of security events that Windows 2000 records in the security log on each computer. The security log allows you to track the events that you specify.</p>

<p>Windows 2000 writes events to the security log on the computer where the event occurs. For example, you can configure auditing so that any time someone tries to log on to the domain by using a domain user account and the logon attempt fails, Windows 2000 writes an event to the security log on the domain controller. The event is recorded on the domain controller rather than on the computer at which the logon attempt was made, because it is the domain controller that attempted to and could not authenticate the logon attempt.</p>

<p>You can set up an audit policy for a computer to do the following:</p>

<ul>
<p><li>Track the success and failure of events, such as logon attempts by users, an attempt by a particular user to read a specific file, changes to a user account or to group memberships, and changes to your security settings.</li></p>

<p><li>Eliminate or minimize the risk of unauthorized use of resources.</li></p>
</ul>

<p>You can use Event Viewer to view events that Windows 2000 has recorded in the security log. You can also archive log files to track trends over time&#8212;for example, to determine the use of printers or files or to verify attempts at unauthorized use of resources.</p>

<A NAME="655"><h2>Planning an Audit Policy</h2></A>
<p>When you plan an audit policy, you must determine the computers on which to set up auditing. Auditing is turned off by default. As you are determining which computers to audit, you must also plan what to audit on each computer. Windows 2000 records audited events on each computer separately.</p>

<p>The types of events that you can audit include the following:</p>

<ul>
<p><li>Access to files and folders</li></p>

<p><li>Users logging on and off</li></p>

<p><li>Shutting down and restarting a computer running Windows 2000 Server</li></p>

<p><li>Changes to user accounts and groups</li></p>

<p><li>Attempts to make changes to Active Directory objects</li></p>
</ul>

<p>After you have determined the types of events to audit, you must determine whether to audit the success and/or failure of events. Tracking successful events can tell you how often Windows 2000 users or services gain access to specific files, printers, or other objects. You can use this information for resource planning. Tracking failed events can alert you to possible security breaches. For example, if you notice a lot of failed logon attempts by a certain user account, especially if these attempts are occurring outside normal business hours, an unauthorized person might be attempting to break into your system.</p>

<p>Consider the following guidelines in determining your audit policy:</p>

<ul>
<p><li>Determine if you need to track trends of system usage. If so, plan to archive event logs. Archiving these logs allows you to view how usage changes over time and allows you to plan to increase system resources before they become a problem.</li></p>

<p><li>Review security logs frequently. You should set a schedule and regularly review security logs because configuring auditing alone does not alert you to security breaches.</li></p>

<p><li>Define an audit policy that is useful and manageable. Always audit sensitive and confidential data. Audit only those events that will provide you with meaningful information about your network environment. This minimizes usage of server resources and makes essential information easier to locate. Auditing too many types of events can create excess overhead for Windows 2000.</li></p>

<p><li>Audit resource access by the Everyone group instead of the Users group. This ensures that you audit anyone who can connect to the network, not just the users for whom you create user accounts in the domain.</li></p>
</ul>

<A NAME="656"><h2>Implementing an Audit Policy</h2></A>
<p>Auditing is a powerful tool for tracking events that occur on computers in your organization. To implement auditing, you must consider auditing requirements and set the audit policy. After you set an audit policy on a computer, you can implement auditing on files, folders, printers, and Active Directory objects.</p>

<A NAME="657"><h3>Configuring Auditing</h3></A>
<p>You can implement an audit policy based on the role of the computer in the Windows 2000 network. Auditing is configured differently for the following types of computers running Windows 2000:</p>

<ul>
<p><li>For member or stand-alone servers or computers running Windows 2000 Professional, an audit policy is set for each individual computer. For example, to audit user access to a file on a member server, you set the audit policy on that computer.</li></p>

<p><li>For domain controllers, an audit policy is set for all domain controllers in the domain. To audit events that occur on domain controllers, such as changes to Active Directory objects, you configure a group policy for the domain, which applies to all domain controllers.</li></p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The types of events that you can audit on a domain controller are identical to those you can audit on a computer that is not a domain controller. The procedure is similar as well, but you use a group policy for the domain to control auditing for domain controllers.
</blockquote></div>
</p>

<p><b>Auditing Requirements</b></p>

<p>The requirements to set up and administer auditing are as follows:</p>

<ul>
<p><li>You must have the Manage Auditing And Security Log permission for the computer where you want to configure an audit policy or review an audit log. Windows 2000 grants these rights to the Administrators group by default.</li></p>

<p><li>The files and folders to be audited must be on NTFS volumes.</li></p>
</ul>

<p><b>Setting Up Auditing</b></p>

<p>Setting up auditing is a two-part process:</p>

<ul>
<p><li><b>Setting the audit policy</b> The audit policy enables auditing of objects but does not activate auditing of specific objects.</li></p>

<p><li><b>Enabling auditing of specific resources</b> You identify the specific events to audit for files, folders, printers, and Active Directory objects. Windows 2000 then tracks and logs the specified events.</li></p>
</ul>

<A NAME="658"><h3>Setting an Audit Policy</h3></A>
<p>The first step in implementing an audit policy is selecting the types of events that Windows 2000 audits. For each event that you can audit, the configuration settings indicate whether to track successful or failed attempts. You can set audit policies by using the Group Policy snap-in.</p>

<p>The following table describes the types of events that Windows 2000 can audit.</p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th>Event</th>
			<th>Description</th>
		</tr>

		<tr>
			<td valign="top">Account logon events</td>
			<td valign="top">A domain controller received a request to validate a user account.</td>
		</tr>

		<tr>
			<td valign="top">Account management</td>
			<td valign="top">An administrator created, changed, or deleted a user account or group. A user account was renamed, disabled, or enabled, or a password was set or changed.</td>
		</tr>

		<tr>
			<td valign="top">Directory service access</td>
			<td valign="top">A user gained access to an Active Directory object. You must configure specific Active Directory objects for auditing to log this type of event.</td>
		</tr>

		<tr>
			<td valign="top">Logon events</td>
			<td valign="top">A user logged on or logged off, or a user made or canceled a network connection to the computer.</td>
		</tr>

		<tr>
			<td valign="top">Object access</td>
			<td valign="top">A user gained access to a file, folder, or printer. You must configure specific files, folders, or printers for auditing. Directory service access is auditing a user's access to specific Active Directory objects. Object access is auditing a user's access to files, folders, and printers.</td>
		</tr>
		
		<tr>
			<td valign="top">Policy change</td>
			<td valign="top">A change was made to the user security options, user rights, or audit policies.</td>
		</tr>

		<tr>
			<td valign="top">Privilege use</td>
			<td valign="top">A user exercised a right, such as changing the system time. (This does not include rights that are related to logging on and logging off.)</td>
		</tr>

		<tr>
			<td valign="top">Process tracking</td>
			<td valign="top">A program performed an action. This information is generally useful only for programmers who want to track details of program execution.</td>
		</tr>

		<tr>
			<td valign="top">System</td>
			<td valign="top">A user restarted or shut down the computer, or an event occurred that affects Windows 2000 security or the security log. (For example, the audit log is full and Windows 2000 discards entries.)</td>
		</tr>
		
	</table>
</p>

<p>To set an audit policy on a computer that is not a domain controller, create a custom MMC console and add the Group Policy snap-in. In the console tree, select Audit Policy from the Computer Configuration node, as shown in Figure 11.18. The console displays the current audit policy settings in the details pane.</p>

<p>
<A HREF="javascript:fullSize('f11xx18x.htm')"> <img src="images/f11xx18.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 11.18</b> <i>Group Policy snap-in with the Audit Policy folder selected</i><!--/caption-->
</p>

<p>Changes that you make to your computer's audit policy take effect when one of the following events occurs:</p>

<ul>
<p><li>You initiate policy propagation by typing <b>secedit /RefreshPolicy machine_policy</b> at the command prompt and then pressing Enter.</li></p>

<p><li>You restart your computer. Windows 2000 applies changes that you made to your audit policy the next time that you restart your computer.</li></p>

<p><li>Policy propagation occurs. Policy propagation is a process that applies policy settings, including audit policy settings, to your computer. Automatic policy propagation occurs at regular, configurable intervals. By default, policy propagation occurs every eight hours.</li></p>
</ul>

<A NAME="659"><h3>Auditing Access to Files and Folders</h3></A>
<p>If security breaches are an issue for your organization, you can set up auditing for files and folders on NTFS partitions. To audit user access to files and folders, you must first enable the Audit object access policy, which includes files and folders.</p>

<p>Once you have set your audit policy to audit object access, you enable auditing for specific files and folders and specify which types of access, by which users or groups, to audit. To enable auditing for a specific file or folder, open the Properties dialog box for that file or folder, select the Security tab, and then click Advanced. Select the Auditing tab and configure auditing for the selected file or folder.</p>

<A NAME="660"><h3>Auditing Access to Active Directory Objects</h3></A>
<p>To audit Active Directory object access, you must configure an audit policy and then set auditing for specific objects, such as users, computers, organizational units (OUs), or groups by specifying which types of access and access by which users to audit.</p>

<p>To enable auditing of access to Active Directory objects, enable the Audit directory services access policy in the Group Policy snap-in.</p>

<p>To enable auditing for specific Active Directory objects, open the Active Directory Users And Computers snap-in and select Advanced Features from the View menu. Open the Properties dialog box for the object that you want to audit. On the Security tab, click Advanced. Select the Auditing tab and configure auditing for that object.</p>

<A NAME="661"><h3>Auditing Access to Printers</h3></A>
<p>You can audit access to printers in order to track access to sensitive printers. To audit access to printers, enable the Audit Object Access policy, which includes printers. Then enable auditing for specific printers, and specify which types of access and access by which users to audit. After you select the printer, you use the same steps that you use to set up auditing on files and folders.</p>

<p>To set up auditing on a printer, open the Properties dialog box for the printer that you want to audit. On the Security tab, click Advanced. Select the Auditing tab and configure auditing for the printer.</p>

<A NAME="662"><h2>Using Event Viewer</h2></A>
<p>You can use Event Viewer to perform a variety of tasks, including viewing the audit logs that are generated as a result of setting audit policies and auditing events. You can also use Event Viewer to view the contents of security log files and find specific events within log files.</p>

<A NAME="663"><h3>Windows 2000 Logs</h3></A>
<p>You can use Event Viewer to view information contained in Windows 2000 logs. By default there are three logs available to view in Event Viewer. These logs are described in the following table.</p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th>Log</th>
			<th>Description</th>
		</tr>

		<tr>
			<td valign="top">Application log</td>
			<td valign="top">Contains errors, warnings, or information that programs, such as a database program or an e-mail program, generate. The program developer presets which events to record.</td>
		</tr>

		<tr>
			<td valign="top">Security log</td>
			<td valign="top">Contains information about the success or failure of audited events. The events that Windows 2000 records are a result of your audit policy.</td>
		</tr>

		<tr>
			<td valign="top">System log</td>
			<td valign="top">Contains errors, warnings, and information that Windows 2000 generates. Windows 2000 presets which events to record.</td>
		</tr>
		
	</table>
</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
If additional services are installed, they might add their own event log. For example, the Domain Name System (DNS) service logs DNS events in the DNS Server log.
</blockquote></div>
</p>

<A NAME="664"><h3>Viewing the Security Log</h3></A>
<p>The Security log contains information about events that are monitored by an audit policy, such as failed and successful logon attempts. You can view the Security log in the Event Viewer snap-in, as shown in Figure 11-19.</p>

<p>
<A HREF="javascript:fullSize('f11xx19x.htm')"> <img src="images/f11xx19.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 11.19</b> <i>Event Viewer snap-in with the Security Log selected</i><!--/caption-->
</p>

<p>In the details pane, Event Viewer displays a list of log entries and summary information for each item.</p>

<p>Successful events appear with a key icon, and unsuccessful events appear with a lock icon. Other important information includes the date and time that the event occurred, the category of the event, and the user who generated the event. The category indicates the type of event, such as object access, account management, directory service access, or logon events.</p>

<p>Windows 2000 records events in the Security log on the computer at which the event occurred. You can view these events from any computer as long as you have administrative privileges for the computer where the events occurred. To view the security log on a remote computer, point Event Viewer to a remote computer when you add this snap-in to a console.</p>

<A NAME="665"><h3>Locating Events</h3></A>
<p>When you first start Event Viewer, it automatically displays all events that are recorded in the selected log. To change what appears in the log, you can locate selected events by using the Filter command. You can also search for specific events by using the Find command. To filter or find events, start Event Viewer, and click Filter or click Find on the View menu.</p>

<A NAME="666"><h3>Managing Audit Logs</h3></A>
<p>You can track trends in Windows 2000 by archiving event logs and comparing logs from different periods. Viewing trends helps you determine resource use and plan for growth. If unauthorized use of resources is a concern, you can also use logs to determine patterns of usage. Windows 2000 allows you to control the size of the logs and to specify the action that Windows 2000 takes when a log becomes full.</p>

<p>You can configure the properties of each individual audit log. To configure the settings for logs, select the log in Event Viewer, and then display the Properties dialog box for the log.</p>

<p>Use the Properties dialog box for each type of audit log to control the size of each log, which can be from 64 KB to 4,194,240 KB (4 GB). The default size is 512 KB. You can also use the log properties to control the action that Windows 2000 takes when the log fills up.</p>

<p>
<div class="tip"><blockquote><b>TIP</b><hr>
Use the Security Configuration And Analysis snap-in to configure settings for Event Viewer.
</blockquote></div>
</p>

<A NAME="667"><h3>Archiving Logs</h3></A>
<p>Archiving security logs allows you to maintain a history of security-related events. Many companies have policies on keeping archive logs for a specified period to track security-related information over time. If you want to save the log file, clear all events, or open a log file, select the log from the Event Viewer console tree and then select the appropriate option from the Action menu.</p>

<A NAME="668"><h2>Lesson Summary</h2></A>
<p>Auditing in Microsoft Windows 2000 is the process of tracking both user activities and Windows 2000 activities, called events, on a computer. Through auditing, you can specify that Windows 2000 writes a record of an event to the Security log. An audit policy defines the types of security events that Windows 2000 records in the Security log on each computer. The Security log allows you to track the events that you specify. When you plan an audit policy you must determine the computers on which to set up auditing. As you are determining which computers to audit, you must also plan what to audit on each computer. To implement auditing, you need to consider auditing requirements and set the audit policy. After you set an audit policy on a computer, you can implement auditing on files, folders, printers, and Active Directory objects. You can use Event Viewer to view the audit logs that are generated as a result of setting the audit policy and auditing events. You can also use Event Viewer to view the contents
of Security log files and find specific events within log files.</p>

</BODY>
</HTML>



