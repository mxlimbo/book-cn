<html>
<head>
<title>Lesson 3: Zone Replication and Transfer</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05c.htm", "ch05e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="239"><h1>Lesson 3: Zone Replication and Transfer</h1></A>
<p>This lesson introduces zone replication and transfer. <i>Zone transfer</i> is the process by which DNS servers interact to maintain and synchronize authoritative name data.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li> Explain the purpose of zone transfers</li></p>

<p><li> Configure zone transfers</li></p>
</ul>

<b>Estimated lesson time: 10 minutes</b>
</blockquote></div>
</p>

<A NAME="240"><h2>Zone Replication and Zone Transfers</h2></A>
<p>Because of the important role that zones play in DNS, it is intended that they be available from more than one DNS server on the network to provide availability and fault tolerance when resolving name queries. Otherwise, if a single server is used and that server is not responding, queries for names in the zone can fail. For additional servers to host a zone, zone transfers are required to replicate and synchronize all copies of the zone used at each server configured to host the zone.</p>

<p>When structuring your zones, there are several good reasons to use additional DNS servers for zone replication:</p>

<ul>
<p><li> Added DNS servers provide zone redundancy, enabling DNS names in the zone to be resolved for clients if a primary server for the zone stops responding.</li></p>

<p><li> Added DNS servers can be placed to reduce DNS network traffic. For example, adding a DNS server to the opposing side of a low-speed wide area network (WAN) link can be useful in managing and reducing network traffic.</li></p>

<p><li> Additional secondary servers can be used to reduce loads on a primary server for a zone.</li></p>
</ul>

<p>When a new DNS server is added to the network and is configured as a new 
secondary server for an existing zone, it performs a <i>full zone transfer (AXFR)</i> to obtain and replicate a full copy of resource records for the zone. For earlier DNS server implementations, this same method of full transfer for a zone is also used when the zone requires updating after changes are made to the zone. For 
Windows 2000 Server, the DNS service supports <i>incremental zone transfer (IXFR)</i>, a revised DNS zone transfer process for intermediate changes.</p>

<A NAME="241"><h3>Incremental Zone Transfers</h3></A>
<p>IXFR is described in RFC 1995 as an additional DNS standard for replicating DNS zones. IXFRs provide a more efficient method of propagating zone changes and updates.</p>

<p>In earlier DNS implementations, any request for an update of zone data required a full transfer of the entire zone database using an AXFR query. With incremental transfer, an IXFR query is used instead. IFXR allows the secondary server to pull only those zone changes it needs to synchronize its copy of the zone with its source, either a primary or secondary copy of the zone maintained by another DNS server.</p>

<p>With IXFR zone transfers, differences between the source and replicated versions of the zone are first determined. If the zones are identified to be the same version&#8212;as indicated by the serial number field in the SOA resource record of each zone&#8212;no transfer is made.</p>

<p>If the serial number for the zone at the source is greater than at the requesting secondary server, a transfer is made of only those changes to resource records for each incremental version of the zone. For an IXFR query to succeed and changes to be sent, the source DNS server for the zone must keep a history of incremental zone changes to use when answering these queries. The incremental transfer 
process requires substantially less traffic on a network and zone transfers are completed much faster.</p>

<A NAME="242"><h3>Example: Zone Transfer</h3></A>
<p>In addition to a manual initiation, a zone transfer occurs during any of the 
following scenarios:</p>

<ul>
<p><li> When starting the DNS service on the secondary server for a zone</li></p>

<p><li> When the refresh interval time expires for the zone</li></p>

<p><li> When changes are made to the primary zone and a notify list is configured</li></p>
</ul>

<p>Zone transfers are always initiated by the secondary server for a zone and sent to the DNS server configured as its source for the zone. This DNS server can be any other DNS server that loads the zone, either a primary or another secondary server. When the source server receives the request for the zone, it can reply with either a partial or full transfer of the zone.</p>

<p>As shown in Figure 5.6, zone transfers between servers follow an ordered 
process. This process varies depending on whether a zone has been previously replicated or if initial replication of a new zone is being performed.</p>

<p>
<A HREF="javascript:fullSize('05wtk06x.htm')"> <img src="images/05wtk06.JPG" width=404 height=142 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 5.6</b> <i>Zone transfer process</i><!-- /caption -->
</p>


<p>In this example, the following sequence is performed for a requesting secondary server&#8212;the destination server&#8212;for a zone and its source server, another DNS server that hosts the zone.</p>

<ol>
<p><li> During new configuration, the destination server sends an initial (AXFR) transfer request for the zone to the DNS server configured as its source for the zone.</li></p>

<p><li> The source server responds and fully transfers the zone to the destination server.</li></p>

<p>The zone is delivered to the server requesting the transfer with its version 
established by use of a serial number field in the properties for the SOA 
resource record. The SOA record also contains a stated refresh interval in 
seconds (by default, 15 minutes) to indicate when the destination server should next request renewal of the zone with the source server.</p>

<p><li> When the refresh interval expires, the destination server requests renewal of the zone from the source server with an SOA query.</li></p>

<p><li> The source server answers the query for its SOA record.</li></p>

<p>This response contains the serial number for the zone in its current state at the source server.</p>

<p><li> The destination server checks the serial number of the SOA record in the response and determines how to renew the zone.</li></p>

<p>If the value of the serial number in the SOA response is equal to its current local serial number, it concludes the zone is the same at both servers and a zone transfer is not needed. The destination server then renews the zone by resetting its refresh interval based on the value of this field in the SOA 
response from its source server.</p>

<p>If the value of the serial number in the SOA response is higher than its current local serial number, it concludes that the zone has been updated and a transfer 
is needed.</p>

<p><li> If the destination server concludes the zone has changed, it sends an IXFR query to the source server containing its current local value for the serial number in the SOA record for the zone.</li></p>

<p><li> The source server responds with either an incremental or full transfer of the zone.</li></p>

<p>If the source server supports incremental transfer by maintaining a history of recent and incremental zone changes for modified resource records, it can 
answer with an incremental (IXFR) transfer of the zone.</p>

<p>If the source server does not support incremental transfer or does not have 
a history of zone changes, it can, alternatively, answer with a full (AXFR) transfer of the zone instead.</p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
For Windows 2000 Server, incremental zone transfer through IXFR query is supported. For earlier versions of the DNS service running in Windows NT Server 4.0, and for many other DNS server implementations, incremental zone transfer is not available and only full-zone (AXFR) queries and transfers are used to replicate zones.</blockquote></div>
</p>

<A NAME="243"><h3>Zone Transfer Security</h3></A>
<p>The DNS console permits you to specify the servers allowed to participate in zone transfers. This can help prevent an undesired attempt by an unknown or 
unapproved DNS server to pull, or request, zone updates.</p>

<p><li> <b>To specify servers allowed to participate in zone transfers</b></li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click DNS.</li></p>

<p><li> In the DNS console tree, right-click the zone for which you want to set up zone transfers, and then click Properties.</li></p>

<p><li> Select the Zone Transfers tab (see Figure 5.7).</li></p>

<p>
<img src="images/05wtk07.JPG" width=404 height=466 border="0">
</p><p>
<!-- caption --><b>Figure 5.7</b> <i>The Zone Transfers tab</i><!-- /caption -->
</p>


<p><li> Specify the servers for which you want to allow zone transfers, then click OK.</li></p>
</ol>

<A NAME="244"><h2>DNS Notification</h2></A>
<p>The DNS service supports DNS notification, which is an updated revision to the DNS standard specification (RFC 1996). DNS notification implements a push mechanism for notifying a select set of secondary servers for a zone when a zone is updated. The notified servers can then initiate the zone transfer process and pull changes from the notifying server to update the zone.</p>

<p>Use DNS notification only to notify DNS servers that are operating as secondary servers for a zone. For replication of directory-integrated zones, DNS notification is not needed. This is because any DNS servers that load a zone from Active 
Directory automatically poll the directory approximately once every 15 minutes (depending on the SOA refresh interval setting) to update and refresh the zone. In these cases, configuring a notification list can actually degrade system performance by causing unnecessary additional transfer requests for the updated zone.</p>

<p><li> <b>To specify servers to be notified</b></li></p>

<ol>

<p><li> Click Start, point to Programs, point to Administrative Tools, and then click DNS.</li></p>


<p><li> In the DNS console tree, right-click the zone for which you want to set up zone transfers, and then click Properties.</li></p>

<p><li> Select the Zone Transfers tab, then click Notify.</li></p>

<p><li> In the Notify dialog box (see Figure 5.8), specify the secondary servers to be notified when the zone changes, then click OK.</li></p>
<p>
<img src="images/05wtk08.JPG" width=384 height=379 border="0">
</p><p>
<!-- caption --><b>Figure 5.8</b> <i>The Notify dialog box</i><!-- /caption -->
</p>

</ol>

<A NAME="245"><h2>The DNS Notify Process</h2></A>
<p>The following is a brief summary of the typical DNS Notify process:</p>

<ol>
<p><li> The local zone on a DNS server acting as a source for the zone to other servers is updated. When the zone is updated at the source, the serial number field in the SOA record also updates, indicating a new local version of the zone.</li></p>

<p><li> The source server sends a notify message to other servers specified on the Notify screen.</li></p>

<p><li> All secondary servers that receive the notification message can then respond by initiating a zone transfer request back to the notifying server. The normal zone transfer process can then continue as described in the previous section.</li></p>
</ol>

<A NAME="246"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned how zone transfers are required to replicate and synchronize all copies of the zone used at each server configured to host the zone. For earlier DNS server implementations, when a new DNS server is added to the network and is configured as a new secondary server for an existing zone, it 
performs a full initial transfer of the zone to obtain and replicate a full copy of resource records for the zone. For Windows 2000 Server, the DNS service 
supports incremental zone transfer, a revised, more efficient DNS zone transfer process for intermediate changes.</p>

<p>You also learned how the DNS console permits you to specify the servers allowed to participate in zone transfers. Finally, you learned how DNS notification implements a push mechanism for notifying a select set of secondary servers for a zone when a zone is updated. The notified servers can then initiate the zone transfer process and pull changes from the notifying server to update the zone. The DNS console allows you to specify the secondary servers for notification; for replication of directory-integrated zones, DNS notification is not needed.</p>

</BODY>
</HTML>







