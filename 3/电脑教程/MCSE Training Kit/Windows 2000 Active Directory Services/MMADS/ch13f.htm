<html>
<head>
<title>Lesson 5: Using Security Templates</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch13e.htm", "ch13g.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="739"><h1>Lesson 5: Using Security Templates</h1></A>
<p>Windows 2000 provides a centralized method of defining security using security templates. This lesson explains how to use security templates.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li> Explain the purpose of security templates</li></p>

<p><li> Explain the purpose of the predefined security templates</li></p>

<p><li> Manage security templates</li></p>
</ul>

<p><b>Estimated lesson time: 25 minutes</b></p>
</blockquote></div>
</p>

<A NAME="740"><h2>Security Templates Overview</h2></A>
<p>A <i>security template</i> is a physical representation of a security configuration, a single file where a group of security settings is stored. Locating all security 
settings in one place streamlines security administration. Each template is saved as a text-based .inf file. This allows you to copy, paste, import, or export some or all of the template attributes. With the exceptions of IP Security and Public Key policies, all security attributes can be contained in a security template.</p>

<A NAME="741"><h2>Security Template Uses</h2></A>
<p>You can import (apply) a security template file to a local or nonlocal GPO. 
Any computer or user accounts in the site, domain, or OU to which the GPO is 
applied will receive the security template settings. Importing a security template to a GPO eases domain administration by configuring security for multiple 
computers at once.</p>

<p>The security settings in the local GPO are the initial settings applied to a 
computer. You can export the local security settings to a security template file to preserve initial system security settings. This enables the restoration of the initial security settings at any later point.</p>

<A NAME="742"><h2>Predefined Security Templates</h2></A>
<p>Windows 2000 includes a set of predefined security templates, each based on the role of a computer and common security scenarios: from security settings for low-security domain clients to highly secure domain controllers. These templates can be used as provided, they can be modified, or they can serve as a basis for creating custom security templates. Do not apply predefined security templates to production systems without testing to ensure that the right level of application functionality is maintained for your network and system architecture.</p>

<p>The predefined security templates are</p>

<ul>
<p><li> Default domain controller security settings (BASICDC.INF)</li></p>

<p><li> Default server security settings (BASICSV.INF)</li></p>

<p><li> Default workstation security settings (BASICWK.INF)</li></p>

<p><li> Compatible workstation or server security settings (COMPATWS.INF)</li></p>

<p><li> Default security settings updated for domain controllers (DC SECURITY.INF)</li></p>

<p><li> Highly secure domain controller security settings (HISECDC.INF)</li></p>

<p><li> Highly secure workstation or server security settings (HISECWS.INF)</li></p>

<p><li> Removes the Terminal Server User SID from Windows 2000 server (NOTSSID.INF)</li></p>

<p><li> Optional Component File Security for server (OCFILESS.INF)</li></p>

<p><li> Optional Component File Security for workstation (OCFILESW.INF)</li></p>

<p><li> Secure domain controller security settings (SECUREDC.INF)</li></p>

<p><li> Secure workstation or server security settings (SECUREWS.INF)</li></p>

<p><li> Out of the box default security settings (SETUP SECURITY.INF)</li></p>
</ul>

<p>By default, these templates are stored in the <i>systemroot</i>\Security\Templates folder.</p>

<A NAME="743"><h3>Security Levels</h3></A>
<p>The predefined security templates are designed to cover common requirements for security:</p>

<ul>
<p><li> <b>Basic (BASIC*.INF).</b> The basic configuration templates are provided as a means to reverse the application of a different security configuration. The basic configurations apply the Windows 2000 default security settings to all security areas except those pertaining to user rights. These are not modified in the basic templates because application setup programs commonly modify user rights to enable successful use of the application. It is not the intent of the basic configuration files to undo such modifications.</li></p>

<p><li> <b>Compatible (COMPAT*.INF).</b> By default, Windows 2000 security is configured such that members of the local users group have ideal security settings and members of the local Power Users group have security settings that are compatible with Windows NT 4.0 users. This default configuration enables development of applications to a standard definition of a secure Windows environment, while still allowing existing applications to run successfully under the less secure Power User configuration. By default, all users that are authenticated by Windows 2000 are members of the Power Users group. This may be too unsecured for some environments, where it would be preferable to have users, by default, only be members of the Users group, and decrease the security on the Users group to the level where the applications run successfully. The compatible templates are designed for such environments. By lowering the security levels on specific files, folders, and registry keys that are commonly accessed by applications, the compatible templates allow most applications to run successfully. In addition, as it is assumed that the administrator applying the compatible template does not want users to be Power Users, all members of the Power Users group are removed.</li></p>

<p><li> <b>Secure (SECURE*.INF).</b> The secure templates implement recommended security settings for all security areas except files, folders, and registry keys. These are not modified because file system and registry permissions are configured securely by default.</li></p>

<p><li> <b>Highly Secure (HISEC*.INF).</b> The highly secure templates define security settings for Windows 2000 network communications. The security areas are set to require maximum protection for network traffic and protocols used between computers running Windows 2000. As a result, such computers configured with a highly secure template can only communicate with other Windows 2000 computers. They will not be able to communicate with computers running Windows 95, Windows 98, or Windows NT.</li></p>
</ul>

<A NAME="744"><h2>Managing Security Templates</h2></A>
<p>The tasks for managing security templates are</p>

<ol>
<p><li> Accessing the Security Templates console</li></p>

<p><li> Customizing a predefined security template</li></p>

<p><li> Defining a new security template</li></p>

<p><li> Importing a security template to a local and nonlocal GPO</li></p>

<p><li> Exporting security settings to a security template</li></p>
</ol>

<A NAME="745"><h3>Accessing the Security Templates Console</h3></A>
<p>The Security Templates console is the main tool for managing security templates.</p>

<p><li> <b>To access the Security Templates console</b></li></p>

<ol>
<p><li> Decide whether to add the Security Templates console to an existing console or create a new console.</li></p>

	<ul>
	<p><li> To create a new console, click Start, click Run, type <b>mmc</b>, then click OK.</li></p>
	
	<p><li> To add the Security Templates console to an existing console, open the console, then proceed to Step 2.</li></p>
	</ul>

<p><li> On the Console menu, click Add/Remove Snap-In, then click Add.</li></p>

<p><li> In the Add Standalone Snap-In dialog box, select Security Templates, click Add, click Close, then click OK.</li></p>

<p><li> On the Console menu, click Save.</li></p>

<p><li> Enter the name to assign to this console and click Save.</li></p>

<p>The console appears on the Administrative Tools menu.</p>
</ol>

<A NAME="746"><h3>Customizing a Predefined Security Template</h3></A>
<p>Customizing a predefined security template allows you to save the predefined template as a new template (to preserve the original predefined template) and then make edits to security settings to create a new template.</p>

<p><li> <b>To customize a predefined security template</b></li></p>

<ol>
<p><li> In the Security Templates console (see Figure 13.13), double-click Security Templates.</li></p>

<p>
<img src="images/13wtk12.JPG" width=400 height=383>
</p><p>
<!-- caption --><b>Figure 13.13</b> <i>The Security Templates console</i><!-- /caption -->
</p>


<p><li> Double-click the default path folder (<i>systemroot</i>\Security\Templates), right-click the predefined template you want to modify, then click Save As.</li></p>

<p><li> In the Save As dialog box, in the File Name box, specify a filename for the new security template, then click Save.</li></p>

<p><li> In the console tree, right-click the new security template, then select Set Description.</li></p>

<p><li> In the Security Template Description dialog box, enter a description for the new security template, then click OK.</li></p>

<p><li> In the console tree, double-click the new security template to display the security policies, and double-click the security policy (such as Account Policies) you want to modify.</li></p>

<p><li> Click the security policy you want to customize (such as Password Policy), then double-click the security setting to modify (such as Minimum Password Length).</li></p>

<p><li> On the Template Security Policy Setting dialog box, click the Define This Policy Setting In The Template check box to allow configuration, then configure the security setting.</li></p>

<p><li> Click OK.</li></p>

<p><li> Configure other security settings as needed.</li></p>

<p><li> Close the Security Templates console.</li></p>

<p><li> In the Save Security Templates dialog box, click Yes to save the new security template file.</li></p>
</ol>

<A NAME="747"><h3>Defining a New Security Template</h3></A>
<p>You can define a new security template and then modify the default settings to meet your requirements.</p>

<p><li> <b>To define a new security template</b></li></p>

<ol>
<p><li> In the Security Templates console, double-click Security Templates.</li></p>

<p><li> Right-click the template path folder where you want to store the new template and click New Template.</li></p>

<p><li> In the dialog box for the templates folder, enter the name and description for your new security template, then click OK.</li></p>

<p><li> In the console tree, right-click the new security template, then select Set Description.</li></p>

<p><li> In the Security Template Description dialog box, enter a description for the new security template, then click OK.</li></p>

<p><li> In the console tree, double-click the new security template to display the security policies, and double-click the security policy (such as Account Policies) you want to define.</li></p>

<p><li> Click the security policy you want to define (such as Password Policy), then double-click the security setting to define (such as Minimum Password Length).</li></p>

<p><li> In the Template Security Policy Setting dialog box, click the Define This Policy Setting In The Template check box to allow configuration, then configure the security setting.</li></p>

<p><li> Click OK.</li></p>

<p><li> Configure other security settings as needed.</li></p>

<p><li> Close the Security Templates console.</li></p>

<p><li> In the Save Security Templates dialog box, click Yes to save the new security template file.</li></p>
</ol>

<A NAME="748"><h3>Importing a Security Template to a GPO</h3></A>
<p>You can import a security template to local or nonlocal GPOs. Importing security templates make administration easier because security is configured in one step for multiple objects.</p>

<p><li> <b>To import a security template to a local and nonlocal GPO</b></li></p>

<ol>
<p><li> In a console from which you manage local or nonlocal group policy settings, click the GPO to which you want to import the security template.</li></p>

<p><li> In the console tree, right-click Security Settings, then click Import Policy.</li></p>

<p><li> In the Import Policy From dialog box (see Figure 13.14), click the security template you want to import, then click Open.</li></p>

<p>
<A HREF="javascript:fullSize('13wtk14x.htm')"> <img src="images/13wtk14.JPG" width=404 height=285 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 13.14</b> <i>The Import Policy From dialog box</i><!-- /caption -->
</p>


<p><li> Because the security settings are applied when the group policy is propagated (applied) to your computer, do one of the following to initiate policy propagation:</li></p>

	<ul>
	<p><li> Type <b>secedit /refreshpolicy machine_policy</b> at the command prompt, then press Enter.</li></p>
	
	<p><li> Restart your computer.</li></p>
	
	<p><li> Wait for automatic policy propagation, which occurs at regular, configurable intervals. By default, policy propagation occurs every eight hours.</li></p>
	</ul>
</ol>

<A NAME="749"><h3>Exporting Security Settings to a Security Template</h3></A>
<p>You can export both local and effective security settings to a security template. By exporting the local settings to a security template, you can preserve initial system settings. Because the local GPO is overridden by domain-based GPOs, the local security settings are available for restoration later, if necessary. By 
exporting the effective security settings to a security template, you can then 
import the settings into a security database (discussed in the next lesson), overlay new templates, and analyze potential conflicts.</p>

<p><li> <b>To export security settings to a security template</b></li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Local Security Policy.</li></p>

<p><li> In the console tree, right-click Security Settings, click Export Policy, and select Local Policy or Effective Policy.</li></p>

<p><li> In the Export Policy To dialog box (see Figure 13.15), enter the name of the security template to which you want to export security settings, then click Save.</li></p>

<p>
<A HREF="javascript:fullSize('13wtk15x.htm')"> <img src="images/13wtk15.JPG" width=404 height=250 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 13.15</b> <i>The Export Policy To dialog box</i><!-- /caption -->
</p>

</ol>

<p><img src="images/practic.JPG" width=92 height=74 border="0"></p>

<A NAME="750"><h2>Practice: Managing Security Templates</h2></A>
<p>In this practice you access the Security Templates console and customize a 
predefined security template.</p>

<A NAME="751"><h3>Exercise 1: Accessing the Security Templates Console</h3></A>
<p>In this exercise you access the Security Templates console, the main tool for managing security templates.</p>

<p><li> <b>To access the Security Templates console</b></li></p>

<ol>
<p><li> Click Start, click Run, type <b>mmc</b>, then click OK.</li></p>

<p><li> On the Console menu, click Add/Remove Snap-In, then click Add.</li></p>

<p><li> In the Add Standalone Snap-In dialog box, select Security Templates, click Add, click Close, then click OK.</li></p>

<p><li> On the Console menu, click Save.</li></p>

<p><li> In the File Name list, type <b>Security Templates</b> to name this console, then click Save. The console appears on the Administrative Tools menu.</li></p>
</ol>

<A NAME="752"><h3>Exercise 2: Customizing a Predefined Security Template</h3></A>
<p>In this exercise you customize a predefined security template by saving the predefined template as a new template (to preserve the original predefined template) and then making edits to security settings to create a new template.</p>

<p><li> <b>To customize a predefined security template</b></li></p>

<ol>
<p><li> In the Security Templates console, double-click Security Templates.</li></p>

<p><li> Double-click the default path folder (<i>systemroot</i>\Security\Templates), right-click the basicdc template, then click Save As.</li></p>

<p><li> In the Save As dialog box, in the File Name box, type <b>new template</b>, then click Save.</li></p>

<p><li> In the console tree, right-click New Template, then select Set Description.</li></p>

<p><li> In the Security Template Description dialog box, type the description <b>New</b> <b>domain controller template</b>, then click OK.</li></p>

<p><li> In the console tree, double-click the new security template to display the security policies.</li></p>

<p><li> Double-click Account Policies, click Password Policy, then double-click Minimum Password Length.</li></p>

<p><li> In the Template Security Policy Setting dialog box, click the Define This Policy Setting In The Template check box to allow configuration, then set the password to be at least 10 characters.</li></p>

<p><li> Click OK.</li></p>

<p><li> Close the Security Templates console and save the console settings.</li></p>

<p><li> In the Save Security Templates dialog box, click Yes to save the NEW TEMPLATE.INF security template file.</li></p>
</ol>

<A NAME="753"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned that a security template is a physical representation of a security configuration, a single file where a group of security settings is stored. Locating all security settings in one place streamlines security administration.</p>

<p>You learned that the tasks for managing security templates are accessing the 
Security Templates console, customizing a predefined security template, defining a new security template, importing a security template to a local and nonlocal GPO, and exporting security settings to a security template.</p>

<p>In the practice portion of this lesson you accessed the Security Templates 
console, the main tool for managing security templates, and customized a 
predefined security template.</p>

</BODY>
</HTML>







