<HTML>
<HEAD>
<TITLE>Lesson 1: Performing Remote Installations</TITLE>
<link rel="STYLESHEET" type="text/css" href="upwin2k.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch14a.htm", "ch14c.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="660"><H1>Lesson 1: Performing Remote Installations</H1></A>

<p>The most efficient method of deploying Windows 2000 Professional is
to use remote installation. You can perform remote installations of Windows
2000 Professional if you have a Windows 2000 Server infrastructure in place
and the computers in your network support remote boot.</p>

<p>
<div class="sidebar"><blockquote>
<p><b>After this lesson, you will be able to</b></p>

<ul>
<p><li>Describe how to deploy Windows 2000 using Remote
Installation Services.</li></p>

<p><li>Install Remote Installation Services.</li></p>

<p><li>Create a boot floppy.</li></p>
</ul>


<p><b>Estimated lesson time: 40 minutes</b></p>
</blockquote></div>
</p>

<A NAME="661"><H2>Understanding Remote Installation</H2></A>

<p><i>Remote installation</i> is the process of connecting to a server
running Remote Installation Services (RIS), called the RIS server, and then starting
an automated installation of Windows 2000 Professional on a local
computer. Remote installation enables administrators to install Windows
2000 Professional on client computers throughout a network from a
central location. This reduces the time spent by administrators
visiting all the computers in a network, thereby reducing the cost of
deploying Windows 2000 Professional.</p>

<p>RIS provides the following benefits:</p>

<ul>
<p><li>Enables remote installation of Windows 2000
Professional</li></p>

<p><li>Simplifies server image management by eliminating
hardware-specific images, and by detecting Plug and Play hardware during Setup</li></p>

<p><li>Supports recovery of the operating system and computer in
the event of computer failure</li></p>

<p><li>Retains security settings after restarting the destination
computer</li></p>

<p><li>Reduces TCO (Total Cost of Ownership) by allowing either
users or technical staff to install the operating system on individual
computers</li></p>
</ul>


<A NAME="662"><H2>Installing and Configuring Remote Installation Services</H2></A>

<p>Before beginning a rollout of Windows 2000 Professional using RIS,
you should become familiar with the prerequisites for the service and
you must install the service using the Remote Installation Services
Setup wizard.</p>

<A NAME="663"><H3>Prerequisites</H3></A>

<p>The RIS server can be a domain controller or a member server. Table
14.1 lists the network services required for RIS and their RIS
function. These network services do not have to be installed on the same computer as RIS, but
must be available somewhere on the network.</p>

<p><b>Table 14.1</b> <i>Network Services Required for RIS</i></p>

<P>
<table cellpadding=5 width="95%">
<tr> 
<th>Network service</th>
<th>RIS function</th></tr>
<tr>
<td valign="top">DNS Service</td>
<td valign="top">RIS relies on the DNS Server for locating both the directory  service and client computer accounts.</td></tr>
<tr>
<td valign="top">DHCP Service</td>
<td valign="top">Client computers that can perform a network boot receive an IP  address from the DHCP server.</td></tr>
<tr>
<td valign="top">Active Directory Directory Services </td>
<td valign="top">RIS relies upon Active Directory directory services in Windows 2000 for locating existing client computers as well as existing  RIS servers.</td></tr>
</table></p>


<p>Remote installation requires that RIS (included on the Windows 2000
Server CD-ROM) be installed on a volume that is shared over the network. This
shared volume must meet the following criteria:</p>

<ul>
<p><li>The shared volume cannot be on the same drive that is
running Windows 2000 Server.</li></p>

<p><li>The shared volume must be large enough to hold the RIS
software and the various Windows 2000 Professional images.</li></p>

<p><li>The shared volume must be formatted with the Windows 2000
NTFS file system.</li></p>
</ul>


<A NAME="664"><H3>Remote Installation Services Setup Wizard</H3></A>

<p>When your network meets the prerequisites for RIS, you can run the
Remote Installation Services Setup wizard, which does the following:</p>

<ul>
<p><li>Installs the RIS software</li></p>

<p><li>Creates the remote installation folder and copies the
Windows 2000 Professional installation files to the server</li></p>

<p><li>Adds .sif files, which are a variation of an Unattend.txt
file</li></p>

<p><li>Configures the Client Installation wizard screens that will
appear during a remote installation</li></p>

<p><li>Updates the registry</li></p>

<p><li>Creates the Single-Instance Store Volume</li></p>

<p><li>Starts the required remote installation services</li></p>
</ul>


<p>When installation of RIS is complete, you can configure RIS using
the server's computer object in Active Directory Users and
Computers. For more information on the management of Active Directory
objects, see <A HREF="ch05a.htm">Chapter 5</A>, &quot;Administering Active Directory Directory Services.&quot;</p>

<p>The RIS server stores the RIS images used to automatically install
Windows 2000 Professional on client computers that are enabled for
remote boot. The RIS server can be a domain controller or a standalone
server that is a member of a domain containing Active Directory
directory services.</p>

<p>
<img src="images/practic.JPG" width=68 height=54 border="0">
</p>

<A NAME="665"><H2>Practice: Installing RIS</H2></A>

<p>In this practice, you install Windows 2000 Remote Installation
Services from a Windows 2000 Server CD-ROM.</p>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
To complete this exercise you need to have a
Windows 2000 Professional CD-ROM or access to a shared folder that
contains the Windows 2000 Professional installation files. You must
also have a drive on the computer on which you installed RIS that is
formatted with NTFS version 5.0 or later and that contains enough room
to hold the Windows 2000 Professional installation files.
</blockquote></div>
</p>

<A NAME="666"><H3>Exercise 1: Installing Remote Installation Services</H3></A>

<p>In this exercise, you install the Remote Installation Services on a
computer running Windows 2000 Server.</p>


<p><li><b> To install Remote Installation Services</b></li></p>

<ol>
<p><li>Log on as Administrator, and insert the Windows 2000 Server
CD-ROM into your CD-ROM drive.</li></p>

<p><li>Open Control Panel, and double-click Add/Remove Programs.</li></p>


<p>The Add/Remove Programs window appears.</p>


<p><li>Click Add/Remove Windows Components.</li></p>


<p>The Add/Remove Windows Components page appears.</p>


<p><li>Click to select Remote Installation Services in the Components
box, and then click Next.</li></p>


<p>Setup installs and configures Remote Installation Services.</p>

<p>The Completing The Windows Components Wizard page appears.</p>


<p><li>Click Finish.</li></p>


<p>A System Settings Change dialog box appears, indicating that you
must reboot before the new settings will take effect.</p>


<p><li>Remove the Windows 2000 Server CD-ROM from you CD-ROM drive and
click Yes.</li></p>
</ol>

<A NAME="667"><H3>Exercise 2: Configuring Remote Installation Services</H3></A>

<p>In this exercise, you configure Remote Installation Services.</p>


<p><li><b> To install Remote Installation Services</b></li></p>

<ol>
<p><li>Log on as administrator.</li></p>


<p>The Microsoft Windows 2000 Configure Your Server screen appears,
indicating that you have selected components that require additional
configuration.</p>


<p><li>Click Finish Setup.</li></p>


<p>The Add/Remove Programs window appears, indicating that you now need
to configure Remote Installation Services.</p>


<p><li>Click Configure.</li></p>


<p>The Remote Installation Services Setup wizard appears.</p>


<p><li>Read the information on the welcome screen, and then click
Next.</li></p>

<p>The Remote Installation Folder Location page appears.</p>

<p>Notice that the drive on which you create the Remote Installation
Folder cannot be the system drive and must be formatted with NTFS
version 5.0 or later.</p>


<p><li>Enter E:\RemoteInst in the Path box.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
Enter an appropriate path for your system. The
folder should not exist; it will be created as part of the
configuration process. Remember that the drive must be on the computer
on which you installed RIS, must be formatted with NTFS version 5.0 or
later, and must have about 300 MB of space available to hold the
Windows 2000 Professional installation files.
</blockquote></div>
</p>

<ol>
<p>The Initial Settings page appears.</p>


<p><li value="6">Click Next to accept the default settings.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
By default, the RIS server does not support
client computers until you configure it to do so.
</blockquote></div>
</p>

<ol>
<p>The Installation Source Files Location page appears.</p>


<p><li value="7">Enter the path to the installation source files and then click
Next.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you are using a Windows 2000 Professional
CD-ROM in the CD-ROM drive of the server on which you were configuring RIS, enter <i>
X</i>:\i386, where <i>X</i> is the drive letter for the CD-ROM
drive.
</blockquote></div>
</p>

<ol>
<p>The Windows Installation Image Folder Name page appears.</p>


<p><li value="8">Click Next to accept the default name of win2000pro.</li></p>


<p>The Friendly Description And Help Text page appears.</p>


<p><li>Click Next to accept the default friendly description and help
text.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
 The default description is &quot;Microsoft Windows 2000 Professional.&quot; The help text is &quot;Automatically
installs Windows Professional without prompting the user for
input.&quot;
</blockquote></div>
</p>

<ol>
<p>The Review Settings page appears.</p>


<p><li value="10">Review the information and then click Finish.</li></p>

<p>It will take several minutes for the following steps to
complete:</p>

<ul>
<p><li>The remote installation folder is created.</li></p>

<p><li>The files needed by the services are copied.</li></p>

<p><li>The Windows installation files are copied.</li></p>

<p><li>The client installation wizard screen files are
updated.</li></p>

<p><li>A new unattended Setup answer file is created.</li></p>

<p><li>Remote installation services are created.</li></p>

<p><li>The registry is updated.</li></p>

<p><li>The Single-Instance-Store Volume is created.</li></p>

<p><li>The required remote installation services are started.</li></p>
</ul>



<p><li>When all the tasks are completed, click Done.</li></p>

<p><li>Close any open windows.</li></p>
</ol>

<A NAME="668"><H2>Understanding Client Requirements for Remote Installation</H2></A>

<p>Client computers that support remote installation must have one of
the following configurations:</p>

<ul>
<p><li>A configuration meeting the Net PC specification.</li></p>

<p><li>A network adapter card with a Pre-Boot Execution Environment
(PXE) boot ROM and BIOS support for starting from the PXE boot
ROM.</li></p>

<p><li>A supported network adapter card and a remote installation
boot disk.</li></p>
</ul>


<A NAME="669"><H3>Net PCs</H3></A>

<p>The Net PC is a highly manageable platform with the ability to
perform a network boot, manage upgrades, and prevent users from
changing the hardware or operating system configuration. Additional
requirements for the Net PC are:</p>

<ul>
<p><li>The network adapter must be set as the primary boot device
within the system BIOS.</li></p>

<p><li>The user account that will be used to perform the
installation must be assigned the user right &quot;Log on as a batch
job.&quot; For more information on assigning user rights, see <a href="ch07a.htm">Chapter 7</a>, &quot;Managing Software by Using Group Policy.&quot;</li></p>
</ul>


<p>
<div class="note"><blockquote><b>NOTE</b><hr>
The Administrator group does not have the right
to log on to a batch job by default and thus will need to be assigned
this right prior to attempting a remote installation.
</blockquote></div>
</p>

<ul>
<p><li>Users must be assigned permission to create computer
accounts in the domain that they are joining. The domain is specified
in the Advanced Settings on the RIS server.</li></p>
</ul>


<A NAME="670"><H3>Computers Not Meeting the Net PC Specification</H3></A>

<p>Computers that do not directly meet the Net PC specification can
still interact with the RIS server. To enable remote installation on a
computer that does not meet the Net PC specification:</p>

<ol>
<p><li>Install a network adapter card with a PXE boot ROM.</li></p>

<p><li>Set the BIOS to start from the PXE boot ROM.</li></p>

<p><li>The user account that will be used to perform the installation
must be assigned the user right Log On As A Batch Job.</li></p>

<p><li>Users must be assigned permission to create computer accounts in
the domain that they are joining. The domain is specified in the
Advanced Settings on the RIS server.</li></p>
</ol>

<A NAME="671"><H2>Creating Boot Floppies</H2></A>

<p>If the network adapter card in a client is not equipped with a PXE
boot ROM or the BIOS does not allow starting from the network adapter
card, create a remote installation boot disk. The boot disk simulates
the PXE boot process. Windows 2000 ships with the Windows 2000 Remote
Boot Disk Generator that allows you to easily create a boot disk (see
Figure 14.1).</p>

<p>
<img src="images/F14UP01.JPG" width=371 height=293 border="0">
</p><p>
<!--caption--><b>Figure 14.1</b> <i>Windows 2000 Remote Boot Disk Generator</i><!--/caption-->
</p>


<p>The Windows 2000 Remote Boot Disk Generator is started by running
the Rbfg.exe. The Rbfg.exe file is located in the
\RemoteInstall\admin\i386 folder on the Remote Installation Server.
These boot floppies only support the PCI-based network adapters listed
in the Supported Adapters list. To see the list of the supported
network adapters, click the Adapter List button shown in Figure 14.1. A
partial listing of the supported network adapter cards is shown in
Figure 14.2.</p>

<p>
<img src="images/F14UP02.JPG" width=371 height=293 border="0">
</p><p>
<!--caption--><b>Figure 14.2</b> <i>Network Adapters supported by boot floppies</i><!--/caption-->
</p>


<p>You will also need to set the user rights and permissions. The user
account that will be used to perform the installation must be assigned
the user right Log On As A Batch Job. The users must be assigned
permission to create computer accounts in the domain that they are joining. The domain is specified
in the Advanced Settings on the RIS server.</p>

<p>
<img src="images/practic.JPG" width=68 height=54 border="0">
</p>

<A NAME="672"><H2>Practice: Creating a Remote Boot Disk</H2></A>

<p>In this practice, you create a remote boot disk.</p>


<p><li><b> To create a remote book disk</b></li></p>

<ol>
<p><li>Log on as administrator.</li></p>

<p><li>Click Start and then click Run.</li></p>


<p>The Run dialog box appears.</p>


<p><li>Type <b>E:\RemoteInst\Admin\i386\rbfg</b> in the Open box.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
Your path to rbfg.exe may vary. See step 5 under
&quot;To install remote installation services&quot; in the previous Practice.
</blockquote></div>
</p>

<ol>
<p><li value="4">Click OK.</li></p>


<p>The Windows 2000 Remote Boot Disk Generator window appears.</p>


<p><li>Read the information in the Windows 2000 Remote Boot Disk
Generator window and then click Adapter List.</li></p>

<p><li>Scroll through the list of supported adapters, and then click OK
to return to the Windows 2000 Remote Boot Disk Generator window.</li></p>

<p><li>Insert a formatted 3.5-inch floppy into your floppy disk
drive.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you have more than one floppy disk drive in
your computer, make sure you select the appropriate floppy disk drive
in Windows 2000 Remote Boot Disk Generator.
</blockquote></div>
</p>

<ol>
<p><li value="8">Click Create Disk.</li></p>


<p>A Windows 2000 Remote Boot Disk Generator dialog box appears,
prompting you to create another boot floppy.</p>


<p><li>Click No.</li></p>

<p><li>Click Close to close the Windows 2000 Remote Boot Disk
Generator window.</li></p>
</ol>

<A NAME="673"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that if you have a Windows 2000 Server
infrastructure in place, and the computers in your network support
remote boot, the most efficient method of deploying Windows 2000
Professional is to use remote installation. Remote installation is the
process of connecting to an RIS server and then starting an automated
installation of Windows 2000 Professional on a local computer. Remote
installation enables administrators to install Windows 2000
Professional on client computers throughout a network from a central
location. This reduces the time spent by administrators visiting all
the computers in a network, thereby reducing the cost of deploying
Windows 2000 Professional.</p>

<p>The requirements for Remote Installation include the following.
Client computers that support remote installation must have one of the
three following configurations: a configuration meeting the Net PC
specification, in which the network adapter must be set as the primary
boot device within the system BIOS; a network adapter card with a
Pre-Boot Execution Environment (PXE) boot ROM and BIOS support for
starting from the PXE boot ROM; or a supported network adapter card and
a remote installation boot disk.</p>

<p>Finally, the user account that will be used to perform the
installation must be assigned the user right Log On As A Batch Job, and users must be
assigned permission to create computer accounts in the domain that they are
joining. The domain is specified in the Advanced Settings on the RIS
server.</p>

</BODY>
</HTML>



