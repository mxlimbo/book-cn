<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 4: Deploying Terminal Services to Client Computers</title>


</head>
<body>
<div class="prevnext"><p><a href="ch22d.htm">3</a> <a href="ch22f.htm">4</a></p></div>

<h1><a name="1656">Lesson 4: Deploying Terminal Services to Client Computers</a></h1>


<p>Client computers or terminals connect to a Terminal server using a small client program installed on disk or in firmware. The choice of which client platform to use depends on the current installed base and individual user need. At a minimum, ensure that every client computer or terminal that you expect to connect to a Terminal server is physically capable of hosting the client software and connecting over the network. This lesson walks you through the various procedures used to deploy Terminal Services to Client computers.</p>

<hr />
<p><b>After this lesson, you will be able to</b></p>

<ul>
<li>Optimize Terminal Services deployment to client computers</li>

<li>Determine the best method to upgrade existing Terminal Services</li>

<li>Install and configure applications</li>
</ul>

<p><b>Estimated lesson time: 45 minutes</b></p>
<hr />

<h2><a name="1657">Preparing to Deploy Terminal Services</a></h2>


<p>Windows-based client computers connecting to Terminal Services should have at least an 80386 microprocessor running at 33 MHz (though a 486/66 is recommended), a 16-bit VGA video card, and the Microsoft TCP/IP stack. The Terminal Services client runs on Windows for Workgroups 3.11, Windows 95, Windows 98, Windows NT 3.51 or later, and Windows 2000.</p>

<p>The Terminal Services client takes up only about 500 KB of disk space and typically uses approximately 4 MB of RAM when running. If client bitmap caching is enabled, another 10 MB of disk space might be used. For best performance, a computer running the Terminal Services client should have a total of 8 MB of physical RAM or more under Windows for Workgroups 3.11 or Windows 95, 24 MB or more for Windows 98, and 32 MB or more for Windows 2000.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
A Terminal Services client for Windows CE devices can be found on
the Windows 2000 Server installation CD-ROM in the \Valueadd\msft\mgmt\mstsc_hpc folder.</div></blockquote>

<p>The RDP client software is installed by default as a subcomponent of Terminal Services. The various clients are installed in the directory %systemroot%\system32\clients\tsclient.</p>

<p>There are two ways to deploy the client:</p>

<ul>
<li>Create a file share to do the installation over the network.</li>

<li>Select Terminal Services Client Creator from the Administrative Tools menu and make a client image that can be installed with a floppy disk.</li>
</ul>

<blockquote><div class="note"><b>NOTE</b><hr />
The Terminal Services client requires TCP/IP to connect to the server, but Terminal Services itself can use IPX to gain access to Novell servers if necessary.</div></blockquote>

<h2><a name="1658">Client Configurations</a></h2>


<p>You can optimize Terminal Services by following these recommendations:</p>

<ul>
<li>Disable the Active Desktop.</li>

<li>Disable smooth scrolling.</li>

<li>Minimize the use of graphics and animation, including animated graphics, screen savers, blinking cursors, and the animated Microsoft Office Assistant. Place shortcuts on the desktop and keep the Programs submenu as flat as possible. Avoid using bitmaps in wallpaper; in Display Properties set Wallpaper to None on the Background tab and select a single color from the Appearance tab.</li>

<li>Enable file sharing on client computers and share drives with easily identifiable names like &quot;drivec.&quot; Be aware of the security implications involved.</li>

<li>Avoid the use of MS-DOS or Win16 (16-bit) applications where possible.</li>

<li>Configure the Terminal server to return the user's logon name rather than the computer name to applications that make use of a NetBIOS function that calls for the computer name.</li>

<li>Train users to use Terminal Services hot key sequences. There are a few important differences in the hot key sequences used in a Terminal Services client session than in a Windows 2000 session.</li>
</ul>

<h2><a name="1659">Upgrading to Terminal Services</a></h2>


<p>The approach you take to upgrade to Terminal Services depends upon your existing Terminal Services setup.</p>

<h3><a name="1660">WinFrame with or without MetaFrame</a></h3>


<p>There is no direct upgrade path from WinFrame to Terminal Services. In this case you first have to upgrade to Microsoft Terminal Server 4.0 and then upgrade to Windows 2000.</p>

<h3><a name="1661">Terminal Server 4.0 without MetaFrame</a></h3>


<p>With Terminal Server 4.0 installed, there is a direct upgrade path to Terminal Services. When you install Windows 2000, the server recognizes the Terminal Server 4.0 edition, automatically performs the upgrade, and automatically enables Terminal Services in Application Server mode. Note that you might need to reinstall existing applications if you enable Terminal Services in Application Server mode.</p>

<h3><a name="1662">Terminal Server 4.0 with MetaFrame</a></h3>


<p>Upgrading from Terminal Services 4.0 with MetaFrame is similar to upgrading from Terminal Server 4.0, but first you need to upgrade to the MetaFrame version for Windows 2000. After MetaFrame is upgraded, you can follow the same procedure for upgrading from Terminal Server 4.0 without MetaFrame.</p>

<h3><a name="1663">Windows NT without Terminal Services</a></h3>


<p>When you install Windows 2000, select Terminal Services in Remote Administration or Application mode to enable Terminal Services.</p>

<h2><a name="1664">Installing and Configuring Applications</a></h2>


<p>A Windows 2000 server that is configured to run Terminal Services in Application Server mode provides multiple concurrent user connections to any number of applications.</p>

<p>It is recommended that applications be added or removed by using the Add/Remove Programs function under Control Panel. This process automatically manages the Terminal Services installation requirements. It is also possible to install the application directly by putting the server into Install mode.</p>

<p>To put the Terminal Server in Install mode, type <b>change user /install</b>. After the software installation is complete, type <b>change user /execute</b> to return the Terminal Server to Execute mode.</p>

<p>The change user commands are not necessary when using Add/Remove Programs because Add/Remove Programs takes care of this process in the background. Add/Remove Programs is preferred because there is always the possibility of error or omission when using the command lines. If an application is installed without using Add/Remove Programs and without using the command line to set the Install mode, the application should be removed and reinstalled.</p>

<p>Only administrators are allowed to install applications on a Terminal Services application server.</p>

<h3><a name="1665">Deploying Applications through Group Policy</a></h3>


<p>Deploying applications through Active Directory service and Group Policy by using Windows Installer is a very flexible application deployment method. It allows applications to be installed and managed in a number of different ways. The following are the three main ways applications can be deployed using Windows Installer:</p>

<ul>
<li>A user installs them on a local computer.</li>

<li>The system administrator assigns them from the domain controller to a user or a computer.</li>

<li>The system administrator publishes from the domain controller for a user.</li>
</ul>

<p>Before an application can be installed using Windows Installer, an .MSI installation package must be available for the application.</p>

<h3><a name="1666">Deploying Applications from a Domain Controller</a></h3>


<p>To deploy an application from a domain controller, a system administrator needs to assign a .MSI-based application to a computer. Application servers cannot assign or publish applications to users.</p>

<p>Transform files are required if the original application installation package did not install all of the necessary components of the application to the local disk. Transform files allow you to select what, if anything, needs to be installed during the installation.</p>

<p>A system administrator can also install an application from a remote session or the console of an application server. A typical installation is initiated by using the following command:</p>

<div class="code">
<pre>
Msiexec/I <i>ApplicationName</i>.MSI
TRANSFORMS=<i>TransformFileName</i>.MST ALLUSERS=1
</pre>
</div>

<p>The installation of an application in a multi-user environment is quite different from an installation to an individual user. Application server software installation must not jeopardize the system that is running, and the installation must be configured to allow concurrent users. For these reasons, only administrators can install applications, and users are not able to install anything.</p>

<p>It is the responsibility of the system administrator to decide which applications are needed and to ensure that applications are locally installed and available before allowing remote user connections.</p>

<p><img src="images/practice.jpg" /></p>

<h2><a name="1667">Practice: Installing and Configuring Terminal Services and Terminal Services Licensing</a></h2>


<p>In this practice you install Windows 2000 Terminal Services, and then run remote administration from Server02 to Server01. Next, you install Terminal Services Licensing and then establish a terminal session from Server02 to Server01.</p>

<h3><a name="1668">Exercise 1: Preparing an Application for Terminal Services Application Mode Operation</a></h3>


<p>In this exercise, you uninstall the Windows 2000 Administration Tools and then reinstall them to ensure that they run properly from a terminal session. Make sure that the Windows 2000 Server installation CD-ROM is inserted in the CD-ROM drive on Server01 and that you are logged on as Administrator on Server01.</p>

<ol>
<li>On Server01, click the Start menu, point to Settings, and then click Control Panel.</li>

<li>In Control Panel, double-click Add/Remove Programs.
<p>The Add/Remove Programs dialog box appears.</p></li>

<li>In the Currently Installed Programs box, click Windows 2000 Administrative Tools, and then click the Remove button.
<p>The Add/Remove Programs message box appears, asking if you want to remove the Windows 2000 Administrative Tools from your computer.</p></li>

<li>Click Yes.
<p>A Windows Installer status box appears and then the Windows 2000 Administrative Tools status box appears as the tools are removed.</p>
<p>The Add/Remove Programs dialog box no longer contains the Windows 2000 Administrative Tools.</p></li>

<li>In the left frame, click Add New Programs.</li>

<li>From the main window, click CD or Floppy.
<p>The Install Program From Floppy Disk or CD-ROM screen appears.</p></li>

<li>Click Next.
<p>The Run Installation Program screen appears.</p></li>

<li>In the Open text box, type <b>&lt;<i>cd-rom</i>&gt;:\i386\adminpak.msi</b> where &lt;<i>cd-rom</i>&gt; is the drive letter of your CD-ROM drive.</li>

<li>Click Next.
<p>The Windows Installer status box appears and then the Windows 2000 Administrative Tools Installation status box appears. After a few moments, the Windows 2000 Administrative Tools Setup wizard appears.</p></li>

<li>Click Next.
<p>The Installation Progress screen appears as installation proceeds.</p>
<p>After a few minutes, the Completing the Windows 2000 Administrative Tools Setup wizard appears.</p></li>

<li>Click Finish.
<p>The After Installation screen appears.</p></li>

<li>Click Next.
<p>The Finish Admin Install screen appears.</p></li>

<li>Read the text on this screen and then click Finish.
<p>The Add/Remove Programs dialog box appears.</p></li>

<li>Click the Close button.</li>

<li>Close Control Panel.</li>
</ol>

<h3><a name="1669">Exercise 2: Connecting to Terminal Services in Application Mode and Running Terminal Services Tools</a></h3>


<p>In this exercise you install the terminal services client on Server02 and then run a terminal screen from Server02 to Server01. Inside the terminal session running on Server02 you monitor the session using tools installed on Server01. Server01 and Server02 should be logged on as Administrator to the MICROSOFT domain.</p>

<ol>
<li>On Server01 click the Start menu and then click Run.
<p>The Run dialog box appears.</p></li>

<li>In the Open text box, type <b>C:\winnt\system32\clients</b> and then click OK.
<p>The Clients window appears.</p></li>

<li>Click the Tsclient folder.</li>

<li>Click the File menu and then click Sharing.
<p>The Tsclient Properties dialog box appears with the Sharing tab active.</p></li>

<li>Click the Share This Folder radio button.
<p>Tsclient appears in the Share Name text box.</p></li>

<li>Click OK.</li>

<li>Close the Clients window.</li>

<li>On Server02 click the Start menu and then click Run.
<p>The Run dialog box appears.</p></li>

<li>In the Open text box, type <b>\\server01\tsclient</b> and then click OK.
<p>The Tsclient On Server01 window appears.</p></li>

<li>Double-click the win32 folder.</li>

<li>Double-click the disks folder.</li>

<li>Double-click the disk1 folder.</li>

<li>Double-click the setup icon.
<p>The Terminal Services Client Setup screen appears.</p></li>

<li>Click Continue.
<p>The Name And Organization Information dialog box appears.</p></li>

<li>Type your name and then click OK.
<p>The Confirm Name And Organization Information message box appears.</p></li>

<li>Click OK.
<p>A License Agreement message box appears.</p></li>

<li>Click the I Agree button.
<p>The Terminal Services Client Setup dialog box appears.</p>
<p>Notice that the client software is installed below the Program Files folder.</p></li>

<li>Click the large button to install the Terminal Services Client software.
<p>The Terminal Services Client Setup message box appears asking if you want this installation routine to apply to all users of this computer.</p></li>

<li>Click Yes.
<p>The installation progresses and then the Terminal Service Client Setup message box appears stating that the installation was successful.</p></li>

<li>Click OK.</li>

<li>Close the Disk1 window.</li>

<li>On Server02 click the Start menu, point to Programs, point to Terminal Services Client, and then click the Terminal Services Client icon.
<p>The Terminal Services Client dialog box appears.</p></li>

<li>In the Server drop-down list box, type <b>Server01</b>.</li>

<li>Leave the Screen area at 640 x 480, verify that the Enable Disk Compression check box is selected, and select the Cache Bitmaps To Disk check box.</li>

<li>Click the Connect button.
<p>The Server01 - Terminal Services Client window appears.</p></li>

<li>In the Log On To Windows dialog box, type <b>Jane_Doe.</b> In the Password field type <b>student</b> and then click OK.
<p>Notice that the Jane_Doe personal profile appears which is indicated by the custom color scheme.</p></li>

<li>From within the terminal session, click the Start menu, point to Programs, point to Administrative Tools, and then click Terminal Services Manager.
<p>The SERVER01 - Terminal Services Manager snap-in starts inside of the terminal session.</p></li>

<li>In the console tree, click SERVER01.</li>

<li>In the details pane, click Jane_Doe.</li>

<li>Click the Actions menu and then click Status.
<p>Status information about the Jane_Doe session appears.</p></li>

<li>Click the Close button.</li>

<li>Click the Actions menu and then click Send Message.
<p>The Send Message dialog box appears.</p></li>

<li>In the top Message title box, type <b>Message from the Administrator</b> and in the bottom Message box, type <b>Terminal Services will be shutting down for maintenance in a few minutes. Please close your session.</b></li>

<li>Click OK.
<p>A message box from the Administrator appears in the terminal session.</p></li>

<li>Click OK.</li>

<li>Close the SERVER01 - Terminal Services Manager snap-in and then close the SERVER01 - Terminal Services Client window.
<p>The Disconnect Windows Session message box appears.</p></li>

<li>Read the message and then click OK.</li>

<li>Shut down Server02 and Server01.</li>
</ol>

<h2><a name="1670">Lesson Summary</a></h2>


<p>In this lesson you learned that every client computer or terminal that you expect to connect to a Terminal server must be physically capable of hosting the client software and connecting over the network. A Windows 2000 server that is configured to run Terminal Services in Application Server mode provides multiple concurrent user connections to any number of applications. You can deploy applications through Active Directory service and Group Policy or from a domain controller.</p>



</body>
</html>



