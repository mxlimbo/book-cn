<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 5: Using Routing and Remote Access with DHCP</title>


</head>
<body>
<div class="prevnext"><p><a href="ch12d.htm">3</a> <a href="ch12f.htm">4</a></p></div>

<h1><a name="944">Lesson 5: Using Routing and Remote Access with DHCP</a></h1>


<p>When a Routing and Remote Access address pool is configured to use DHCP, no DHCP packets go over the wire to the Routing and Remote Access clients. In this lesson, you learn how Routing and Remote Access handles DHCP.</p>

<hr />
<p><b>After this lesson, you will be able to</b></p>
<ul>
<li>Explain Routing and Remote Access and DHCP</li>
<li>Describe how to implement the DHCP relay agent</li>
</ul>
<p><b>Estimated lesson time: 10 minutes</b></p>
<hr />

<h2><a name="945">Routing and Remote Access and DHCP</a></h2>


<p>When a Routing and Remote Access address pool is configured to use DHCP, no DHCP packets go over the wire to the Routing and Remote Access clients. Routing and Remote Access uses DHCP to lease addresses in blocks of 10, and stores them in the registry. The network information center (NIC) used to lease these DHCP addresses is configurable in the user interface if two or more NICs are in the server. In earlier versions of Windows, the remote access server would renew and maintain these DHCP addresses indefinitely. In Windows 2000, the DHCP leases are released when Routing and Remote Access is shut down.</p>

<p>The number of addresses that Routing and Remote Access will lease at a time is configurable in the registry under \System\CurrentControlSet\Services\ RemoteAccess\Parameters\Ip\InitialAddressPoolSize. The value in this key is the number of DHCP leases Routing and Remote Access will initially reserve. These addresses are stored in the registry and are given to Routing and Remote Access clients. When the initial pool is used up, another block of this size is leased.</p>

<h2><a name="946">DHCP Relay Agent</a></h2>


<p>The DHCP relay agent can now be used over Routing and Remote Access. The Routing and Remote Access client receives an IP address from the Routing and Remote Access server, but may use DHCPINFORM packets to obtain Windows Internet Name Service (WINS) and Domain Name System (DNS) addresses, domain name, or other DHCP options. DHCPINFORM messages are used to obtain option information without getting an IP address.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
Sending the domain name using DHCPINFORM is of particular importance because PPP does configure this information.</div></blockquote>

<p>DNS and WINS addresses received using DHCPINFORM override addresses obtained from the Routing and Remote Access server.</p>

<p><img src="images/practice.jpg" /></p>
<h2><a name="947">Practice: Configuring the DHCP Relay Agent to Work over Routing and Remote Access</a></h2>


<h3><a name="948">Exercise 1: Configuring a DHCP Relay Agent</a></h3>


<ol>
<li>In the Routing and Remote Access Manager, right-click General under IP Routing, and select New Routing Protocol.</li>

<li>Choose DHCP Relay Agent, and then click OK.</li>

<li>Highlight DHCP Relay Agent, and then right-click Properties.

<p>The DHCP Relay Agent Properties dialog box appears, allowing you to configure the IP addresses of any DHCP server.</p></li>

<li>Click OK to close the DHCP Relay Agent Properties dialog box.</li>

<li>Right-click the DHCP Relay Agent and choose New Interface.</li>

<li>Select Internal (Internal represents the virtual interface connected to all Routing and Remote Access clients), and then click OK.</li>

<li>Click OK to close the DHCP Relay Agent Internal Properties dialog box.</li>
</ol>

<h2><a name="949">Lesson Summary</a></h2>


<p>When a Routing and Remote Access address pool is configured to use DHCP, no DHCP packets will go over the wire to the Routing and Remote Access clients. In this lesson, you learned how Routing and Remote Access handles DHCP and DHCP relay agents.</p>

</body>
</html>



