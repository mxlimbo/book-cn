<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 2: Installing Internet Connection Sharing</title>


</head>
<body>
<div class="prevnext"><p><a href="ch14b.htm">3</a> <a href="ch14d.htm">4</a></p></div>

<h1><a name="1063">Lesson 2: Installing Internet Connection Sharing</a></h1>


<p>Internet Connection Sharing (ICS) is a feature of Network and Dial-Up Connections that allows you to use Windows 2000 to connect your home network or small office network to the Internet. For example, you might have a home network that connects to the Internet by using a dial-up connection. In this lesson, you learn how to install ICS in Windows 2000.</p>

<hr />
<p><b>After this lesson, you will be able to</b></p>

<ul>
<li>Enable the ICS feature of Windows 2000</li>

<li>Configure Internet options for ICS</li>
</ul>



<p><b>Estimated lesson time: 35 minutes</b></p>
<hr />

<h2><a name="1064">Internet Connection Sharing</a></h2>


<p>ICS is a simple package consisting of DHCP, NAT, and DNS. You can use ICS to easily connect your entire network to the Internet. Because ICS provides a translated connection, all computers on a network can access Internet resources such as e-mail, Web sites, and FTP sites. ICS provides the following:</p>

<ul>
<li>Ease of configuration</li>

<li>Single public IP address</li>

<li>Fixed address range for hosts</li>

<li>DNS proxy for name resolution</li>

<li>Automatic IP addressing</li>
</ul>



<p>ICS provides many more features than just address translation. Microsoft has added many features to make the configuration of Internet connections as simple as possible. ICS can be fully configured and administered from the Routing and Remote Access Manager. For a simple home network, a Connection Sharing wizard can also be launched from Control Panel Connections. The wizard does not allow configuration of any options but can get a home network up on the Internet in minutes. What simplifies the configuration is automatic addressing and automatic name resolution through the DHCP allocator, DNS proxy, and WINS proxy components. Each of these components provides a simplified configuration over the full version of DHCP, DNS, and WINS servers.</p>

<p>By enabling ICS on the computer that uses the dial-up connection, you are providing NAT, addressing, and name resolution services for all computers on your home network. After ICS is enabled and users verify their networking and Internet options, home network or small office network users can use applications such as Microsoft Internet Explorer and Microsoft Outlook Express as if they were directly connected to the ISP. The ICS computer then dials the ISP and creates the connection so that the user can reach the specified Web address or resource. To use the ICS feature, users on your home office or small office network must configure TCP/IP on their local area connection to obtain an IP address automatically.</p>

<h3><a name="1065">Enabling Internet Connection Sharing</a></h3>


<p>Before you enable ICS, consider the following:</p>

<ul>
<li>You should not use the ICS feature in a network with other Windows 2000 Server domain controllers, DNS servers, gateways, DHCP servers, or systems configured for static IP.</li>

<li>When you enable ICS, the network adapter connected to the home or small office network is given a new IP address configuration. Existing TCP/IP connections on the ICS computer are lost and must be reestablished.</li>

<li>To use the ICS feature, users on your home office or small office network must configure TCP/IP on their local area connection to obtain an IP address automatically.</li>

<li>If the ICS computer is using ISDN or a modem to connect to the Internet, you must select the Enable On-Demand Dialing check box.</li>
</ul>



<p><b>Follow these steps to enable ICS on a network connection:</b></p>

<ol>
<li>Click Start, point to Settings, and then click Network And Dial-Up Connections.</li>

<li>Right-click the dial-up, virtual private network (VPN), or the incoming connection you want to share, and then click Properties.</li>

<li>In the Sharing tab, select the Enable Internet Connection Sharing For This Connection check box.</li>

<li>If you want this connection to dial automatically when another computer on your home network attempts to access external resources, select the Enable On-Demand Dialing check box.</li>
</ol>

<h3><a name="1066">Installing Connection Sharing</a></h3>


<p>Connection Sharing is configured from within the Routing and Remote Access Manager.</p>

<p><b>Follow these steps to install Connection Sharing:</b></p>

<ol>
<li>In the Routing and Remote Access Manager, open the IP Routing folder and right-click on General.</li>

<li>Click New Routing Protocol, as illustrated in Figure 14.5.

<p>The Select Routing Protocol dialog box appears.</p></li>

<li>In the Select Routing Protocol dialog box, click Connection Sharing.</li>
</ol>

<div class="figure">
<a href="javascript:fullSize('F14cc05x.htm')"><img src="images/F14cc05.JPG" /></a>
<div class="caption"><b>Figure 14.5</b> <i>Routing and Remote Access Manager IP Routing menu</i>
</div>
</div>


<h3><a name="1067">Configuring Internet Options for Internet Connection Sharing</a></h3>


<p>If you have not previously established an Internet connection, you should do so.</p>

<p><b>Follow these steps to establish an Internet connection:</b></p>

<ol>
<li>Open Internet Explorer.</li>

<li>Click I Want To Set Up My Internet Connection Manually or I Want To Connect Through A Local Area Network (LAN), and then click Next.</li>

<li>Click I Connect Through A Local Area Network (LAN), and then click Next.</li>

<li>Clear the Automatic Discovery Of Proxy Server [Recommended] check box, and then click Next.</li>

<li>If you want to set up an Internet mail account now, and know your connection information, click Yes, and provide the e-mail account information for which the wizard prompts you. If you do not want to set up an Internet mail account, click No, click Next, and then click Finish.</li>
</ol>

<p>If you have previously established an Internet connection, you are prompted to complete the following steps.</p>

<p><b>Follow these steps to configure Internet options for ICS:</b></p>

<ol>
<li>From the Tools menu, click Internet Options.</li>

<li>In the Connections tab, click Never Dial A Connection, and then click LAN Settings.</li>

<li>In Automatic Configuration, clear the Automatically Detect Settings and Use Automatic Configuration Script check boxes.</li>

<li>In Proxy Server, clear the Use A Proxy Server check box.</li>
</ol>

<h2><a name="1068">Internet Connection Sharing and NAT</a></h2>


<p>To connect a small office or home office network to the Internet, you can use either a routed or translated connection. For a routed connection, the computer running Windows 2000 Server acts as an IP router that forwards packets between the internal network and the public Internet. Although conceptually simple, a routed connection requires knowledge of IP addressing and routing. However, routed connections enable all IP traffic between internal hosts and the public Internet. For more information, see the Small Office/Home Office (SOHO) Network to the Internet Help topic.</p>

<p>For a translated connection, the computer running Windows 2000 Server acts as a network address translator. Translated connections that use computers running Windows 2000 Server require less knowledge of IP addressing and routing and provide a simplified configuration for hosts and the Windows 2000 router. However, translated connections may not allow all IP traffic between SOHO hosts and Internet hosts.</p>

<p>In Windows 2000 Server, you can configure a translated connection to the Internet by using either the ICS feature of Network and Dial-Up Connections or the NAT routing protocol provided with Routing and Remote Access. Both ICS and NAT provide translation, addressing, and name resolution services to SOHO hosts.</p>

<p>As described in the previous section, ICS is designed to provide a single step of configuration (a single check box) on the computer running Windows 2000 to provide a translated connection to the Internet for all of the hosts on the network. However, once enabled, ICS does not allow further configuration beyond the configuration of applications and services. For example, ICS is designed for a single IP address obtained from an ISP and does not allow you to change the range of IP addresses allocated to hosts.</p>

<p>As you learned in Lesson 1, the NAT routing protocol is designed to provide maximum flexibility in the configuration of the computer running Windows 2000 Server to provide a translated connection to the Internet. NAT requires additional configuration steps; however, each step of the configuration is customizable. The NAT protocol allows for the use of ranges of IP addresses from the ISP and the configuration of the range of internal IP addresses allocated to hosts.</p>

<p>Table 14.2 summarizes the features and capabilities of ICS and NAT.</p>

<p><b>Table 14.2</b> <i>ICS and NAT Features</i></p>

<table>
<tr>
<th>ICS</th>
<th>NAT</th>
</tr>
<tr>
<td>Single check box configuration</td>
<td>Manual configuration</td>
</tr>
<tr>
<td>Single public IP address</td>
<td>Multiple public IP addresses</td>
</tr>
<tr>
<td>Fixed address range for internal hosts</td>
<td>Configurable address range for internal hosts</td>
</tr>
<tr>
<td>Single internal interface</td>
<td>Multiple internal interfaces</td>
</tr>
</table>
<p>ICS and NAT are features of Windows 2000 Server that are designed to connect SOHO networks to the Internet. ICS and NAT are not designed to do the following:</p>

<ul>
<li>Directly connect separate private networks together</li>

<li>Connect networks within an intranet</li>

<li>Directly connect branch office networks to a corporate network</li>

<li>Connect branch office networks to a corporate network over the Internet</li>
</ul>



<h2><a name="1069">Troubleshooting Connection Sharing (NAT)</a></h2>


<p>Answer the following questions to troubleshoot configuration problems with Connection Sharing (NAT):</p>

<ul>
<li><b>Are all of your interfaces (public and private) added to the Connection Sharing (NAT) routing protocol?</b> You must add both public (Internet) and private (small office or home office) interfaces to the Connection Sharing (NAT) routing protocol.</li>

<li><b>Is translation enabled on the Internet (external) interface?</b> You need to verify that the interface on the Windows router that connects to the Internet is configured for translation. The Enable Translation Across This Interface option in the General tab of the Properties Of The Internet Interface dialog box should be selected.</li>

<li><b>Is Connection Sharing enabled on the private (internal) interface?</b> You need to verify that the interface on the Windows router that connects to the internal network is configured for Connection Sharing. The Allow Clients On This Interface To Access Any Shared Networks option in the General tab of the Properties Of The Home Network Interface dialog box should be selected.</li>

<li><b>Is TCP/UDP port translation enabled?</b> If you only have a single public IP address, you need to verify that the Translate TCP/UDP Headers check box in the General tab of the Properties Of The External Interface dialog box is selected.</li>

<li><b>Is your range of public addresses set correctly?</b> If you have multiple public IP addresses, you need to verify that they are properly entered in the Address Pool tab of the Properties Of The Internet Interface dialog box. If your address pool includes an IP address that was not allocated to you by your ISP, inbound Internet traffic that is mapped to that IP address may be routed by the ISP to another location.</li>

<li><b>Is the protocol being used by a program translatable?</b> If you have some programs that do not seem to work through the NAT, you can try running them from the NAT computer. If they work from the NAT computer and not from a computer on the private network, the payload of the program may not be translatable. You can check the protocol being used by the program against the list of supported NAT editors.</li>

<li><b>Is Connection Sharing addressing enabled on the home office network?</b> If static addresses are not configured on the private network, verify that Connection Sharing addressing is enabled on the interfaces corresponding to the private network. To verify, click Interfaces in the Addressing tab of the Properties Of The Connection Sharing Object dialog box.</li>
</ul>



<h2><a name="1070">Lesson Summary</a></h2>


<p>ICS is a feature of Network and Dial-Up Connections that allows you to use Windows 2000 to connect your home network or small office network to the Internet. ICS can be fully configured and administered from the Routing and Remote Access Manager. By enabling ICS on the computer that uses the dial-up connection, you are providing NAT, addressing, and name resolution services for all computers on your home network.</p>

</body>
</html>



