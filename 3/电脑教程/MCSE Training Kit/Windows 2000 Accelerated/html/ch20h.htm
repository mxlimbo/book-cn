<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 7: Administering RIS</title>


</head>
<body>
<div class="prevnext"><p><a href="ch20g.htm">3</a> <a href="ch20i.htm">4</a></p></div>

<h1><a name="1522">Lesson 7: Administering RIS</a></h1>


<p>This lesson discusses the tasks necessary to administer RIS, including managing client installation images, managing RIS client computers, and managing RIS security.</p>

<hr />
<p><b>After this lesson, you will be able to</b> </p>

<ul>
<li>Manage RIS client installation images</li>

<li>Manage RIS client computers</li>

<li>Manage RIS security</li>
</ul>

<p><b>Estimated lesson time: 20 minutes</b> </p>
<hr />

<h2><a name="1523">Managing RIS</a></h2>


<p>Managing RIS includes the following tasks:</p>

<ul>
<li>Managing RIS client installation images</li>

<li>Managing RIS client computers</li>

<li>Managing RIS security</li>
</ul>

<h2><a name="1524">Managing RIS Client Installation Images</a></h2>


<p>Managing RIS client installation images includes the following tasks:</p>

<ul>
<li>Adding new client OS installation images</li>

<li>Associating unattended setup answer files</li>
</ul>

<p><b>Follow these steps to add a new client OS installation image:</b> </p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>In the console tree, right-click the applicable RIS server, and then click Properties.</li>

<li>In the Properties dialog box for the server, click the Remote Install tab, and then click Advanced Settings.</li>

<li>In the Remote Installation Services Properties dialog box, click the Images tab.</li>

<li>Click Add to start the Add wizard.</li>

<li>On the New Answer File Or Installation Image page, click Add A New Installation Image, and then click Next to start the Add Installation Image wizard.</li>

<li>On the Welcome To The Add Installation Image Wizard page, click Next.</li>

<li>On the Installation Source Files Location page, type the location of the Windows 2000 Professional installation image, and then click Next. The location can be either a CD-ROM or network share.</li>

<li>On the Windows Installation Image Folder Name page, type a name for the Windows installation image, and then click Next.</li>

<li>On the Friendly Description And Help Text page, enter the friendly description and help text for the installation image, and then click Next.</li>

<li>If a previous set of Client Installation wizard screens exists, the Previous Client Installation Screens Found page appears. Select the Client Installation wizard screen you want to use for this image, and then click Next.</li>

<li>On the Review Settings page, review the installation summary, and then click Finish.

<p>The Remote Installation Setup wizard completes the addition of the new client installation image.</p></li>
</ol>
<p><b>Follow these steps to associate unattended setup answer files:</b> </p>
<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>In the console tree, right-click the applicable RIS server, and then click Properties.</li>

<li>In the Properties dialog box for the server, click the Remote Install tab, and then click Advanced Settings.</li>

<li>In the Remote Installation Services Properties dialog box, click the Images tab.</li>

<li>Click Add to start the Add wizard.</li>

<li>On the New Answer File Or Installation Image page, click Associate A New Answer File To An Existing Image, and then click Next.</li>

<li>On the Unattended Setup Answer File Source page, click the source that contains the unattended setup file you want to copy:

<ul>
<li>Windows Image Sample Files</li>

<li>Another Remote Installation Server</li>

<li>An Alternate Location</li>
</ul>
</li>

<li>Click Next.</li>

<li>On the Select An Installation Image page, select the installation image the answer file will be associated with, and then click Next.</li>

<li>On the Select A Sample Answer File page, select a sample unattended setup answer file, and then click Next.</li>

<li>On the Friendly Description And Help Text page, enter the friendly description and help text for the installation image, and then click Next.</li>

<li>On the Review Settings page, review the settings summary, and then click Finish.</li>
</ol>

<h2><a name="1525">Managing RIS Client Computers</a></h2>


<p>Managing RIS client computers includes the following tasks:</p>

<ul>
<li>Prestaging RIS client computers</li>

<li>Finding RIS client computers</li>
</ul>

<h3><a name="1526">Prestaging RIS Client Computers</a></h3>


<p>Prestaging an RIS client computer is the process of creating a valid client CAO within Active Directory. By prestaging the client computer account in Active Directory, you can configure the RIS servers to respond only to prestaged client computers. This ensures that only those client computers that have been prestaged as authorized users are allowed to install an OS from the RIS server. Prestaging can save time and money by reducing, and in some cases eliminating, the need to fully preinstall the computer.</p>

<p>When you prestage a client computer, you can define a specific computer name and optionally specify the RIS server to service the computer. This information is used to identify and route the client computers during the network service boot request. Make sure you set the appropriate access permissions for users of the prestaged client computer. When prestaging a client computer into a domain with multiple domain controllers, the replication delay of the client CAO information can cause a client computer to be serviced by another RIS server.</p>

<p><b>Follow these steps to prestage a client computer:</b> </p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>In the console tree, right-click the applicable OU that will contain the new client computer, click New, and then click Computer.</li>

<li>In the New Object-Computer dialog box (see Figure 20.31), type the client computer name, authorize domain join permissions for the user or security group containing the user that will receive the physical computer this computer account represents, and then click Next.


<div class="figure">
<a href="javascript:fullSize('F20cc31x.htm')"><img src="images/F20cc31.JPG" /></a>
<div class="caption"><b>Figure 20.31</b> <i>New Object-Computer dialog box</i>
</div>
</div>
</li>


<li>In the Managed dialog box (see Figure 20.32), click This Is A Managed Computer, type the client computer GUID into the text entry field, and then click Next. See &quot;<a href="ch20h.htm#1528">Locating the GUID for Client Computers</a>&quot; later in this lesson for details.


<div class="figure">
<a href="javascript:fullSize('F20cc32x.htm')"><img src="images/F20cc32.JPG" /></a>
<div class="caption"><b>Figure 20.32</b> <i>Managed dialog box</i>
</div>
</div>
</li>


<li>In the Host Server dialog box (see Figure 20.33), click one of the following options to determine which server will support this client computer:

<ul>
<li><b>Any Available Remote Installation Server.</b>  Selecting this option indicates this client computer can be serviced by any RIS server.</li>

<li><b>The Following Remote Installation Server.</b>  Selecting this option allows you to designate a specific server.</li>
</ul>

<div class="figure">
<a href="javascript:fullSize('F20cc33x.htm')"><img src="images/F20cc33.JPG" /></a>
<div class="caption"><b>Figure 20.33</b> <i>Host Server dialog box</i>
</div>
</div>


<p>You can use the options in the Host Server dialog box to manually set clients across the available RIS servers within your organization and to segment the network traffic, if you know the physical location of the specific RIS server and where this computer will be delivered. For example, if an RIS server is located on the fifth floor of your building and you are delivering these computers to users on that floor, you could choose to assign this computer to the RIS server on the fifth floor.</p>
</li>


<li>Click Next.</li>

<li>Review the settings on the New Object-Computer dialog box, and then click Finish.</li>
</ol>

<h3><a name="1527">Finding RIS Client Computers</a></h3>


<p>You can search Active Directory for RIS client computer accounts using their computer name or GUID. The Show Clients feature searches for all client computers that are prestaged for this RIS server. The search process can include the entire Active Directory structure or be limited to a specific domain. The search process returns a list of the client computers and displays them by their computer name and GUID.</p>

<p>The Show Clients search process uses a wildcard search attribute appended to the current RIS server computer name. For example, if the RIS server is named RISsvr1, the Show Clients feature will use RISsvr1* for the server name. When you use the Show Clients feature in multiple RIS server environments, the search result might contain client computers from multiple servers. For example, if you have multiple RIS servers with computer names such as RISsvr1, RISsvr10, and RISsvr100, the search will return, from each of the servers, client computers that begin with the same computer name.</p>

<h3><a name="1528">Locating the GUID for Client Computers</a></h3>


<p>The computer's GUID appears on the following:</p>

<ul>
<li>The label on the side of the computer case</li>

<li>The label inside the computer case</li>

<li>The BIOS of the client computer</li>
</ul>

<p>The manufacturer supplies the computer's GUID. The GUID must be in the form {<i>dddddddd-dddd-dddd-dddd-dddddddddddd</i>}, where <i>d</i> is a hexadecimal text digit. For example, it could be eight hexadecimal text digits, followed by four, then four, then four, then twelve, as in the following: {921FB974-ED42-11BE-BACD-00AA0057B223}</p>

<p>Valid entries for the client GUID are restricted to the following digits and characters:</p>

<p>0 1 2 3 4 5 6 7 8 9 a b c d e f - A B C D E F</p>

<p>Dashes are optional and spaces are ignored. Brackets {} must be included.</p>

<p><b>Follow these steps to find RIS client computers:</b> </p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>In the console tree, right-click the applicable RIS server, and then click Properties.</li>

<li>In the Properties dialog box for the server, click the Remote Install tab.</li>

<li>In the Remote Install dialog box, click Show Clients.</li>

<li>In the Find Remote Installation Clients dialog box (see Figure 20.34), in the GUID box, enter the client computer's GUID, and then click Find Now.

<div class="figure">
<a href="javascript:fullSize('F20cc34x.htm')"><img src="images/F20cc34.JPG" /></a>
<div class="caption"><b>Figure 20.34</b> <i>Find Remote Installation Clients dialog box</i>
</div>
</div>


<blockquote><div class="note"><b>NOTE</b> <hr />
You can limit the client computer search to a specific RIS server by entering the server name in the RI server box.</div></blockquote>
</li>

<li>The RIS client computers appear in the Name and GUID columns in the lower portion of the Find Remote Installation Clients dialog box.</li>

<li>Close the Find Remote Installation Clients dialog box.</li>

<li>Close the Properties dialog box for the server.</li>
</ol>

<h2><a name="1529">Managing RIS Security</a></h2>


<p>Managing RIS security includes the following tasks:</p>

<ul>
<li>Setting permissions for creating prestaged and user-created computer accounts</li>

<li>Setting permissions for joining computers created in the Computers container and OUs to the domain</li>
</ul>

<h3><a name="1530">Setting Permissions for Creating Computer Accounts</a></h3>


<p>To create new computer accounts in Active Directory, users need to have permissions and rights assigned to them. You must determine which users will be creating new client computer accounts and modify the users' rights and privileges accordingly.</p>

<p><b>Follow these steps to set permissions for creating prestaged computer accounts:</b> </p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>On the View menu, enable Users, Groups And Computers As Containers and Advanced Features.</li>

<li>In the console tree, right-click the applicable client computer account, and then click Properties.</li>

<li>In the Properties dialog box, click the Security tab, and then click Add.</li>

<li>In the Select Users, Computers, Or Groups dialog box, select the user or group from the list, click Add, and then click OK.</li>

<li>In the Properties dialog box, click the user or group you have added.</li>

<li>In the Permissions box, click the Read, Write, Change Password, and Reset Password permissions, and then click OK.
<p>If a group is allowed to have these permissions, remember to add users 
to that group.</p>

<p>For client computer accounts that are prestaged in another Active Directory folder location, expand the Active Directory Users and Computer console and select the appropriate client computer account.</p></li>
</ol>
<p> <b>Follow these steps to set permissions for creating user-created computer accounts:</b> </p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>In the console tree, right-click the applicable domain, and then click Delegate Control to start the Delegation Of Control wizard.</li>

<li>On the Welcome To The Delegation Of Control Wizard page, click Next.</li>

<li>On the Users Or Groups page, click Add.</li>

<li>In the Select Users, Computers, Or Groups dialog box, click the user account or security group (preferred) containing the users you are setting permissions for, click Add, and then click OK.</li>

<li>On the Users Or Groups page, click Next.</li>

<li>On the Tasks To Delegate page, click Delegate The Following Common Tasks, click Join A Computer To The Domain, and then click Next.</li>

<li>Review the delegation of control summary information, and then click Finish.</li>
</ol>

<h3><a name="1531">Setting Permissions for Joining Computer Accounts to a Domain</a></h3>


<p>To join new computer accounts to the domain, users need to have permissions and rights assigned to them. You must determine which users will be joining new client computer accounts to a domain and modify the users' rights and privileges accordingly.</p>

<p><b>Follow these steps to set permissions for joining computer accounts created in the Computers container to the domain:</b> </p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>In the console tree, right-click the applicable domain, and then click Delegate Control to start the Delegation Of Control wizard.</li>

<li>On the Welcome To The Delegation Of Control Wizard page, click Next.</li>

<li>On the Users Or Groups page, click Add.</li>

<li>In the Select Users, Computers, Or Groups dialog box, click the user account or security group (preferred) containing the users that will be joining client computers to the domain, click Add, and then click OK.</li>

<li>On the Users Or Groups page, click Next.</li>

<li>On the Tasks To Delegate page, click Delegate The Following Common Tasks, click Join A Computer To The Domain, and then click Next.</li>

<li>Review the delegation of control summary information, and then click Finish.</li>
</ol>
<p><b>Follow these steps to set permissions for joining computer accounts created in OUs to the domain:</b> </p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Active Directory Users And Computers.</li>

<li>In the console tree, right-click the applicable OU, and then click Properties.</li>

<li>In the Properties dialog box for the OU, in the Group Policy tab, click the GPO in the Group Policy Object Links box, and then click Edit.</li>

<li>In the Group Policy snap-in, open Computer Configuration, click Windows Settings, click Security Settings, click Local Policies, and then click User Rights Assignment.</li>

<li>Double-click Add Workstations To Domain.</li>

<li>In the Security Policy Setting dialog box, click Add.</li>

<li>In the Add User Or Group dialog box, type or use the Browse button to enter the names of the user accounts or security groups (preferred) containing the users who will be adding client computers to the domain in the User And Group Names box, and then click OK.</li>

<li>In the Security Policy Setting dialog box, click OK.</li>

<li>Close the Group Policy snap-in.</li>

<li>In the Properties dialog box for the OU, click OK.</li>
</ol>

<blockquote><div class="note"><b>NOTE</b> <hr />
Because the changes that you make to RIS policy take effect only when the policy is propagated (applied) to your computer, do one of the following to initiate policy propagation:

<ul>
<li>Type <b>secedit /refreshpolicy machine_policy</b>  at the command prompt, and then press Enter.</li>

<li>Restart your computer.</li>

<li>Wait for automatic policy propagation, which occurs at regular, configur-able intervals. By default, policy propagation occurs every 8 hours.</li>
</ul>
</div></blockquote>

<h2><a name="1532">Lesson Summary</a></h2>


<p>In this lesson you learned about the tasks necessary to administer RIS, including managing RIS client installation images, managing RIS client computers, and managing RIS security.</p>

</body>
</html>



