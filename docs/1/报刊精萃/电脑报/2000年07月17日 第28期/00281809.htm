 
<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<TITLE>电脑报电子版 -- powerBuilder编程俱乐部</TITLE>
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><img src='imagesdot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><img src='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='电脑报' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><img src='imagespixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><img src='imagesdot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://drivers.cpcw.com/issue.htm'>2000 年</a> &gt; <a href="index.html">28期</a> 
      &gt; <a href="software.html">软件世界</a> &gt; powerBuilder编程俱乐部</td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><img src='imagesdot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 powerBuilder编程俱乐部 》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>　　大家好！PowerBuilder编程俱乐部又与大家见面了，最近俱乐部的论坛中你问我答，非常热闹，有一大批PB爱好者及高手活跃在论坛上。我们也热切期待你的加盟，各位可到俱乐部主页http://kjx.126.com或http://pb70.yeah.net的BBS讨论区去提交或解答问题。<br>
      　　问：PB6.5所带的数据库Sybase SQL Anywhere 5.0 小巧方便，但不知如何在Sybase SQL Anywhere 服务器增加用户和设置数据库的操作权限？<br>
      　　答：不知以下的介绍对你是否有用：<br>
      　　SQL Anywhere数据库的默认用户名和口令是DBA和SQL，要对数据库安全负责的话，就应当更改口令或用户名，不然大家得到你的数据库后都能打开它。<br>
      　　启动Sybase Central，″connect″数据库后，在数据库项目列表中，有一项″users ＆ groups″，打开它，有以下功能：<br>
      　　add user：添加用户及口令，指定级别（可选DBA）。<br>
      　　add group：添加用户组。<br>
      　　dba。<br>
      对已有的用户，进行修改，打开后有四个标签页：<br>
      　　1．General：修改用户口令<br>
      　　2．Authorities：设置用户级别，其中DBA为系统管理员；Resource为可以创建数据库级别。<br>
      　　3．Membership：指定用户组。<br>
      　　4．Permissions：设定对每个表的操作级别。<br>
      　　dbo和public：添加或删除组中的用户。<br>
      　　Sybase Central是一个数据库管理中心，功能十分强大，可以实现诸如创建数据库、压缩、备份、改变库结构（这个功能相当实用，例如你在PB的table画板下，不能改变字段类型、长度只能扩大不能缩小，在Sybase 
      Central下你想做什么都可以）等等许多数据库操作。（此题由yiyi提供答案）<br>
      　　问：我的程序在PB下可正常运行，单步调试也没出错。但是编译成.EXE 文件后运行时连不上数据库(SQL Anywhere的本地库)，不知哪里出了问题，有没有可能是我的PB安装得不完全？缺少一些DLL文件？<br>
      　　答：经过编译生成的PowerBuilder应用程序需要如下运行环境：<br>
      　　1PowerBuilder 运行时动态连接库( Runtime Library ) ，在PowerBuilder 6.0中需要如下DLL：<br>
      　　PBVM60.DLL (PowerBuilder 虚拟机)(必需)<br>
      　　PBDWE60.DLL (DataWindow 引擎) (可选) <br>
      　　PBRTC60.DLL (Rich Text Control)(可选) <br>
      　　PBTRA60.DLL (DLL used for tracing db calls)(可选)<br>
      　　2与所需连接的数据库的直连接口(Native Driver) 或 ODBC接口(ODBC Driver)：<br>
      　　PBSYC60.DLL (连接Sybase 的直连接口) <br>
      　　PBO7360.DLL (连接Oracle7.3的直连接口)<br>
      　　3所需连接的数据库的Client端(如Sybase的Open Client, Oracle 的SQL Net) <br>
      　　以上是Sybase公司的建议。 <br>
      　　我的经验是，编译好的程序必须有pbdwe60.dll和pbvm60.dll才行。如果使用了数据管道、超文本控件，还要加pbrtc60.dll。另外，如果使用ODBC连接数据库则还需pbodb60.dll，如果使用专用接口，则必须对应数据库的DLL，如Oracle7.3用PBO7360.DLL，Sybase用PBSYC60.DLL。这些文件必须在你的PB应用程序可搜索的路径内（如Window\System、应用程序目录下等），PB可执行文件才能正常运行。（此题由yiyi回答）<br>
      　　问：怎样检测数据窗口中数据是否被修改，以避免用户不小心关闭窗口而导致数据窗口中大量修改数据未保存而丢失？<br>
      　　答：在窗口的closequery事件加入如下代码即可：<br>
      　　if dw_1.deletedcount() ＋ dw_1.modifiedcount() &gt; 0 then<br>
      　　integer li_ret<br>
      　　li_ret = messagebox(″注意″,″数据已经被修改，是否存盘？″,Question!,YesNoCancel!)<br>
      　　choose case li_ret<br>
      　　case 1<br>
      　　if dw_1.update() = 1 then <br>
      　　commit;<br>
      　　return 0<br>
      　　else<br>
      　　rollback;<br>
      　　messagebox(″出错″,″存盘时出错！请检查数据的正确性。″)<br>
      　　return 1<br>
      　　end if<br>
      　　case 2<br>
      　　return 0<br>
      　　case 3<br>
      　　return 1<br>
      　　end choose<br>
      　　end if<br>
      　　（此题由ferryman回答）<br>
      　　问：各位大侠，怎么在数据窗口中用箭头键实现“Shift＋Tab”按键的功能？我想在PB中获得一个像Foxpro那样的编辑环境，即按左箭头键光标便移动到当前列的左边一列，按右箭头键光标便移动到右边一列?<br>
      　　答：方法一（推荐）：<br>
      　　声明函数：<br>
      　　subroutine keybd_event(uint bVk,uint bScan,long dwFlags,long dwExtraInfo 
      ) library ′user32.dll′<br>
      　　定义用户事件ue_keydown：pbm_dwnkey。<br>
      　　在事件中编程：<br>
      　　integer VK_TAB = 09<br>
      　　integer VK_SHIFT = 16<br>
      　　if key = KeyLeftArrow! then<br>
      　　 keybd_event(VK_SHIFT,0,0,0) //按下shift<br>
      　　 keybd_event(VK_TAB,0,0,0) //按下tab <br>
      　　 keybd_event(VK_TAB,0,2,0) //释放tab <br>
      　　 keybd_event(VK_SHIFT,0,2,0) //释放shift <br>
      　　 return 1<br>
      　　end if<br>
      　　if key = KeyRightArrow! then<br>
      　　 keybd_event(VK_TAB,0,0,0) //按下tab <br>
      　　 keybd_event(VK_TAB,0,2,0) //释放tab <br>
      　　 return 1<br>
      　　end if<br>
      　　（此题由ferryman回答）<br>
      　　方法二（比较原始，但也能实现）：<br>
      　　声明函数：<br>
      　　function boolean GetKeyboardState (ref char kbarray[256]) library ″user32.dll″<br>
      　　function boolean SetKeyboardState (ref char kbarray[256]) library ″user32.dll″<br>
      　　脚本：用户事件ue_keydown：pbm_dwnkey<br>
      　　char lc_kb[256] <br>
      　　if key = KeyLeftArrow! then<br>
      　　 GetKeyboardState (lc_kb) <br>
      　　 lc_kb[17] = Char (128) <br>
      　　 SetKeyboardState (lc_kb) <br>
      　　 Send (Handle (this), 256, 9, 0) <br>
      　　 GetKeyboardState (lc_kb) <br>
      　　 lc_kb[17] = Char (0) <br>
      　　 SetKeyboardState (lc_kb) <br>
      　　end if<br>
      　　问：动态切换数据窗口对象编译后运行为何出错？如在数据窗口dw_1中用 dw_1.dataobject=″dw_sj″来改变对象，在PB7环境下运行一切OK。但当创建工程和应用程序后，运行该应用程序（.EXE文件）时，数据窗口dw_1的数据对象dw_sj不能出现。<br>
      　　答：当程序中用到了动态加入的对象，如BMP资源文件、数据窗口对象（dw_1.dataobject=″dw_sj″，这里″dw_sj″即为动态加入），PB编译时是扫描不到的，有两种方法解决：<br>
      　　1．将此对象写入到资源文件中：<br>
      　　用记事本创建资源文件dw_object.pbr<br>
      　　写入：c:\myprogram.pbl(dw_sj)<br>
      　　编译时将此文件选入Resource File Name处。<br>
      　　2．将应用编译成PBD、DLL文件。<br>
      　　问：请问PB编译后的程序可否带参数运行，就像DOS中的dir命令：dir/w的形式，如果可以，PB中怎样接收呢？<br>
      　　答：PB中带参数运行应用程序一般都是用在Application 的 Open 事件里访问 CommandLine参数的办法，根据参数CommandLine 
      的不同做不同的操作。如程序myapp ，运行：myapp hello。hello就是命令行参数。</TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='index.html#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><img src='imagesdot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD>&nbsp;</TD>
    <TD> <a name='top'></a> <A HREF='/28/index.html'>CPCW版权所有</A>，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布 
      <script language="JavaScript" src="http://nethome.yesky.com/sp/yeskye.js">
</script>
    </TD>
  </TR>
</TABLE>
</BODY>
</HTML>
