 
<HTML>
 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/epcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- VC++编程俱乐部</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <img src="images/yjds.gif" width="468" height="50">
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='468' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; <a href='http://drivers.cpcw.com/issue.htm'>2000 年</a> &gt; <a href="index.html">26期</a> 
      &gt; <a href="software.html">软件世界</a> &gt; VC++编程俱乐部</td>
  </tr>
</table>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 VC++编程俱乐部 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>　　大家好！新的一期“VC＋＋编程俱乐部”又和大家见面了。我们的网上“VC＋＋编程俱乐部”（http://vcclub.yes8.com）自开通以来，得到了广大的编程爱好者的大力支持和热心参与，在此我们深表谢意，也希望大家能继续给予关爱，齐心协力，共同营造我们VC＋＋编程爱好者的这一方乐土。<br>
      　　问：如何通过代码获取应用程序主窗口的指针和主窗口的句柄？<br>
      　　答：应用程序主窗口的指针保存在CWinThread::m_pMainWnd中，编程中可调用AfxGetMainWnd来获取主窗口的指针。如下面的代码可获得主窗口的指针，并使该窗口最大化显示：<br>
      　　AfxGetMainWnd()－&gt;ShowWindow(SW_SHOWMAXIMIZED);<br>
      　　而主窗口的句柄可通过如下的方式来获取：<br>
      　　HWND my_hWnd=AfxGetMainWnd()－&gt;m_hWnd;<br>
      　　问：在编写多文档界面应用程序时，我想定义所有的类都能访问的全局变量，不知如何实现？<br>
      　　答：例如要将变量MyVar声明为全局变量，只需要在该应用程序CWinApp派生类（比如为CMyApp）定义中加上public型MyVar变量声明，然后就可在程序的任何地方用下面的方法来访问MyVar变量了：<br>
      　　CMyApp＊ myapp=(CMyApp＊)AfxGetApp();<br>
      　　Myapp→MyVar=...;　//可进行赋值等操作<br>
      　　问：在不使用通用文件打开对话框的情况下，如何显示某一指定目录下的文件列表？<br>
      　　答：可以调用CWnd::DlgDirList函数或者CWnd::DlgDirListComboBox()函数，将向列表框或组合框填充指定目录下的文件列表。下面的示例代码将把C:\Temp目录中的文件列表显示在列表框中，其中IDC_LIST1为该列表框的ID值，IDC_CURRENTDIR为一静态文本框的ID值，用来显示当前列表目录。<br>
      　　char szPath[MAX_PATH]=″C:\\Temp″;<br>
      　　int nResult=DlgDirList( szPath, IDC_LIST1, IDC_CURRENTDIR, DDL_READWRITE 
      | DDL_READONLY |DDL_HIDDEN |DDL_SYSTEM | DDL_ARCHIVE );<br>
      　　问：我在编写服务器端的应用程序时，要求没有用户界面，如何才能实现无界面程序？<br>
      　　答：只要在InitInstance函数中显示主窗口的代码前添加如下代码即可：<br>
      　　UINT wParam, lParam;<br>
      　　while(GetMessage(NULL, NULL, wParam, lParam));<br>
      　　return FALSE;<br>
      　　问：如何在程序中打开/关闭CDROM？<br>
      　　答：先在文件头加入：<br>
      　　＃include &lt;mmsystem.h&gt;<br>
      　　＃pragma comment(lib, ″WINMM.LIB″)<br>
      　　使用下面的代码就可以在程序中打开/关闭CDROM了：<br>
      　　mciSendString(″set cdaudio door open″, NULL,0,0);<br>
      　　mciSendString(″set cdaudio door closed″, NULL,0,0);<br>
      　　问：请问如何在程序中动态创建控件（比如一个按钮）？<br>
      　　答：首先在相应类（如主窗口类）的定义中申明一个控件对象：<br>
      　　private:<br>
      　　CButton:＊ m_pButton;<br>
      　　然后在对应的cpp文件中添加如下代码即可动态创建控件（其中IDC_MYBUTTON需要手动建立）：<br>
      　　m_pButton=new CButton;<br>
      　　ASSERT_VALID(m_pButton);<br>
      　　m_pButton－&gt;Create(_T(″Button Title″), WS_CHILD | WS_VISIBLE |BS_PUSHBUTTON, 
      CRect(0,0,100,26), this, IDC_MYBUTTON);<br>
      　　问：我需要在程序中显示一个目录选择对话框，请问如何实现？<br>
      　　答：可以利用SDK函数SHBrowseForFolder()来实现目录选择对话框。先在需要引入该对话框类的文件中说明：＃include &lt;shlobj.h&gt;，然后在需要显示目录选择对话框的函数中加入如下代码:<br>
      　　BROWSEINFO bi; // 文件夹浏览结构<br>
      　　char dispname[MAX_PATH], path[MAX_PATH];<br>
      　　ITEMIDLIST＊ pidl;<br>
      　　bi.hwndOwner=0; // 初始化bi<br>
      　　bi.pidlRoot=0;<br>
      　　bi.pszDisplayName=dispname;<br>
      　　bi.lpszTitle=″请选择目录:″;<br>
      　　bi.ulFlags=BIF_RETURNONLYFSDIRS;<br>
      　　bi.lpfn=0;<br>
      　　bi.lParam=0;<br>
      　　bi.iImage=0;<br>
      　　// 弹出文件夹浏览目录,并选取目录<br>
      　　if(pidl=SHBrowseForFolder(＆bi))<br>
      　　{ // 取得目录信息, path表示选取的目录<br>
      　　SHGetPathFromIDList(pidl, path);<br>
      　　MessageBox(″选取的目录为: ″＋CString(path)); }<br>
      　　问：我想从一些应用程序中“借用”光标和位图等资源，请问在VC＋＋中如何实现？<br>
      　　答：VC＋＋中选择“File/Open…”菜单项，在弹出的对话框中，选择所需的文件如mspaint.exe，在Open as下拉式列表框中选择Resources，然后按“打开”按钮，以资源方式打开该应用程序（VC＋＋可能会提示不能将修改后的资源存回原文件，可不必管它）。然后就可以很方便地浏览该文件中的资源了，如图标、光标和位图等，还可以将其复制到自己的工程资源中。</TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD>&nbsp;</TD>
    <TD> <a name='top'></a>  
      
       CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>

</HTML>
