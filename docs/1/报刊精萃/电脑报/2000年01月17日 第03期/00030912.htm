<HTML><!-- #BeginTemplate "/模板/software.dwt" -->
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --PowerBuilder编程俱乐部</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><script language="JavaScript" src="http://ad.cpcw.com/js/hardware.js"></script></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/issue/all.html'>2000年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->03期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{PowerBuilder编程俱乐部}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{PowerBuilder编程俱乐部}<!-- #EndEditable --> 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　大家新年好！非常感谢各位在版主出差期间对PowerBuilder编程俱乐部一如既往的支持。建议各位到俱乐部主页http://kjx.126.com或http://pb70.yeah.net的BBS讨论区去提交问题，在那会有很多热心的PB爱好者替你排忧解难，更欢迎你去讨论区解答问题，因为我们俱乐部的宗旨就是互相学习、共同进步！<br>
      　　2000年已经到来，PowerBuilder编程俱乐部也在大家的关心下逐步发展壮大，在这里版主衷心地祝福各位新年快乐、学习进步！<br>
      　　一、问：下拉列表控件（DropDownListBox）中，当选中某一项后，我怎样才能返回当前选中项的索引号？（相当于VB中ComboBox的Index属性）<br>
      　　答：PowerBuilder中下拉列表控件没有Index属性，不能直接引用，得用其它方法实现。现给出两种方法：<br>
      　　1．设一long型实例变量il_index，在下拉列表的SelectionChanged事件中加入：<br>
      　　il_index = index<br>
      　　以后引用il_index即可。<br>
      　　2．假设下拉列表名为ddlb_1，则索引号：<br>
      　　li_index = ddlb_1.FindItem(ddlb_1.Text,1)<br>
      　　二、我用的数据库是 Sybase SQL Anywhere 5.0 ，数据库文件在本机能用，拷贝到别的机器却连接不上，是否还需其它配置？<br>
      　　答：假设数据库文件为hello.db，将hello.db与hello.log拷贝过去，再配置ODBC数据源。如果还连不上数据库，则须重新连接事务注册文件hello.log，方法如下：<br>
      　　1．进入MS_DOS模式。<br>
      　　2．进入Sybase SQL Anywhere5.0\win32目录，如：C:&gt; cd C:\Program Files\Sybase\SQL 
      Anywhere 5.0\Win32<br>
      　　3．运行命令（假设数据库文件拷贝到D盘根目录下）：<br>
      　　dblog －t d:\hello.log d:\hello.db<br>
      　　三、问： 我在安装好PB6.5之后，连接示例Powersoft Demo DB V6数据库，打开DATABASE画板，出现Select Table对话框，选择Cancel。打开FILE菜单中只有：Close、Connect、Configure 
      ODBC、PowerPanel、Print Setup、Exit等菜单项,，却没有像书中所讲的Create Database选项，请问这是为什么？<br>
      　　答：这个问题的关键所在是在PowerBuilder所能找到的路径中，必须有dbtl50t.dll这个文件，PB才会出现建数据库的选项。这个文件包含在完整的SQL 
      Anywhere之中，PB安装时只安装SQL Anywhere最基本的引擎部分，不安装这个文件。<br>
      　　解决方法：在PB光盘上有完整的SQL Anywhere 5.0，安装它即可。或者你也可以从其他机上将dbtl50t.dll拷贝到C:\Windows\System或\SQL 
      Anywhere 5.0\Win32中。<br>
      　　（本题由网易PB版主ilike提供解答）<br>
      　　四、数据窗口中某列的编辑风格设为下拉数据窗口（DropDownDataWindow），用GetItemNumber()函数只能得到实际值。有什么办法能得到此列的显示值？<br>
      　　答：数据窗口中有一个内部函数LookupDisplay()可实现此功能，若列名为“currency”，取第1行的显示值的方法如下：<br>
      　　dw_1.Describe ( “Evaluate(′LookupDisplay(currency)′,1)” )<br>
      　　这种方法同样适用于编辑风格为下拉列表框（DropDownListBox）、单选钮（RadioButtons）等的列。<br>
      　　五、在数据窗口录入数据时，有的域要输英文，有的域要输中文，每次要手工切换，很麻烦，能不能在程序中自动控制切换中英文输入法？<br>
      　　答：可以用API函数实现：<br>
      　　声明API函数：<br>
      　　function boolean ImmSimulateHotKey (ULong hWnd, ULong dwHotKeyID) library 
      “IMM32.dll” <br>
      　　function ulong GetKeyboardLayout(ulong dwLayout) LIBRARY “user32.dll”<br>
      　　function boolean ImmIsIME(uLong hklKeyboardLayout) library “IMM32.DLL” 
      <br>
      　　定义变量：<br>
      　　constant int IME_THotKey_IME_NonIME_Toggle=112<br>
      　　ulong hklCurrent<br>
      　　ulong hnd<br>
      　　切换到英文输入法：<br>
      　　hklCurrent=GetKeyboardLayout(0)<br>
      　　if ImmIsIME(hklCurrent) then<br>
      　　hnd=Handle(parent)<br>
      　　ImmSimulateHotKey(hnd,IME_THotKey_IME_NonIME_Toggle) <br>
      　　end if<br>
      　　切换到中文输入法：<br>
      　　hklCurrent=GetKeyboardLayout(0)<br>
      　　if not ImmIsIME(hklCurrent) then<br>
      　　hnd=Handle(parent)<br>
      　　ImmSimulateHotKey(hnd,IME_THotKey_IME_NonIME_Toggle)<br>
      　　end if<br>
      　　可根据需要，触发两段不同的脚本以达到动态切换中英文输入法的目的。<br>
      　　六、问：在数据窗口对象画板中可以设定列的编辑风格为下拉数据窗口（DropDownDataWindow），请问在程序中可以动态实现这项功能吗？<br>
      　　答：可以的，假设所设定列为部门号“department_id”，相关连的子数据窗口为“d_dddw_dep”，显示列为部门名称“dept_name”，数据列为部门号“dept_id”，实现方法如下：<br>
      　　dw_1.Modify(“department_id.DDDW.Name=d_dddw_dep ”)<br>
      　　dw_1.Modify(“department_id.DDDW.DisplayColumn=′dept_name′ ”)<br>
      　　dw_1.Modify(“department_id.DDDW.DataColumn=′dept_id′ ”)<br>
      　　或：<br>
      　　dw_1.object.department_id. DDDW.name = “d_dddw_dep”<br>
      　　dw_1.object.department_id.DDDW.DisplayColumn = “dept_name” dw_1.object.department_id.DDDW.DataColumn 
      = “dept_id”<br>
      　　注：PowerBuilder有一个小工具DWSyntax（程序名为：dwsyn60.exe），提供了获得及修改数据窗口、列等的各项属性值的语法，对编程非常有帮助。上述脚本在DWSyntax中都能找到。}<!-- #EndEditable --></TD>
  </TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>
      <script language="JavaScript" src="../../download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
</TR>
</TABLE></BODY><!-- #EndTemplate --></HTML>