<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- 使用VREPALR修复NOVELL网络的卷</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'>
      <div align="center">
        <img width="468" height="60" src="images/yjds.gif">
      </div>
    </TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; 2000 年 &gt; <a href="index.html">20期</a> 
      &gt; <a href="oa.html">OA专刊</a>&gt; 
      使用VREPALR修复NOVELL网络的卷</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 使用VREPALR修复NOVELL网络的卷 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>
      <p>　<b>　VREPAIR(Volume REPAIR)</b>是Netware为修复网络而提供的一个可装入模块,我初次使用就领略到了它的神奇魅力。</p>
      <p> 　　我校的计算机网络教室安装的是NOVELL网络操作系统,装有系统卷,教师卷,学生卷和游戏卷。有一天启动服务器时突然发生故障,文件服务器控制台显示镜像错误(Mirror 
        Error)和硬盘读错误(Read Error),并且显示学生卷安装失败(Volume student not mounted)。这表明有一些卷已经损坏。</p>
      <p> 　　我查阅了一些技术资料后,决定使用</p>
      <p>　　VREPAIR来进行修复，它可以在不破坏数据的情况下纠正卷上因硬磁盘故障而产生的非致命错误。</p>
      <p> 　　<b>一、VREPAIR修复卷的原理</b></p>
      <p> 　　Netware操作系统在硬盘的不同区域保存了FAT和目录表的双份拷贝。如果作了磁盘镜像,则有四份FAT和目录表的拷贝。运行VREPAIR时,它会自动比较主表和镜像表(副本)中的内容,发现不一致的地方则加以改正,然后将修正后的内容写入主表和它的镜像中。在修复过程中,VREPAIR可能会删除一些损坏严重的文件或表项。</p>
      <p> 　　在NOVELL网络出现下列故障时,可以使用VREPAIR来修复: </p>
      <p>　　1.硬件故障造成卷的加载过程中断或产生磁盘读错误。</p>
      <p> 　　2.电源失效或非正常关闭服务器损坏了卷。</p>
      <p> 　　3.文件服务器控制台在服务器启动时显示镜像错误(Mirror Error)。</p>
      <p> 　　4.卷安装失败(Volume not mounted),当SYS卷不能加载时,整个网络陷于瘫痪。</p>
      <p><b>　　 二、修复NOVELL网络的步骤</b></p>
      <p> 　　我采用以下步骤对NOVELL网络的卷进行修复:</p>
      <p> 　　第一步:使所有的工作站都退出网络,并关闭它们。</p>
      <p> 　　第二步:在控制台提示符“:”下,卸下有错误而需要修复的卷:</p>
      <p> 　　SERVER_312:DISMOUNT SYS &lt;CR&gt;<cr> (“CR”表示回车键)。考虑到系统卷可能也有错误,首先修复系统卷。</p>
      <p> 　　第三步:加载VREPAIR模块。</p>
      <p> 　　SERVER_312:LOAD C:\SERVER.312\VREPAIR <cr> (VREPAIR在C:\SERVER.312子目录下)。</p>
      <p> 　　这时,屏幕显示VREPAIR的主菜单如下:</p>
      <p> 　　opions:</p>
      <p> 　　1.Repair A Volume </p>
      <p>　　2.Set Repair options </p>
      <p>　　0.Exit</p>
      <p> 　　Enter your choice:</p>
      <p> 　　选项“1”表示修复一个卷,屏幕显示所有未安装的卷(只有一个卷时不显示),选择要修复的卷,VREPAIR显示出每一个有错误的目录或文件。</p>
      <p> 　　选项“2”表示设置VREPAIR参数。设置好参数后,系统会将错误信息记录到用户指定的文件中去,修复后的文件可能会被破坏,要用后备文件才能恢复,因此一般不提倡使用这个选项。</p>
      <p> 　　第四步:选择菜单选项,修复有错误的卷。</p>
      <p> 　　现在要修复卷的错误,故选择“1.Repair A Volume”。屏幕显示出所有未安装的卷,我先选择“SYS”卷进行修复。屏幕显示出该卷的错误信息(略)和供选择的菜单:</p>
      <p> 　　Total errors:</p>
      <p> 　　Current settings。</p>
      <p> 　　1.Pause after each error </p>
      <p>　　2.Do not log errors to a file</p>
      <p> 　　Press F1 change settins,or any key to continue &gt; 按F1键,改变设置,屏幕显示出如下信息:</p>
      <p> 　　Current settings:(当前设置)</p>
      <p> 　　Pause after each error(每出一个错误后暂停)</p>
      <p> 　　Do not log erroe to a file(出错信息不记录到文件中) </p>
      <p>　　Options:</p>
      <p> 　　1.Do not pause after errors(每出一个错误后不停)。</p>
      <p> 　　2.Log error to a file(出错信息记录到文件中)。</p>
      <p> 　　3.Stop volume repair(终止卷修复操作)。</p>
      <p> 　　0.Continue with volume repair(继续卷修复操作)。</p>
      <p> 　　Enter your choice:</p>
      <p> 　　因屏幕显示的错误信息较多,我按“1 <cr>”,改变设置,使其修复时在每一个错误处不停下来,这样可以大大提高修复的速度,修复工作可以自动进行,不需要人工干预,这对我更方便一些。屏幕上显示出许多空白,表示存在的错误,显示出的“”表示已经修复好的数据。随着修复过程的进行,屏幕上的数字在不断地跳跃和变化,当所有的空白都变成“”时,表示已经修复完好。大约经过15分钟～20分钟,屏幕显示都变成了“”,修复工作已经完成。这时,屏幕上提示: 
      </p>
      <p>　　Write repair to the disk(Y/N)?</p>
      <p> 　　问是否要将修复结果写到磁盘上,我键入“Y <cr>”,屏幕显示如下:</p>
      <p> 　　Write FAT repairs&gt;.............&lt; </p>
      <p>　　Write directory repairs&gt;......&lt; </p>
      <p>　　(Press any key to continue)</p>
      <p> 　　按一下任意键,返回到VREPAIR主菜单。再用同样的方法修复学生卷(Volume student),教师卷和游戏卷。 　　第五步:修复好所有的卷后,重新启动服务器。</p>
      <p> 　　修复好所有的卷后,在VREPAIR的主菜单上选择“0 <cr>”,退出VREPAIR,回到控制台提示符“:”下，键入如下命令关闭网络:</p>
      <p> 　　: DOWN&lt;CR&gt;</p>
      <p> <cr> 　　: EXIT&lt;CR&gt;<cr> </p>
      <p>　　然后,重新启动服务器,屏幕上显示出各个卷的安装过程。看到所有的卷都能顺利加载,最后,服务器显示屏上出现了蓝色背景下的网络主菜单。再检查各个卷的安装情况,显示的信息表明,所有的卷都已经加载成功,并且运行正常。“OK”,大功告成! 
      </p>
      <p> <b>　　三、使用VREPAIR的注意事项</b></p>
      <p> 　　根据我的经验,使用VREPAIR修复卷时,要注意以下一些问题:</p>
      <p> 　　1.修复过程必须在控制台提 示符“:”下进行。如果服务器已经启动,可以在服务器主菜单上选择“EXIT”退出网络,回到控制台提示符“:”下进行修复操作。</p>
      <p> 　　2.指定要修复的卷必须是没有加载的卷,若该卷已经加载,则要先用DISMOUNT命令将其卸下。</p>
      <p> 　　3.卷中需要修复的错误越多,则修复速度越慢。这时最好选择自动修复,不让其在每个错误处停下来,以提高修复速度。</p>
      <p> 　　4.修复过程中,屏幕上显示出的“”表示已经修复的数据,空白表示还没有修复的数据。</p>
      <p> 　　5.如果一次运行VREPAIR还不能修复成功,可以重复运行VREPAIR进行多次修复。</p>
      <p> 　　6.如果系统卷(SYS)损坏不能加载,则要使用软盘中的VREPAIR.NLM。这时可将操作系统盘中标有“SYSTEM2”的软盘插入A驱(或B驱),加载软盘中的VREPAIR.NLM。在服务器控制台提示符“:”输入命令:</p>
      <p> 　　: LOAD A:VREPAIR <cr> </p>
      <p>　　进入VREPAIR的主菜单后选择“1”进行修复。</p>
      <p> 　　7.VREPAIR参数设置:</p>
      <p> 　　进入VREPAIR的主菜单后,输入“2 <cr>”,选择“Set Vrepair Options”项, 根据屏幕提示进行设置和选择。</p>
      <p> 　　(1)如果要从卷中删除名字空间表,则输入“1 <cr>”,屏幕显示如下(参数设置菜单):</p>
      <p> 　　Sever Supported Name Spaces:</p>
      <p> 　　1.MACINTOSH </p>
      <p>　　2.NFS</p>
      <p> 　　3.FTAM </p>
      <p>　　4.OS2 </p>
      <p>　　0.Return to Vrepair</p>
      <p> 　　Enter Name space to Remove:</p>
      <p> 　　输入需要删除的名字空间的符号,然后输入“0 <cr>”,返回参数设置菜单。</p>
      <p> 　　(2)当卷损坏很严重或要删除一个名字空间项时,为了防止服务器内存不够。 应该选择“Write Changes Immediately 
        to Disk。”</p>
      <p> 　　(3)当服务器做了磁盘镜像时,如果第一次运行VREPAIR失败,而镜像盘上的卷的内容没有被损坏,则应选择“Write All Directory 
        and FAT Entries Out to Disk。”这样可以确保更新两个硬盘上的内容和FAT的所有内容后,使主磁盘和镜像盘保持一致。</p>
      <p> 　　(4)若要改变参数设置菜单中的2、3两项时,输入菜单序号后,该菜单项和当前设置中的对应项的内容互换。</p>
      <p> 　　(5)设置好参数后,输入“0 <cr>”,退回VREPAIR的主菜单。</p>
      <p> 　　8.如果要将出错信息记录到文件中去,则在VREPAIR主菜单上选择“1 <cr>”后, 再按“F1”,显示“改变设置菜单”,在设置菜单上选择“2 
        ”,屏幕上显示如下信息:</p>
      <p> 　　Error log file name:</p>
      <p> 　　要求输入记录错误信息的文件名。输入“C:\error\error.txt(或a:error.txt)”后则错误信息记录到C(A)盘中的“error.txt”文件中(记录错误信息的文件名由用户自己指定)。</p>
      <p> 　　9.对于损坏严重的卷或有致命错误的卷,如果多次运行VREPAIR也无法修复, 则应当重新安装,或者用备份盘恢复。</p>
      <p> 　　NOVELL网络在局域网中应用非常广泛。这种网络有许多优点,如安装简单, 使用方便,并且有较完善的安全措施和容错性能,可靠性高, 还有开放的网络软件开发环境。但也会常常因为停电,死机,操作失误等原因而造成故障,严重时甚至使整个网络瘫痪。学校和企事业单位的网络因使用频繁,特别是供学生使用的网络教室, 
        还可能经常发生误操作,出现的故障就更多。这些故障如果不及时解决, 会给企事单位和学校的工作带来重大损失。本文介绍了使用VREPAIR修复NOVELL网络的一些方法和经验,以供NOVELL网络管理员和业界同仁参考。 
      </p>
      <p align="right">（湖南　刘先觉）</p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD>&nbsp;</TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>