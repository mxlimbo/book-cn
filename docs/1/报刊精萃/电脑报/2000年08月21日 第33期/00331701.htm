 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 在VFP中发送电子邮件</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><a href="http://www.yesky.com"><img src="images/logo.gif" width="140" height="60" border="0"></a></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://drivers.cpcw.com/issue.htm'>2000 年</a> &gt; <a href='index.html'><!-- #BeginEditable "%C6%DA" -->33期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{在VFP中发送电子邮件}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{在VFP中发送电子邮件}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　用过《网络蚂蚁》的朋友都知道，在帮助菜单的对话框里作者留下了他的电子邮件地址，单击该邮件地址我们便能给作者发送电子邮件。这种功能看起来有些神秘，实际上只要利用Windows 
      API的ShellExecute函数，便可轻松地实现该功能。<br>
      　　ShellExecute是用来打开特定格式的文件（如WORD文件、EXCEL表格）的函数。该函数存放在Shell32.DLL动态链接库中，通过查阅MSDN，我们能够得到下述帮助：<br>
      　　HINSTANCE ShellExecute(HWND hwnd,LPCTSTR lpOperation,LPCTSTR lpFile,LPCTSTR 
      lpParameters,LPCTSTR lpDirectory,INT nShowCmd);<br>
      　　其调用参数的含义如下：<br>
      　　hwnd：指明打开文件的窗口句柄。<br>
      　　lpOperation:指明操作类型，分别是“open”（打开）、“print”（打印）、“explore”（浏览）。<br>
      　　lpFile:欲打开文件的文件名。这里应该将文件的含义向更深层次理解。文件可以是本地文件，也可以是远程文件；文件的类型可以是文本文件，也可以是多媒体文件。<br>
      　　lpParameters：打开文件时所传递的参数。特别适合打开EXE文件。<br>
      　　lpDirectory：文件所在路径。<br>
      　　nShowCmd：打开文件时窗口的状态。0表示隐藏，1表示最大化，2表示最小化。<br>
      　　如果该函数能够成功打开文件，则该函数的返回值大于32。该函数的返回值能够为你调试程序提供很多有用的信息，具体情况见MSDN内帮助文件。<br>
      　　好，有了上述认识之后，我们便能在VFP的程序开发中利用ShellExecute函数来实现发送电子邮件的功能。新建一表单ABOUTME，在该表单上添加下列控件(见表1)。<br>
      　　需要说明的是，在Label1中的MouseIcon设为一手型光标，其所对应的图标文件在系统内可以随处找到(利用查找文件功能)，本文用的是Windows自带h_move.cur文件。针对Label11的各类设置都是为了将该标签打扮得更象“超文本”。<br>
      　　添加完上述控件之后，接下来便是编写控件的CLICK事件代码了。对Label1和Label2的CLICK事件设定相同，其他代码为：<br>
      　　＊进行声明操作：<br>
      　　DECLARE INTEGER ShellExecute IN shell32.DLL INTEGER HWND,STRING,STRING 
      lpszFile,STRING,STRING,INTEGER<br>
      　　＊向kingdom@126.com邮箱内发送一封主题为“你好”的电子邮件。<br>
      　　在Label1的CLICK事件里，添加以下代码：<br>
      　　ShellExecute(0,″open″,″mailto:kingdom@126.com?subject=你好″,0,0,1)<br>
      　　在Label2的CLICK事件里，将上述语句改为：<br>
      　　ShellExecute(0,″open″,″http:∥NationalTax.home.Chinaren.com″,0,0,1)<br>
      　　＊以最大化窗口方式打开IE，进入作者主页。<br>
      　　确认按钮的CLICK事件代码很简单：thisform.release<br>
      　　运行上述表单，当鼠标移动到电子邮件或是作者主页区域时，鼠标便会变成一只手，点一下即可进行相应的操作：单击Label1，启动Outlook Express；单击Label2，启动IE，表单真有些像一个小型的IE！其实，在VFP的程序开发中，一些看似不可能的事件只要稍微用到一些Windows 
      API，所有的事件一下子都变得简单多了。“山重水复疑无路，柳暗花明又一村”，这可能就是编程的乐趣所在吧！（四川　周鸣扬)<br>
      　　<br>
      　　Windows API简介：<br>
      　　Application Program Interface，即应用程序编程接口，它是Windows提供给程序员的一系列函数。这些API函数同一般的函数相似，同样具有输入输出参数，并编译到一个独立的文件中，该文件被称为动态链接库。运用API函数可以实现许多复杂和有趣的功能，如重新启动计算机、跟踪当前激活窗体、收发E－mail等。}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://nethome.yesky.com/sp/yeskye.js">
</script>
    </TD>
    <TD> <A HREF='/'>CPCW版权所有</A>，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
