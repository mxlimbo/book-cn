 
<HTML>
 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- 手工优化MODEM的方法</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; 2000 年 &gt; <a href="index.html">07期</a> 
      &gt; <a href="internet.html">大众网络</a> 
      &gt; 手工优化MODEM的方法</TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 手工优化MODEM的方法 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>　　除了使用现成的优化软件外，我们还可以自己动手修改系统的配置文件及注册表等，达到优化MODEM的目的。 
      <p><b>　　1．MODEM配置</b></p>
      　　选中“控制面板”的“调制解调器”，单击“常规”项目下的“属性”，在“最快速度”设置中选定最大值“115200”。单击“连接”，不选取“拨号之前等候拨号音”。再单击“端口设置”，选取“使用FIFO缓冲区”，并且把“接受缓冲区”、“传输缓冲区”都设为最大。在“高级”选项中，选取“使用流控制”中的“硬件（RTS／CTS）”，不选取“使用差错控制”中的“请求连接”。在“附加设置”栏键入S11=50，即设置音频持续和间隔时间为最小值（50毫秒）。 
      <p><b>　　2．COM端口配置</b></p>
      　　MODEM应接在主机的COM2上，因为COM2比COM1中断优先权高，这样可以保证优先响应MODEM的中断请求。此外还须要对COM2端口进行设置。选中“控制面板”，双击“系统”，单击“设备管理器”，打开“端口（COM＆LPT）”，双击连接MODEM的“通讯端口”，单击“端口设置”，在“波特率”栏选取“115200”，在“数据位”栏选取“8”，在“奇偶校验”栏选取“无”，在“停止位”栏选取“1”，在“流量控制”栏选取“硬件”。<br>
      　　编辑“winini”文件，把“COM2=9600，n，8，1，x（默认值）”修改为“COM2=921600，n,8，1，p”。 
      <p><b>　　3修改SYSTEMINI文件</b></p>
      　　在Windows主目录下打开SYSTEMINI，在386[ENH]组中手工添上“com2buffer=2048”（上述是假设MODEM在COM2口、内存64M以上的电脑，如果内存小于64M可以将2048改为1024）。 
      <p><b>　　4修改注册表</b></p>
      　　(1）MaxMTU<br>
      　　MaxMTU在注册表中的位置：<br>
      　　HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Class\NetTrans\00yy，键名：MaxMTU。<br>
      　　其中yy是TCP/IP的入口，随设置的不同而不同，一般在00到30之间。<br>
      　　（2）DefaultRcvWindow<br>
      　　DefaultRcvWindow是缺省的传输单元缓冲区的大小。缓冲区太小，将导致分组阻塞，降低传输效率。缓冲区太大，一个分组出错会导致缓冲区中的所有分区被丢弃和重发，也会降低效率。该值的大小与MODEM的速度有关，最好是MSS（Maximum 
      Segment Size——最大分组数，等于MaxMTU减去40字节的地址信息）的整数倍。计算方法如下：假设你的MODEM是56Kbps的，那么最大传输率（无压缩）为56000/9=6222。如果MaxMTU值为576，则MSS的值为576－40=536，RcvWin值应设为536×12=6432（因为536×11&lt;6222）。其他的依此类推。当然，如果不考虑分组出错的情况，那么可以将缓冲区直接开到最大，以得到最好的效果。<br>
      　　DefaultRcvWindow在注册表中的位置：<br>
      　　HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\MSTCP，键名：DefaultRcvWindow。<br>
      　　该值Windows缺省为8192，56Kbps MODEM优化值为6432。<br>
      　　(3)DefaultTTL<br>
      　　DefaultTTL是TCP/IP分组的寿命，如果分组在Internet中传输的时间超过了分组的寿命，则该分组将被丢弃。将DefaultTTL改得更大些，有利于信息在Internet中传得更远。<br>
      　　DefaultTTL在注册表中的位置：<br>
      　　HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\MSTCP，键名：DefaultTTL。<br>
      　　该值缺省为32，默认优化值为255。<br>
      　　(4)NameSrvQueryTimeout<br>
      　　NameSrvQueryTimeout是域名服务器超时计数。如果在计数值的时间内没有收到域名服务器的回应，则系统认为域名服务器没有收到本机的请求，请求将会重发或做超时错误处理。加大此值可以增加连接的成功率。 
      　　DefaultTTL在注册表中的位置：<br>
      　　HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\MSTCP，键名：NameSrvQueryTimeout。<br>
      　　该值Windows缺省为750（毫秒），默认优化值为3000，最大不得超过65535。建议采用Windows缺省值750。<br>
      　　(5)MaxSocket和NDI<br>
      　　MaxSocket在注册表中的位置：<br>
      　　HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\NWLink\Ndi\params\maxsockets，键名：max。<br>
      　　默认优化值为1020。<br>
      　　NDI在注册表中的位置：<br>
      　　HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\NWLink\Ndi\params\cachesize，键名：（默认）<br>
      　　该值Windows缺省为0，默认优化值为16。<br>
      　　这两项是优化NWLink协议的，对于只使用TCP/IP协议的用户（一般拨号上网的用户）没有多大用处。<br>
      　　(6)NameCache和PathCache<br>
      　　Windows储存已访问文件的路径和名字，以加快下一次访问的速度。可以将它们改得大些。<br>
      　　Windows对于不同的机型（台式机、便携机、服务器）有不同的设置，可根据具体情况选择。<br>
      　　NameCache和PathCache在注册表中的位置：<br>
      　　HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\FS Templates\Desktop，键名：<br>
      NameCache，PathCache(注意其值是二进制形式)。<br>
      　　NameCache：Windows缺省为32，默认优化值为128。<br>
      　　PathCache：Windows缺省为677，默认优化值为4096。<br>
      　　(7)MODEM初始化字符串<br>
      　　MODEM初始化字符串是以“AT”开头的字符串形式的命令，根据MODEM的型号不同而不同。适当的初始化字符串可以提高MODEM的工作效率。具体请参阅你的MODEM使用说明书，或访问MODEM厂商的主页。<br>
      　　(8)最后要说明的一点是，几乎现在所有的MODEM优化工具对NDI Cache的设置都没有考虑到中文版Windows注册表的特点，所以进行优化后须要手工修改注册表，具体方法是：运行注册表编辑器，在HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\NWLink\Ndi\params\cachesize，修改该键值的默认值为16或20等，然后删除下边的Default值，最后保存设置并重新启动系统即可。<br>
      <b>(四川　龚师傅)</b></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>下载本期推荐软件</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD>&nbsp; 
      
       </TD>
    <TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>

</HTML>
