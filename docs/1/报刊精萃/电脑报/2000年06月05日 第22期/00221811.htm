<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/epcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- 用DELPHI编写字数统计程序</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span></span><A NAME='top'></A>  

 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<tr>
    <td width='470' bgcolor='#CCCC99' height='50'><img src="images/yjds.gif" width="468" height="60"> 
    </td>
  </tr>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<table width='468' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='index.html'>CPCW电子版</a> 
      &gt; 2000 年 &gt; <a href="index.html">22期</a> 
      &gt; <a href="software.html">软件世界</a> &gt; 用DELPHI编写字数统计程序</td>
  </tr>
</table>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN>《 用DELPHI编写字数统计程序 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>
      <p>　　我们都知道，Word97/2000里有“字数统计”的功能，但它的“字数统计”功能有一个缺陷：它会把全角符号都视为汉字处理，结果统计的汉字数总是大于实际的汉字数，针对这个缺陷，本人编写了这个程序，此程序不同于1997年《电脑报》中的一篇查汉字的文章：第一，那个程序是Pascal编写的；第二，那个程序不能识别GBK大字符集的汉字，比如“”等等汉字它都视而不见。方法如下：<br>
        　　首先进入Delphi主界面，选择“File/New Application”，在程序设计窗体上建立一个Button控件、一个Memo控件和一个Label控件，分别取名为“Button1”、“Memo1”和“Label1”，然后双击“Button1”进入“Button1”的“onlick”事件设置窗口，对应的代码如下：<br>
        　　procedure TForm1.Button1Click(Sender: TObject);<br>
        　　var<br>
        　　Character,i:integer;<br>
        　　Str:string;<br>
        　　begin<br>
        　　i:=1;<br>
        　　Character:=0;<br>
        　　Str:=Memo1.lines.text;<br>
        　　If Length(Str)&gt;0 Then<br>
        　　Repeat<br>
        　　if(ord(Str[i])&gt;=129) and (ord(Str[i])&lt;=254 )and (ord(Str[i＋1])&gt;=64) 
        and (ord(Str[i＋1])&lt;=254)then<br>
        　　Begin<br>
        　　If (ord(Str[i])&gt;=161) and (ord(Str[i])&lt;=169) Then<br>
        　　i:=i＋2<br>
        　　Else<br>
        　　Begin<br>
        　　i:=i＋2;<br>
        　　Character:=Character＋1;<br>
        　　end;<br>
        　　end<br>
        　　Else<br>
        　　i:=i＋1;<br>
        　　Until i&gt;=length(Str);<br>
        　　Label1.caption:=′共有 ′＋IntToStr(Character)＋′ 个汉字′;end;<br>
        　　按F9执行程序，运行成功后，在Memo1中输入一些汉字和全角符号以及GBK大字符集中的汉字，试验一下程序的可靠性。这样以后就可以安心地写文章，而再也不用担心字数不够了。</p>
      <p align="right"><br>
        　　（吉林　李宏秋）</p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>&nbsp;</TD>
<TD> <A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>