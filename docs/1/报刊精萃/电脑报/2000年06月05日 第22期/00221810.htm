<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/epcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- 在VB中利用MSTTS技术实现英语朗读功能</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span></span><A NAME='top'></A>  

 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<tr>
    <td width='470' bgcolor='#CCCC99' height='50'><img src="images/yjds.gif" width="468" height="60"> 
    </td>
  </tr>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<table width='468' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='index.html'>CPCW电子版</a> 
      &gt; 2000 年 &gt; <a href="index.html">22期</a> 
      &gt; <a href="software.html">软件世界</a> &gt; 在VB中利用MSTTS技术实现英语朗读功能</td>
  </tr>
</table>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN>《 在VB中利用MSTTS技术实现英语朗读功能 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>
      <p>　　《金山词霸2000》的英文全文朗读功能，是直接使用了MSTTS(Text－to－Speech)技术，在VB6.0中通过对MS Speech 
        API的调用，可以轻松实现更强大的功能。方法如下：<br>
        　　首先，从《金山词霸2000》光盘上\ciba子目录下运行mstts.exe(MS TTS engine)并安装spchapi(MS Speech 
        API)。<br>
        　　第二，进入VB6.0,执行菜单“工程”中的“引用”，“浏览”到Windows目录下的Speech子目录，打开vtxtauto.tlb,则“VoiceText 
        1.0 Type Library”将被添加到可用的引用中。选中它，然后单击确定。<br>
        　　第三，执行菜单“文件/新建工程/标准EXE”并确定，在Form1中添加Text1,command1,command2,command3和command4。主要属性设置如下：<br>
        　　Form1的StartUpPosition=2<br>
        　　Text1的MultiLine=True,Caption=″How are you?″,ScrollBars=2<br>
        　　Command1的Caption=″Read″<br>
        　　Command2的Caption=″Stop″,Enabled=false<br>
        　　Command3的Caption=″Pause″,Enabled=false<br>
        　　Command4的Caption=″Quit″<br>
        　　第四，代码如下：<br>
        　　′通用声明<br>
        　　Private Declare Function waveOutGetNumDevs Lib ″winmm.dll″ () As Long<br>
        　　Private Sub Form_Load()<br>
        　　′通过API函数调用,判断系统是否安装有声卡以及声卡驱动程序<br>
        　　Dim i As Integer<br>
        　　i = waveOutGetNumDevs()<br>
        　　If i &lt;= 0 Then<br>
        　　MsgBox ″系统无声卡或未装声卡驱动程序，请安装好以后再试...″, ″错误提示″<br>
        　　Unload Me<br>
        　　Else<br>
        　　′注册<br>
        　　Call VTxtAuto.VTxtAuto.Register(Space(10), Space(10))<br>
        　　End If<br>
        　　End Sub<br>
        　　Private Sub Command1_Click()<br>
        　　′如果text1中有汉字,转到错误提示<br>
        　　On Error GoTo handler<br>
        　　′开始朗读<br>
        　　Call VTxtAuto.VTxtAuto.Speak(Trim(Text1.Text), vtxtsp_VERYHIGH ＋ vtxtst_READING)<br>
        　　Command2.Enabled = True<br>
        　　Command3.Enabled = True<br>
        　　Exit Sub<br>
        　　handler:<br>
        　　MsgBox ″本程序只能阅读英文文档″, , ″错误提示″<br>
        　　End Sub<br>
        　　Private Sub Command2_Click()<br>
        　　′停止朗读<br>
        　　Call VTxtAuto.VTxtAuto.StopSpeaking<br>
        　　Command2.Enabled = False<br>
        　　Command3.Enabled = False<br>
        　　End Sub<br>
        　　Private Sub Command3_Click()<br>
        　　′暂停或恢复朗读<br>
        　　If VTxtAuto.VTxtAuto.IsSpeaking Then<br>
        　　Call VTxtAuto.VTxtAuto.AudioPause<br>
        　　Command3.Caption = ″Resume″<br>
        　　Else<br>
        　　Call VTxtAuto.VTxtAuto.AudioResume<br>
        　　Command3.Caption = ″Pause″<br>
        　　End If<br>
        　　End Sub<br>
        　　Private Sub Command4_Click()<br>
        　　Unload Me<br>
        　　End Sub<br>
        　　程序运行时,在Text1中输入英文句子,然后单击“朗读”按钮,即可实现朗读。<br>
        　　第五，说明:<br>
        　　1.成员函数的第一个参数向TTS引擎传递需要朗读的文字,第二个控制朗读时的语气和优先级,由两个常量相加组成。<br>
        　　控制优先级的常量有：vtxtsp_HIGH = 256 (＆H100)，尽快读出，加入播放队列开始。vtxtsp_NORMAL = 512 
        (＆H200)，默认，加入播放队列末尾。vtxtsp_VERYHIGH = 128 (＆H80),立即读出，可打断正在读的内容。<br>
        　　控制语气的常量有：vtxtst_COMMAND = 4，命令的语气。vtxtst_NUMBERS = 32 (＆H20)，阅读数字的语气。vtxtst_QUESTION 
        = 2，提问的语气。vtxtst_READING = 16 (＆H10)，阅读文档时的语气。vtxtst_SPREADSHEET = 64 
        (＆H40)，阅读电子表格中元素的语气。vtxtst_STATEMENT = 1，平时说话时的语气，默认。vtxtst_WARNING = 
        8，警告语气。<br>
        　　2.通过IsSpeaking可以取得当前状态,AudioPause和AudioResume实现暂停和恢复朗读。<br>
        　　3.另外，AudioFastForward和AudioRewind可以向前和向后跳过一句朗读,修改Speed属性的值可以设置朗读的语速,默认是170。<br>
        　　4.本程序支持粘贴功能，可从剪贴板中粘贴英文文档内容到文本框中，也可直接输入英文句子。<br>
        　　注：本程序在Win98、VB6.0环境中调试通过。</p>
      <p align="right"><br>
        　　（请本文作者速与编辑部联系）</p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>&nbsp;</TD>
<TD> <A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>