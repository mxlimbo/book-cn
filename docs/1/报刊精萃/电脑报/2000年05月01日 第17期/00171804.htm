<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 魔鬼辞典</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'></TD>
</TR></TABLE>
<table width='468' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; 2000 年 &gt; <!-- #BeginEditable "%C6%DA" -->17期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt;用VB制作网址链接器</td>
  </tr>
</table>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 用VB制作网址链接器 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD> 
      <p>　　用过《东方网神》的朋友们都知道，《东方网神》内设有一个网址资源，分类存放了很多网址，你只要用鼠标单击要去的网址，就可把你带到该网站。其实我们也可以自己设计一个网址链接器实现此功能。<br>
        　　下面就用VB6.0编写一个简单的网址链接器，步骤如下：<br>
        　　1．启动VB6.0,新建一个标准EXE工程，系统自动创建一个窗体form1,设置其caption属性为“创新搜索引擎”。<br>
        　　2．我们需要引用一个API函数ShellExecute，方法是在工程中添加一个模块Module1，打开VB6.0 API浏览器，在API浏览器的“文件”菜单中选择“加载文本文件”菜单项，此时将弹出一个“选择一个文本API文件”对话框，从中选择“Win32api.txt”，单击“确定”按钮，单击ShellExecute函数，然后单击“复制”按钮。再回到Module1,按CTRL＋V把ShellExecute函数粘贴到Module1模块的代码窗口中。<br>
        　　3．回到form1窗体，添加一个frame控件，取名为frame1,caption属性设置为“请选择网站类别”，在frame1控件中放置一个option 
        button控件组(单选按钮)，取名为option1,该控件存放网站类别，可根据需要设置option的控件数目。这里仅设置了四个，option1(0)的caption属性为“国内著名网站”，option1(1)的caption属性为“IT”，option1(2)的caption属性为“硬件”，option1(3)的caption属性为“软件”。<br>
        　　4．再添加一个frame控件，取名为frame2，caption属性设置为“请选择网站”,在frame2控件中放置一个label控件组，取名为label1,该控件存放网站的名称。放置两个label控件，也根据实际需要设置控件数目。设置其Font属性为下划线,Forecolor属性为突出显示，Mouseicon属性(设置自定义的鼠标图标)为一个手形图标，这里为VB98\graphics\icons\arrows目录下的Point02.ico文件，其Mousepointer属性为99(通过Mouseseicon属性所指定的自定义图标)。<br>
        　　5．在form1窗体声明以下变量：<br>
        　　Public kind As String ′kind变量为网站类别 <br>
        　　Dim addess As String ′addess变量为网址 <br>
        　　Dim addeslink <br>
        　　6．双击form1窗体的option1控件，在弹出的代码窗口中的Private Sub Option1_Click(Index As Integer)子程序中编写代码：<br>
        　　Select Case Index <br>
        　　Case 0 ′国内著名网站 <br>
        　　kind = ″zm″<br>
        　　Label1(0).Caption = ″搜狐″<br>
        　　′当鼠标移到该控件时，显示该网站的网址<br>
        　　Label1(0).ToolTipText = ″http://www.sohoo.com.cn/″ <br>
        　　Label1(1).Caption = ″网易″<br>
        　　Label1(1).ToolTipText = ″http://www.netease.com/″ <br>
        　　′以下添加你常用的网站的网址 <br>
        　　...<br>
        　　Case 1 ′IT <br>
        　　kind= ″IT″<br>
        　　Label1(0).Caption = ″电脑报″<br>
        　　Label1(0).ToolTipText = ″http://www.yesky.com/″<br>
        　　′以下添加你常去的网站的网址<br>
        　　...<br>
        　　Case 2 ′硬件<br>
        　　kind= ″hardware″<br>
        　　Label1(0).Caption = ″驱动之家″<br>
        　　Label1(0).ToolTipText = ″http://www.mydrives.com″<br>
        　　′以下你常用的网站的网址 <br>
        　　... <br>
        　　Case 3 ′软件<br>
        　　kind = ″software″<br>
        　　Label1(0).Caption = ″华军软件园″<br>
        　　Label1(0).ToolTipText = ″http://www.newhua.com.cn/″<br>
        　　′以下添加你常用的网站的网址 <br>
        　　...<br>
        　　End Select<br>
        　　End Sub<br>
        　　7．编写一个link子程序<br>
        　　′此子程序功能为转到超级链接<br>
        　　Private Sub link( )linkaddess = ShellExecute(0＆, vbNullString, addess, 
        vbNullString, vbNullString, vbNormalFocus) <br>
        　　End Sub <br>
        　　8．双击form1窗体的label1控件，在弹出的代码窗口中的Private Sub Label1_Click(Index As Integer)子程序中编写代码：<br>
        　　If kind = ″zm″ Then ′<br>
        如果单击“著名国内网站“单选按钮则 <br>
        　　Select Case Index <br>
        　　Case 0 ′如果单击第一个label控件则 <br>
        　　addess = ″http://www.sohoo.com.cn/″<br>
        　　Call link ′调用link子程序,进行超级链接 <br>
        　　Case 1 <br>
        　　addess = ″http://www.netease.com/<br>
        　　end select <br>
        　　ElseIf kind = ″IT″ Then ′如果单击“IT“单选按钮则 <br>
        　　Select Case Index <br>
        　　Case 0 <br>
        　　addess = ″http://www.cce.com.cn/″<br>
        　　Call link <br>
        　　end select <br>
        　　ElseIf kind = ″hardware″ Then ′硬件 <br>
        　　Select Case Index <br>
        　　Case 0 <br>
        　　addess = ″http://www.mydrives.com″<br>
        　　Call link<br>
        　　end select<br>
        　　ElseIf kind = ″software″ Then ′软件<br>
        　　Select Case Index <br>
        　　Case 0<br>
        　　addess = ″http://www.newhua.com.cn/″<br>
        　　Call link <br>
        　　end select <br>
        　　endif <br>
        　　end sub<br>
        　　9．保存该工程，取名为“创新链接器”，并生成“创新链接器.EXE”。至此，一个简单的链接器就制作完成了。<br>
        　　测试：拨号上网，启动该链接器程序，把鼠标移动到“搜狐“，出现一个手形光标，并显示其网址：<br>
        http://www.sohoo.com.cn/。此时单击鼠标左键，浏览器被运行并打开 “搜狐”的主页，所示。<br>
        　　当然，我们还可扩充其功能，如：1.把常用的网址放入一个数据库，加入数据控件，使其成为一个搜索引挚；<br>
        　　2.添加一个systray控件，使程序启动后放入WIN95/WIN98状态栏的系统盒中等等。限于篇幅，这里不再具体说明。编写此程序旨在抛砖引玉，朋友们如有什么建议，请与我联系：rabbitlhf@zdl.net。<br>
        　　此程序在WIN95/WIN98,VB6.0运行通过。<br>
      </p>
      <p align="right">　　（广西　梁海锋）</p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有</A>，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>