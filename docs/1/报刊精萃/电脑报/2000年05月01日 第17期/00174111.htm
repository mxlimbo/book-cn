<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 魔鬼辞典</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; 2000 年 &gt; 17<!-- #BeginEditable "%C6%DA" -->期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="internet.html">大众网络</a><!-- #EndEditable --> 
      &gt;用ASP编写图片计数器</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 用ASP编写图片计数器 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD> 
      <p>　　在Internet上，用ASP编写的计数器到处都是，本人觉得再在这里谈ASP编写计数器已没有多大意义。后来想想还是有必要谈一下，因为这不仅仅只是在谈计数器的编写，而是在向大家介绍ASP的知识与应用技巧。 
        　　程序原代码如下：<br>
        　　&lt;％countlong=8 ′countlong定义计数器显示位数<br>
        　　On Error Resume Next ′ 忽略所有的错误<br>
        　　count=server.mappath(″count.txt″) <br>
        　　set cou = server.createobject(″scripting.filesystemobject″)<br>
        　　set out=cou.opentextfile(count,1,false,false) <br>
        　　counter=out.readline<br>
        　　out.close <br>
        　　′以上代码是打开文件count.txt并读取一行,读出目前计数器的值<br>
        　　if session(″in″)&lt;>″in″ then <br>
        　　′判断用户是否已进入主页，以确保他按刷新或再次来到此页面时计数器不会再加1 <br>
        　　session(″in″)=″in″<br>
        　　set out = cou.createtextfile(count,true,false)<br>
        　　application.lock <br>
        　　counter=counter＋1 ′计数器加1 <br>
        　　out.writeline(counter) <br>
        　　application.unlock<br>
        　　out.close<br>
        　　′以上代码是建立一个新的文件count.txt并写入一行，写入加1后计数器的值 <br>
        　　end if <br>
        　　co=cstr(counter) ′cstr函数用来把数字型变量转换成字符型 <br>
        　　for i = 1 to countlong－len(co) <br>
        　　response.write ″″<br>
        　　next <br>
        　　′上面的循环语句是完成计数器前面的0图片的添加 <br>
        　　′len(co)函数是得到变量co的长度，countlong－len(co)就得到前面0图片的个数 <br>
        　　for i= 1 to len(co) <br>
        　　response.write ″″ <br>
        　　next <br>
        　　′mid(co,i,1)函数是用来从变量co的第i位开始读一个字符％> <br>
        　　这个计数器做得比较成功的地方是使用session防止用户对计数器的多次刷新; 使用了文本文件记录计数器的值，虽然代码写起来比较长，但比起用application对象要好得多，因为当服务器reboot或改动global.asa时 
        ,application对象的值就会被清空; 还有就是用图片代替了字符，看起来更美观大方！ 　　计数器的图片你可以自己设计一下，0用文件名0.gif，1用1.gif,以此类推。<br>
      </p>
      <p align="right">　　（浙江　烛光）</p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有</A>，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>