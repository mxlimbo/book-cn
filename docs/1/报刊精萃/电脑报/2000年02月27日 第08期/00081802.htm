 
<HTML>
 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- VB中DOS文件名与长文件名的转换</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; 2000 年 &gt; <a href="index.html">08期</a> 
      &gt; <a href="software.html">软件世界</a> 
      &gt; VB中DOS文件名与长文件名的转换</TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 VB中DOS文件名与长文件名的转换 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>　　自从进入Win95时代以来，Win95的长文件名给人们带来了很多方便，但是由于原来的DOS只支持8.3格式，即8个主文件名加上3个扩展名，所以所有Win95的长文件名都有一个DOS名，具体方法为取原长文件名前6位加～num（其中num为现目录中不重名的序号）。现在的VB已完全支持了长文件名，但是有一点可能没有注意到，即当用command()接收从命令行传来的参数时，如果参数是长文件名，则被强制转换成为DOS名，即8.3格式文件名。由于这两种文件名通用，所以一般情况下不会有什么问题。但遇到特殊场合就不行了。有没有办法再把8.3格式的文件名转换为原来的长文件名呢？答案是：可以。<br>
      　　让我们编程来回答这个问题：<br>
      　　首先建立一个窗体，在窗体上加两个TEXT控件，其中第一个TEXT的TEXT属性为“显示命令行参数”，第二个TEXT的TEXT属性为“显示转换后文件名”,再建立一个 
      commandbutton 控件，其caption属性为“显示”，具体原代码如下：<br>
      　　′－－－－－－－通用，声明:<br>
      　　Dim dosfilename As String ′声明dos 文件名<br>
      　　Dim longfilename As String ′声明长文件名<br>
      　　′－－－－－－－－－－－－<br>
      　　Private Sub Command1_Click()<br>
      　　Text1.Text = dosfilename<br>
      　　Text2.Text = longfilename<br>
      　　End Sub<br>
      　　′－－－－－－－－<br>
      　　Private Sub Form_Load()<br>
      　　dosfilename = Command＄() ′从命令行取得参数<br>
      　　longfilename = Dir(dosfilename) ′得到长文件名<br>
      　　End Sub<br>
      　　接着生成EXE文件，然后将一个长文件名的文件图标拖到新生成的EXE文件上去，点击EXE文件的commandbutton 就可以看到转换结果了。<br>
      <b>　　（马　麟）</b></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD>&nbsp; 
      
       </TD>
    <TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>

</HTML>
