 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --算算今天是第几周？</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='143' HEIGHT='50' ALT='电脑报' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/issue/all.html'>2000 年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->36期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{算算今天是第几周？}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{算算今天是第几周？}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　新的学期又到了，听说第十周有门课要考试了，到底今天是第几周呢？算起来真麻烦，让我们编程来解决！利用C＋＋ 
      Builder中的TDateTime类及其相关的方法可以很轻松的解决这个问题。<br>
      　　首先需要说明的是，对于每个日期时刻都有一个整型（对于纯日期）或双精度型数值与其相对应。TDateTime类对应数值的整数部分代表距1899年12月30日的天数，而小数部分则代表当天的具体时刻。<br>
      　　下面是一些具体的TDateTime类数值对应的日期和时刻。<br>
      　　0　1899－12－30 12:00 am<br>
      　　2.75　1900－1－1 6:00 pm<br>
      　　－1.25　1899－12－29 6:00 am<br>
      　　35065　1996－1－1 12:00 am<br>
      　　利用TDateTime类的operator方法就可以对这些数值进行操作，从而计算出今天是第几周。下面是一个简单的示例程序。<br>
      　　先建立一个Form，然后在这个Form上加上一个Edit组件、一个Label组件和一个Button组件，并把Edit组件的Text属性改为2000－9－4（起始日期），其余所有的属性都可以保持缺省值。<br>
      　　在Button1的Click事件中加入如下一小段代码：<br>
      　　void __fastcall TForm1::Button1Click(TObject ＊Sender)<br>
      　　{<br>
      　　∥定义两个TDateTime类变量，起始时间和现在时间<br>
      　　TDateTime begin,now;<br>
      　　int week=0;<br>
      　　∥把Edit1组件中的字符串转换为日期<br>
      　　begin=StrToDateTime(Edit1－&gt;Text);<br>
      　　∥得到现在日期<br>
      　　now=Now();<br>
      　　∥计算今天的周数，floor函数取整，需要在程序起始部分加入＃include &lt;math.h&gt;。<br>
      　　∥大家可以根据实际情况适当更改下面的表达式。<br>
      　　week=floor(now.operator －(begin))/7＋1;<br>
      　　∥在Label1组件中显示今天的周数<br>
      　　Label1－&gt;Caption=week;<br>
      　　Label1－&gt;Refresh();<br>
      　　}<br>
      　　运行该程序，按下Button1按钮就可以显示出今天是第几周，可以更改Edit1组件框中的字符串来设置不同的日期起始值。由于这里没有对字符串作为日期表达式合法性的判断，所以你输入的日期要用原来的格式，否则会@＃＄％^＆... 
      　（上海　Purple）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://nethome.yesky.com/sp/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
