 
<HTML>
<!-- #BeginTemplate "/Templates/oa.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2912'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 巧用EXCEL97/2000自动计算个人所得税</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='/'><IMG SRC='../../images/logo.gif' WIDTH='143' HEIGHT='50' ALT='电脑报' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesk.com"><img src="images/0823-3.gif" width="468" height="60"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='/issue/index.html'>CPCW电子版</A> 
      &gt; <A HREF='http://drivers.cpcw.com/issue.htm'>2000 年</A> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->29期<!-- #EndEditable --></a> 
      &gt;<!-- #BeginEditable "%C0%B8%C4%BF" --> <a href="oa.html">OA专刊</a><!-- #EndEditable -->&gt; 
      <!-- #BeginEditable "%B1%EA%CC%E2" -->巧用EXCEL97/2000自动计算个人所得税<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->巧用EXCEL97/2000自动计算个人所得税<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%C4%DA%C8%DD" -->　　新的个人所得税法的颁布实施，已经为国家财政收入和调节个体收入差异起到了积极的作用。但是，个人所得税的征收管理工作仍不很理想，而计算个人所得税的工作量较大，不能不说是其中的一个重要原因。个人所得税计算的工作量大，其实多数指的是对“工资薪金所得”项目个人所得税的计算。因为，每一个单位少则几十人，多则几百人，每个月都要算一下哪些人要缴个人所得税，应缴纳多少金额，等等，实在不是一件轻松的事。因此，本文侧重于对“工资薪金所得”的探讨，其他项目则是“一窍通，百窍同”了。<br>
      　　一、个人取得的所得是含税所得（雇主不负担税款）情况下个人所得税的计算<br>
      　　设计一表格（表1），该表共10栏（A、B、C、D……为列标，1、2、3、4……为行标）。先选定F3单元格，在其中填写公式“=Sum（c3：e3）”，该公式的含义是：本单元格等于c3到e3这三个单元格之和，即：含税收入=工资＋奖金＋补贴。再选定G3单元格，在其中填写如下公式：“=if(f3&gt;800,f3－800,0)”。该公式的含义是：如果f3&gt;800，那么G3=f3－800，否则G3=0；即：如果含税收入大于费用扣除标准，那么应税所得等于含税收入减去费用扣除标准后的差额，否则就等于0。<br>
      　　再选定H3单元格，在其中填写如下公式：“=if(g3&lt;=500,5％,if(g3&lt;=2000,10％,if(g3&lt;=5000,15％,if(g3&lt;=20000,20％,if(g3&lt;=40000,25％,if(g3&lt;=60000,30％,if(g3&lt;=80000,35％,if(g3&lt;=100000,40％,45％))))))))”。该公式的含义是：当G3的值（应税所得）小于或等于500时，H3（适用税率）为5％，当500&lt;G3&lt;=2000时，H3为10％，当2000&lt;G3&lt;=5000时，H3为15％……<br>
      　　再选定I3单元格，在其中填写如下公式：“=if(h3=5％,0,if(h3=10％,25,if(h3=15％,125,if(h3=20％,375,if(h3=25％,1375,if(h3=30％,3375,if(h3=35％,6375,if(h3=40％,10375,15375))))))))”。该公式的含义是：当H3（适用税率）=5％时，I 
      3（速算扣除数）=0，当H3=10％时，I 3=25,当H3=15％时，I 3=125……<br>
      　　再选定J3单元格，在其中填写公式：“=g3＊h3－i3”即可。该公式的含义为：J3=G3×H3 － I 3，即：应纳税额=应税所得×适用税率－速算扣除数。<br>
      　　现在，第一个记录中各单元格的公式都设好了，我们只要在C3到E3的各个单元格中输入数值，就会马上知道应税所得、适用税率、速算扣除数和应纳税额分别是多少。<br>
      　　不过，到现在为止，我们还只能对一个记录进行自动计算，因为下一个记录我们还没有给它填写公式。为此，我们可以利用自动填充功能来完成：先同时选定F3到J3这五个单元格，接着把鼠标指向J3单元格的右下角一黑色小方块处，当鼠标变成了一个黑色的“＋”时，按住鼠标左键不放，向下拖动，我们拖到哪里，公式就自动复制到哪里。<br>
      　　现在所有的公式都设好了，接下来就是一些扫尾工作了，如：1给表格加上表格线；2通过“页面设置”窗口，给表格加上行标题；3通过“分类汇总给每页加上合计数，并在最后一页加上总计数。等等，这里就不一一说明了。<br>
      　　至此，我们就把整张表格都设计好了，只要把刚才设计好的表格保存为“模板”形式，就可以在以后的工作中反复调用，而不必从头再来。<br>
      　　二、个人取得的所得为不含税所得情况下个人所得税的计算<br>
      　　在这种情况下，应税所得=（不含税收入 － 费用扣除标准 － 速算扣除数）÷（1－ 税率），所以我们要在表1的基础上做下列的修改才能保证计算的准确性：1把“含税收入”改为“不含税收入”；2把G3单元格中的公式改为：“=if(f3&gt;800,（f3－800－i3）/（1－h3）, 
      0 )”；3把H3单元格中的公式改为“=if(f3－800&lt;=475,5％,if(475&lt;f3－800&lt;=1825,10％,if(1825&lt;=f3－800&lt;4375,15％,if(4375&lt;=f3－800&lt;16375,20％,if(16375&lt;=f3－800&lt;31375,25％,if(31375&lt;=f3－800&lt;45375,30％,if(45375&lt;=f3－800&lt;58375,35％,if(58375&lt;=f3－800&lt;70375,40％,45％))))))))”；其他各单元格则保持不变。接下来的工作就和第一点的一样了（修改后的表格命名为表2）。<br>
      　　三、个人取得的所得含且只含有部分税款（雇主负担部分税款）情况下个人所得税的计算<br>
      　　1.雇主定额负担税款<br>
      　　这种情况下，以表1为基础在“含税收入”前插入一栏“雇主负担税额”，然后把G3中的公式改为“=Sum（c3：f3）”，其他单元格中的公式则无须我们手工去修改，一切都已在悄然间自动完成了。接下来的工作也是和第一点中的相同（修改后的表格命名为表3）。<br>
      　　2.个人定额负担税款<br>
      　　这种情况下，以表2为基础，在“不含税收入”前插入一栏“个人负担税额”，然后把G3中的公式改为“=sum（c3：e3）－ f3”即可，其他单元格中的公式也无须手工更改。接下来的工作也是和第一点中的相同（修改后的表格命名为表4）。<br>
      　　3.雇主按比例负担税款<br>
      　　在这种情况下，应税所得必须通过公式“应税所得=（未含雇主负担的税款的收入额 － 费用扣除标准 － 速算扣除数×比例）÷（1－ 税率×比例）”来求得，而由公式我们可以看出，要求应税所得，先要知道适用税率；而要确定适用税率，就必须知道应税所得或不含税所得。这样就出现了“死循环”——要求A必须知道B，而要确定B则须知道A。难道我们就没有办法了？这时我们可以用“代入法”来确定适用税率并求出应税所得：就是把各个税率（5％、10％、15％、20％、25％、30％、35％、40％、45％）逐一代入上面的这一公式中，然后根据求出的应税所得来确定它的适用税率，最后把这个适用税率和刚才代入公式的税率比较——如果两者相等，说明这个税率是正确的，否则就是错误的。<br>
      　　根据这个原理，我们可以利用Excel的“宏”来实现工作的自动化。以表1为基础，把“含税收入”改为“部分含税收入”，然后在“应税所得”前插入一栏“雇主负担的比例”，并把H3中的公式改为：“=（f3 
      － 800 － j3＊g3）/（1 － i3＊g3）” ，最后把 i3中公式清除掉即可，其他单元格也无须手工更改。接下来的工作也是和第一点中的相同（修改后的表格命名为表5）。最后我们所要做的就是编辑“宏”了，具体如下：<br>
      　　先录制一个内容是空的宏，将它命名为“雇主负担比例税款”，并指定快捷键为“Ctrl＋Shift＋A”，然后打开这个宏进行编辑，输入下面的代码（从Sub开始，至End 
      Sub结束），保存退出后就可以按快捷健“Ctrl＋Shift＋A”运行这个宏（也可设置一个命令按钮来简化操作），根据提示输入必要的数据后，就可自动求出所有记录（每个人）的应税所得、适用税率、应纳税额等各栏的值。<br>
      Sub　雇主负担比例税款( )<br>
      　On Error GoTo 比例税款_err<br>
      　Cells.Find(What:=″适用税率″, After:=ActiveCell, <br>
      　LookIn:=xlFormulas,LookAt:=xlPart,SearchOrder:=　xlByRows,SearchDirection:=xlNext,MatchCase:=False, 
      　MatchByte:=False).Activate<br>
      　ActiveCell.Offset(1, 0).Range(″A1″).Select<br>
      　Dim a As Integer<br>
      　Dim b As Integer<br>
      　Dim e As Integer<br>
      　e = InputBox(″请以数字的形式输入″应税所得″所在的栏次″)<br>
      　a = InputBox(″请输入总记录数″)<br>
      　b = 1<br>
      　　Do Until b &gt; a<br>
      　　　With Selection<br>
      　　　　Dim I As Integer<br>
      　　　　I = 1<br>
      　　　　Dim c As Single<br>
      　　　　c = 1<br>
      　　　　Dim d As Double<br>
      　　　　　Do Until ActiveCell = c<br>
      　　　　　　If I &gt;10 Then<br>
      　　　　　　　MsgBox ″找不到适用税率或该个人的收入未达到起征点″<br>
      　　　　　　　Selection = ″″<br>
      　　　　　　　Exit Do<br>
      　　　　　　Else<br>
      　　　　　　　Selection = I ＊ 0.05<br>
      　　　　　　　d = Cells(ActiveCell.Row, e)<br>
      　　　　　　　If d&lt; 0 Then<br>
      　　　　　　　c = 0<br>
      　　　　　　　　ElseIf d&lt; 500 Then c = 0.05<br>
      　　　　　　　　ElseIf d&lt; 2000 Then c = 0.1<br>
      　　　　　　　　ElseIf d&lt; 5000 Then c = 0.15<br>
      　　　　　　　　ElseIf d&lt; 20000 Then c = 0.2<br>
      　　　　　　　　ElseIf d&lt; 40000 Then c = 0.25<br>
      　　　　　　　　ElseIf d&lt; 60000 Then c = 0.3<br>
      　　　　　　　　ElseIf d&lt; 80000 Then c = 0.35<br>
      　　　　　　　　ElseIf d&lt; 100000 Then c = 0.4<br>
      　　　　　　　Else: c = 0.45<br>
      　　　　　　　End If<br>
      　　　　　　　I = I ＋ 1<br>
      　　　　　　End If<br>
      　　　　　Loop<br>
      　　　　ActiveCell.Offset(1, 0).Select<br>
      　　　End With<br>
      　　　　b = b ＋ 1<br>
      　　Loop<br>
      　Exit Sub<br>
      　比例税款_err:<br>
      　MsgBox ″错误! error number:″ ＆ Err.Number ＆ Err.<br>
      　Description<br>
      End Sub<br>
      　　至此，对各种情况下的工薪所得，其个人所得税的计算，我们均可顺利通过Excel来实现。明白了其中的道理，对“劳务报酬所得”、“个体工商户生产经营所得”等项目的个人所得税的电算化也就迎刃而解了。（福建　游建勋）<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><a name='top'></a> <img src='http://cq.cpcw.com/cgi-bin/Count.cgi?ft=2|md=8|df=cpcw.dat|dd=E|cache=F|expires=18000' width='1' height='1' alt='312945678'> 
      <script language="JavaScript" src="http://nethome.yesky.com/sp/yeskye.js">
</script>
      <noscript> <a href='http://best.nease.net/cgi-bin/view/viewbasic.cgi?cpcw' target='_blank'> 
      <img src='http://best.nease.net/cgi-bin/log.cgi?user=cpcw&refer=http%3A//www.cpcw.com/&cur=http%3A//www.cpcw.com/issue/1999/50/99500302.html#NoJavaScript' width='1' height='1' border='0' alt='网易中文排行榜'></a> 
      <!-- Start of NedStat Basic code --> <a href="http://usa.nedstatbasic.net/cgi-bin/viewstat?name=cpcwissue"><img
src="http://usa.nedstatbasic.net/cgi-bin/nedstat.gif?name=cpcwissue"
border=0 alt="" nosave width=1 height=1></a> <!-- End of NedStat Basic code --> 
      <!-- Start of ReferStat --> 
      <script type="text/javascript" language="JavaScript">
<!--
d=document;
d.write("<img src=\"http://usa.nedstatbasic.net");
d.write("/cgi-bin/referstat.gif?");
d.write("name=cpcwissue&refer=");
d.write(escape(top.document.referrer));
d.write("\" width=1 height=1 align=\"right\">");
// -->
</script>
      <!-- End of ReferStat --></noscript> </TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD>&nbsp;</TD>
    <TD> <A HREF='/'>CPCW版权所有</A>，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布<script language="JavaScript" src="http://nethome.yesky.com/sp/yeskye.js">
</script></TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
