<HTML><!-- #BeginTemplate "/模板/software.dwt" -->
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 利用VFP制作财务报表--谈VFP与Excel的交互操作</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><script language="JavaScript" src="http://ad.cpcw.com/js/hardware.js"></script></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/issue/all.html'>2000年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->04期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{利用VFP制作财务报表--谈VFP与Excel的交互操作}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{利用VFP制作财务报表--谈VFP与Excel的交互操作}<!-- #EndEditable --> 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　在VFP中制作财务报表（或者是其他报表），通常的方法是利用VFP的报表生成器一步一步地生成，这种方法用起来很麻烦，而且打印出来的报表格式也不能尽如人意。提到制作报表，你可能够马上想到大名鼎鼎的Excel，我们能不能将二者结合起来——利用VFP的数据处理的结果，再使用Excel排版并且打印输出，而且还要让二者结合得天衣无缝呢？答案是肯定的，利用OLE技术，你能够很容易地实现上述想法。<br>
      　　大家对VFP的CreateObject函数可能不会陌生，利用CreateObject函数，你能够在VFP中创建并使用任何在你计算机上注册了的类（通常在安装应用程序时，应用程序都会向注册表里添加类信息）。也就是说你能够在VFP中调用任何应用程序为你的数据处理服务。CreateObject的具体用法如下：<br>
      　　CREATEOBJECT(ClassName[eParameter1,eParameter2,...])<br>
      　　其中，ClassName指明欲建立对象的类名。eParameter1,eParameter2……是用来传递参数给OLE对象的（OLE对象进行初始化时要用要到的）。例如，在VFP中欲建立一Excel工作簿对象，只须在程序中加入下列语句：MySheet=CREATEOBJECT(′Excel.Sheet′)就行了。<br>
      　　要在VFP中灵活地调用Excel为你服务，首先你应该对Excel提供的各类对象进行深入了解。Excel为我们提供了一百多种对象，如应用程序对象、图表对象、工作簿对象等等。对于每种对象调用，你得遵循一定的规则（也就是说你必须熟悉VBA编程）。接下来介绍Excel常见对象的调用方法。<br>
      　　一、创建Excel对象类<br>
      　　1.建立Excel对象MyExcel=CREATEOBJECT(′Excel.application′)<br>
      　　2.建立工作簿对象MyExcel.workbooks.Add<br>
      　　二、文件操作类<br>
      　　1.引用Excel文件Getobject(″Excel文件名″)<br>
      　　2.打开文件workbook.open(″文件名″)<br>
      　　3.保存文件workbook.SaveAs(″文件名″)<br>
      　　4.打印文件workbook.Printout(″文件名″)<br>
      　　注意，上面的workbook为当前活动的工作簿。<br>
      　　实例:假设到了月底，你用计算机对当月的账务资料整理后，得出了当月的损益表，底稿如下（名称为syb.dbf）。<br>
      项　目　　　　　　本月数　本年累计数<br>
      产品销售收入　　　98765.4<br>
      产品销售成本　　　73244.3<br>
      产品销售费用　　　1878.00<br>
      产品销售税金及附加355<br>
      产品销售利润　　　－－－<br>
      其他业务利润<br>
      管理费用　　　　　678<br>
      财务费用　　　　　333<br>
      营业利润　　　　　－－－<br>
      投资收益<br>
      营业外收入　　　　1000<br>
      营业外支出<br>
      利润总额　　　　　－－－<br>
      　　由于Excel中自带了损益表模板，因此我们能够很方便地在Excel中创建损益表。在VFP中建立一程序syb.prg，其内容如下（为节约篇幅，程序中略去了输入本年累计数的语句）。<br>
      　　close all<br>
      　　use syb<br>
      　　go top<br>
      　　＊新建一Excel对象<br>
      　　oleapp=Createobject(″Excel.Application″)<br>
      　　＊让Excel对象可见，如果设为F（不可见），你能够让VFP后台运行Excel，借此可以保持界的一致性。<br>
      　　oleapp.visible=.t.<br>
      　　＊添加工作簿<br>
      　　oleapp.workbooks.add<br>
      　　＊打开Excel自带的财务报表模板<br>
      　　oleapp.workbooks.open(″C:\Program Files\Microsoft Office\Templates\电子表格模板\工业企业财务报表.xlt″)<br>
      　　＊激活损益表<br>
      　　oleapp.sheets(″损益表″).select<br>
      　　＊追加数据<br>
      　　i=1<br>
      　　do while i&lt;=13<br>
      　　if i＃5 and i＃9 and i＃13<br>
      　　oleapp.cells(i＋6,4).value=本月数<br>
      　　endi<br>
      　　i=i＋1<br>
      　　skip<br>
      　　endd<br>
      　　应该注意的是，在Excel自带的损益表模板中，有些单元格是自动计算的，如产品销售利润、营业利润、利润总额，你不能够去修改的。这也是在上面程序中加入“if 
      i＃5 and i＃9 and i＃13”语句的原因。另外，你事先应该根据你的实际情况对损益表模板进行修改，比如设置纸张大小、字体等等。当然你也可以在运行时进行设置（加入oleapp.activeworkbook.printpreview）语句。<br>
      　　上面只是简单地介绍了在VFP中生成损益表的方法。要想更好地将VFP和Excel结合，你可以在Excel中尝试“录制宏”的功能，因为你在Excel中的任何操作都能够被录制成“宏”。“宏”能够以VBA语句的形式重现你刚才的你操作。举一反三，这下利用VFP做出精美的财务状况变动表、利润分配表、主营业务收支明细表，再也不是难事了。}<!-- #EndEditable --></TD>
  </TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>
      <script language="JavaScript" src="../../download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
</TR>
</TABLE></BODY><!-- #EndTemplate --></HTML>