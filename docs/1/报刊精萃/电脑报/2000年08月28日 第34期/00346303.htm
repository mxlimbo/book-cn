 
<HTML>
<!-- #BeginTemplate "/模板/oa.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2812'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 处理自定义消息</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='143' HEIGHT='50' ALT='电脑报' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <A href="http://www.cpcw.com/issue/all.html">2000 年</A> &gt; <a href="http://www.cpcw.com/issue/all.html"><!-- #BeginEditable "%C6%DA" -->34期<!-- #EndEditable --></a> 
      &gt;<!-- #BeginEditable "%C0%B8%C4%BF" --> <a href="oa.html">OA专刊</a><!-- #EndEditable -->&gt; 
      <!-- #BeginEditable "%B1%EA%CC%E2" -->{处理自定义消息}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{处理自定义消息}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%C4%DA%C8%DD" -->{ 在VC中ClassWizard 可以像处理其它消息一样处理自定义的消息。<br>
      　　下面是增加自定义消息的步骤：<br>
      　　第一步：定义消息。开发Windows95应用程序时，Microsoft推荐用户自定义消息的是WMUSER＋100，因为很多新控件也要使用WM_USER消息。<br>
      　　第二步：实现消息处理函数。 <br>
      　　LPESULT CMainFrame::OnMyMessage(WPARAM wParam, LPARAM lParam)<br>
      　　{<br>
      　　// TODO: 处理用户自定义消息 <br>
      ...<br>
      　　return 0;<br>
      }<br>
      　　第三步：在类头文件的AFX_MSG块中说明消息处理函数：<br>
      　　class CMainFrame:public CMDIFrameWnd<br>
      　　{<br>
      　　...<br>
      　　// 一般消息映射函数<br>
      　　protected:<br>
      　　// {{AFX_MSG(CMainFrame)<br>
      　　afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);<br>
      　　afx_msg void OnTimer(UINT nIDEvent);<br>
      　　afx_msg LRESULT OnMyMessage(WPARAM wParam, LPARAM lParam);<br>
      　　//}}AFX_MSG<br>
      　　DECLARE_MESSAGE_MAP()<br>
      　　}<br>
      　　第四步：在用户类的消息块中，使用ON_MESSAGE宏指令将消息映射到消息处理函数中。<br>
      　　BEGIN_MESSAGE_MAP(CMainFrame, CMDIFrameWnd)<br>
      　　//{{AFX_MSG_MAP(CMainFrame)<br>
      　　ON_WM_CREATE()<br>
      　　ON_WM_TIMER()<br>
      　　ON_MESSAGE(WM_MY_MESSAGE, OnMyMessage)<br>
      　　//}}AFX_MSG_MAP<br>
      　　END_MESSAGE_MAP()<br>
      　　 如果用户需要一个整个系统唯一的消息，可以调用SDK函数RegisterWindowMessage并使用ON_REGISTER_MESSAGE宏指令取代ON_MESSAGE宏指令，其余步骤同上。<br>
      (青海 乔生文)}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://nethome.yesky.com/sp/yeskye.js">
</script>
    </TD>
    <TD> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
