<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- 魔鬼辞典</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<table width='468' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; <a href='http://drivers.cpcw.com/issue.htm'>2000 年</a> &gt; <a href="index.html">16期</a> 
      &gt; <a href="software.html">软件世界</a> 
      &gt; 在状态栏动态加进度条</td>
  </tr>
</table>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 在状态栏动态加进度条 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD> 
      <p> 　　一般情况下，我们可以创建非模式对话框并在上面显示进度条。如果能够利用状态条，在状态条中动态地添加并显示进度条，将会更加方便直观。下面将讲述如何在Delphi 
        5中编程实现在状态条中动态地添加进度条。具体的过程如下：<br>
        　　1．在Delphi 5中通过菜单“File/New Application”创建一个新的工程。<br>
        　　2．在窗体中添加一个状态栏组件StatusBar1，一个Button组件Button1。在状态栏编辑器中为状态栏添加两个显示面板，因为后面将要在第二个面板中显示进度条，所以将第二个面板的Style属性设置为psOwnerDraw。将Button1组件的Caption属性设置为“演示操作”。<br>
        　　3．在Unit1.pas文件的TForm1的类型定义中添加下面的变量定义：<br>
        　　......<br>
        　　private<br>
        　　{ Private declarations } <br>
        　　progressBar:TProgressBar;// 进度条组件 <br>
        　　progressBarRect:TRect; // 进度条组件的尺寸<br>
        　　public<br>
        　　{ Public declarations }<br>
        　　......<br>
        　　4．在状态栏的OnDrawPanel事件的处理过程中，获取将Style属性设置为psOwnerDraw的面板的尺寸。添加StatusBar1组件的OnDrawPanel事件的处理过程如下：<br>
        　　procedure TForm1.StatusBar1DrawPanel(StatusBar: TStatusBar; <br>
        　　Panel: TStatusPanel; const Rect: TRect);<br>
        　　begin <br>
        　　// 进度条组件的尺寸设定为状态条中的第二个显示面板的尺寸,因为该面板的Style属性已被设置为<br>
        　　psOwnerDraw <br>
        　　progressBarRect:=Rect;<br>
        　　end; <br>
        　　5．在按下按钮Button1组件时将执行一个模拟计算过程的循环操作，同时动态地在StatusBar1的第二个面板中创建并显示ProgressBar组件，并将其父级设置为StatusBar1组件。添加Button1组件的OnClick事件的处理过程如下：<br>
        　　procedure TForm1.Button1Click(Sender: TObject); <br>
        　　var<br>
        　　// I为循环变量, StepCount为执行循环的总数目<br>
        　　I,StepCount : Integer;<br>
        　　begin<br>
        　　//动态创建进度条组件progressBar <br>
        　　progressBar:=TProgressBar.Create(Form1); <br>
        　　StepCount:=10000; // 循环的总数目<br>
        　　with progressBar do <br>
        　　begin <br>
        　　// 先确定进度条组件的尺寸和位置<br>
        　　Top:=ProgressBarRect.Top; <br>
        　　Left:=ProgressBarRect.Left;<br>
        　　Width:=ProgressBarRect.Right－ProgressBarRect.Left; <br>
        　　Height:=ProgressBarRect.Bottom－ProgressBarRect.Top; <br>
        　　Visible:=True; // 使进度条可见 <br>
        　　try <br>
        　　Parent:=StatusBar1; // parent属性设置为状态栏组件 <br>
        　　Min:=0;// 设定进度条的范围和步长 <br>
        　　Max:=StepCount; <br>
        　　Step:=1;<br>
        　　for I:=1 to StepCount do <br>
        　　begin <br>
        　　Stepit;// 循环使进度显示条累加 <br>
        　　end; <br>
        　　MessageDlg(′演示操作已经完成!′, mtInformation, [mbOK], 0);<br>
        　　finally <br>
        　　Free;// 最后释放进度条组件占用的资源 <br>
        　　end;<br>
        　　end;<br>
        　　end; <br>
        　　通过这种方法我们就可以在状态条中动态地添加进度条，同样的原理还用于在状态栏中添加其他的组件，过程基本一致。以上程序在Delphi 5、Windows98中调试通过。<br>
      </p>
      <p align="right"> （广东　粟利民） </p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD>&nbsp;</TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>