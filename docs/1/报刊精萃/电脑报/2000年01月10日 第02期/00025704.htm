<HTML><!-- #BeginTemplate "/模板/oa.dwt" -->
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2812'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --利用Excel 97打印工资条</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <A href="http://www.cpcw.com/issue/all.html">2000年</A> &gt; <a href="http://www.cpcw.com/issue/all.html"><!-- #BeginEditable "%C6%DA" -->02期<!-- #EndEditable --></a> 
      &gt;<!-- #BeginEditable "%C0%B8%C4%BF" --> <a href="oa.html">OA专刊</a><!-- #EndEditable -->&gt; 
      <!-- #BeginEditable "%B1%EA%CC%E2" -->{利用Excel 97打印工资条}<!-- #EndEditable --></TD>
</TR></TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{利用Excel 
      97打印工资条}<!-- #EndEditable --> 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD><!-- #BeginEditable "%C4%DA%C8%DD" -->{　　问题提出：虽然现在有许多的财务软件，它们都有工资管理功能，但由于软件的价格因素，或软件自身存在的不足(如软件的针对性较差，不能满足单位的具体需要)，财务软件在企业和事业单位的应用并不广泛。现实的情况是：在许多单位，特别是事业单位，他们的工资处理都是利用微软的电子表格软件——Excel97。<br>
      　　但在使用Excel97的过程中，可能会有一个问题一直困扰着会计人员，这就是：用Excel97打印的工资条只有第一个人有工资条的条头(如：编号、姓名、工资、津贴……)(见^02050202a^1)，而我们的要求是每个人都要有工资条的条头(见^02050202b^2)(因为工资条是要裁开发给每个人的)。<br>
      　　当然，有些人可能认为这个问题很容易解决，即只要在每个人的前头插入工资条的条头不就好了嘛!但实际是：若单位里有100多个人的话，你就要复制100多次，这显然就不能体现计算机的长处。更要命的是：前面的操作每个月都要如此反复。某些人可能会提议，那就把前面的设置另存为模板吧。当然，这也不失为一种方法，但君不见，这样一来，每个人的工资数在表格中就让工资条的条头给隔开了，以至于不能利用Excel97的填充柄来复制数据、公式(可知道这正是Excel97备受青睐的重要因素之一!)，也就是说，你同样要复制数据、公式上百次。<br>
      　　解决思路：通过一段时间的摸索，我把问题归结为：在表1的表格(称之为源表格)中输入、处理工资数，然后以表2的表格(称之为目标表格)的形式打印，即现在的核心问题是把表1的表格转换为表2的表格，而这可以用嵌入Excel97中的VBA语言来编程实现。<br>
      　　程序清单：假设如表1的表格在工作簿中的sheet1工作表(为活动工作表)中，而如表2的表格要在工作簿中的sheet2工作表中，则程序清单如下：<br>
      　　Option Base1<br>
      　　Dim aa(13)As Range,xm As Range ′xm准备存放条头的项目<br>
      　　Dim List_1 As Integer ′源表格中的行定位变量<br>
      　　Dim List_2 As Integer ′目标表格中的行定位变量<br>
      　　Dim List_str As String ′源表格中的行定位变量，字符型<br>
      　　Sub mymain()<br>
      　　　List_1=2 ′从源表格的第二行开始<br>
      　　　List_2=2<br>
      　　　Do<br>
      　　　　List_str=RTrimS(LTrimS(StrS(List_1)))<br>
      　　　 Set aa(1)=ActiveSheet,Range(″A″＆List_str) ′读编号<br>
      　　　 Set aa(2)=ActiveSheet,Range(″B″＆List_str) ′读月份<br>
      　　　　If aa(1)=aa(2) Then Exit Do ′编号、月份均空白时不再读<br>
      　　　　transform List_2<br>
      　　　　List_1=list_1＋1<br>
      　　　　List_2=List_2＋2<br>
      　　　Loop<br>
      　　End Sub<br>
      　　Sub transform(num As Integer)<br>
      　　　Dim n As Integer<br>
      　　　Dim v As String ′源表格的列定位变量<br>
      　　　Dim nl As Variant′目标表格的列定位变量<br>
      　　　Dim w As Variant ′目标表格的行定位变量<br>
      　　　n1=num<br>
      　　　w=n1＋1<br>
      　　　For n=1 To 11 Step 1 ′准备传送工资条的条头及工资数<br>
      　　　With Worksheets(″sheet2″)<br>
      　　　v=Chr(64＋n) ′源表格的数据从A列开始<br>
      　　　Set xm=ActiveSheet.Range(v＆″1″)<br>
      　　　Range(Chr(n＋64)＆n1)=xm ′传送工资条的条头<br>
      　　　Set aa(n＋2)=ActiveSheet.Range(v＆List1_str)<br>
      　　　Range(Chr(n＋64)＆w)=aa(n＋2) ′传送工资条的工资数<br>
      　　　End With<br>
      　　　Next<br>
      　　End Sub}<!-- #EndEditable --></TD>
  </TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>
      <script language="JavaScript" src="../../download/yeskye.js">
</script>
    </TD>
    <TD> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
</TR>
</TABLE></BODY><!-- #EndTemplate --></HTML>