<HTML><!-- #BeginTemplate "/模板/oa.dwt" -->
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2812'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --Novell网无盘站多重启动</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <A href="http://www.cpcw.com/issue/all.html">2000年</A> &gt; <a href="http://www.cpcw.com/issue/all.html"><!-- #BeginEditable "%C6%DA" -->02期<!-- #EndEditable --></a> 
      &gt;<!-- #BeginEditable "%C0%B8%C4%BF" --> <a href="oa.html">OA专刊</a><!-- #EndEditable -->&gt; 
      <!-- #BeginEditable "%B1%EA%CC%E2" -->{Novell网无盘站多重启动}<!-- #EndEditable --></TD>
</TR></TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{Novell网无盘站多重启动}<!-- #EndEditable --> 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD><!-- #BeginEditable "%C4%DA%C8%DD" -->{　　在Novell网络操作系统中，实现无盘启动Win95工作站的技术相信早已为广大的电脑爱好者所熟悉。Win95、Win98也已逐渐成为流行的桌面操作系统，但在学校和企事业单位，特别是在Novell网的无盘工作站上，DOS还支撑着它的“半边天”。对于Novell操作系统，如果掌握了实现无盘启动Win95工作站的技术，要实现Win95和DOS下应用程序的和平共处，就必然要用到工作站的多重启动。<br>
      　　要实现无盘镜像文件的多重启动，有两种方法可以解决。一种是硬件解决方法，使用能无盘启动Novell的专用BOOTROM，注意不同型号的网卡，它的BOOTROM也不一样，不能混用。然后修改服务器SYS卷下LOGIN目录里面的bootconf.sys文件，格式如下：“0xAAAAAAAA，BBBBBBBBBBBB=WIN.SYS 
      DOS.SYS”（其中0x表示后面为16进制数，AAAAAAAA为802.2及802.3协议的网络号，BBBBBBBBBBBB为无盘工作站网卡ID号，win.sys为无盘启动Win95的镜像文件名，dos.sys为无盘启动DOS的镜像文件名）。当然并不是所有的网卡都能享受到这种待遇，能否实现多重启动完全要由BOOTROM来决定。另一种是软件解决方法，拿Win95的启动镜像文件开刀，对它“做做手脚”。<br>
      　　我们知道，Win95并不是一个真正的操作系统，它只是建立在DOS操作上基于GUI（图形用户接口）的庞大的应用程序。它所依赖的操作系统便是DOS 
      7.0，既然如此，早期的DOS下的应用程序也可以运行在这个版本的DOS平台上。下面就以Netware 4.10下的多重启动镜像文件的建立为例来讲解这种“软”的方法。<br>
      　　一、所需软硬件环境<br>
      　　1.一台Netware 4.10网络服务器。<br>
      　　2.一台能运行Win95或Win98的有盘工作站。<br>
      　　3.能无盘启动Win95的工作站若干台（所选网卡为NE2000兼容网卡）。若还没有建成无盘启动Win95的工作站，可在1998、1999年的《电脑报》里面找到制作无盘启动Win95工作站的相关资料。<br>
      　　二、整理启动软盘所需文件<br>
      　　从有盘的Win95工作站上以超级用户身份入网，将\\SERVER\SYS\LOGIN和\\SERVER\SYS\SYSTEM分别映射为G:和H:网络驱动器(G:和H:是驱动器号，视你未使用的驱动器号而定)。在MS 
      DOS窗口下进入G：驱动器，使用H:\dosgen win.sys／U的命令将Win95的无盘启动镜像文件还原到软盘里面，同理使用H:\dosgen 
      dos.sys／U的命令也将DOS 6.22的无盘启动镜像文件还原到软盘里面。<br>
      　　在还原的Win95启动软盘里面保留如下文件：<br>
      　　ASPI2HLP.SYS　IO.SYS　　 PROTOCOL.INI<br>
      　　AUTOEXEC.BAT MSDOS.SYS　 RAMDRIVE.SYS<br>
      　　CMD640X.SYS　 NDISHLP.SYS RPLBOOT.SYS<br>
      　　CMD640X2.SY 　NE2000.DOS SETMDIR.EXE<br>
      　　COMMAND.COM NET.EXE 　 SNAPSHOT.EXE<br>
      　　CONFIG.SYS　 NET.MSG　　 SYSTEM.DAT<br>
      　　DBLBUFF.SYS　 NWRPLTRM.EXE WIN.BAT<br>
      　　HIMEM.SYS　　 PROTMAN.EXE<br>
      　　IFSHIP.SYS　 PROTMAN.DOS<br>
      　　在还原的DOS启动软盘里面保留如下文件：<br>
      　　AUTO.VLM　　 IPXODI,COM　　NWP.VLM<br>
      　　BIND.VLM　 　 LSL.COM　 　　PNW.VLM<br>
      　　CONN.VLM　 NDS.VLM　 　　REDIR.VLM<br>
      　　FIO.VLM　 　 NE2000.COM　　SECURITY.VLM<br>
      　　GENERAL.VLM NET.CFG　 TRAN.VLM<br>
      　　IPXNCP.VLM　 NETX.VLM　　　VLM.EXE<br>
      　　在Win95启动软盘的根目录下建一Winboot子目录，先将根目录下面的NDISHLP.SYS、NE2000.DOS、NWRPLTRM.EXE、PROTMAN.DOS、PROTMAN.EXE、PROTOCOL.INI、SETMDIR.EXE、SNAPSHOT.EXE、NET.EXE、NET.MSG等文件转移到Winboot子目录下，再将DOS启动软盘所保留下来的文件全部拷入Winboot子目录中，最后将Win95共享目录下的EMM386.EXE和其COMMAND子目录下的COUNTRY.SYS两个文件拷到Win95启动软盘的根目录下。这样，一张用于多重启动的软盘便制作完毕了。<br>
      ##2　　三、软件的配置<br>
      　　1.修改启动盘的msdos.sys文件。<br>
      　　用文本编辑器打开上面制作的Win95启动盘根目录下的msdos.sys文件。将“BOOTGUI=1”修改为“BOOTGUI=0”，然后保存文件。这样就使操作系统启动后不进入GUI界面而直接转入纯DOS模式。<br>
      　　2.建立多重配置文件config.sys。<br>
      　　用文本编辑器在启动盘的根目录下建立config.sys文件如下：<br>
      　　[MENU]<br>
      　　MENUITEM=1 DOS ＆ XMS<br>
      　　MENUITEM=2 DOS ＆ EMS<br>
      　　MENUITEM=3 PWIN95<br>
      　　MENUCOLOR=15,1<br>
      　　MENUDEFAULT=1,10<br>
      　　[1]<br>
      　　COUNTRY=001,437<br>
      　　DEVICE=HIMEM.SYS ／TESTMEM:OFF<br>
      　　DEVICE=EMM386.EXE RAM NOEMS I=B000－B7FF<br>
      　　DEVICEHIGH=A:\RAMDRIVE.SYS 960 ／E<br>
      　　DOS=HIGH,UMB<br>
      　　FILESHIGH=96<br>
      　　STACKSHIGH=9,512<br>
      　　LASTDRIVE=Z<br>
      　　[2]<br>
      　　COUNTRY=001,437<br>
      　　DEVICE=HIMEM.SYS ／TESTMEM:OFF<br>
      　　DEVICE=EMM386.EXE RAM I=B000－B7FF<br>
      　　DEVICEHIGH=A:\RAMDRIVE.SYS 960 ／E<br>
      　　DOS=HIGH,UMB<br>
      　　FILESHIGH=96<br>
      　　STACKSHIGH=9,512<br>
      　　LASTDRIVE=Z<br>
      　　[3]<br>
      　　DEVICE=HIMEM.SYS ／TESTMEM:OFF<br>
      　　DEVICEHIGH=A:\RAMDRIVE.SYS 960 ／E<br>
      　　STACKS=9,512<br>
      　　上面所制作的是有三个菜单选项的多重启动配置文件，其中块名为“1”和“2”的菜单项是应用于DOS下应用程序的启动配置，而块名为“3”的菜单项则是应用于Win95的启动配置。PWin95默认的国家代码和代码页分别为086和936，而我们在安装Novell服务器时大都使用的是Netware英文版，所指定的国家代码和代码页分别为001和437。由于服务器和工作站所使用的代码页不同，使用login.exe程序进行登录时，工作站是进不去网络服务器的NDS里面的。所以在前面两个菜单项里面必须使用COUNTRY命令来指定工作站所使用的国家代码和代码页。调试成功后还可以用文本编辑器打开msdos.sys文件，在文件最后加入一行语句——“BOOTKEYS=0”，以禁止用户使用F4、F5和F8键。<br>
      　　3.建立批处理文件。<br>
      　　用文本编辑器修改启动盘根目录下的autoexec.bat文件如下：<br>
      　　@ECHO OFF<br>
      　　IF NOT EXIST C:\WINBOOT\NUL MKDIR C:\WINBOOT<br>
      　　COPY A:\SYSTEM.DAT C:<br>
      　　COPY A:\WINBOOT C:\WINBOOT<br>
      　　COPY A:\COMMAND.COM C:\WINBOOT<br>
      　　C:\WINBOOT\WIN<br>
      　　用文本编辑器在启动盘Winboot子目录下建立win.bat文件如下：<br>
      　　@ECHO OFF<br>
      　　C:<br>
      　　CD\WINBOOT<br>
      　　SET COMSPEC=C:\WINBOOT\COMMAND.COM<br>
      　　GOTO ％CONFIG％<br>
      　　:1<br>
      　　GOTO 2<br>
      　　:2<br>
      　　LH LSL<br>
      　　LH NE2000<br>
      　　LH IPXODI<br>
      　　VLM ／MX<br>
      　　F:<br>
      　　CX APPS;此行视服务器而定<br>
      　　LOGIN DOS;此行视服务器而定<br>
      　　GOTO END<br>
      　　:3<br>
      　　NWRPLTRM<br>
      　　SNAPSHOT ／S ／B:C ／F ／R<br>
      　　NET START NWREDIR<br>
      　　NET USE ＊ ／D<br>
      　　NET USE H:\\NET\SYS\PWIN95;此行视服务器而定<br>
      　　PATH=H:\INSTALL\;H:\INSTALL\COMMAND ;此行视服务器而定<br>
      　　SETMDIR<br>
      　　WIN.COM<br>
      　　:END<br>
      　　四、制作镜像文件<br>
      　　上述软件的配置都准备就绪后，即可制作无盘启动镜像文件了。在MS DOS窗口下进入G：驱动器，使用H:\dosgen win_dos.sys 
      的命令便完成了镜像文件的制作。最后修改服务器SYS卷下LOGIN目录里面的bootconf.sys文件，格式如下：“0xAAAAAAAA，BBBBBBBBBBBB=WIN_DOS.SYS”。至此，利用软件配置已经实现Win95和DOS的无盘多重启动。}<!-- #EndEditable --></TD>
  </TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>
      <script language="JavaScript" src="../../download/yeskye.js">
</script>
    </TD>
    <TD> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
</TR>
</TABLE></BODY><!-- #EndTemplate --></HTML>