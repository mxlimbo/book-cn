 
<HTML>
 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>

<TITLE>电脑报电子版 -- 用Access 97制作工资数据库</TITLE>

<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='/issue'>CPCW电子版</A> 
      &gt; <A HREF='/issue/2000/'>2000 年</A> &gt; <a href="index.html">06期</a> 
      &gt; <a href="oa.html">OA专刊</a>&gt; 
     用Access 97制作工资数据库</TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 用Access 
      97制作工资数据库》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>　　数据库Access 97中文版是Office 
      97办公软件家族中的重要成员，非常适合非编程人员自己制作管理信息数据库。笔者尝试用Access 97中文版制作了单位的职工工资数据库，感到非常好用、简单、易学。制作步骤和方法请见以下各部分。 
      <p><b>　　创建工资数据库及工资表</b></p>
      　　启动Access 97后，在“Microsoft Access 97”对话框中单击“空数据库”选项按钮，然后单击“确定”按钮；在屏幕上出现的“保存新数据库为”对话框的“保存位置”栏中选择新数据库保存位置；在“保存新数据库为”对话框的“文件名”栏中输入拟定的新数据库文件名；单击对话框的“创建”按钮，系统就在指定位置创建了你需要的数据库。<br>
      　　打开新建的工资数据库，在数据库视图选项卡界面中选“表”选项卡。单击“表”选项卡上的“新建”按钮，打开“新建表”对话框。用鼠标或用键盘光标键选中“新建表”对话框选项区中的“设计视图”，然后单击“确定”按钮。<br>
      　　在打开的“表1：表”设计视图窗体中建立工资表的结构。工资表字段结构可按以下样式建立： 
      <p><b>　　建立具有计算字段的查询表</b></p>
      　　当工资表建立后，可以按以下步骤建立具有计算字段的查询表：<br>
      　　1.建立基本查询表<br>
      　　在数据库视图选项卡界面中选“查询”选项卡，单击“新建”按钮，在打开的“新建查询”对话框中选中“设计视图”选项，然后单击“确定”按钮。<br>
      　　在打开的“查询1：选择查询”窗体上的“显示表”对话框中选择、添加“工资表”，然后关闭“显示表”对话框。在“查询1：选择查询”窗体上部所显示的工资表字段名方框中依次双击每一个字段，将工资表的字段添加到查询表中。<br>
      　　2.添加“应发工资”查询字段<br>
      　　在“查询1：选择查询”窗体下部的设计区域中，将鼠标指针放到“扣发”字段名框中，然后单击“插入列”菜单项，在“扣发”字段前插入一个空白列。将鼠标指针放到新插入的空白列字段名框中，单击鼠标右键，在打开的快捷菜单中单击“显示比例”选项，打开“显示比例”对话框，在“显示比例”对话框中输入表达式：“应发工资：[基本工资]＋[效益工资]＋[工龄工资]＋[职务津贴]＋[加班费]＋[补发]”。最后，单击对话框的“确定”按钮。<br>
      　　这样，系统就会在工资查询表中自动添加“应发工资”字段，并计算出应发工资数。<br>
      　　3.添加“扣税”查询字段<br>
      　　在“查询1：选择查询”窗体下部的设计区域中，将鼠标指针放到最后边“医疗保险”字段名框右边的空白字段框中，单击鼠标右键，在打开的快捷菜单中单击“显示比例”对话框中输入表达式：“扣税：IIf(([应发工资]－[扣公积金6％]－[扣养老4％]－[失业保险]－[医疗保险])〉880 
      And([应发工资]－[扣公积金6％]－[扣养老4％]－[失业保险]－[医疗保险])〈=1350，(([应发工资]－[扣公积金6％]－[扣养老4％]－[失业保险]－[医疗保险])－880)0.05，IIf(([应发工资]－[扣公积金6％]－[扣养老4％]－[失业保险]－[医疗保险])〉1350，((([应发工资]－[扣公积金6％]－[扣养老4％]－[失业保险]－[医疗保险])－1350)0.1)＋((1350－880)0.05)，0))”。最后，单击对话框的“确定”按钮。<br>
      　　这样，系统就会在工资查询表中自动添加“扣税”字段，并计算出当月该职工应交纳的税金数。如果该职工工资达到了应当交纳税金的工资额度，就按照表达式中所列公式计算应扣税金；如果达不到应当交纳税金的工资额度，“扣税”字段就显示为0。<br>
      　　4.添加“实发工资”查询字段<br>
      　　在“查询1：选择查询”窗体下部的设计区域中，将鼠标指针放到最后边“扣税”字段名框右边的空白字段框中，单击鼠标右键，在打开的快捷菜单中单击“显示比例”选项，打开“显示比例”对话框，在“显示比例”对话框中输入表达式：“实发工资：[应发工资]－[扣发]－[扣病事假]－[扣公积金6％]－[扣养老4％]－[失业保险]－[医疗保险]－[扣税]”。最后，单击对话框的“确定”按钮。<br>
      　　这样，系统就会在工资查询表中自动添加“实发工资”字段，并计算出实发工资数。<br>
      　　5.关闭“查询1：选择查询”窗体，并将该查询表命名为“工资表查询”。 
      <p><b>　　制作表格式工资条</b></p>
      　　1.生成报表<br>
      　　在数据库视图选项卡界面中选“报表”选项卡，在“报表”选项卡中单击“新建”按钮，打开“新建报表”对话框，在对话框下部的选择框中单击下拉式列表箭头按钮，选择“工资表查询”，单击“确定”按钮，在打开的“报表向导”对话框中单击双箭头按钮选中左边所列全部字段，然后按提示一步一步生成工资报表，最后将该报表命名为“工资报表”。<br>
      　　2.设置纸张大小<br>
      　　在数据库视图“报表”选项卡界面中选“工资报表”，单击“设计”按钮，打开报表设计视图，然后单击“文件/页面设置”菜单项，在“页面设置”对话框中单击“页”选项卡，设置需要的纸张大小。<br>
      　　3.在报表主体节中添加字段标签控件<br>
      　　在报表设计视图中，将鼠标指针指向报表“页面页眉”节的最左端，当鼠标指针变成向右的黑色箭头形时，单击鼠标左键，选中“页面页眉”的全部字段标签控件，然后单击工具栏的“复制”按钮，再单击“粘贴”按钮，复制选中的全部字段标签控件(或单击鼠标右键复制)。然后将粘贴下来的全部字段标签控件拖到报表“主体”节字段文本控件下面的适当位置(当鼠标指针在指向选 
      中的控件变成手掌形时就可以按住鼠标左键拖动选中的控件)，并与“页面页眉”位置的字段标签控件和“主体”位置的字段文本控件对齐。<br>
      　　4.在报表主体节字段文本控件和字段标签控件之间添加横隔直线<br>
      　　在报表设计视图中，单击“工具箱”上面的“直线”工具按钮，然后在报表“主体”节字段文本控件和字段标签控件之间拖动鼠标，画一条横隔直线。<br>
      　　选中该线条后，单击鼠标右键，在打开的快捷菜单中选“属性”项，出现“线条”对话框，在该框中设置“边框样式”为虚线。<br>
      　　这样，当预览工资报表时，就会发现该报表已经变成了工资条型报表，每一个员工的工资项目为一条，便于裁剪。<br>
      　　5.添加表格线<br>
      　　自动生成的报表没有表格线，我们可以在设计视图中添加表格线。<br>
      　　在报表设计视图中，单击“工具箱”上的“矩形”工具按钮，在报表“页面页眉”节为字段标签控件画一个矩形框，将全部字段标签控件包围在该矩形控件中。<br>
      　　在报表设计视图中，单击“工具箱”上的“直线”工具按钮，在报表“页面页眉”节的矩形框中为每一个字段标签控件之间加竖形直线。可以在画好第一条竖直线后，运用复制方法复制直线，然后拖到字段标签控件之间，这样可以快速、一致地制作直线。<br>
      　　运用上述方法在报表“主体”节为字段文本控件添加矩形框和直线。<br>
      　　选中报表“页面页眉”节已经添加了矩形框和直线的全部字段标签控件，然后复制、粘贴，将粘贴的全部控件拖到报表“主体”节字段文本控件下方适当位置，并将该节中原有的字段标签控件删除。<br>
      　　这样，表格型的报表就生成了。 
      <p><b>　　制作具有合计数字的工资报表</b></p>
      　　1.在数据库视图报表选项卡中选中“工资报表”，按住Ctrl键，同时按住鼠标左键拖动鼠标，这时鼠标指针就变成了有＋形的复制形状，然后松手，就在报表选项卡中产生了一个工资报表的副本。选中该副本，单击鼠标右键，在快捷菜单中选重命名项，将副件重新命名为“工资报表1”。<br>
      　　2.选中“工资报表1”，单击“设计”按钮，进入设计视图，将报表“主体”节的字段标签控件和直线控件删除，往上拖动“主体”节的下边界线到包围字段文本控件的矩形框下界线位置。<br>
      　　3.用鼠标拖动“报表页脚”节下边界，增大“报表页脚”的页面。选中报表“主体”节的全部字段文本控件，单击常用工具栏的“复制”按钮，然后单击“粘贴”按钮，将粘贴的全部字段文本控件拖动到“报表页脚”节，与上一节字段文本控件对齐，紧贴“报表页脚”节的上边界线。<br>
      　　4.选中“报表页脚”节的“编号”字段文本控件，将其删除。单击“工具箱”标签控件按钮，在原“编号”字段文本控件位置拖动鼠标画一个标签控件，在其中输入“合计”，使其成为“合计”字段。<br>
      　　5.选中“报表页脚”节的“姓名”字段文本控件，单击鼠标右键，在快捷菜单中单击“属性”菜单，在“全部/控件来源”栏中单击“表达式生成器”按钮，在表达式文本框中输入表达式：“=count([工资表查询]![姓名])”，单击“确定”按钮，关闭“属性”文本框。这样就可以在报表中计算出员工人数。<br>
      　　6.选中“报表页脚”节的“基本工资”字段文本控件，单击鼠标右键，在快捷菜单中单击“属性”菜单，在“全部/控件来源”栏中单击“表达式生成器”按钮，在表达式文本框中输入表达式：“=sum([工资表查询]![基本工资])”，单击“确定”按钮，关闭“属性”文本框。这样就可以在报表中计算出“基本工资”字段的合计数。<br>
      　　7.用相同方法修改“报表页脚”节其他字段文本控件的“控件来源”属性，使表达式中的字段名称与要合计计算的字段相一致，使报表能计算出本字段的合计数。<br>
      　　关闭报表设计视图后，预览该报表，就会发现在报表最后一行生成了合计数字。<br>
      　　制作工资表窗体，也可以在数据库视图“窗体”选项卡中单击“新建”按钮，一步步按提示完成，然后在设计视图中稍加修改成自己喜欢的样子，这里不再赘述。<br>
      <b> 　　(湖北　姚琪)</b></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD>&nbsp; 
      
       </TD>
    <TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>

</HTML>
