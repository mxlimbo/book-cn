<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>

<TITLE>电脑报电子版 --自己动手做个留言薄</TITLE>

<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='/issue/'>CPCW电子版</A> 
      &gt; <A HREF='/issue/2000/'>2000 年</A> &gt; <a href="index.html">06期</a> 
      &gt; <a href="internet.html">大众网络</a>
      &gt;自己动手做个留言薄</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 自己动手做个留言薄
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>　　Guest－book（留言簿）在网页设计中占有相当重要的地位。留言簿可以用许多编程语言来设计，当然使用最多的还是perl。这里谈谈在编写Guest－book中最应该注意的问题，并给出一个不算很完整的程序代码，你可以改进后使用。<br>
      　　就现在的情况来看，一个标准的guest－book程序一般包括三个文件。提交表单文件（form.html）、cgi处理文件(guest－book.cgi)和最后的输出文件（book.html）。三者的合作就可以完成留言簿的基本功能－留言。留言簿界面可以随便做，只要注意提交表单指向guest－book.cgi就可以，其它没有太多要求。<br>
      　　首先我们来看看form.html的文件内容：<br>
      　　&lt;html&gt;<br>
      　　&lt;title&gt;guest－book.html&lt;/title&gt;<br>
      　　&lt;h1&gt;留言本&lt;/h1&gt;<br>
      　　&lt;form method=″post″ action=″/cgi－bin/guest－book.cgi″&gt;<br>
      　　&lt;p&gt;名字：&lt;input name=″name″ size=″20″&gt;<br>
      　　&lt;p&gt;email:&lt;input name=″email″ size=″30″&gt;<br>
      　　&lt;p&gt;意见：&lt;textarea name=″suggest″ cols=30 rows=4&gt;&lt;/textarea&gt;<br>
      　　&lt;/textarea&gt;&lt;p&gt;<br>
      　　&lt;input type=″submit″ value=″提交″&gt;<br>
      　　&lt;input type=″reset″ value=″取消″&gt;<br>
      　　&lt;/form&gt;&lt;/html&gt;<br>
      　　&lt;form method=″post″ action=″/cgi－bin/guest－book.cgi″&gt;<br>
      　　将此表单的提交后的动作交给guest－book.cgi程序。<br>
      　　再看看guest－book.cgi的源代码：<br>
      　　＃! perl （perl在服务器上的绝对位置）<br>
      　　print″Content－type:text/html\n\n″;<br>
      　　read(STDIN,＄buffer,＄ENV{'CONTENT_LENGTH'})；<br>
      　　@pairs=split(/＆/,＄buffer);<br>
      　　foreach ＄pair(@pairs){<br>
      　　(＄name,＄value)=split(/=/,＄pair);<br>
      　　＄value=～tr/＋//;<br>
      　　＄value=～s/％([a－f A－F 0－9][a－f A－F 0－9])/pack(″C″,hex(＄1))/eg;<br>
      　　＄FORM{＄name}=＄value;<br>
      　　}<br>
      　　print″&lt;title&gt;留言本&lt;/title&gt;″;<br>
      　　print″&lt;h1&gt;留言本&lt;/h1&gt;″;<br>
      　　foreach ＄check(values％FORM){<br>
      　　if(＄check eq″″){<br>
      　　print″&lt;hr size=3&gt;″;<br>
      　　print″&lt;h2&gt;请不要留空″;<br>
      　　exit(0);<br>
      　　}<br>
      　　}<br>
      　　＄FORM{'suggest'}=～s/cM\n/&lt;br&gt;\n/g;<br>
      　　＄filename=″http://www.yourname.com/book.html″;(留言簿的相对位置）<br>
      　　open(FILE,″&gt;&gt; ＄filename″);<br>
      　　print FILE ″名字：＄FORM{'name'}&lt;br&gt;\n″;<br>
      　　print FILE ″Email:&lt;a href=″mailto:＄FORM{'email'}&gt;＄FORM{'email'}&lt;/a&gt;&lt;br&gt;\n″}″;<br>
      　　print FILE ″留言：＄FORM{'suggest'}″;<br>
      　　close{FILE};<br>
      　　print ″&lt;h2&gt;谢谢留言&lt;/h2&gt;″;<br>
      　　print″&lt;a href=\″book.html\″&gt;请观看留言本&lt;/a&gt;″;<br>
      　　exit(0);<br>
      　　这个程序相当简单，但它具备所有的CGI－Guest程序的特点，我们一一分析如下：<br>
      　　首先，<br>
      　　read(STDIN,＄buffer,＄ENV{'CONTENT_LENGTH'})；<br>
      　　@pairs=split(/＆/,＄buffer);<br>
      　　foreach ＄pair(@pairs){<br>
      　　(＄name,＄value)=split(/=/,＄pair);<br>
      　　＄value=～tr/＋//;<br>
      　　＄value=～s/％([a－f A－F 0－9][a－f A－F 0－9])/pack(″C″,hex(＄1))/eg;<br>
      　　＄FORM{＄name}=＄value;<br>
      　　}<br>
      　　这是一段表单分析的语句，在前面的程序里，估计大家也都见过了。<br>
      　　其次：<br>
      　　foreach ＄check(values％FORM){<br>
      　　if(＄check eq″″){<br>
      　　print″&lt;hr size=3&gt;″;<br>
      　　print″&lt;h2&gt;请不要留空″;<br>
      　　exit(0);<br>
      　　}<br>
      　　}<br>
      　　做输入字段的检查，看看是否有留空的现象。从前这种任务都是要CGI程序来验证的，比如E－mail栏中输入的是否E－mail地址检查等。不过现在我们可以通过javascript来做这样的检查，这样服务器的负担将大大减轻。<br>
      　　最后：<br>
      　　＄filename=″http://www.yourname.com/book.html″;<br>
      　　open(FILE,″&gt;&gt; ＄filename″);<br>
      　　print FILE ″名字：＄FORM{'name'}&lt;br&gt;\n″;<br>
      　　print FILE ″Email:&lt;a href=″mailto:＄FORM{'email'}&gt;＄FORM{'email'}&lt;/a&gt;&lt;br&gt;\n″}″;<br>
      　　print FILE ″留言：＄FORM{'suggest'}″;<br>
      　　close{FILE};<br>
      　　print ″&lt;h2&gt;谢谢留言&lt;/h2&gt;″;<br>
      　　print″&lt;a href=\″book.html\″&gt;请观看留言本&lt;/a&gt;″;<br>
      　　exit(0);<br>
      　　输出内容到文件和屏幕上。完成留言的程序。<br>
      　　book.html:<br>
      　　这个程序中对book.html没有什么特别的要求，可以不用写，就让程序自动生成。现在有的cgi程序对book.html也有设定，比如在&lt;head&gt;&lt;/head&gt;之间就写上注释&lt;!－－这是留言开始－－!&gt;&lt;!－－这是留言结束－－!&gt;这样，在程序对留言数据操作的时候，就可以忽略掉文件内的其他内容。<br>
      　　看完了这个简单的自制留言簿程序，你是不是想自己做一个呢？只要你用HTML语言把form.html做的漂亮一点，再把guest－book.cgi写好就可以放在支持CGI的免费个人主页的主机上（设好权限，以免被别人抓走了），你就可以炫耀了:“这是我自己做的留言簿，感觉怎么样？”相信很多“菜鸟”一定会对你佩服得五体投地！<br>
      <b> （四川　刘欢）</b></TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>