<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 魔鬼辞典</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'></TD>
</TR></TABLE>
<table width='468' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; 2000 年 &gt; <!-- #BeginEditable "%C6%DA" -->18期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; PowerBuilder编程俱乐部</td>
  </tr>
</table>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 PowerBuilder编程俱乐部 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD height="528"> 
      <p> 　　大家好！PowerBuilder编程俱乐部又与大家见面了，自俱乐部推出之后，受到广大读者的喜爱，每天都有大量的来信，让我们倍感欣慰。有不少PB爱好者甚至将自己平时编程的经验技巧通过电子邮件寄给了我，我将这些技巧放到了俱乐部的主页上，让大家参考。各位可到俱乐部主页http://kjx.126.com或http://pb70.yeah.net的BBS讨论区去提交问题或解答问题，希望我们能共同进步。<br>
        　　问题一：请问在PB的数据窗口中怎样实现某一列的增量查询功能，就是说在单行编辑器控件中每输入一个字符，数据窗口能找到这一列值左边部分与单行编辑器中内容相等的行，并加亮显示。例如数据窗口是按整型字段“ID”升序排列的，用户在单行编辑器中输入1，则数据窗口滚动到ID字段第一位为“1”的第一行并加亮显示；再在1后输入0，则数据窗口滚动到ID字段前两位为“10”的第一行，依次类推。<br>
        　　答：增量查询功能实现的关键有两点，一是单行编辑器能实时响应键盘的输入，捕捉每一个按键，获得其中的文本；二是数据窗口的模糊查询功能，即能够找到列ID左边文本与单行编辑器文本相等的行，这可以用“like”来实现。下面给出具体方法：<br>
        　　1．定义单行编辑器的用户事件ue_enchange，事件的ID为：pbm_enchange。这个事件能响应键盘的输入。<br>
        　　2．在单行编辑器的ue_enchange事件中编写如下脚本：<br>
        　　long ll_found_row<br>
        　　string ls_find <br>
        　　ls_find = ″string(id) like ″ ＋ ″′″ ＋ this.text ＋ ″％′″ //查找条件（左部分与单行编辑器文本相等）<br>
        　　ll_found_row = dw_name.Find(ls_find, 1, dw_name.RowCount()) //查找符合条件的行<br>
        　　if ll_found_row &lt;= 0 then return<br>
        　　dw_name.ScrollToRow(ll_found_row) //滚动到相匹配的行<br>
        　　dw_name.SelectRow(0 , false)<br>
        　　dw_name.SelectRow(ll_found_row , true) //将匹配行加亮显示<br>
        　　问题二：ORACLE 7.3 ＋ PB，在Oracle的SQL＊PLUS中可以很容易修改表结构，但如何在PB程序中动态修改表结构？比如将某一字段的长度扩大？<br>
        　　答：用动态SQL语句，举例如下:<br>
        　　string ls_Mysql <br>
        　　ls_Mysql=″alter table department modify dept_name varchar2(12)″<br>
        　　sqlca.autocommit = true<br>
        　　EXECUTE IMMEDIATE :ls_Mysql;<br>
        　　sqlca.autocommit = false <br>
        　　commit; <br>
        　　以上脚本的作用是把表department的字符型字段dept_name长度加大到12。<br>
        　　这种方法还可以实现在程序中建表（将ls_Mysql的值改为″create table ...″即可 ）、删除表等操作，也适用于Sybase 
        SQL Anywhere，MS SQL Server等数据库。<br>
        　　问题三：我想把用PB开发的应用的全部源代码打印出来，请问有什么工具可以实现？<br>
        　　答：不用其他工具，PB本身就可以做到。举个例子：要打印一个窗口的脚本，在Library画板中右键点击此窗口，选择print菜单项，里面有打印的内容：画面、窗口脚本、窗口控件脚本等，想打什么就选什么吧。 
        <br>
        　　问题四：如何在菜单中触发父窗口对象中命令按钮控件的单击事件？ <br>
        　　答：先在菜单的父窗口中定义一个自定义事件（如ue_ok，事件ID：pbm_custom01），在ue_ok事件中编写触发父窗口中命令按钮cb_ok的Clicked事件的代码： 
        cb_ok.trigger event(clicked!) 然后在菜单的相应事件中触发该用户事件ue_ok： parentwindow.triggerevent(″ue_ok″) 
        <br>
        　　问题五：如何在复合报表（Composite DataWindow）中引用计算域的值？<br>
        　　答：对于一般类型的数据窗口，我们可以用这种办法：先为计算域取名，如“count_id”，取值过程如下（除了分组的数据窗口，一般计算域都用1）：<br>
        　　long ll_count_id <br>
        　　ll_count_id = dw_1.getitemnumber(1,″count_id″) <br>
        　　而对于复合报表，须先用GetChild()函数得到其中的report，再取此report中计算域的值。假设此 report name 为“report_department”（注意不要混淆report 
        name 与子数据窗口本身的名字），计算域名为count_id，则取值过程如下：<br>
        　　DataWindowChild dwc_child<br>
        　　long ll_count_id <br>
        　　dw_1.GetChild(″report_department″<br>
        　　dwc_child)<br>
        　　ll_count_id = dwc_child.getitemnumber(1,″count_id″) <br>
        　　问题六：在用PB6.5编程序时发现PB6.5中没有反三角函数，请问怎么办？<br>
        　　答：确实如此，PB中只提供了三角函数如sin()、cos()，要想使用反三角函数须借助于数据库。一般数据库如Sybase SQL Anywhere、MS 
        SQL SERVER等都提供反三角函数，使用方法select 函数名(参数) into 变量 ……如在Sybase SQL Anywhere 
        5 中：<br>
        　　double ldb_value<br>
        　　SELECT asin(″search″.″id″) <br>
        　　INTO :ldb_value<br>
        　　FROM ″search″<br>
        　　WHERE ″search″<br>
        .″id″ = 1; <br>
        　　实现了对数据库字段的反三角计算，如果是对一般的内存变量的反三角计算可用变通的办法（此方法由网易PB版主edsion提供）：<br>
        　　double ldb_value = 1 <br>
        　　double ldb_asin <br>
        　　SELECT asin( :ldb_value ) <br>
        　　INTO :ldb_asin <br>
        　　FROM ″department″ ;<br>
      </p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>