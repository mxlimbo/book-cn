<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/epcw.css' TYPE='text/css'>
 
<TITLE>电脑报电子版 -- 用JAVASCRIPT实现邮箱快速登录</TITLE>
 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'>
    <TD WIDTH='100%'>&nbsp;</TD>
  </TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><img src="images/yjds.gif" width="468" height="50"></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='index.html'>YESKY电子版</A> 
      &gt; <A HREF='http://drivers.cpcw.com/issue.htm'>2000 年</A> &gt; <a href="index.html">23期</a> 
      &gt; <a href="internet.html">大众网络</a> &gt; 用JAVASCRIPT实现邮箱快速登录</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 用JAVASCRIPT实现邮箱快速登录 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD> 
      <p>　　在网上逛久了，是不是经常见到别人的站点上的“免费邮箱快捷登录”等“便民”的好东东？打开这些页面的源文件一看，原来都是通过某些ASP或CGI程序登录的，这就不得不使一向喜欢贪图便利的我们小心谨慎起来—要知道，这些来历不明的ASP或CGI若想记录我们的用户名跟密码是轻而易举的事！所以，一般情况下我们都不太用它，除非这个ASP程序是自己做的—但，自己做的自己相信，怎样让别人也相信呢？毕竟ASP太“安全”了，客户端根本看不到真正的源代码！<br>
        　　实际上，撇开其它因素不谈，这些ASP或CGI程序起的仅仅是一个转换作用而已，即将获得的用户名与密码转换为相应免费电邮登录脚本的对应格式。这种功能用JavaScript完全能够胜任，而且由于JavaScript对客户端的透明性即访客可以看到源代码，所以不会有前面的这些ASP的“信任危机”。<br>
        　　先来讲讲它的原理。前面已经提到，我们要做的只是获取用户名与密码然后转换为相应登录脚本的特定格式，如“新浪免费邮件”处理登录信息的文件名及地址是“http://mail.sina.com.cn/cgi－bin/login”，“用户名”的“叫法”是“u”，“密码”是“psw”，如果用户选择了“新浪邮件”，程序要做的就是将用户输入用户名以“u”和密码以“psw”的格式发送到登录脚本，形成“http://mail.sina.com.cn/cgi－bin/login?u=user＆psw=password”，然后登录。下面一起来看具体怎么做。<br>
        　　先做一个登录表单，将需要数据发送给JavaScript函数。表单可参考以下代码：<br>
        　　&lt;form name=″mailForm″ action=″JavaScript:go()″ Onsubmit=″return check(this)″ 
        method=″post″&gt;<br>
        　　&lt;p&gt;&lt;select name=″mailSelect″ size=″1″&gt;<br>
        　　&lt;option selected value=″None″&gt;请选择你的免费邮箱&lt;/option&gt;<br>
        　　&lt;!－－这些选项的顺序可以随意改变，它们的值应根据具体情况以下面的形式设定：第一部分是登录地址，余下的分别是用户名与密码的“叫法”，以半角分号“;”隔开－－&gt;<br>
        　　&lt;option value=″mail.sina.com.cn/cgi－bin/login;u;psw″&gt;新浪免费电邮&lt;/option&gt;<br>
        　　&lt;option value=″web.163.net/cgi/login;user;pass″&gt;163电子邮局&lt;/option&gt;<br>
        　　&lt;option value=″freemail.263.net/cgi/login;user;pass″&gt;263免费电邮&lt;/option&gt;<br>
        　　&lt;option value=″freemail.990.net/prog/login;user;pass″&gt;990免费电邮&lt;/option&gt;<br>
        　　&lt;/select&gt;&lt;br&gt;<br>
        　　账号：&lt;input type=″text″ name=″name″ size=″12″ onfocus=″this.select()″&gt;&lt;br&gt;<br>
        　　密码：&lt;input type=″password″ name=″password″ size=″12″ onfocus=″this.select()″&gt;&lt;br&gt;<br>
        　　&lt;input type=″submit″ value=″登录″ style=″font－size: 9pt″ name=″submit″&gt;<br>
        　　&lt;input type=″reset″ value=″重置″ name=″reset″ style=″font－size: 9pt″&gt;&lt;/p&gt;<br>
        　　&lt;/form&gt;<br>
        　　第二步，编写JavaScript函数，将它放在登录表单所在页面的&lt;head&gt;……&lt;/head&gt;之间。<br>
        　　&lt;script language=″JavaScript″&gt;&lt;!－－<br>
        　　function makeURL(){ /＊登录页面地址生成函数＊/<br>
        　　var objForm=document.mailForm;<br>
        　　var intIndex=objForm.mailSelect.options.selectedIndex;<br>
        　　var varInfo=objForm.mailSelect.options[intIndex].value;　/＊获取的表单中邮件服务器及用户账号和密码信息＊/<br>
        　　var arrayInfo=varInfo.split(′;′);　/＊将以上获取的信息进行分割，并赋给数组变量＊/<br>
        　　var strName=objForm.name.value,varPasswd=objForm.password.value;<br>
        　　var strProvider=arrayInfo[0],strIdName=arrayInfo[1],varPassName=arrayInfo[2];　/＊将″邮件服务器地址及处理登录的文件名″、″账号″、″密码″看作变量＊/<br>
        　　var strUrl=′http://′＋strProvider＋′?′＋strIdName＋′=′＋strName＋′＆′＋varPassName＋′=′＋varPasswd;　/＊合并字符串，得到形如″http://mail.sina.com.cn/cgi－bin/login?u=name＆psw=password″的字符串型URL＊/<br>
        　　return strUrl;　/＊返回得到的登录页面地址＊/<br>
        　　}<br>
        　　function go(){ /＊转到相应的登录页面＊/<br>
        　　var strLocation=makeURL();<br>
        　　window.open(strLocation,′′,′′);<br>
        　　}<br>
        　　function check(input){　/＊表单常规检查函数，可以根据具体情况编写＊/<br>
        　　if(input.mailSelect.options.selectedIndex==0){<br>
        　　alert(″你忘了选择您的邮箱了！″);<br>
        　　return false;}<br>
        　　if(input.name.value==″″){<br>
        　　alert(″你忘了填写您的账号名了！″);<br>
        　　input.name.focus();<br>
        　　return false;}<br>
        　　if(input.password.value==″″ || input.password.value.length&lt;3){<br>
        　　alert(″你的密码长度小于3字符吗？还是重新填写吧！″);<br>
        　　input.password.focus();<br>
        　　return false;}<br>
        　　else return true;<br>
        　　}<br>
        　　－－&gt;&lt;/script&gt;<br>
        　　好了，属于大家的“免费邮箱快捷登录”完成了，现在就试一下，怎么样？我的E－mail：contion@sina.com，有问题可以来信联系。</p>
      <p align="right"><br>
        　　（西安　周辉腾）</p>
      　　　　　　　　　　　　　 
    </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'><img src='http://cq.cpcw.com/cgi-bin/Count.cgi?ft=2|md=8|df=cpcw.dat|dd=E|cache=F|expires=18000' width='1' height='1' alt='312345678'> 
      
      <noscript> <a href='http://best.nease.net/cgi-bin/view/viewbasic.cgi?cpcw' target='_blank'> 
      <img src='http://best.nease.net/cgi-bin/log.cgi?user=cpcw&refer=http%3A//www.cpcw.com/&cur=http%3A//www.cpcw.com/issue/1999/50/99500302.html#NoJavaScript' width='1' height='1' border='0' alt='网易中文排行榜'></a> 
       <a href="http://usa.nedstatbasic.net/cgi-bin/viewstat?name=cpcwissue"><img
src="http://usa.nedstatbasic.net/cgi-bin/nedstat.gif?name=cpcwissue"
border=0 alt="" nosave width=1 height=1></a>  
       
      
      </noscript> 页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>&nbsp;</TD>
<TD> YESKY版权所有，<A HREF='mailto:webmaster@cpcw.com'>YESKY网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>