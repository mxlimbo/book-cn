<HTML>
<HEAD>
	<link rel="STYLESHEET" type="text/css" href="Library.css">
<TITLE>Rebars</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12d.htm", "ch13a.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="396"><H1>Rebars</H1></A>

<P>Internet Explorer 3.0 introduced a new control type to Windows: the rebar control. A rebar is a container for other controls. You populate a rebar control by adding 
<I>bands</I> to it; each band can include a child window such as a toolbar, push button, or combo box. You can add as many bands as you like, and once the rebar is displayed, the user can move and resize the bands to configure the rebar control to his or her liking. Each band in a rebar can optionally have an image from an image list, a label (text string), and a bitmap associated with it. The image and label, if used, are displayed on the face of the band. The bitmap, if used, is tiled horizontally and vertically to form a stylized background for whatever else happens to be displayed in the band. Remember the toolbar with the textured background in Internet Explorer 3.0? That toolbar was actually a rebar control wrapped around an otherwise rather ordinary toolbar control. A bitmap provided the textured background. 
</P>

<P>MFC 6.0 introduced two new classes to simplify the programming of rebar controls: 
<I>CReBar</I> and 
<I>CReBarCtrl</I>. 
<I>CReBarCtrl</I> is a low-level class that provides a very thin wrapper around a raw rebar control. <I>CReBar</I> is a high-level class that makes it almost as easy to add rebars to an MFC application as it is to add toolbars and status bars. 
<I>CReBar</I> publishes just three member functions:
</P>

<UL>

<P><LI>
<I>Create</I>, which creates a rebar from a 
<I>CReBar</I> object</li></p>

<P><li>
<I>GetReBarCtrl</I>, which returns a 
<I>CReBarCtrl</I> reference to the underlying rebar control</li></p>

<P><li>
<I>AddBar</I>, which adds a band to the rebar</li></p>

</UL>

<P>
With 
<I>CReBar</I> and its member functions to help out, creating rebar-type toolbars like the ones used in Visual C++ could hardly be easier. The following example converts an MFC toolbar into a rebar by first creating a <I>CToolBar</I> and then making it a band in a 
<I>CReBar</I>:
</p>

<p><table cellpadding=5 width="95%"><tr><td>	
<PRE>
m_wndToolBar.CreateEx (this);
m_wndToolBar.LoadToolBar (IDR_TOOLBAR);
m_wndReBar.Create (this);
m_wndReBar.AddBar (&amp;m_wndToolBar);
</PRE>
</td></tr></table></p>

<P>
You can use 
<I>AddBar</I>'s optional second and third parameters to specify a label and a background bitmap. For example, if 
<I>m_bitmap</I> is a 
<I>CBitmap</I> object, the statements 
</p>

<p><table cellpadding=5 width="95%"><tr><td>	
<PRE>
m_bitmap.LoadBitmap (IDB_BKGND);
m_wndToolBar.CreateEx (this, TBSTYLE_FLAT | TBSTYLE_TRANSPARENT);
m_wndToolBar.LoadToolBar (IDR_TOOLBAR);
m_wndReBar.Create (this);
m_wndReBar.AddBar (&amp;m_wndToolBar, _T (&quot;Main&quot;), &amp;m_bitmap);
</PRE>
</td></tr></table></p>

<p>
assign the toolbar the label &quot;Main&quot; and use the bitmap resource whose ID is IDB_BKGND as the toolbar's background. When you use a background bitmap in this manner, it's important to create the toolbar with the styles TBSTYLE_FLAT and TBSTYLE_TRANSPARENT and to use light gray as the toolbar buttons' background color. Otherwise, the button backgrounds are drawn over the top of the background bitmap, and you won't get the effect you were hoping for. 
</p>

<p>
If you check the Internet Explorer ReBars box in AppWizard's Step 4 dialog box (shown in Figure 12-10), AppWizard wraps a rebar around the toolbar that it generates. If you want to do more with the rebar, such as add a label or a bitmap, or if your application features multiple toolbars and you want to wrap each of them in a rebar, you must add the code yourself.
</p>

<P>
<A HREF="javascript:fullSize('F12mg10x.htm')"> <img src="images/F12mg10.JPG" width=404 height=325 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- CAPTION --><B>Figure 12-10.</B> <I>Using AppWizard to wrap a rebar around a toolbar.</I><!-- /CAPTION -->
</p>


</BODY>

</HTML>




