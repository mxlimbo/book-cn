<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>The Position of a Maximized Window</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY>
<A NAME="303"><H1>The Position of a Maximized Window</H1></A>
<P>As a Windows user, you know that you can maximize a window from the system menu or by clicking a button at the top right corner of the window. You can return a maximized window to its original size in a similar fashion. It's obvious that a maximized window remembers its original size and position.
<P>The <I>CWnd</I> function <I>GetWindowRect</I> retrieves the screen coordinates of a window. If a window is maximized, <I>GetWindowRect</I> returns the coordinates of the screen rather than the window's unmaximized coordinates. If a persistent frame class is to work for maximized windows, it has to know the window's unmaximized coordinates. <I>CWnd::GetWindowPlacement</I> retrieves the unmaxi-mized coordinates together with some flags that indicate whether the 
window is currently minimized or maximized or both.
<P>The companion <I>SetWindowPlacement</I> function lets you set the maximized and minimized status and the size and position of the window. To calculate the position of the top left corner of a maximized window, you need to account for the window's border size, obtainable from the Win32 <I>GetSystemMetrics</I> function. See Figure 15-1 for the <I>CPersistentFrame::ActivateFrame</I> code for an example of how <I>SetWindowPlacement</I> is used.
</BODY>
</HTML>



