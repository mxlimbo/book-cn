<HTML>
<HEAD>
<TITLE>Running the Script Engine in MTS</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12k.htm", "ch13a.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="441"><H1>Running the Script Engine in MTS</H1></A>

<P>You can place the Event Scripting Agent (Scripto.dll) into MTS, 
which allows you to run the Scripting Agent using a specific Windows 
NT account for security purposes and also to run the Scripting 
Agent in a dedicated and isolated process. MTS will manage 
instantiating the Scripting Agent as well as shutting it down if any anomalies 
occur during processing.</P>
<P>To make it easier for you to install the Event Scripting 
Agent as an MTS component, Microsoft Exchange Server 5.5 includes 
a prebuilt MTS package for you to use. To install the package, 
follow these steps:</P>

<OL>
<P><LI>Make sure you have MTS installed on the server where 
you are running the Event Service. As of the writing of 
this book, the latest version of MTS is version 2.0, and it 
ships with the Windows NT 4.0 Option Pack.</LI></P>
<P><LI>Start the MTS Explorer by accessing the Start menu 
and then selecting Programs, Windows NT 4.0 Option 
Pack, Microsoft Transaction Server, and Transaction Server 
Explorer.</LI></P>
<P><LI>Locate the name of your computer in the Computers tree.</LI></P>
<P><LI>Select the folder named Packages Installed, and from 
the Action menu, select New and then Package.</LI></P>
<P><LI>Click the Install Pre-Built Packages button.</LI></P>
<P><LI>Click the Add button, and find the Scripto.pak file on 
the Exchange Server 5.5 CD in the Server\Support\Collab\Sampler\Scripts folder. Select 
this package, and click Open.</LI></P>
<P><LI>Click Next.</LI></P>
<P><LI>Click the This User option. Click the Browse button to 
find the Windows NT account identity you want the script 
engine to run under. As discussed earlier, this account 
should have Log On As A Service privileges. Once you have 
specified an account, click Next.</LI></P>
<P><LI>Verify the Install Directory and click Finish.</LI></P>


<P>The Exchange Scripting Agent package should now be 
installed in MTS, as shown in Figure 12-22.</P>
</OL>

<P>
<A HREF="javascript:fullSize('f12oh22x.htm')"> <img src="images/f12oh22.JPG" width=404 height=269 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 12-22</B> <I>The Exchange Event Scripting Agent installed as an MTS component.</I><!-- /CAPTION -->
</P>

<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>
If you are interested in learning more about 
the Event Service and the types of applications you can 
develop with this technology, you should look at the 
four sample scripts included on the Exchange Server 5.5 CD 
in the Server\Support\Collab\Sampler\Scripts folder.
</BLOCKQUOTE></DIV></P>

 </BODY>
</HTML>





