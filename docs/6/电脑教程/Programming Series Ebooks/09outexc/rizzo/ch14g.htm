<HTML>
<HEAD>
<TITLE>Creating Paths to Exchange Server Objects and Attributes</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch14f.htm", "ch14h.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="499"><H1>Creating Paths to Exchange Server Objects and Attributes</H1></A>

<P>The first step in developing any ADSI application that accesses the 
Exchange Server directory is creating a valid instance of ADSI and passing this instance 
a valid path to the object you want to access. When writing Java, Visual 
Basic, VBScript, or VBA applications, the easiest way to create a valid instance of 
the ADSI library is to use the 
<I>GetObject(</I>AdsPath<I>)</I> syntax. <I>AdsPath 
</I>corresponds to a valid ADSI path to a specific object. For example, to access a specific 
Exchange Server object named <I>ExServer</I>, a specific Organization in Exchange Server 
named <I>Microsoft</I>, and a specific site in the Organization named 
<I>ExSite</I>, you would pass in the following AdsPath to the 
<I>GetObject </I>method:</p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
LDAP://ExServer/ou=ExSite, o=Microsoft
</PRE></TD></TR></TABLE></P>

<P>The <I>LDAP</I> at the beginning of the path specifies the ADSI provider to use. 
If you just want to set an object variable to a specific ADSI provider without 
attempting to open an object, you can also use the 
<I>GetObject(</I>ADSIProvider<I>) </I>syntax. For example,</p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
oIADs = GetObject(&quot;LDAP:&quot;)
</PRE></TD></TR></TABLE></P>

<P>sets the <I>oIADs</I> variable to the LDAP provider. To specify a different 
provider, you would replace the LDAP string with 
<I>WinNT</I> or <I>NDS</I>. To access a specific recipient in a specific container on the ExServer Exchange Server, you 
would use the following AdsPath:</p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
LDAP://ExServer/cn=<I>RecipientName</I>, cn=<I>RecipientContainer</I>, 
ou=ExSite, o=Microsoft
</PRE></TD></TR></TABLE></P>

<P>As you can see from both examples, the syntax for creating a valid 
path follows this structure:</p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
LDAP://<I>Exchange NT Server Name</I>/cn=<I>Bottom most object</I>, 
<I>cn=next level of object</I>, ou=<I>Exchange Site</I>, o=<I>Exchange Organization</I>
</PRE></TD></TR></TABLE></P>

<P>Throughout the sample application in this chapter, you will see examples 
of how to use this syntax to query different parts of the Exchange Server directory.</p>

</BODY>
</HTML>





