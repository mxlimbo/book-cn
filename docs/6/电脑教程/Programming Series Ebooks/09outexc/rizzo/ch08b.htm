<HTML>
<HEAD>
<TITLE>Outlook Today</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch08a.htm", "ch08c.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="238"><H1>Outlook Today</H1></A>

<P>As you learned at the end of <A HREF="ch07a.htm">Chapter 7</A>, Outlook 98 includes a feature 
that takes advantage of the HTML support in Outlook&#8212;Outlook Today. 
Outlook Today allows users to view information in an HTML window, as shown 
in Figure 8-1, rather than as separate modules. You can also 
customize Outlook Today's HTML code. For example, a customized 
Outlook Today page might include hyperlinks to Public Folder favorites, intranet 
sites, or Internet sites. You can even link to other applications, such as a 
web-based SQL Server application. You can also create multiple Outlook Today pages 
for the different types of users of your application. Let's take a look at how 
the Outlook Today page functions and how you modify the Outlook Today 
page for your specific application needs.</P>

<P>
<A HREF="javascript:fullSize('f08oh01x.htm')"> <img src="images/f08oh01.JPG" width=404 height=280 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 8-1</B> <I>Outlook Today is an HTML feature added to Outlook 98. Users can see different types of information in a single window.</I><!-- /CAPTION -->
</P>

<A NAME="239"><H2>Outlook Today Technologies</H2></A>

<P>The standard Outlook Today page takes advantage of a feature in 
Microsoft Internet Explorer called data binding. Data binding allows Outlook to 
quickly display the user interface for the Outlook Today page while 
asynchronously downloading data from the Exchange Server to the Outlook client. Once 
the data is downloaded, Outlook can modify the data without making 
additional trips to the server. On the default Outlook Today page, there are three 
separate data binding tables for your Calendar, Tasks, and Mail. To modify the 
location of these tables or to add new functionality to the Outlook Today page, 
you need to know how to modify HTML. Since Outlook Today leverages 
Internet Explorer, you can even use Dynamic HTML (DHTML) in your 
customization. However, remember these limitations when customizing the Outlook Today page:</P>

<UL>
<P><LI>Modifying the page might slow performance because Outlook has 
to retrieve information from other data sources. Try not to build 
complex applications in the Outlook Today window; instead, build 
either an Outlook form or a standard HTML application, and then add 
the HTML application to Outlook Web Access.</LI></P>
<P><LI>Although you can add external links to Internet sites on your 
Outlook Today page, Outlook Today will not verify the security of 
the site. To use the security capabilities you have in your browser, 
you could add a link in Outlook Today that launches a separate 
browser, such as Internet Explorer, to render the page. If you are sure of 
the content that you are linking to, you do not have to browse the 
link in a separate browser.</LI></P>
<P><LI>You cannot add the Outlook Today page as an Active Desktop 
item. Currently, the Outlook Today functionality works only when 
hosted in the Outlook window.</LI></P>
</UL>

<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>
The standard Outlook Today pages are hosted in a 
resource dynamic link library (DLL), which improves the performance of 
the Outlook Today application. When modifying your Outlook 
Today pages, you have the option to place your custom HTML pages 
and images in a resource DLL. However, this book covers only 
customizing Outlook Today and saving these customizations as HTML 
files. To learn how to compile your files into a resource DLL for 
Outlook Today, refer to the Outlook 98 Deployment Kit. The Deployment 
Kit is presently not available for retail purchase or download from 
the Web, but you can access the Deployment Kit documentation 
from <I><A HREF="http://www.microsoft.com/office/98/outlook/documents/O98DKdoc.htm" TARGET="_window2">http://www.microsoft.com/office/98/outlook/documents/O98DKdoc.htm</A>.</I>
</BLOCKQUOTE></DIV></P>

<A NAME="240"><H2>Customizing Outlook Today</H2></A>

<P>Customizing the Outlook Today page and saving the result as an HTML 
file involves a few steps, which are outlined in the following sections.</P>

<A NAME="241"><H3>Retrieving the Outlook Today Source</H3></A>

<P>To view the source of an HTML page in Internet Explorer, you can 
right-click on the page and select View Source from the context menu. If you right-click 
on the Outlook Today page to view the source of the HTML page, however, 
you will notice that the View Source option is not available&#8212;Outlook disables 
this option. To retrieve the HTML source for the Outlook Today page, you can 
copy the Outlook.htm file from the Outlook 98 Deployment Kit, or you can 
use Internet Explorer to retrieve the source by following these steps:</P>

<OL>
<P><LI>Start Internet Explorer. In the address box, type the following 
URL, adjusting the path as necessary:</LI></P>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
<I>res://c:\Program Files\Microsoft Office\Office\
Outlwvw.dll/Outlook.htm</I>
</PRE></TD></TR></TABLE></P>


<P><LI>After you press Enter, you will get a script error. Select No to 
decline continuing running scripts and debugging the current page.</LI></P>
<P><LI>From the View menu, select Source to display the source in 
Notepad.</LI></P>
<P><LI>From the File menu in Notepad, select Save As and save the file 
to your hard disk as Outlook.htm.</LI></P>
<P><LI>Perform a search in Notepad for the three instances of 
<I>display:none</I>, and replace them with 
<I>display:</I>.</LI></P>
</OL>

<A NAME="242"><H3>Modifying the Registry</H3></A>

<P>You need to modify your Registry settings so that Outlook knows you 
want Outlook Today to point to a new file for its functionality. You could write 
a program that performs this step for your customers:</P>

<OL>
<P><LI>Start the Registry Editor (Regedit.exe).</LI></P>
<P><LI>Find the following Registry key:</LI></P>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\
Outlook\Today
</PRE></TD></TR></TABLE></P>

<P>If the Today key does not exist, create it. Right-click on the 
Outlook key, point to New, and select Key. Type 
<I>Today</I> for the name of the key.</P>

<P><LI> Add a new string value to the Today key by right-clicking on 
the Today key, pointing to New, and selecting String Value. Type 
<I>Url</I> for the value name.</LI></P>
<P><LI>Double-click on the URL string icon to edit it. For its value 
data, type the path to the Outlook.htm file that you saved previously. 
For example, file://C:\Outlook.htm<I>.</I> When finished, click OK.</LI></P>
</OL>

<A NAME="243"><H3>Customizing the HTML File</H3></A>

<P>The final step is to customize the HTML file with your functionality. The 
easiest way to do this is by using a text editor, because the HTML code in the 
page contains special formatting that will make the file appear incorrectly in 
Microsoft FrontPage. Let's review some of the ways you can customize the Outlook 
Today HTML page.</P>

<P><B>Changing fonts</B> Since Outlook Today uses cascading style sheets, you 
can easily change fonts and styles by modifying the style sheet. For example, 
you could change the font for important items by changing the 
<I>.itemImportant {color:red} </I>line in the style sheet to the desired font and color.</P>
<P><B>Adding text, images, and hyperlinks</B> Using HTML, you can add new 
text, images, or hyperlinks to your Outlook Today page. Remember that if you 
link to an external web site, Outlook will not implement the security that you 
set in your standard web browser. So use the following code when placing 
external links in the Outlook Today page:</P>
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
&lt;a style=&quot;cursor:hand&quot; class=&quot;itemNormal&quot; onclick=
&quot;window.open('http://www.microsoft.com/exchange/','_blank');&quot;&gt;
Exchange web site&lt;/a&gt;
</PRE></TD></TR></TABLE></P>

<P><B>Adding components</B> Since Outlook Today leverages Internet Explorer, 
you can place any components on your page as long as Internet Explorer 
supports them. These components can include ActiveX controls as well as Java 
applets. However, make sure you trust the source of the component because 
Outlook does not check the component's security credentials.</P>
<P><B>Adding script</B> Outlook Today supports both JScript as well as VBScript. 
From script, you can access the Outlook object library and use its functions in 
your Outlook Today page. You can see an example of a customized Outlook 
Today page for the Account Tracking application in <A HREF="ch07a.htm">Chapter 7</A>.</P>

</BODY>
</HTML>





