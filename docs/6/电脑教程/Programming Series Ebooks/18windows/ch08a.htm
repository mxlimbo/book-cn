<HTML>
<HEAD>
	<LINK REL=StyleSheet HREF="petzoldi.css" TYPE="text/css">
<TITLE>Chapter 8 -- The Timer</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff">

<font size="+3">Chapter 8</font>

<A NAME="215"><h1>The Timer</h1></A>
<p>The Microsoft Windows timer is an input device that periodically notifies an application when a specified interval of time has elapsed. Your program tells Windows the interval, in effect saying, for example, &quot;Give me a nudge every 10 seconds.&quot; Windows then sends your program recurrent WM_TIMER messages to signal the intervals.

<p>At first, the Windows timer might seem a less important input device than the keyboard and mouse, and certainly it is for many applications. But the timer is more useful than you may think, and not only for programs that display time, such as the Windows clock that appears in the taskbar and the two clock programs in this chapter. Here are some other uses for the Windows timer, some perhaps not so obvious:

<p><ul>

<p><li><I>Multitasking</I> Although Windows 98 is a preemptive multitasking environment, sometimes it is more efficient for a program to return control to Windows as quickly as possible after processing a message. If a program must do a large amount of processing, it can divide the job into smaller pieces and process each piece upon receipt of a WM_TIMER message. (I'll have more to say on this subject in <a href="ch20a.htm#709">Chapter 20</a>.)

<p><li><I>Maintaining an updated status report</I> A program can use the timer to display &quot;real-time&quot; updates of continuously changing information, such as a display of system resources or the progress of a certain task.

<p><li><I>Implementing an &quot;autosave&quot; feature</I> The timer can prompt a Windows program to save a user's work to disk whenever a specified period of time has elapsed.


<p><li><I>Terminating &quot;demo&quot; versions of programs</I> Some demonstration versions of programs are designed to terminate, say, 30 minutes after they begin. The timer can signal such applications when the time is up.

<p><li><I>Pacing movement</I> Graphical objects in a game or successive displays in a computer-assisted instruction program might need to proceed at a set rate. Using the timer eliminates the inconsistencies that might result from variations in microprocessor speed.

<p><li><I>Multimedia</I> Programs that play CD audio, sound, or music often let the audio data play in the background. A program can use the timer to periodically determine how much of the audio has played and to coordinate on-screen visual information.
</UL>

<p>Another way to think of the timer is as a guarantee that a program can regain control sometime in the future after exiting the window procedure. Usually a program can't know when the next message is coming.

</BODY>
</HTML>






