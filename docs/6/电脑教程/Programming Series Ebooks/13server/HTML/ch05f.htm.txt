<HTML>
<HEAD>
<TITLE>Storing Data in the System Registry</TITLE>
<link rel="STYLESHEET" type="text/css" href="prosrvwin.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<A HREF="ch05e.htm">[Previous]</A> <A HREF="ch05g.htm">[Next]</A><P>

<A NAME="84"><h1>Storing Data in the System Registry</h1></A>
<p>Before I discuss how to store data in the system registry, I will revisit the topic of proper registry usage. As you know, the system registry is a shared resource. As such, it is limited and access to it is serialized. Your application can store many thousands of kilobytes of data in the registry in various data types, but it is rarely in your application's best interest to take these capabilities to the extreme.</p>

<p>You should ask yourself two questions when considering registry storage:</p>

<ul>
<p><li>Is the data I am storing part of my application's configuration information, or is it general application data? (For example, it would be inappropriate for a word processor to store documents in the registry.)</li></p>

<p><li>Is the amount of data I am storing large enough (and will I be accessing the data frequently enough) to make storage in a file more efficient than storage in the registry? (For example, a spell-checking dictionary used by a word processing application would be better stored in a file.)</li></p>
</ul>

<p>In making these decisions, you end up weighing the pros and cons of file system clutter vs. the inefficiencies of storing large data in the system registry. I will be further discussing efficient use of the system registry in the section &quot;<A HREF="ch05h.htm#86">Using the System Registry Efficiently</A>&quot; later in this chapter.</p>

<p>You can use the <i>RegSetValueEx</i> function to store data to the registry. Here is the prototype for <i>RegSetValueEx</i>:</p>

<p>
<table cellpadding=5 width="95%"><tr><td><pre>
LONG燫egSetValueEx(
牋燞KEY牋爃key,
牋燩CTSTR爌szValueName,
牋燚WORD牋dwReserved,