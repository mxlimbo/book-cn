<HTML>
<HEAD>
<TITLE>Working with Registry Values</TITLE>
<link rel="STYLESHEET" type="text/css" href="prosrvwin.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<A HREF="ch05d.htm">[Previous]</A> <A HREF="ch05f.htm">[Next]</A><P>

<A NAME="82"><h1>Working with Registry Values</h1></A>
<p>Up to this point, I have mostly discussed registry keys, without much mention of how to work with registry values. The registry value is the actual meat and potatoes of the registry. Registry values store the actual configuration data for your applications. Once you have a valid handle to an open registry key, you are ready to retrieve data contained within that key.</p>

<p>Three functions retrieve values from the system registry: <i>RegQueryValueEx</i>, <i>RegEnumValue</i>, and <i>RegQueryMultipleValues</i>. I will focus on <i>RegQueryValueEx</i> and <i>RegEnumValue</i> now. I'll discuss <i>RegQueryMultipleValues</i> shortly, in the section &quot;<A HREF="ch05g.htm#85">Accessing the Registry Remotely</A>.&quot;</p>

<p>You should use the <i>RegEnumValue</i> function when you do not know the name of the value that contains the data you want to retrieve, or when you want to systematically retrieve the data for all values contained within a given key. Conversely, you should use <i>RegQueryValueEx</i> to obtain data from a single value within a key, whose name (or lack of a name, in the case of the default value) is known ahead of time. The <i>RegQueryValueEx</i> function is prototyped as follows:</p>

<p>
<table cellpadding=5 width="95%"><tr><td><pre>
LONG燫egQueryValueEx(
牋燞KEY牋爃key,
牋燩TSTR牋pszValueName,