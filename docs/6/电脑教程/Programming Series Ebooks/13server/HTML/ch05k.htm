<HTML>
<HEAD>
<TITLE>More Registry Functions</TITLE>
<link rel="STYLESHEET" type="text/css" href="prosrvwin.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<A HREF="ch05j.htm">[Previous]</A> <A HREF="ch06a.htm">[Next]</A><P>

<A NAME="90"><h1>More Registry Functions</h1></A>
<p>The designers of Windows 2000 added a registry function known as <i>RegOverridePredefKey</i> that allows your code to map one of the predefined registry keys listed in Table 5-1 to another registry key. The intended purpose of <i>RegOverridePredefKey</i> is to redirect registry changes made by a software component (such as an ActiveX control or a DLL) to a temporary key. This allows your application to easily and safely determine what keys and values must be added to the registry to accommodate the component. If necessary, your application can make changes or adjustments to these keys and values before copying them to their intended location in the registry. <i>RegOverridePredefKey</i> has this prototype:</p>

<p>
<table cellpadding=5 width="95%"><tr><td><pre>
LONG燫egOverridePredefKey(
牋燞KEY爃key
牋燞KEY爃NewKey);
</pre></td></tr></table>
</p>

<p>You should pass one of the predefined registry keys listed in Table 5-1 for the <i>hkey</i> parameter, and you should pass an existing registry key as the <i>hNewKey</i> parameter. Passing NULL as <i>hNewKey</i> causes the predefined key to revert to its default mapping.</p>

<p>Finally, this chapter would not be complete without mention of <i>RegSaveKey</i> and <i>RegRestoreKey</i>. <i>RegSaveKey</i> allows you to copy a registry key and its underlying tree to a file. <i>RegRestoreKey</i> allows you to restore the registry key from a file. The prototypes of these functions are as follows:</p>

<p>
<table cellpadding=5 width="95%"><tr><td><pre>
LONG燫egSaveKey(
牋燞KEY牋牋牋牋牋牋牋牋爃key,
牋燩CTSTR牋牋牋牋牋牋牋爌szFile,
牋燩SECURITY_ATTRIBUTES爌sa);

LONG燫egRestoreKey(
牋燞KEY牋爃key,
牋燩CTSTR爌szFile,
牋燚WORD牋dwFlags);
</pre></td></tr></table>
</p>

<p>Although these functions are somewhat useful in their own right, they are closely related to <i>RegLoadKey</i> and <i>RegUnloadKey</i> and deal with registry hives, which are covered in the Platform SDK documentation.</p>

</body>
</html>



