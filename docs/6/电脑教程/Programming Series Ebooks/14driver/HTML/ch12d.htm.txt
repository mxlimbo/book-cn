<HTML>
<HEAD>
<TITLE>Launching an Application</TITLE>
<link rel="STYLESHEET" type="text/css" href="waltoney.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor="#ffffff" text="#000000">
<p>
<A HREF="ch12c.htm">[Previous]</A> <A HREF="ch12e.htm">[Next]</a>
</p>

<A NAME="421"><H1>Launching an Application</H1></A>

<p>You can enhance the end user experience of your hardware by providing an application that
starts whenever one of your devices exists. Microsoft provides a special-purpose mechanism for
still-image cameras but hasn't provided a general-purpose mechanism that other devices can
use. I'll describe just such a mechanism, named AutoLaunch, in this section.</p>

<A NAME="422"><H2>The AutoLaunch Service</H2></A>

<p>Windows 98 and Windows 2000 both provide for notifications to applications when hardware
events occur. Microsoft Windows 95 introduced the WM_DEVICECHANGE message. As originally
conceived for Windows 95, the system broadcasts this message in user mode to all top-level
windows for each of several possible device events.</p>

<p>Building on WM_DEVICECHANGE, Windows 2000 generates notifications to interested service
applications whenever a device driver enables or disables a registered device interface. I
wrote an AutoLaunch service to take advantage of these notifications. The service subscribes
for notifications about a special interface GUID by calling a new user-mode API named <b>
RegisterDeviceNotification</b>:</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>#include