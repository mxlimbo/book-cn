<HTML>
<HEAD>
<TITLE>The INF File</TITLE>
<link rel="STYLESHEET" type="text/css" href="waltoney.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor="#ffffff" text="#000000">
<p>
<A HREF="ch12a.htm">[Previous]</A> <A HREF="ch12c.htm">[Next]</a>
</p>

<A NAME="402"><H1>The INF File</H1></A>

<p>An INF file contains a collection of <i>sections</i> introduced by a section name in
brackets. Most sections contain a series of directives of the form &quot;keyword = value&quot;.
The INF file begins with a <b>Version</b> section that identifies the type of device described
by entries in the file:</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>[Version]
Signature=$CHICAGO$
Class=Sample
ClassGuid={894A7460-A033-11d2-821E-444553540000}</pre>
</td></tr>
</table>
</p>

<p><b>Signature</b> can be one of the three magic values <b>$Chicago$</b>, <b>$Windows NT$</b> 
(with one space), or <b>$Windows 95$</b> (also with one space). <b>Class</b> identifies the
class of device. Table 12-1 lists the predefined classes that Windows 2000 already supports.
<b>ClassGuid</b> uniquely identifies the device class. The DDK header file DEVGUID.H defines
the globally unique identifiers (GUIDs) for standard device classes, and the DDK documentation
entry for the Version section documents them as well.</p>

<p>In a production INF file, you will also need to have <b>DriverVer</b> and <b>CatalogFile</b> 
statements in the <b>Version</b> section. You should also have a comment (that is, any line
that starts with a semicolon) containing the word &quot;copyright&quot; to satisfy the CHKINF
utility I'll describe in the section &quot;<A HREF="ch12b.htm#417">Tools for INF Files</A>&quot; later in this chapter.
The operating systems will accept INF files that lack these details, but Microsoft won't
certify your driver package without them. Refer to the DDK documentation for more details about
the required INF syntax.</p>

<p>I find it useful to think of the bulk of an INF file as the linear description of a tree
structure. Each section is a node in the tree, and each directive is a pointer to another
section. Figure 12-1 illustrates the concept.</p>

<p>
<A HREF="javascript:fullSize('F12wi01x.htm')"> <img src="images/F12wi01.JPG" width=404 height=261 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 12-1.</b> <i>Tree structure of an INF file.</i><!--/caption-->
</p>


<p><b>Table 12-1.</b> <i>Device classes for INF files.</i></p>

<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th><i>INF Class Name</i></th><th><i>Description</i></th>
</tr>
<tr>
<td valign="top">1394</td><td valign="top">IEEE 1394 host bus controllers (but not peripherals)</td>
</tr>
<tr>
<td valign="top">Battery</td><td valign="top">Battery devices</td>
</tr>
<tr>
<td valign="top">CDROM</td><td valign="top">CD-ROM drives, including SCSI and IDE</td>
</tr>
<tr>
<td valign="top">DiskDrive</td><td valign="top">Hard disk drives</td>
</tr>
<tr>
<td valign="top">Display</td><td valign="top">Video adapters</td>
</tr>
<tr>
<td valign="top">FDC</td><td valign="top">Floppy disk controllers</td>
</tr>
<tr>
<td valign="top">FloppyDisk</td><td valign="top">Floppy disk drives</td>
</tr>
<tr>
<td valign="top">HDC</td><td valign="top">Hard disk controllers</td>
</tr>
<tr>
<td valign="top">HIDClass</td><td valign="top">Human input devices</td>
</tr>
<tr>
<td valign="top">Image</td><td valign="top">Still-image capture devices, including cameras and scanners</td>
</tr>
<tr>
<td valign="top">Infrared</td><td valign="top">NDIS miniport drivers for Serial-IR and Fast-IR ports</td>
</tr>
<tr>
<td valign="top">Keyboard</td><td valign="top">Keyboards</td>
</tr>
<tr>
<td valign="top">MediumChanger</td><td valign="top">SCSI media changer devices</td>
</tr>
<tr>
<td valign="top">Media</td><td valign="top">Multimedia devices, including audio, DVD, joysticks, and full-motion video capture devices</td>
</tr>
<tr>
<td valign="top">Modem</td><td valign="top">Modems</td>
</tr>
<tr>
<td valign="top">Monitor</td><td valign="top">Display monitors</td>
</tr>
<tr>
<td valign="top">Mouse</td><td valign="top">Mouse and other pointing devices</td>
</tr>
<tr>
<td valign="top">MTD</td><td valign="top">Memory technology driver for memory devices</td>
</tr>
<tr>
<td valign="top">Multifunction</td><td valign="top">Combination devices</td>
</tr>
<tr>
<td valign="top">MultiportSerial</td><td valign="top">Intelligent multiport serial cards</td>
</tr>
<tr>
<td valign="top">Net</td><td valign="top">Network adapter cards</td>
</tr>
<tr>
<td valign="top">NetClient</td><td valign="top">Network file system and print providers (client side)</td>
</tr>
<tr>
<td valign="top">NetService</td><td valign="top">Server-side support for network file systems</td>
</tr>
<tr>
<td valign="top">NetTrans</td><td valign="top">Network protocol drivers</td>
</tr>
<tr>
<td valign="top">PCMCIA</td><td valign="top">PCMCIA and CardBus host controllers (but not peripherals)</td>
</tr>
<tr>
<td valign="top">Ports</td><td valign="top">Serial and parallel ports</td>
</tr>
<tr>
<td valign="top">Printer</td><td valign="top">Printers</td>
</tr>
<tr>
<td valign="top">SCSIAdapter</td><td valign="top">SCSI and RAID controllers, host bus adapter miniports, and disk array controllers</td>
</tr>
<tr>
<td valign="top">SmartCardReader</td><td valign="top">Smart card readers</td>
</tr>
<tr>
<td valign="top">System</td><td valign="top">System devices</td>
</tr>
<tr>
<td valign="top">TapeDrive</td><td valign="top">Tape drives</td>
</tr>
<tr>
<td valign="top">USB</td><td valign="top">USB host controllers and hubs (but not peripherals)</td>
</tr>
<tr>
<td valign="top">Volume</td><td valign="top">Logical storage volume drivers</td>
</tr>
</table>
</p>



<p>At the apex of the tree is a <b>Manufacturer</b> section that lists all the companies with
hardware described in the file. For example:</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>[manufacturer]
&quot;Walter燨ney燬oftware&quot;=DeviceList
&quot;Finest燨rganization燨n燛arth燳et&quot;=FOOEY

[DeviceList]
...

[FOOEY]
...</pre>
</td></tr>
</table>
</p>

<p>Each individual manufacturer's <i>model</i> section (DeviceList and FOOEY in the
example) describes one or more devices:</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>[DeviceList]
<i>Description</i>=<i>InstallSectionName</i>,<i>DeviceId</i>
...</pre>
</td></tr>
</table>
</p>

<p>where <b>Description</b> is a human-readable description of the device and <b>DeviceId</b> 
identifies a hardware device. The <b>InstallSectionName</b> parameter identifies (or points to,
in my tree metaphor) another section of the INF file that contains instructions for installing
the software for a particular device. An example of an entry for a single type of device might
be this (drawn from the PKTDMA sample in Chapter 7, &quot;<A HREF="ch07a.htm#226">Reading and Writing Data</A>&quot;):</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>[DeviceList]
&quot;AMCC燬5933燚evelopment燘oard