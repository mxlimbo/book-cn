<HTML>
<HEAD>
<TITLE>WMI Support</TITLE>
<link rel="STYLESHEET" type="text/css" href="waltoney.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor="#ffffff" text="#000000">
<p>
<A HREF="chacf.htm">[Previous]</A> <A HREF="chach.htm">[Next]</a>
</p>

<A NAME="443"><H1>WMI Support</H1></A>

<p>If you've specified that you want to handle IRP_MJ_SYSTEM_CONTROL requests, the wizard
will present the page shown in Figure C-9 to allow you to specify the elements of your custom
WMI schema.</p>

<p>
<A HREF="javascript:fullSize('FCwi09x.htm')"> <img src="images/FCwi09.JPG" width=404 height=325 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure C-9.</b> <i>Page for specifying WMI options.</i><!--/caption-->
</p>


<p>In this page, you should always leave the Use WMILIB option checked because the generated
code won't give you much help in handling WMI requests otherwise. The Block Identifiers
list names the class GUIDs in your custom schema in the order they'll appear in the GUID
list for WMILIB.</p>

<p>Figure C-10 illustrates how you can describe one class in your custom schema. The topmost
(unlabelled) control is the symbolic name of a GUID that the wizard will generate for you
automatically. You can specify the following attributes of this class:</p>

<ul>
<p><li> <b>Number Of Instances</b>&nbsp;&nbsp;Indicates how many instances of the class your driver will
create.</li></p>

<p><li> <b>Expensive</b>&nbsp;&nbsp;Indicates an expensive class that must be specifically enabled.</li></p>

<p><li> <b>Event Only</b>&nbsp;&nbsp;Indicates that the class is used only to fire an event.</li></p>

<p><li> <b>Traced</b>&nbsp;&nbsp;Corresponds to a WMI option that I don't currently understand. But if I
ever do understand it, I'll be able to use this check box to influence its state.</li></p>
</ul>


<p>You can choose between PDO-based instance naming or instance naming using a base name.
Microsoft recommends you use PDO-based naming.</p>

<p>
<img src="images/FCwi10.JPG" width=398 height=358 border="0">
</p><p>
<!--caption--><b>Figure C-10.</b> <i>Dialog box for specifying a WMI class.</i><!--/caption-->
</p>


</BODY>
</HTML>





