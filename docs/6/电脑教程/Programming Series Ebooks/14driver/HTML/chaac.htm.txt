<HTML>
<HEAD>
<TITLE>Determining the Operating System Version</TITLE>
<link rel="STYLESHEET" type="text/css" href="waltoney.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor="#ffffff" text="#000000">
<p>
<A HREF="chaab.htm">[Previous]</A> <A HREF="chaba.htm">[Next]</a>
</p>

<A NAME="435"><H1>Determining the Operating System Version</H1></A>

<p>Once you've managed to get your device driver loaded&#8212;a feat that might require, as
I've just discussed, arranging to define Windows 98 stubs for certain support
routines&#8212;you may need to base run-time decisions on which version of the operating system
happens to be in charge of the computer. You might want, for example, to call functions that
aren't, strictly speaking, part of the WDM. <b>IoReportTargetDeviceChangeAsynchronous</b>,
which I used in the PNPEVENT sample, is such a function.</p>

<p>It's very easy for an application to learn the operation system platform by calling <b>GetVersionEx</b>. The closest equivalent function in kernel mode is <b>IoIsWdmVersionAvailable</b>:</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>BOOLEAN IoIsWdmVersionAvailable(MajorVersion, MinorVersion);</pre>
</td></tr>
</table>
</p>

<p>Windows 2000 supports WDM version 1.10, which corresponds to the WDM_MAJORVERSION (1) and WDM_MINORVERSION (10) constants in the file WDM.H. Windows