<HTML>
<head>
<link rel="STYLESHEET" type="text/css" href="Progie5.css">
<TITLE>Controlling Internet Explorer by Using a BHO</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch12d.htm">[Previous]</A> <A HREF="ch12f.htm">[Next]</A><P>

<A NAME="282"><H1>Controlling Internet Explorer by Using a BHO</H1></A>

<p>In addition to using a BHO to receive events from Internet Explorer, you can use 
a BHO to control Internet Explorer's behavior. By using the pointer to the 
<I>IWebBrowser2</I> interface that you saved in the 
<I>SetSite </I>method, you can call any of 
<I>IWebBrowser2</I>'s methods, including 
<I>Navigate</I>, <I>GoBack</I>, and 
<I>GoForward</I>, to name a few.</p>

<p>IEHelper demonstrates how to control Internet Explorer by providing 
navigation buttons. When you enter a URL into the Address edit box and click the 
Navigate button, IEHelper calls the 
<I>Navigate</I> method of <I>IWebBrowser2</I>, as shown here:</p>

<p><table cellpadding=5 width="95%"><TR><TD>
<PRE>void CIEHlprObj::Navigate(LPTSTR szURL)
{
   CComBSTR bstrURL(szURL);
   CComVariant vtEmpty;

   m_spWebBrowser2-&gt;Navigate(bstrURL, &amp;vtEmpty, &amp;vtEmpty,
                             &amp;vtEmpty, &amp;vtEmpty);
}
</PRE>
</td></tr></table></p>

<p>You can also click the Go Back and Go Forward buttons to navigate 
backward and forward in the history list. When you click one of the two buttons, IEHelper 
calls either the <I>GoBack</I> method or the 
<I>GoForward</I> method of the <I>IWebBrowser2</I> 
interface, as shown here:</p>

<p><table cellpadding=5 width="95%"><TR><TD>
<PRE>void CIEHlprObj::GoBack()
{
   m_spWebBrowser2-&gt;GoBack();
}

void CIEHlprObj::GoForward()
{
   m_spWebBrowser2-&gt;GoForward();
}
</PRE>
</td></tr></table></p>

<p>By now, this code should be pretty familiar to you. If you have further 
questions about it, refer to <A HREF="ch06a.htm">Chapter 6</A>.</p>

</BODY>
</HTML>





