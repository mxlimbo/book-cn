<HTML>
<head>
<link rel="STYLESHEET" type="text/css" href="Progie5.css">
<TITLE>WBCustomizer Object</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch09c.htm">[Previous]</A> <A HREF="ch09e.htm">[Next]</A><P>

<A NAME="223"><H1><I>WBCustomizer</I> Object</H1></A>
<p>When I was with the Internet Client Development group of Microsoft 
Developer Support, I discovered that a lot of developers who were creating Visual Basic 
applications that host the WebBrowser control wanted to disable context menus and 
specific accelerator keys. As you know, you can do this by using two methods 
of <I>IDocHostUIHandler</I>: <I>ShowContextMenu 
</I>and <I>TranslateAccelerator</I>. But you can't 
implement <I>IDocHostUIHandler</I> in Visual Basic.</p>

<p>That's why I created <I>WBCustomizer</I>, a COM object created by using ATL. 
It implements <I>IDocHostUIHandler </I>for use in Visual Basic applications and allows 
you to enable or disable context menus, all accelerators, or only specific ones.</p>

<p><div class="sidebar"><blockquote>
<p><b>Where to Get the <I>WBCustomizer </I>Object</b></p>
<p>You can get the<I> WBCustomizer</I> object<I> </I>from the companion CD and many 
other sources as well, such as the Microsoft Visual Basic Web Site at 
<I><a href="http://msdn.microsoft.com/vbasic" target="_window2">http://msdn.microsoft.com/vbasic</a></I>, and Knowledge Base article number 
Q183235, which you can access at <I><a href="http://support.microsoft.com/support/kb/articles/q183/2/35.asp" target="_window2">http://support.microsoft.com/support/kb/articles/q183/2/35.asp</a></I>. The Knowledge Base article includes source code for 
the <I>WBCustomizer</I> COM object, the COM object compiled in release mode 
with minimum dependencies, and a Visual Basic example that demonstrates how 
to use <I>WBCustomizer</I>.</p>
<p>To compile both examples discussed in this Knowledge Base article, 
you must install headers and libraries for Internet Explorer 5, as I explained in 
earlier chapters, and you must place the headers and libraries in the correct 
order as specified in <A HREF="ch06a.htm">Chapter 6</A>.</p>
</blockquote></div>
</p>

<p>Let's look at how <I>WBCustomizer</I> works and how to use it in Visual 
Basic applications. (You can also use <I>WBCustomizer 
</I>as an example<I> </I>if you want to implement the functionality of controlling user interface features in your own COM 
objects or applications.) <I>WBCustomizer</I> exposes three properties: 
<I>WebBrowser</I>, <I>EnableContextMenus</I>, and 
<I>EnableAllAccelerators</I>. 
<I>EnableAccelerator</I> is its only method.</p>

<p>The <I>WebBrowser</I> property is crucial. It must be set so that the 
<I>WBCustomizer</I> object can connect its implementation of 
<I>IDocHostUIHandler</I> to the WebBrowser control you are hosting.</p>

<p>The <I>EnableContextMenus</I> and 
<I>EnableAllAccelerators</I> properties do just 
what they say: they enable or disable context menus and all accelerators, respectively.</p>

<p>The <I>EnableAccelerator </I>method allows you to enable or disable specific 
accelerator keys. It takes the key code of the accelerator key, the extended key code 
for Ctrl, Alt, or Shift, and the state of the key. The state of the accelerator key is 
<I>True</I> or <I>False</I> depending on whether you want to enable or disable it.</p>

<p>To use <I>WBCustomizer</I> in a Visual Basic application, follow these steps:</p>
<OL>
<p><li> Register WBCustomizer.dll on your system by using Regsvr32, as follows:</li></p>

<p><table cellpadding=5 width="95%"><TR><TD>
<PRE>regsvr32 WBCustomizer.dll
</PRE>
</td></tr></table></p>

<p><li> Set a reference to Microsoft WebBrowser Customizer Sample Object in 
your Visual Basic application.</li></p>
<p><li> Declare a variable of type 
<I>WBCustomizer</I>, as follows:</li></p>

<p><table cellpadding=5 width="95%"><TR><TD>
<PRE>Dim CustomWB As WBCustomizer
</PRE>
</td></tr></table></p>

<p><li> In the <I>Form_Load</I> event handler, create a new instance of the 
<I>WBCustomizer</I> object, as follows:</li></p>


<p><table cellpadding=5 width="95%"><TR><TD>
<PRE>Set CustomWB = New WBCustomizer
</PRE>
</td></tr></table></p>

<p><li> To do its work, 
<I>WBCustomizer</I> needs a reference to the 
WebBrowser control that is on the form. Set this reference by using the 
<I>WebBrowser</I> property of <I>WBCustomizer</I>, as follows:</li></p>

<p><table cellpadding=5 width="95%"><TR><TD>
<PRE>Set WBCustomizer.WebBrowser = WebBrowser1
</PRE>
</td></tr></table></p>

<p><li> Turn context menus on or off by setting the 
<I>EnableContextMenus</I> property to <I>True</I> or 
<I>False</I>. A value of <I>True</I> turns context menus on. 
<I>False</I> turns them off.</li></p>
<p><li> Turn all accelerator keys on or off by setting the 
<I>EnableAllAccelerators</I> property to 
<I>True</I> or <I>False</I>. A value of 
<I>True</I> turns on all accelerators. A value of 
<I>False</I> turns them all off. Only those accelerators that require Ctrl, 
Shift, or Alt key combinations will be turned off. Those that don't require one 
of these keys, such as Tab, F1, and so forth, must be turned off 
manually, as described in step 8.</li></p>
<p><li> Turn specific accelerator keys on or off by using the 
<I>EnableAccelerator </I>method. The following parameters apply to this method:</li></p>
<ul>
<p><li> <I>nKeyCode.</I> The key code constant that specifies an accelerator 
key (<I>vbKeyTab</I>, <I>vbKeyN</I>, <I>vbKeyO</I>, and so on).</li></p>
<p><li> <I>nVirtExtKey.</I> The virtual key code of an extended key, such 
as <I>vbKeyControl</I>, <I>vbKeyAlt</I>, or 
<I>vbKeyShift</I>. This parameter is optional and has a default value of 
<I>0</I>.</li></p>
<p><li> <I>bState.</I> The state of the accelerator key. 
<I>True</I> turns the accelerator key on, and 
<I>False</I> turns it off. This parameter has a default value of 
<I>True</I>.</li></p>
</ul>
</ol>

<p>VBCustomWB is a Visual Basic sample application that uses 
<I>WBCustomizer</I>. Figure 9-2 shows this application in action. As you can see, 
VBCustomWB<I> </I>has check boxes that you can use to enable or disable the context menus and accelerators. 
You can easily customize this application to fit your own needs.</p>

<p>
<A HREF="javascript:fullSize('F09II02x.htm')"> <img src="images/F09II02.JPG" width=404 height=351 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><B>Figure 9-2.</B> <I>VBCustomWB</I>.<!-- /caption -->
</p>

</BODY>
</HTML>





