<html>
<head>
<TITLE>Microsoft OLE DB Remoting Provider</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="ch16f.htm">[Previous]</A> <A HREF="ch16h.htm">[Next]</A><P>

<A NAME="438"><H1>Microsoft OLE DB Remoting Provider</H1></A>

<p>There's another way you can execute remote queries using the RDS
technology&#8212;by using the Microsoft OLE DB Remoting Provider, known
as MS Remote. Instead of using a DataControl object or a DataSpace
object and a DataFactory object to retrieve a Recordset, you can use
the ADO Connection object and a connection string that references the
MS Remote provider. You can supply a connection string and a query
string to the MS Remote provider as shown here:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strConn = &quot;Provider=MS Remote;Remote Server=http://scep;&quot; &amp; _
          &quot;Remote Provider=SQLOLEDB;Data Source=Gilliam;&quot; &amp; _
          &quot;Initial Catalog=Northwind;User ID=sa;Password=;&quot;
Set cnNorthwind = New ADODB.Connection
cnNorthwind.Open strConn

strSQL = &quot;SELECT * FROM Customers&quot;
Set rsCustomers = New ADODB.Recordset
rsCustomers.Open strSQL, cnNorthwind, adOpenStatic, _
                 adLockBatchOptimistic, adCmdText
</pre>
</td></tr></table>
</p>

<p>Notice that the connection string is similar to the connection
string you'd use with straight ADO while running on the local
network. MS Remote is now your provider, and the provider you want to
use to connect to your database is now the Remote Provider. (This is
similar to what happens when you use the MSDataShape provider and call
it the Data Provider.) Specify the IIS server and protocol you want to
use in the Remote Server argument. You can also use an Internet Timeout
argument to specify a value that you'd otherwise use in the
InternetTimeout property of the RDS DataControl or DataSpace
object.</p>

<p>If you want to use the MS Remote provider with a handler, you can use
code such as the following. Note that you substitute a connection
string and query string as specified in the handler's settings:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strConn = &quot;Provider=MS Remote;Remote Server=http://scep;&quot; &amp; _
          &quot;Handler=MSDFMap.Handler;Data Source=CustomerDatabase;&quot;
Set cnNorthwind = New ADODB.Connection
cnNorthwind.Open strConn

strSQL = &quot;GetAllCustomers&quot;
Set rsCustomers = New ADODB.Recordset
rsCustomers.Open strSQL, cnNorthwind, adOpenStatic, _
                 adLockBatchOptimistic, adCmdText
</pre>
</td></tr></table>
</p>

<p>I'll admit that, initially, I preferred using the DataControl
and DataFactory objects. But the more I used the MS Remote provider,
the more it felt like a logical extension of ADO to the Internet.</p>

</BODY>
</HTML>






