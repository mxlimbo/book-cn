<html>
<head>
<TITLE>JRO</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="chaab.htm">[Previous]</A> <A HREF="chaad.htm">[Next]</A><P>

<A NAME="454"><H1>JRO</H1></A>

<p>JRO includes Jet database replication features and provides the
ability to compact Jet databases and refresh the data in the Jet
engine's cache. The JRO object model includes three main objects:
the JetEngine object, the Replica object, and the Filter object. First
I'll cover the JetEngine object, and later in this appendix
I'll discuss the Replica object. Version 2.5 of the JRO objects can
be accessed in Visual Basic by selecting Microsoft Jet And Replication
Objects 2.5 Library in the References dialog box.</p>

<A NAME="455"><H2>JetEngine Object</H2></A>

<p>The JRO JetEngine object exposes two
methods&#8212;<i>CompactDatabase</i> and <i>RefreshCache</i>&#8212;that
provide the ADO and Jet programmer with features previously available
only through the DAO DBEngine object. Let's take a brief look at
each of these methods.</p>

<A NAME="456"><h3><i>CompactDatabase</i> method</h3></A>
<p>When you delete a row in an Access table, that row is
&quot;lost&quot;&#8212;in other words, you can no longer view the row.
However, that data is not removed from the physical database file. As a
result, continued use of an Access database causes the file to
grow.</p>

<p>Access has the ability to &quot;compact&quot; a database. When you
compact a database, you recover its lost space. The Jet engine
essentially copies the database's structure and the contents of its
tables into a new copy of the database. The engine does not copy
deleted rows. Thus, the new copy of the database is smaller than the
original copy that contained deleted rows.</p>

<p>The <i>CompactDatabase</i> method also allows you to control attributes
of the new database, including its format (Access 2000, Access 97, and
so on), database password, and locale. For more information on each of
these options, see the documentation on the <i>CompactDatabase</i>
method in the Jet and Replication Objects portion of the Platform
SDK.</p>

<p>Here's an example that uses <i>CompactDatabase</i> to compact a
database:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strConnOriginal