<html>
<head>
<title>Questions That Should Be Asked More Frequently</title>
<LINK REL=STYLESHEET HREF="progado.css" TYPE="text/css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor="#ffffff" text="#000000">
<A HREF="ch10f.htm">[Previous]</A> <A HREF="ch11a.htm">[Next]</A><P>

<A NAME="316"><H1>Questions That Should Be Asked More Frequently</H1></A>

<p><b>Q. <i>What if I don't include the key
field or fields for my table in my initial query? Will I still be able
to update my database with the Recordset object?</i></b></p>

<p>A.  Short answer: Don't do this. (Why would you ever do
this? Bad programmer!) Include the key field or fields in your
query.</p>

<p>Long answer: I have to admit, I've done some testing of this
scenario because I was curious and I've had people ask about it
before. In my tests, I watched a trace of the action queries passed by
ADO to my SQL Server database through SQL Server Profiler. It turns out
that ADO included primary key values in the action queries, even though
I didn't include the primary key field in my query. However, that
field didn't show up in the trace as being part of the query. What
happened?</p>
<p>
The SQL Server OLE DB provider (and ODBC driver) returned this data in
a hidden field. I discovered this by checking the Recordset's
Hidden Columns dynamic property. Sure enough, it was set to 1. Needless
to say, I was impressed. This functionality seems similar to the
Microsoft OLE DB Provider For Oracle having the sense to retrieve row
ID data to facilitate updating. But don't rely on this
functionality.</p>

<p>Why ask ADO, the OLE DB provider, or the ODBC driver to do all this
work when you could simply include the key field or fields in your
query? Don't be lazy. Besides, not all providers and drivers
retrieve this data. When I ran this test with the Jet OLE DB Provider,
it didn't retrieve the key field or fields, but it still allowed me
to update my database. How? From some painful testing, I deduced that
it simply used data from all the fields in the Recordset to form some
sort of mock key.</p>

<p>In short, if you don't include the key field or fields in your
query, you might still be able to update your database, but how
that's accomplished depends on your OLE DB provider or ODBC
driver&#8212;then again, you really shouldn't be doing this in the
first place. Instead, just say no.</p>

<p><b>Q. <i>What happens if I don't have a
live connection to my database and I call</i> Update <i>or</i>
UpdateBatch?</b></p>

<p><b>A.</b>  The ADO Cursor Engine assumes you have good reason to do
this and pretends it successfully updated your database. There might be
times when you want to make use of this particular behavior. Just be
sure to keep this behavior in mind if you disconnect your Recordset
from your database. If you call the <i>UpdateBatch</i> method while
your Recordset is disconnected, those changes will no longer be marked
as pending. When you reconnect the Recordset, those changes will not be
transmitted to your database.</p>

<p><b>Q. <i>I'm having problems with my
joins. With some back-end databases, I can't tell what table a
particular field references because both tables in my join contain that
same field name. What should I do, and why does this problem occur only
with particular back-end databases?</i></b></p>

<p><b>A.</b>  ADO simply uses the field names that the OLE DB provider or
ODBC driver returns. If the OLE DB provider or ODBC driver doesn't
return the field names the way you want, try using aliases in the query
string so that you can tell the fields apart in the Recordset
object.</p>
</BODY>
</html>







