<html>
<head>
<TITLE>How MSDataShape Stores Data and Maintains Hierarchies</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="ch14c.htm">[Previous]</A> <A HREF="ch14e.htm">[Next]</A><P>

<A NAME="368"><H1>How MSDataShape Stores Data and Maintains Hierarchies</H1></A>

<p>There are two main types of hierarchies: standard and parameterized.
While they can use similar queries to retrieve the same data, they
differ in how and when they retrieve that data. In this section,
we'll take a look at both types of hierarchies.</p>

<A NAME="369"><H2>Standard Hierarchies</H2></A>

<p>The example discussed in the previous section is a standard
hierarchy. The data shape provider parses the query string and passes
each separate query contained in that string to the data provider.</p>

<p>ADO maintains the results of each query (in the case of our example,
the customers query and the orders query) separately, in structures
similar to Recordset objects. When you request the contents of the
Orders field in the customers Recordset, ADO applies a filter to the
results of the query on the Orders table, which is the data you
see.</p>

<p>Many features available through the data shape provider make the
query string and the resulting Recordset complex. We'll still
categorize those complex hierarchies as standard hierarchies to reflect
how the data is stored and maintained. In short, any hierarchy that
isn't parameterized&#8212;a capability we'll cover
momentarily&#8212;is considered standard.</p>

<A NAME="370"><H2>Parameterized Hierarchies</H2></A>

<p>A parameterized hierarchy is more than a hierarchical query that
uses parameters. With a standard hierarchy, the data shape provider
submits one query per level of the hierarchy to the OLE DB provider
that communicates with the database. Parameterized hierarchies work
differently and use a slightly different syntax. A query string similar
to the string discussed in &quot;<A HREF="ch14c.htm#366">Parsing a Hierarchical Query String</A>,&quot; but using a parameterized
hierarchy, looks like this:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strSQL