<html>
<head>
<TITLE>Update Resync to the Rescue!</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="ch11b.htm">[Previous]</A> <A HREF="ch11d.htm">[Next]</A><P>

<A NAME="322"><H1>Update Resync to the Rescue!</H1></A>

<p>ADO 2.1 introduced a dynamic property to the Recordset object called
Update Resync, which is used with client-side Recordsets to aid
developers who encounter scenarios such as those just described.
Depending on the value that you specify for this property, ADO executes
queries to refetch the record that you just updated (or attempted to
update) in the database.</p>

<p>If you're using optimistic updating mode, ADO issues these
queries when you call the <i>Update</i> method on the Recordset,
immediately after the ADO Cursor Engine issues the action query. If
you're using batch optimistic updating mode, ADO issues these
queries when you call <i>UpdateBatch</i>. The Update Resync property
can contain values from the CEResyncEnum data type, shown in the
following table:</p>

<p>
<table valign="top" cellpadding="5" width="95%">

<tr>
<th colspan="3">CEResyncEnum Values</th>
</tr>

<tr>
<th><i>Constant </i></th><th><i>Value</i></th> <th><i>Description</i></th>
</tr>

<tr>
<td valign="top">adResyncNone </td><td valign="top">0</td> <td valign="top">Retrieves no data after modifications</td>

</tr>

<tr>
<td valign="top">adResyncAutoIncrement</td><td valign="top"> 1 </td><td valign="top">Default; retrieves auto-incrementing value
for new records</td>
</tr>

<tr>
<td valign="top">adResyncConflicts</td> <td valign="top">2</td> <td valign="top">Retrieves underlying values for records whose
updates fail because of optimistic updating
conflicts</td>
</tr>

<tr>
<td valign="top">adResyncUpdates </td><td valign="top">4 </td><td valign="top">Retrieves the current contents of records after
their updates have been submitted to the database</td>
</tr>

<tr>
<td valign="top">adResyncInserts </td><td valign="top">8</td> <td valign="top">Retrieves the current contents of new records
after they have been submitted to the database</td>
</tr>

<tr>
<td valign="top">adResyncAll </td><td valign="top">15</td> <td valign="top">Performs actions associated with
adResyncAutoIncrement, adResyncConflicts, adResyncUpdates, and
adResyncInserts</td>

</tr>
</table>
</p>
<p>To access this property, you must set the CursorLocation property to
adUseClient on either the Recordset object or the Connection object
prior to opening the Recordset, as shown, respectively, in the
following code:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
With爎sCustomers
牋牋.CursorLocation