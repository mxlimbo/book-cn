<html>
<head>
<TITLE>ADO Recordset Object Properties and Collections</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="ch04a.htm">[Previous]</A> <A HREF="ch04c.htm">[Next]</A><P>

<A NAME="77"><H1>ADO Recordset Object Properties and Collections</H1></A>

<p>Let's take a look at each of the different properties available
on the Recordset object and listed in the following table.</p>

<p>
<table cellpadding=5 width="95%">
<tr>
<th colspan="3">Recordset Object Properties and Collections</th></tr>
<tr>
<th><i>Property or Collection Name</i> </th>
<th><i>Data Type</i>  </th>
<th><i>Description </i> </th></tr>
<tr>
<td valign="top">AbsolutePage  </td>
<td valign="top">Long  </td>
<td valign="top">Identifies the page the current record of the
 Recordset is on  </td></tr>
<tr>
<td valign="top">AbsolutePosition  </td>
<td valign="top">Long  </td>
<td valign="top">Identifies the position of the current record
in the Recordset  </td></tr>
<tr>
<td valign="top">ActiveCommand   </td>
<td valign="top">Variant  </td>
<td valign="top">Pointer to the Command object that created
the  Recordset object  </td></tr>
<tr>
<td valign="top">ActiveConnection  </td>
<td valign="top">String or Connection </td>
<td valign="top">Specifies the Connection object used to
retrieve the results of your query  </td></tr>
<tr>
<td valign="top">BOF  </td>
<td valign="top">Boolean   </td>
<td valign="top">Indicates whether you're currently at beginning  of file (BOF), the position before the first record  in your Recordset  </td></tr>
<tr>
<td valign="top">Bookmark  </td>
<td valign="top">Variant  </td>
<td valign="top">Allows you to return to a particular record in
the Recordset  </td></tr>
<tr>
<td valign="top">CacheSize  </td>
<td valign="top">Long   </td>
<td valign="top">Specifies the number of records that ADO will
 cache from the server  </td></tr>
<tr>
<td valign="top">CursorLocation  </td>
<td valign="top">Long   </td>
<td valign="top">Specifies the location of the cursor service (either client-side or server-side) that will maintain the  results of your query  </td></tr>
<tr>
<td valign="top">CursorType  </td>
<td valign="top">CursorTypeEnum  </td>
<td valign="top">Specifies the type of cursor used to access the  results of your query  </td></tr>
<tr>
<td valign="top">DataMember  </td>
<td valign="top">String  </td>
<td valign="top">Controls which Recordset in the data source you're binding to  </td></tr>
<tr>
<td valign="top">DataSource  </td>
<td valign="top">Object  </td>
<td valign="top">Allows you to bind the Recordset to a data
source </td></tr>
<tr>
<td valign="top">EditMode  </td>
<td valign="top">EditModeEnum  </td>
<td valign="top">Specifies the editing status for the current
record in the Recordset  </td></tr>
<tr>
<td valign="top">EOF  </td>
<td valign="top">Boolean   </td>
<td valign="top">Indicates whether you're currently at end of
file  (EOF), the position following the last record in  your Recordset  </td></tr>
<tr>
<td valign="top">Fields  </td>
<td valign="top">Collection of Field objects  </td>
<td valign="top">Pointer to the collection of Field objects that
contain the results of your query  </td></tr>
<tr>
<td valign="top">Filter  </td>
<td valign="top">Variant  </td>
<td valign="top">Allows you to filter your Recordset for
particular  records  </td></tr>
<tr>
<td valign="top">Index  </td>
<td valign="top">String  </td>
<td valign="top">Controls the index currently in effect for a  Record-set object  </td></tr>
<tr>
<td valign="top">LockType   </td>
<td valign="top">LockTypeEnum  </td>
<td valign="top">Specifies how the contents of your Recordset
can  be locked and updated  </td></tr>
<tr>
<td valign="top">MarshalOptions  </td>
<td valign="top">Long  </td>
<td valign="top">Controls which records are included in your  Recordset when it is passed across a process  boundary  </td></tr>
<tr>
<td valign="top">MaxRecords  </td>
<td valign="top">Long  </td>
<td valign="top">Specifies the maximum number of records to be  returned by your query  </td></tr>
<tr>
<td valign="top">PageCount  </td>
<td valign="top">Long   </td>
<td valign="top">Returns the number of pages in your Recordset  </td></tr>
<tr>
<td valign="top">PageSize   </td>
<td valign="top">Long   </td>
<td valign="top">Specifies the number of records per page in your  Recordset  </td></tr>
<tr>
<td valign="top">Properties  </td>
<td valign="top">Collection of Property objects </td>
<td valign="top">Collection of dynamic properties  </td></tr>
<tr>
<td valign="top">RecordCount  </td>
<td valign="top">Long  </td>
<td valign="top">Returns the number of records in the Recordset  </td></tr>
<tr>
<td valign="top">Sort  </td>
<td valign="top">String  </td>
<td valign="top">Allows you to reorder the data in your Recordset  </td></tr>
<tr>
<td valign="top">Source  </td>
<td valign="top">String or Command </td>
<td valign="top">Contains the query string used to build the   Recordset  </td></tr>
<tr>
<td valign="top">State   </td>
<td valign="top">Long  </td>
<td valign="top">Specifies the current state of the Recordset  </td></tr>
<tr>
<td valign="top">Status  </td>
<td valign="top">RecordStatusEnum  </td>
<td valign="top">Returns the update status of the current
record  </td></tr>
<tr>
<td valign="top">StayInSync  </td>
<td valign="top">Boolean  </td>
<td valign="top">Controls whether references to child Recordsets will be kept in sync as you navigate through the  parent Recordset  </td></tr>
</table></p>


<A NAME="78"><H2>AbsolutePage, PageCount, and PageSize Properties</H2></A>

<p>The PageSize property specifies the number of records per page in
your Recordset. If you have a Recordset with 81 records and the
PageSize property is set to 10 (its default value), the Recordset will
have nine pages&#8212;the first eight pages containing 10 records each
and the last page containing only one record. You can change the value
of the PageSize property at any time. If the Recordset is currently
open, the PageCount and AbsolutePage properties will be updated
automatically.</p>

<p>The PageCount property is read-only and reflects the number of pages
in the Recordset. If the Recordset does not support pages or bookmarks,
this property will return -1.</p>

<p>The AbsolutePage property returns a long value. AbsolutePage will
return the page number of the current record and is 1-based. You can
use this property only if it's supported by the provider and if
your record pointer is currently at a valid record. If your record
pointer is not pointing to a valid record, AbsolutePage will contain a
value in the form of a PositionEnum value constant. (See the following
table.) If your record pointer is currently at BOF or EOF, the
AbsolutePage property will return adPosBOF or adPosEOF, respectively.
AbsolutePage will return adPosUnknown if the Recordset's current
record is neither BOF nor EOF and the Recordset doesn't support
bookmarks, or if the Recordset is empty.</p>

<p>If the Recordset supports bookmarks, you can set the AbsolutePage
property to a long value, between 1 and PageCount, while the Recordset
is open. You cannot set the AbsolutePage property to adPosBOF or
adPosEOF. If you set the AbsolutePage property, ADO will move the
current record pointer to the first record on that page.</p>

<p>
<table cellpadding=5 width="95%">
<tr> 
<th colspan="3">PositionEnum Values  </th></tr>
<tr>
<th><i>Constant</i>   </th>
<th><i>Value</i>  </th>
<th> <i>Description</i> </th></tr>
<tr>
<td valign="top">adPosUnknown  </td>
<td valign="top">-1   </td>
<td valign="top">The Recordset contains no data, the current position
is unknown, or the property isn't supported for the current
CursorType or provider.  </td></tr>
<tr>
<td valign="top">adPosBOF  </td>
<td valign="top">-2   </td>
<td valign="top">The Recordset is at BOF, just before the first
record.  </td></tr>
<tr>
<td valign="top">adPosEOF  </td>
<td valign="top">-3   </td>
<td valign="top">The Recordset is at EOF, just after the last record.  </td></tr>
</table></p>


<p>As of ADO 2.1, the AbsolutePage property is supported for
client-side Recordsets for all providers, and for server-side static
and keyset Recordsets by means of the Microsoft OLE DB Provider For SQL
Server and the Microsoft Jet 4.0 OLE DB Provider.</p>

<p>You can determine whether the Recordsets for your choice of OLE DB
provider, cursor location, and cursor type will support the
AbsolutePage property by using the <i>Recordset.Supports</i> method
with the adApproxPosition constant.</p>

<A NAME="79"><H2>AbsolutePosition Property</H2></A>

<p>The AbsolutePosition property is similar to the AbsolutePage
property, except that it refers to the record number within the
Recordset rather than the page number. If your Recordset is at BOF or
EOF, AbsolutePosition will return adPosBOF or adPosEOF, respectively.
If the provider supports this property and your current record pointer
is pointing to a record in the Recordset (neither BOF nor EOF),
AbsolutePosition will return a number between 1 and the number of
records in the Recordset.</p>

<p>For a Recordset that contains data and supports bookmarks, you can
set this property to any number between 1 and the number of records in
the Recordset to move to that specific record. You cannot set this
property to adPosBOF or adPosEOF to move to BOF or EOF,
respectively.</p>

<p>As of ADO 2.1, this property is supported for client-side Recordsets
for all providers, and for server-side static and keyset Recordsets by
means of the OLE DB Provider For SQL Server and the Jet 4.0 OLE DB
Provider.</p>

<A NAME="80"><H2>ActiveCommand Property</H2></A>

<p>The ActiveCommand property contains the Command object that created
the Recordset object. This property is read-only and is available even
after the Recordset object has been closed.</p>

<A NAME="81"><H2>ActiveConnection Property</H2></A>

<p>For an open Recordset object, the ActiveConnection property is set
to the Connection object used to retrieve your data. The property will
not change once the Recordset object is closed. If your Recordset
object was opened from a file, returned from another process, or
created by populating the Fields collection yourself, this property
will return Nothing, the default.</p>

<p>You can set the ActiveConnection property either to a connection
string or to a Connection object while the Recordset is closed. You can
also modify this property while the Recordset object is open, but only
if you're using a client-side Recordset.</p>

<p>If you assign a connection string to the ActiveConnection property,
ADO will create a new Connection object and attempt to connect to your
database based on this string.</p>

<p>If you're using a client-side Recordset, you can set the
ActiveConnection property to Nothing after opening the Recordset in
order to disconnect the Recordset from your database. Once you've
done that, the Recordset object will still contain the results of your
query even after you close the Connection object.</p>

<A NAME="82"><H2>BOF and EOF Properties</H2></A>

<p>When you open a Recordset, you might want to programmatically loop
through the records until you've reached the end of the Recordset.
The BOF and EOF properties allow you to do this by letting you know
when you've reached the beginning or end of the Recordset. Before
the first true record in the Recordset, there is a placeholder that
designates the beginning of the Recordset. Similarly, another
placeholder designates the position following the last record in the
Recordset. For example, you could use the following code to loop
through the results of your query:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
Dim爏trSQL燗s燬tring
Dim爎sCustomers燗s燗DODB.Recordset
<img src="images/grayvellip.JPG" width=3 height=13 border="0">
'Specify爐he爍uery爏tring.
strSQL