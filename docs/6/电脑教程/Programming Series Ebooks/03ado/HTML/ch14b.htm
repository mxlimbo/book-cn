<html>
<head>
<TITLE>Using the Data Shape Provider</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="ch14a.htm">[Previous]</A> <A HREF="ch14c.htm">[Next]</A><P>

<A NAME="364"><H1>Using the Data Shape Provider</H1></A>

<p>Microsoft Data Access Components (MDAC) includes a number of OLE DB
providers that are considered &quot;service providers.&quot; Rather
than communicating directly with a database, you utilize the services
of these providers. One prime example of such a service provider is the
OLE DB provider for data shaping&#8212;often referred to as MSDataShape.
In this text, I'll also refer to the provider as the &quot;data
shape provider.&quot;</p>

<p>The features described throughout this chapter require the use of
the MSDataShape provider. To use the functionality exposed by this
provider, you have to reference the provider when you connect to your
database. Luckily, referencing this provider requires only a small
change in your connection string. If your normal connection string
was</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strConn = &quot;Provider=SQLOLEDB;Data Source=ScepHome;&quot; &amp; _
          &quot;Initial Catalog=Northwind;&quot;
</pre>
</td></tr></table>
</p>

<p>you would change it to</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strConn = &quot;Provider=MSDataShape;Data Provider=SQLOLEDB;&quot; &amp; _
          &quot;Data Source=ScepHome;Initial Catalog=Northwind;&quot;
</pre>
</td></tr></table>
</p>

<p>to use the MSDataShape provider. Simply put, what you normally used
as your provider is now the &quot;data provider&quot;&#8212;the OLE DB
provider that MSDataShape will use to communicate with your
database.</p>

<p>If you use properties exposed by the Connection object to connect to
your database rather than using a connection string to do so, the
Connection object will expose a Data Provider property in its dynamic
Properties collection after you set the Provider property to
MSDataShape. Thus, instead of connecting with code such as</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
cnNorthwind.Provider = &quot;SQLOLEDB&quot;
cnNorthwind.Properties(&quot;Data Source&quot;) = &quot;ScepHome&quot;
cnNorthwind.Properties(&quot;Initial Catalog&quot;) = &quot;Northwind&quot;
</pre>
</td></tr></table>
</p>

<p>you would use code such as</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
cnNorthwind.Provider = &quot;MSDataShape&quot;
cnNorthwind.Properties(&quot;Data Provider&quot;) = &quot;SQLOLEDB&quot;
cnNorthwind.Properties(&quot;Data Source&quot;) = &quot;ScepHome&quot;
cnNorthwind.Properties(&quot;Initial Catalog&quot;) = &quot;Northwind&quot;
</pre>
</td></tr></table>
</p>

<p>Once you've connected to your database using the MSDataShape
provider, you can continue to run your standard nonhierarchical queries
as you normally would.</p>

</BODY>
</HTML>






