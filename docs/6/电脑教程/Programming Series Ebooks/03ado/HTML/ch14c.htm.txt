<html>
<head>
<TITLE>How the Data Shape Provider Works</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="ch14b.htm">[Previous]</A> <A HREF="ch14d.htm">[Next]</A><P>

<A NAME="365"><H1>How the Data Shape Provider Works</H1></A>

<p>When you submit a query on a connection that loads the data shape
provider, the provider parses the query string to determine whether
that string includes keywords that the provider uses to build
hierarchical recordsets. If no such keywords are used, the data shape
provider passes the query string to the OLE DB provider you've
specified as the data provider.</p>

<A NAME="366"><H2>Parsing a Hierarchical Query String</H2></A>

<p>If the data shape provider finds keywords, it breaks the query
string into distinct queries, passes those queries along to the data
provider, processes the results, and organizes the data into the
hierarchy you requested. For example, let's take a look at the
query string used earlier in the chapter:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strSQL