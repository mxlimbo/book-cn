<html>
<head>
<TITLE>RecordCount and Bookmarks</title>
<link rel="STYLESHEET" type="text/css" href="progado.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<BODY bgcolor = "#ffffff" text="#000000">
<A HREF="ch07e.htm">[Previous]</A> <A HREF="ch07g.htm">[Next]</A><P>

<A NAME="260"><H1>RecordCount and Bookmarks</H1></A>

<p>When displaying data, many developers want to do two things as soon
as they open their Recordset&#8212;display the results in a grid and
display the number of records returned by the query. Depending on the
cursor type, you might not be able to do either. You might find that
the Recordset object's RecordCount property returns -1 and that you
get an error when you try to bind your Recordset to your grid.</p>

<A NAME="261"><H2>Why Does the RecordCount Property Return -1?</H2></A>

<p>Not all cursors provide the functionality required to report how
many records they contain. While developers who have a lot of
experience with cursors might find this obvious, others are initially
amazed&#8212;they find this behavior absurd. An ADO Recordset is unable
to provide a definite value for RecordCount when using forward-only or
dynamic cursors, while static and keyset cursors have a well-defined
RecordCount.</p>

<p>With a static cursor, the data remains the same; changes made by
other users will not be visible. If you scroll back and forth through
the cursor, you'll always see the same number of records unless
you're using a client-side cursor, in which case you're the
only one adding or removing records. For this reason there is a
well-defined number of records in a static cursor at all times. While
keyset cursors allow you to see changes made by other users to the
records that make up the cursor, membership in the cursor is still
static. Thus, keyset cursors also contain a well-defined number of
records.</p>

<p>Forward-only cursors are more concerned with performance than with
functionality. You generally ask for data in a forward-only cursor if
you want to retrieve data as quickly as possible. Forward-only cursors
do not support a record count and the RecordCount property is set to -1
to reflect this. If you need to know how many records the query
returned with a forward-only cursor, count the records as you fetch
them. Alternatively, most database systems support a COUNT function
that you can use to simply return the number of records retrieved by a
query.</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
strSQL