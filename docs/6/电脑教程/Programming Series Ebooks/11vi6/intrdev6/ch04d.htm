<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>How the Scripting Object Model Works</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch04c.htm", "ch04e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="84"><H1>How the Scripting Object Model Works</H1></A>
<P>The files for the Scripting Object Model are contained in the _ScriptLibrary 
folder that Visual InterDev 6 inserts in your Web project when you create a 
project. (See Figure 4-2) You should never change anything 
in one of the _ScriptLibrary files or delete any of these files.

</P>
<P>Microsoft is going to replace the JScript files that make up the SOM 
with a set of components written in C++ using the Active Template Library 
(ATL). The new Scripting Object Model components should provide faster 
execution, a more stable environment, and a true black-box architecture for the server. 
In the interim, you should treat the Scripting Object Model as a black box 
(that is, you should not be concerned about how it accomplishes its tasks).

</P>
<P>
<IMG SRC="images/F04lh02.GIF" width=288 height=303 BORDER=0>
</P>
<P>
<!-- CAPTION --><B>Figure 4-2.</B> <I>The _ScriptLibrary folder contains the Scripting Object Model files.</I><!-- /CAPTION -->

</P>
<P>ASP files execute in a linear manner as indicated by Figure 4-3. When 
a user visits an ASP file, the page starts executing at the first line of code 
and continues to execute sequentially top to bottom. Once the code in a page 
is executed, the HTML generated is sent to the browser via HTTP. The only 
changes to the linear flow of execution are governed by the logic in the page that 
might call procedures or redirect the flow of execution directly.

</P>
<P>
<A HREF="javascript:fullSize('F04lh03x.htm')"> <IMG SRC="images/F04lh03.JPG" width=404 height=302 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 4-3.</B> <I>The ASP execution model is sequential from top to bottom.</I><!-- /CAPTION -->

</P>
<P>DHTML pages, on the other hand, execute in an event-driven manner 
just as Visual Basic applications do. Figure 4-4 demonstrates how this can look 
when a page executes. 

</P>
<P>
<A HREF="javascript:fullSize('F04lh04x.htm')"> <IMG SRC="images/F04lh04.JPG" width=404 height=247 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 4-4.</B> <I>The DHTML execution model is event-driven.</I><!-- /CAPTION -->

</P>
<P>In Figure 4-4, when a user clicks a hyperlink to this page, the 
<I>onload</I> event will execute when the page loads. The 
<I>onclick</I> event will not execute until the user clicks the command button. This execution model greatly simplifies the 
way you build Web applications and reduces the long-term maintenance costs of 
the applications. You as the developer can control what happens when 
particular parts of the page execute. This allows you to isolate your code and execute 
code discretely when certain actions (events) occur in a page.

</P>
<P>The Document Object Model of the browser exposes the page as an 
object hierarchy. The script in the page can execute against the Document Object 
Model, automating features of the page and making it dynamic. DHTML pages 
are typically event driven, with code that is contained in event procedures 
within the page. Of course, you must be using a browser that supports DHTML, 
such as Microsoft Internet Explorer 4, to use the DHTML features.

</P>
<P>The Scripting Object Model works with both DHTML and ASP files. 
It provides the framework to allow both ASP and DHTML Web pages to 
execute in an object-oriented manner. Figure 4-5 demonstrates how ASP files have an object model when using the SOM.

</P>
<P>You can see the event model of ASP files in Figure 4-5. This new 
event model is particularly interesting as it allows you to script events for DTCs 
in either the client or server. Whenever you use the Scripting Object Model, at 
run-time an object is created for each DTC and the current page. These objects 
are the mechanism that you use to have access to the features of the page and 
its DTCs. More on this in a moment.

</P>
<P>
<A HREF="javascript:fullSize('F04lh05x.htm')"> <IMG SRC="images/F04lh05.JPG" width=404 height=245 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 4-5.</B> <I>The Visual InterDev 6 Scripting Object Model provides ASP events.</I><!-- /CAPTION -->

</P>
<P>The DTCs' event model is implemented by the Scripting Object Model 
at run time. This allows you to build events in client or server code. Usage of 
the new DTCs is covered in detail in <A HREF="ch06a.htm">Chapter 6</A>. The server events for pages 
are provided by the PageObject DTC, which is the foundation for page type 
events and other support for treating pages as objects. Its close relationship to 
the Scripting Object Model is the reason for covering it in this chapter.

</P>
</BODY>
</HTML>




