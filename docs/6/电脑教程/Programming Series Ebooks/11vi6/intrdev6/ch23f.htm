<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Client-Side Certificates</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch23e.htm", "ch23g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="416"><H1>Client-Side Certificates</H1></A>
<P>Now that we have Certificate Server installed and we have installed a 
server-side digital certificate within IIS 4.0, two procedures remain before we can start 
working with client-side certificates within our Visual InterDev 6.0 Web projects. 
First we need to request a client-side certificate from Certificate Server and install 
it into our browser, and second we need to configure the Web server to 
accept or require client certificates for the relevant virtual directories or Web pages.

</P>
<P>To request a client-side certificate from Certificate Server, follow these steps:

</P>
<OL>
<P><LI>Make sure that Certificate Server is installed and has been 
configured as a root CA.

</LI>
</P>
<P><LI>Go into the main administration page of Certificate Server at 
<I>http://localhost/certsrv/</I>, and click the Certificate Enrollment 
Tools hyperlink.

</LI>
</P>
<P><LI>Select the Request A Client Authentication Certificate option.

</LI>
</P>
<LI><P>Complete the Certificate Enrollment Form with your personal 
information, as shown in Figure 23-6 below.

</P>
<P>
<A HREF="javascript:fullSize('f23LH06x.htm')"> <IMG SRC="images/f23LH06.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-6.</B> <I>Certificate Server's Certificate Enrollment Form page.</I><!-- /CAPTION -->
</P>
</LI>

<P><LI>Click Submit Request to submit the information to Certificate Server.

</LI>
</P>
<P><LI>If all is successful, Certificate Server will present you with a 
Certificate Download page, as shown in Figure 23-7.

</LI>
</P>
<P><LI>Click Download to download and install the new certificate. 
Certificate Server will remind you that you need to have the CA's 
root certificate installed as well.
</LI>
</P>
</OL>




<P>Within Internet Explorer 4.0, you can check that the client certificate 
has been installed correctly by choosing Internet Options from the View menu 
and then selecting the Content tab. Next click Personal in the Certificates group 
box. You'll now be presented with a list of the client authentication certificates 
that have been installed into your browser. From here you have the ability 
either to view the details of the certificate or to import or export certificates. 
Figure 23-8 shows the certificate Properties dialog box if you click the View 
Certificate button. This dialog box shows the fields and their respective values 
within your certificate.

</P>
<P>
<A HREF="javascript:fullSize('f23LH07x.htm')"> <IMG SRC="images/f23LH07.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-7.</B> <I>Certificate Server's Certificate Download page.</I><!-- /CAPTION -->

</P>
<P>
<A HREF="javascript:fullSize('f23LH08x.htm')"> <IMG SRC="images/f23LH08.JPG" width=404 height=273 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-8.</B> <I>The certificate Properties dialog box showing field names 
and their values for a client authentication certificate generated by 
Certificate Server.</I><!-- /CAPTION -->

</P>
<P>To configure IIS 4.0 to accept or require a client certificate, follow these steps:

</P>
<OL>
<P><LI>Start Internet Service Manager by choosing 
Start|Programs|Windows NT 4.0 Option Pack|Microsoft Internet Information 
Server|Internet Service Manager.

</LI>
</P>
<P><LI>Select the virtual directory or Web page that you want to secure.

</LI>
</P>
<P><LI>Right-click the item, and choose Properties from the context menu.

</LI>
</P>
<P><LI>In the Directory Security or File Security tab, click the Edit 
button in the Secure Communications group box.

</LI>
</P>
<P><LI>Check the Require Secure Channel When Accessing This 
Resource check box.

</LI>
</P>
<LI><P>Check either the Accept Certificates radio button or the Require 
Client Certificates radio button as required, as shown in Figure 23-9.

</P>
<P>
<A HREF="javascript:fullSize('f23LH09x.htm')"> <IMG SRC="images/f23LH09.JPG" width=404 height=340 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-9.</B> <I>The Secure Communications dialog box in the Internet 
Service Manager, showing the options for accepting or requiring client certificates.</I><!-- /CAPTION -->
</P>
</LI>

</OL>




<P>You'll also notice in Figure 23-9 that client certificates can be mapped 
to Windows NT user accounts. This allows you to control access to resources 
using standard Windows NT security. You can either specify direct one-to-one 
mapping of a certificate to a user account or specify wildcard mapping. In 
wildcard mapping, you can map any certificates that match certain criteria (such as 
the organization unit) to a single Windows NT user account or group. For 
example, you might map all client certificates with an organization code beginning 
with NIP to a Windows NT 4.0 group named NIP.

</P>
</BODY>
</HTML>




