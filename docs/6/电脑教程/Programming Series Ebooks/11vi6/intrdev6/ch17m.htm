<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>The Permission Checker Component</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch17l.htm", "ch18a.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="333"><H1>The Permission Checker Component</H1></A>
<P>The Permission Checker component implements the 
<I>PermissionChecker</I> object, which uses the password authentication protocols in IIS to determine whether a Web user has permission to read a file.

</P>
<P>A typical use of the <I>PermissionChecker</I> object is to test whether the 
user has permission to read a particular Web page (by clicking a hyperlink to 
that page). If the <I>PermissionChecker</I> object determines that the user does not 
have permission to read the page, ASP script can be used to disable the 
hyperlink, or better yet, not to show the hyperlink at all. The 
<I>PermissionChecker</I> object has one method, named 
<I>HasAccess</I>. 

</P>
<P>The example in Figure 17-16 shows how to test whether a user has 
access to a Web page.

</P>
<P><B>Figure 17-16.</B> <I>Permission Checker sample code, PermissionChecker.asp, 
showing how to read whether a user has access to a particular Web page using either 
a physical or a virtual path.</I>

</P>
<P><PRE>&lt;%@ Language=VBScript %&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;H2&gt;Permission Checker Sample&lt;/H2&gt;
&lt;HR&gt;

&lt;OBJECT RUNAT=server PROGID=MSWC.PermissionChecker id=oPermChk&gt;
&lt;/OBJECT&gt;

The following code checks to see if the current user has
access to the PermissionChecker.asp file
&lt;P&gt;
Physical Path = &lt;%=oPermChk.HasAccess(&quot;.\PermissionChecker.asp&quot;) %&gt;
&lt;P&gt;
Virtual Path = 
    &lt;%=oPermChk.HasAccess(&quot;/Components/PermissionChecker.asp&quot;) %&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>You can use physical paths, such as .\PermissionChecker.asp, as well 
as virtual paths, such as /Components/PermissionChecker.asp, when 
checking permissions using this component. Figure 17-17 shows the resulting output 
from the PermissionChecker.asp page.

</P>
<P>
<A HREF="javascript:fullSize('f17lh17x.htm')"> <IMG SRC="images/f17lh17.jpg" width=404 height=339 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 17-17.</B> <I>Output from the PermissionChecker.asp page.</I><!-- /CAPTION -->
</P>
</BODY>
</HTML>



