<HTML>
<HEAD>
	<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Working with Database Connections</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05a.htm", "ch05c.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>



<A NAME="92"><H1>Working with Database Connections</H1></A>

<P>There are a number of steps you must take to work with databases from 
within Visual InterDev 6.0. The first step is to create a data connection and link it 
to a data source. If you do not have a data source definition before you create 
the data connection, you can add one at the time. The steps in this process are 
very similar to those in Visual InterDev 1.0.

</P>
<P>Define a data connection to an existing data source by following these steps:

</P>
<OL>
<P><LI>Right-click the Project name or global.asa in Project Explorer, 
and select Add Data Connection from the context menu. You will see 
the Select Data Source dialog box shown in Figure 5-2.

</LI>
</P>
<P><LI>Click the File Data Source tab or the Machine Data Source tab 
to select the type of data source you want to select. Figure 5-2 
shows the Machine Data Source tab.

</LI>
</P>
<P><LI>Select the data source name, and click OK. A dialog box 
showing parameters for the data connection is displayed based upon 
the driver for the data source you select. (Setting these parameters 
is discussed in the following section.)

</LI>
</P>
<P><LI>Enter the data connection parameters.

</LI>
</P>
<P><LI>Click OK to add the data connection.
</LI>
</P>
</OL>




<P>
<A HREF="javascript:fullSize('F05lh02x.htm')"> <IMG SRC="images/F05lh02.JPG" width=404 height=349 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 5-2.</B> <I>The Select Data Source dialog box shows the existing data sources on a system.</I><!-- /CAPTION -->

</P>
<P>The data connection is displayed under the Data Environment icon 
in Project Explorer. You can also browse and edit the data from the database 
in the Data View window.

</P>
<A NAME="93"><H3>Setting Data Connection Parameters</H3></A><P>After you select a data source for your data connection, you will see the 
data connection Properties dialog box shown in Figure 5-3. The dialog box is 
displayed as &quot;Connection1 Properties&quot; because Connection1 is the default 
name for a new data connection when it is the first in a project. Figure 5-3 also 
shows the new name I have assigned the data connection&#8212;cnPubs. This will 
become the name of the dialog box once I apply the change.

</P>
<P>
<IMG SRC="images/F05lh03.GIF" width=401 height=338 BORDER=0>
</P>
<P>
<!-- CAPTION --><B>Figure 5-3.</B> <I>The data connection Properties dialog box lets you name the data connection and set various design-time and run-time properties.</I><!-- /CAPTION -->

</P>
<P>You can use the data connection Properties dialog box to change 
the configuration of a data connection. You can:

</P>
<UL>
<P><LI>Change the data source

</LI>
</P>
<P><LI>Change the authentication properties used at both run time 
and design time

</LI>
</P>
<P><LI>Change other properties, such as cursor type
</LI></P>
</UL>




<P>If you change the data source to a connection string, you can use the 
Build button to select the driver for the connection and then configure its 
properties. This option is not available for an ODBC data source or a data link file.

</P>
<P>Figure 5-4 shows the Authentication tab of the data connection 
Properties dialog box. Notice that you can specify both user name and password 
strings for the run-time and design-time connections. You can choose whether to 
allow the Visual InterDev environment to prompt you at design time for any 
required connection information. You can also choose to allow a user prompt for 
connection information during design time.

</P>
<P>
<IMG SRC="images/F05lh04.GIF" width=401 height=338 BORDER=0>
</P>
<P>
<!-- CAPTION --><B>Figure 5-4.</B> <I>The Authentication tab provides a design-time interface for changing both design-time and run-time authentication for the data connection.</I><!-- /CAPTION -->

</P>
<P>The run-time prompt must always be set to Never. The data 
connection cannot prompt the user for the connection information when the 
application executes because the data connection will be running on the server, not 
the client. Even if you set the run-time environment for DTCs to client, the 
prompting behavior will not work in Web applications. You can, of course, override 
these defaults by passing the security credentials in to the data connection when 
the application is executing.

</P>
<A NAME="94"><H3>Creating a New Data Source</H3></A><P>Visual InterDev 6.0 will let you create a new data source when you add a 
data connection. The steps are similar to the ones used in Visual InterDev 1.0.

</P>
<OL>
<P><LI>Right-click the Project name or global.asa in Project Explorer, 
and select Add Data Connection from the context menu. You will see 
the Select Data Source dialog box, shown in Figure 5-2.

</LI>
</P>
<P><LI>Click the File Data Source tab or the Machine Data Source tab 
to select the type of data source. Figure 5-2 shows the Machine 
Data Source tab.

</LI>
</P>
<P><LI>Click the New button.

</LI>
</P>
<P><LI>Select the database driver for your database, and choose Next.

</LI>
</P>
<P><LI>Type the name for the data source, and choose Next. The 
extension .dsn is automatically added to the name for a file data source.

</LI>
</P>
<P><LI>Choose Finish. The database driver will be invoked and will 
display dialog boxes to complete the setup process. Enter 
driver-specific information, such as the name of the database. 
</LI>
</P>
</OL>




<P>Be careful when using data sources. Observe the guidelines listed below: 

</P>
<UL>
<P><LI>When you specify the path for a file database such as Access, 
use the relative path to the database, not its location on your 
development computer. For example, if the database is located on a 
Web server, use the URL path to the database. This ensures that the 
database will be available from your Web server.

</LI>
</P>
<P><LI>Often it is best to use a system data source rather than a file 
data source. The reasons are twofold: First, using a system data 
source allows you to create the same data source name on all the 
developer systems and on the production server. Then you can move the 
application from one system to the other without any database 
issues. Second, the application will run faster, since system data sources 
are faster than file data sources.

</LI>
</P>
<P><LI>Be careful when using system and user data sources. System 
data sources are available to all users on the system. User data 
sources are only available to the user who creates them. For Web 
servers, always define the data sources as system, unless you want to 
define them explicitly for the run-time user only. Figure 5-5 shows this 
step in the Create New Data Source Wizard.
</LI></P>
</UL>




<P>The step shown in Figure 5-5 will display only if you select the 
Machine Data Source tab in the Select Data Source dialog box before you click the 
New button in step 3 above.

</P>
<P>
<A HREF="javascript:fullSize('F05lh05x.htm')"> <IMG SRC="images/F05lh05.JPG" width=404 height=256 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 5-5.</B> <I>The Create New Data Source Wizard steps you through the process of creating a new data source.</I><!-- /CAPTION -->

</P>
<P>When you reach the last step of the Create New Data Source Wizard, 
you will see a summary of the data source information you specified. An 
example of a SQL Server data source is shown in Figure 5-6. At the bottom of this 
dialog box you will see the Test Data Source button. Click this button, and the 
data source connection will be tested for you. This ensures that the data 
source information is valid and that the data connection will work.

</P>
<P>
<IMG SRC="images/F05lh06.GIF" width=368 height=379 BORDER=0>
</P>
<P>
<!-- CAPTION --><B>Figure 5-6.</B> <I>You can test your data source during the creation stage by clicking the Test Data Source button.</I><!-- /CAPTION -->

</P>
<P>Once you have completed the steps to set up the data source, you 
are returned to the Select Data Source dialog box shown in Figure 5-2 and the 
data source name you created is displayed in the list. Select this name and click 
OK. This will add the data source to your project.

</P>

</BODY>
</HTML>




