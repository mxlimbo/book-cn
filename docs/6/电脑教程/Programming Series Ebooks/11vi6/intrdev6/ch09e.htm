<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Using Server Variables with Forms</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch09d.htm", "ch10a.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="151"><H1>Using Server Variables with Forms</H1></A>
<P>One example of a useful server variable is <I>REQUEST_METHOD</I>. If you check it in an ASP Web page, it has a value of POST<I> </I>when the page is referenced by a form, and it has a value of 
GET<I> </I>when the user has referenced a page either directly or by using the Refresh feature of the browser. This is useful because if the user refreshes the ASP Web page that was used to respond to a form, the values are not set in the <I>Request</I> object and your page does not display correctly.


</P>
<P><div class="note"><blockquote>
<B>NOTE</B><HR>The problem of a user refreshing an ASP Web page that 
was used to respond to an HTML form is not so significant if your users 
are using Microsoft Internet Explorer 4.0. During a refresh, this browser 
will display a message box (&quot;Repost form data?&quot;) so that the end user 
has the option of reposting the data. Checking for GET or POST in your 
ASP code is still useful, however, because it covers the scenario in which 
the page might be accessed directly.
</blockquote></div>

</P>
<P>Figure 9-10 shows how to modify the Favorite Car form's 
corresponding ASP Web page, FormHandler.asp. The modified file is named 
FormHandler2.asp. This example tests 
<I>REQUEST_METHOD</I> and displays a message when the 
user clicks the Refresh button.

</P>
<P><B>Figure 9-10.</B> <I>An example that tests the </I>REQUEST_METHOD<I> server variable.</I>

</P>
<P><PRE>&lt;%@ Language=VBScript %&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;TITLE&gt;Form Processor&lt;/TITLE&gt;


&lt;/HEAD&gt;
&lt;BODY BGCOLOR=&quot;#FFFFFF&quot;&gt;
&lt;%
Dim RequestMethod
' reference 1
RequestMethod = Request.ServerVariables(&quot;REQUEST_METHOD&quot;)
' reference 2
If RequestMethod = &quot;GET&quot; Then
' This means the user refreshed FormHandler2.asp

' reference 3
%&gt;
&lt;H1&gt;
&lt;C&gt;Sorry!&lt;/C&gt;
&lt;/H1&gt;
You can't use Refresh to view this screen. Use your Back button to go 
to the form, change the data if need be, and press the Submit button 
to get back to this point.
&lt;P&gt;
Thanks!
&lt;%
Else  ' The user pressed submit on the form
%&gt;
Welcome, 
&lt;% = Request.Form(&quot;FName&quot;) &amp; &quot; &quot; &amp; Request.Form(&quot;LName&quot;) %&gt;.
&lt;P&gt;
Your favorite car is a 
&lt;%
DIM favcar
favcar = Request.Form(&quot;Car&quot;)
If favcar = &quot;Chrysler&quot; Then
    Response.Write(&quot;... wait a minute... there must be an error.&quot;)
    Response.Write(&quot;&lt;P&gt;A &lt;B&gt;Chrysler&lt;/B&gt;?&quot;)
Else
    Response.Write(favcar &amp; &quot;.&lt;P&gt;That's cool.&quot;)
End If
%&gt;

&lt;%
End If
%&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>The statement after the reference 1 comment gets the value of 
<I>REQUEST_METHOD</I> and stores it in a local variable. 
<I>REQUEST_METHOD</I>'s value is POST<I> </I>when the ASP Web page is called by a &lt;FORM&gt; tag's ACTION attribute. Any other time the ASP Web page is called&#8212;when the user types the Web address directly into the browser, refreshes the page, or clicks on a link that is 
connected to the page&#8212;the value of <I>REQUEST_METHOD</I> is GET.

</P>
<P>The script then checks the value of <I>REQUEST_METHOD</I> (the statement after the reference 2 comment). As in Visual Basic, the <I>If</I> construct in VBScript contains a block of code that is executed if the condition being evaluated is True; and an optional <I>Else</I> block that, when included, executes if the condition is False. One technique you can use in this VBScript is to place a chunk of HTML in between the VBScript <I>If</I>, <I>Else</I>, and <I>End If</I> statements. Even though the VBScript section is closed after the reference 3 comment, the code that follows is still part of the <I>If</I> block. The HTML between the <I>If</I> block and the VBScript section with the <I>Else</I> statement is executed only when the condition in the 
<I>If</I> is true, even though it is not between the &lt;% and %&gt; symbols. Although this technique can be slightly confusing at first, it is important and is often used in ASP Web pages.</P>
</BODY>
</HTML>




