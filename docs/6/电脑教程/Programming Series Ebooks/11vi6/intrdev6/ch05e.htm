<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Using the Query Designer</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05d.htm", "ch06a.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="99"><H1>Using the Query Designer</H1></A>
<P>The Query Designer&#8212;a SQL Builder add-in for Visual InterDev&#8212;is a 
member of the Microsoft Visual Database Tools product family and is a key 
companion to the Data Environment in both Visual InterDev and Visual Basic. The 
Query Designer provides visual design tools to create SQL statements for 
performing queries, updates, and other tasks on any ODBC-compliant database. The 
Query Designer lets you perform the following tasks:

</P>
<UL>
<P><LI>Create queries to retrieve, update, insert, and delete data from 
any ODBC-compliant database

</LI>
</P>
<P><LI>Select tables, views, and columns for a query

</LI>
</P>
<P><LI>Specify how to order query results

</LI>
</P>
<P><LI>Build Where clauses that specify what values to search for

</LI>
</P>
<P><LI>Preview query results in the Results pane

</LI>
</P>
<P><LI>Join tables to create multitable queries

</LI>
</P>
<P><LI>Edit databases by inserting, updating, or deleting rows

</LI>
</P>
<P><LI>Create special-purpose queries, such as parameter queries in 
which search values are provided when the query is executed

</LI>
</P>
<P><LI>Enter SQL statements directly or edit the SQL statements created 
by the Query Designer

</LI>
</P>
<P><LI>Create back-end-specific SQL statements to take advantage of 
a particular database's features

</LI>
</P>
<P><LI>Execute Microsoft SQL Server stored procedures
</LI></P>
</UL>




<A NAME="100"><H2>The Query Designer Interface</H2></A><P>The Query Designer interface is built around four panes, or windows, as 
described in Table 5-1.

</P>
<P>You can control which panes are currently displayed by using the 
buttons on the Query toolbar, shown in Figure 5-17. The buttons are toggles that 
turn a pane's display on or off. Figure 5-17 shows the Query Designer with the 
SQL statement for the GetCustomers data command object.

</P>
<P>The Query Designer supports drag-and-drop and cut-and-paste 
operations to the Clipboard. For example, the interactive interface lets you drag a 
column from the Diagram pane and drop it onto the Grid pane.

</P>
<P><B>Table 5-1.</B> <I>The graphical panes of the Query Designer interface.</I>

<TABLE CELLPADDING=5 WIDTH="95%">
<TR>
<TH VALIGN="TOP"><B><I>Query Designer Pane</I></B></TH>
<TH VALIGN="TOP"><B><I>Description</I></B></TH>
</TR>

<TR>
<TD VALIGN="TOP">Diagram</TD>
<TD VALIGN="TOP">Displays the input sources (tables or views) that
you are querying</TD>
</TR>

<TR>
<TD VALIGN="TOP">Grid</TD>
<TD VALIGN="TOP">Contains a spreadsheet-like grid in which
you specify query options, such as which data 
columns to display, how to order the results, which rows 
to select, and how to group rows</TD>
</TR>

<TR>
<TD VALIGN="TOP">SQL</TD>
<TD VALIGN="TOP">Displays the SQL statement for the current
query and lets you create your own SQL statements</TD>
</TR>

<TR>
<TD VALIGN="TOP">Results</TD>
<TD VALIGN="TOP">Shows a grid with the results of the most
recently executed query</TD>
</TR>
</TABLE>
      



</P>
<P>
<A HREF="javascript:fullSize('F05lh17x.htm')"> <IMG SRC="images/F05lh17.JPG" width=404 height=291 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 5-17.</B> <I>The Query Designer interface is based upon four windows (from top to bottom): Diagram, Grid, SQL, and Results.</I><!-- /CAPTION -->

</P>
<A NAME="101"><H2>Creating Queries with the Query Designer</H2></A><P>You can create a query and/or display the Query Designer interface in 
several ways. You can open the Query Designer for an existing table or you can 
view it in Data View.

</P>
<P>To open the Query Designer for a table or a view, take the following steps:

</P>
<OL>
<P><LI>Display the tables or views in the Data View window.

</LI>
</P>
<P><LI>Double-click a table or a view to open the Query Designer for 
that object.
</LI>
</P>
</OL>




<P>These two steps open the Results pane for the selected table or view 
and display the data from the query. The Results pane lets you edit and delete 
the data returned by the query. You cannot access the Query Designer's other 
features because they are not useful for a table or a view. You can, however, 
use the Query toolbar to open the other panes.

</P>
<P>If you open the Diagram or SQL pane, you can create an entirely 
new query. After you change the query definition, the query is no longer based 
on the table with which you opened the Query Designer. You can save the 
query to a file by clicking the Standard toolbar's Save button. The resulting .dtq 
file is an ASCII description of the query that you can add to a database project.

</P>
<P>To open the Query Designer for the Recordset DTC, follow these steps:

</P>
<OL>
<P><LI>Display the properties for the Recordset DTC by right-clicking 
the DTC and choosing Properties from the context menu.

</LI>
</P>
<P><LI>Click the General tab of the Recordset Properties dialog box.

</LI>
</P>
<P><LI>Select the SQL Statement option, and then click the SQL 
Builder button.
</LI>
</P>
</OL>




<P>To open the Query Designer for a data command object, 
do the following:

</P>
<UL>
<P><LI>Right-click the data command in Project Explorer, and select 
SQL Builder from the context menu.
</LI></P>
</UL>




<P>You can also open the Query Designer for a data command object 
by clicking the SQL Builder button on the data command Properties dialog box.

</P>
<P>The query you create for a Recordset DTC or a data command 
object automatically updates the SQL for the object when you save or close the query.

</P>
<P>To add input sources (tables and views) to the Query Designer, 
follow these steps:

</P>
<OL>
<P><LI>Display the Data View window of the Project Workspace.

</LI>
</P>
<P><LI>Drag the table or view, and drop it onto the Query Designer 
Diagram pane.
</LI>
</P>
</OL>




<P>You can also drag a database diagram from the Database Designer 
and drop it onto the Query Designer. This step inserts all the tables in the 
diagram into the Query Designer. This is a quick way to get several tables into 
the Query Designer when you already have a database diagram containing 
the tables you need.

</P>
<P>Once the Query Designer is open, you can quickly create a query. Just 
add the tables from which you want to retrieve the data, and then follow these steps:

</P>
<OL>
<P><LI>Select the columns to use in the query by dragging them to the 
Grid pane or by selecting the check box next to the column name.

</LI>
</P>
<P><LI>Enter any criteria for the query, such as filters or expressions.

</LI>
</P>
<P><LI>Test the query by clicking the Run Query button on the 
Query toolbar.
</LI></P>
</OL>
</BODY>
</HTML>




