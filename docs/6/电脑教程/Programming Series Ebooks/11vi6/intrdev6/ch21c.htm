<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Installing MSMQ</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch21b.htm", "ch21d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="379"><H1>Installing MSMQ</H1></A>
<P>MSMQ is provided as part of the Windows NT 4.0 Option Pack and can 
be installed on Windows NT 4.0 Server, Windows NT 4.0 Workstation, or 
Windows 95/Windows 98. When installing MSMQ from the Windows NT 4.0 Option 
Pack, you should choose the Microsoft Message Queue option from the Setup 
dialog box, as shown in Figure 21-2. For a Windows NT 4.0 Server installation, 
the entire MSMQ software including documentation is 41.3 MB. Figure 21-3 
shows the subcomponents available for MSMQ. You can access these 
subcomponents by clicking the Show Subcomponents button on the Setup dialog box.

</P>
<P>
<A HREF="javascript:fullSize('f21LH02x.htm')"> <IMG SRC="images/f21LH02.JPG" width=404 height=316 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 21-2.</B> <I>The Windows NT 4.0 Option Pack Setup dialog box showing the MSMQ component.</I><!-- /CAPTION -->

</P>
<P>
<A HREF="javascript:fullSize('f21LH03x.htm')"> <IMG SRC="images/f21LH03.JPG" width=404 height=310 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 21-3.</B> <I>The Microsoft Message Queue dialog box showing the subcomponents of MSMQ.</I><!-- /CAPTION -->

</P>
<P>The available MSMQ subcomponents are as follows:

</P>
<UL>
<P><LI>Administration Tools     (0.9 MB)
</LI>
</P>
<P><LI>HTML Documentation (23.8 MB)
</LI>
</P>
<P><LI>Microsoft Message Queue Code (9.6 MB)
</LI>
</P>
<P><LI>Software Development Kit (7.0 MB)
</LI></P>
</UL>




<P>The steps to install MSMQ onto Windows NT 4.0 Server are as follows:

</P>
<OL>
<P><LI>Select the MSMQ client or server to install. For a new 
installation, you should choose the Primary Enterprise Controller (PEC) and 
then click the Next button, as shown in Figure 21-4.
</LI>
</P>
<P><LI>   Enter the MSMQ Enterprise Name and MSMQ Site Name, and 
click Next.
</LI>
</P>
<P><LI>Enter the MSMQ installation folder location, and click Next.
</LI>
</P>
<P><LI>Enter the folder location for the Data Device and Log Device for 
the MSMQ Information Server database on SQL Server. The default 
size is 80 MB for the data device and 20 MB for the log device. Click 
the Continue button to have setup create the MQIS database.
</LI>
</P>
<P><LI>Click the Add button on the MSMQ Connected Networks dialog 
box to enter the name of the new connected network and select its 
protocol. When completed, the screen should look similar to Figure 21-5.
</LI>
</P>
<P><LI>Click the Finish button in the Windows NT 4.0 Option Pack 
Setup dialog box.
</LI>
</P>
<P><LI>Restart the server for the changes to take effect.
</LI>
</P>
</OL>

<P>
<A HREF="javascript:fullSize('f21LH04x.htm')"> <IMG SRC="images/f21LH04.JPG" width=404 height=316 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 21-4.</B> <I>The Microsoft Message Queue (MSMQ) Setup dialog box showing the available MSMQ clients and servers that can be installed.</I><!-- CAPTION -->

</P>
<DIV CLASS="NOTE"><BLOCKQUOTE>
<P>
<B>NOTE</B>
<HR>
Prior to installing the Primary Enterprise Controller (PEC) onto 
Windows NT 4.0 Server, you'll need to make sure you have Microsoft 
SQL Server 6.5 installed. MSMQ uses SQL Server 6.5 for the MQIS 
database. The MQIS is a distributed database that stores the following information:

</P>
<UL>
<P><LI>Enterprise topology (such as sites, CNs, and InRS/OutRS assignments)

</LI>
</P>
<P><LI>Enterprise settings (such as enterprise name, PEC name, and default-replication intervals)

</LI>
</P>
<P><LI>Computer information

</LI>
</P>
<P><LI>Queue information
</LI></P>
</UL>

<P>&nbsp;</P>
</BLOCKQUOTE></DIV>


<P>
<IMG SRC="images/f21LH05x.gif" width=428 height=365 border=0> 
</P>
<P>
<!-- CAPTION --><B>Figure 21-5.</B> <I>The MSMQ Connected Networks dialog box showing an installed connected network and its protocol.</I><!-- /CAPTION -->

</P>
<P>When you have completed the installation of MSMQ on your 
Windows NT 4.0 Server, you will have a Microsoft Message Queue folder available 
from the Start menu on the taskbar. Under the Microsoft Message Queue folder, 
you will find samples, documentation, and the MSMQ Explorer.

</P>
</BODY>
</HTML>




