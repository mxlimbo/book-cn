<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Using the Tabular Data Control</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch16b.htm", "ch16d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="298"><H1>Using the Tabular Data Control </H1></A>
<P>Now that we've covered some of the theory involved in DHTML data 
binding, let's take a look at some real examples. For the TDC, we'll look at two 
code samples&#8212;a simple example and then a more advanced example.


</P>
<A NAME="299"><H2>Sorting a Simple HTML Table</H2> </A>

<P>The code below shows the source code for TDC.htm. This file, along with 
all the other related files, is included on the CD-ROM under the CHAP16 folder.
</P>
<P><PRE>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META name=VI60_defaultClientScript content=VBScript&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;SCRIPT ID=clientEventHandlersVBS LANGUAGE=vbscript&gt;
&lt;!--
Sub Col1_onclick
    CTDCCtl1.Sort = &quot;A&quot;
    CTDCCtl1.Reset
End Sub

Sub Col2_onclick
    CTDCCtl1.Sort = &quot;B&quot;
    CTDCCtl1.Reset
End Sub

Sub Col3_onclick
    CTDCCtl1.Sort = &quot;C&quot;
    CTDCCtl1.Reset
End Sub

Sub btnFilt_onclick
    CTDCCtl1.Filter = &quot;A=1&quot;
    CTDCCtl1.Reset     
End Sub

Sub btnReset_onclick
    CTDCCtl1.Filter = &quot;A=*&quot;
    CTDCCtl1.Reset
End Sub
--&gt;
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;H2&gt;Simple Table (Using the Tabular Data Control)&lt;/H2&gt;
&lt;HR&gt;

&lt;OBJECT CLASSID=&quot;clsid:333C7BC4-460F-11D0-BC04-0080C7055A83&quot; 
id=CTDCCtl1 VIEWASTEXT&gt;
&lt;PARAM NAME=&quot;DataURL&quot; VALUE=&quot;TDC.csv&quot;&gt;
&lt;PARAM NAME=&quot;UseHeader&quot; VALUE=&quot;True&quot;&gt;
&lt;/OBJECT&gt;

&lt;TABLE BORDER=1 DATASRC=&quot;#CTDCCtl1&quot;&gt;
&lt;THEAD&gt;
&lt;TR&gt;
&lt;TH ID=&quot;Col1&quot;&gt;1st&lt;TH ID=&quot;Col2&quot;&gt;2nd&lt;TH ID=&quot;Col3&quot;&gt;3rd
&lt;TBODY&gt;
&lt;TR&gt;
&lt;TD&gt;&lt;SPAN DATAFLD=A&gt;&lt;/SPAN&gt;
&lt;TD&gt;&lt;SPAN DATAFLD=B&gt;&lt;/SPAN&gt;
&lt;TD&gt;&lt;SPAN DATAFLD=C&gt;&lt;/SPAN&gt;
&lt;/TABLE&gt;
&lt;P&gt;
&lt;INPUT type=&quot;button&quot; value=&quot;Filter&quot; id=&quot;btnFilt&quot; name=&quot;filter&quot;&gt;
&amp;nbsp;
&lt;INPUT type=&quot;button&quot; value=&quot;Reset&quot; id=&quot;btnReset&quot; name=&quot;reset&quot;&gt;
&lt;P&gt;
&lt;FONT face=&quot;&quot; size=2&gt;
Click a column heading to sort the table by that column
&lt;/FONT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>The TDC.htm file demonstrates how to use the TDC to retrieve data 
from a comma-delimited text file named TDC.csv and display it within the 
browser in the form of an HTML table. Notice that the code consists of the 
&lt;OBJECT&gt; tag for the TDC, plus an HTML table for the display. Also notice the 
DATASRC and DATAFLD attributes that are used to bind the data to the HTML table. 
And that each column within the HTML table has been given an ID. This allows 
us to reference the various columns in our script. Finally, client-side VBScript 
has been used to trap several events: the 
<I>onclick</I> event for the column headers is used to sort the data by the values in that column. Also, the Filter and Reset buttons are used to demonstrate how to filter the data and reset the data back to its original setting. 
</P>
<P>Figure 16-2 shows how this page appears within the Internet Explorer 
4.0 browser. When you click the column headers, you'll see that the table is 
sorted so that the numbers appear in ascending order for that particular column. 
This is done on the client side with no round-trip back to the TDC.csv file.

</P>
<P>
<A HREF="javascript:fullSize('f16lh02x.htm')"> <IMG SRC="images/f16lh02.jpg" width=404 height=284 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 16-2.</B> <I>The TDC.htm file within the Internet Explorer 4.0 browser. </I><!-- /CAPTION -->


</P>
<A NAME="300"><H2>Sorting and Searching Using an HTML Table</H2></A>

<P>The next example takes the functionality of the TDC a little further. We'll 
use the TDC to retrieve information about customers and use an HTML table 
to navigate through the resultset and to search for data by customer ID, 
company name, or contact name.

</P>
<P><div class="note"><blockquote>
<B>Note</B><HR>If you want to add the TDC ActiveX control onto your 
Visual InterDev Toolbox just bring up the Customize Toolbox dialog box 
and then browse through the list of ActiveX controls until you find the 
control with the name <I>Tabular Data Control</I>. This control is named tdc.ocx 
and is usually installed in the C:\WINNT\System32 folder if you are 
running Windows NT. Having the TDC in your Toolbox makes it easy to add it 
to your Web pages instead of having to manually code the &lt;OBJECT&gt; 
tag and the CLASSID attribute.
</blockquote></div>

</P>
<P>The code below shows the source code for TDC_Customer_List.htm. 
This file, along with all the other related files, is included on the CD-ROM under 
the CHAP16 folder.
</P>
<P><PRE>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META name=VI60_defaultClientScript content=VBScript&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;SCRIPT ID=clientEventHandlersVBS LANGUAGE=vbscript&gt;
&lt;!--
Sub Col1_onclick
    CTDCCtl1.Sort = &quot;CustomerID&quot;
    CTDCCtl1.Reset
End Sub
Sub Col2_onclick
    CTDCCtl1.Sort = &quot;CompanyName&quot;
    CTDCCtl1.Reset
End Sub
Sub Col3_onclick
    CTDCCtl1.Sort = &quot;ContactName&quot;
    CTDCCtl1.Reset
End Sub
Sub search_onclick
    If listbox.selectedIndex = 0 Then
        col = &quot;CustomerID&quot;
    Elseif listbox.selectedIndex = 1 Then
        col = &quot;CompanyName&quot;
    Else
        col = &quot;ContactName&quot;
    End If
    str = col &amp; &quot;=&quot; &amp; CStr(find.value)
    MsgBox(str)
    CTDCCtl1.Filter = str
    CTDCCtl1.Reset     
End Sub
Sub reset_onclick
    CTDCCtl1.Filter = &quot;CustomerID=*&quot;
    CTDCCtl1.Reset
End Sub
Sub next_onclick
    datatbl.nextPage
End Sub
Sub previous_onclick
    datatbl.previousPage
End Sub
--&gt;
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;H3&gt;Customer List (Using the Tabular Data Control)&lt;/H3&gt;
&lt;HR&gt;
&lt;TABLE cellpadding=3&gt;
&lt;TR&gt;
&lt;TD&gt;Find&lt;/TD&gt;
&lt;TD&gt;&lt;INPUT id=find name=find&gt;&lt;/TD&gt;
&lt;TD&gt;In Column&lt;/TD&gt;
&lt;TD&gt;
&lt;SELECT id=listbox name=listbox&gt;
&lt;OPTION selected&gt;Customer ID&lt;/OPTION&gt;
&lt;OPTION&gt;Company Name&lt;/OPTION&gt;
&lt;OPTION&gt;Contact Name&lt;/OPTION&gt;
&lt;/SELECT&gt; 
&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;OBJECT classid=clsid:333C7BC4-460F-11D0-BC04-0080C7055A83 
    id=CTDCCtl1 VIEWASTEXT&gt;
    &lt;PARAM NAME=&quot;UseHeader&quot; VALUE=&quot;1&quot;&gt;
    &lt;PARAM NAME=&quot;DataURL&quot; VALUE=&quot;Customers.csv&quot;&gt;
&lt;/OBJECT&gt;
&lt;TABLE id=datatbl BORDER=1 DATASRC=&quot;#CTDCCtl1&quot; DATAPAGESIZE=&quot;8&quot;&gt;
&lt;THEAD&gt;
&lt;TR&gt;
&lt;TH ID=&quot;Col1&quot;&gt;CustomerID
&lt;TH ID=&quot;Col2&quot;&gt;CompanyName
&lt;TH ID=&quot;Col3&quot;&gt;ContactName&lt;/TR&gt;
&lt;TBODY&gt;
&lt;TR&gt;
&lt;TD&gt;&lt;SPAN DATAFLD=CustomerID&gt;&lt;/SPAN&gt;
&lt;TD&gt;&lt;SPAN DATAFLD=CompanyName&gt;&lt;/SPAN&gt;
&lt;TD&gt;&lt;SPAN DATAFLD=ContactName&gt;&lt;/SPAN&gt;&lt;/TR&gt;&lt;/TBODY&gt;
&lt;/TABLE&gt;
&lt;TABLE cellpadding=3&gt;
&lt;TR&gt;
&lt;TD&gt;
&lt;INPUT type=&quot;button&quot; value=&quot; &lt;- &quot; id=previous name=previous&gt;
&lt;/TD&gt;
&lt;TD&gt;
&lt;INPUT type=&quot;button&quot; value=&quot; -&gt; &quot; id=next name=next&gt;
&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
&lt;TABLE cellpadding=3&gt;
&lt;TR&gt;
&lt;TD&gt;
&lt;INPUT type=&quot;button&quot; value=&quot;Search&quot; id=search name=search&gt; 
&lt;/TD&gt;&lt;TD&gt;
&lt;INPUT type=&quot;button&quot; value=&quot;Reset&quot; id=reset name=reset&gt; 
&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;P&gt;
&lt;FONT face=&quot;&quot; size=2 style=&quot;BACKGROUND-COLOR: #ffffff&quot;&gt;
    Click a column heading to sort the table by that column&lt;/FONT&gt; 
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>Figure 16-3 shows the resulting screen when viewed within Internet 
Explorer. You'll notice that the table displays eight rows of data. This 
was accomplished by setting the DATAPAGESIZE attribute within the &lt;TABLE&gt; 
tag as follows:
</P>
<P><PRE>
&lt;TABLE id=datatbl BORDER=1 DATASRC=&quot;#CTDCCtl1&quot; DATAPAGESIZE=&quot;8&quot;&gt;
</PRE>

</P>
<P>
<A HREF="javascript:fullSize('f16lh03x.htm')"> <IMG SRC="images/f16lh03.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 16-3.</B> <I>The TDC_Customer_List.htm file showing how the TDC together with the HTML TABLE element can be used to navigate, search, and sort a client-side recordset.</I><!-- /CAPTION -->

</P>
<P>The previous and next buttons shown in Figure 16-3 allow the end 
user to page through the recordset. This is accomplished by calling the 
<I>previousPage</I> and <I>nextPage</I> methods on the table object. Note that we are not calling 
methods on the TDC here. The methods are executed against the table object 
by referencing its ID, which in this case is <I>datatbl</I>.

</P>
<P>Search functionality is provided via a text box and a drop-down list 
box. The drop-down list box allows the user to specify the column on which 
to perform the search. When the Search button is clicked, the 
<I>search_onclick</I> event fires and the TDC is filtered using the 
<I>filter</I> property. Wildcards also work in this type of search. The Reset button simply resets the filter to include all customer IDs by using a wildcard and retrieves all the data back into the HTML table.

</P>
<P>When you run this code sample, you'll notice how quickly the page 
responds to your input. Using an HTML table is a way to keep the page size 
light and ensure fast download plus fast navigation, searching, and sorting. One 
minor drawback to loading the data on the client side is that there might be some 
delay in loading the page because of the amount of data being retrieved. To 
minimize this effect, you should load only the data you need for your particular 
Web page to carry out the required functionality.

</P>
</BODY>
</HTML>




