<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Dynamic Content</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch07d.htm", "ch07f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="118"><H1>Dynamic Content</H1></A>
<P>Now that we've seen some code examples that change the style and 
position of elements on the screen, let's take a look at some examples that change 
the actual content that is displayed on the screen. Obviously, when dealing 
with content, we need to be able to change both the text that appears on the 
screen and its formatting. We therefore need to be able to change not only text 
itself but also the HTML tags that control the formatting of the text.
</P>
<P>The following example shows how to change the text and HTML 
formatting of various textual elements on the screen. Figure 7-6 comes from 
the DynamicContent.htm file in the Chap07 folder on the CD-ROM.

</P>
<P><B>Figure 7-6.</B> <I> DHTML code showing how to change the text and formatting of 
several elements on a page.</I>

</P>
<P><PRE>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;TITLE&gt;Dynamic Content&lt;/TITLE&gt;
&lt;SCRIPT LANGUAGE=&quot;JScript&quot;&gt;

function changeMe() {
    document.all.MyHeading.outerHTML = 
        &quot;&lt;H1 ID=MyHeading&gt;Dynamic HTML!&lt;/H1&gt;&quot;;
    document.all.MyHeading.style.color = &quot;red&quot;;
    document.all.MyText.innerText = 
        &quot;This text was altered using the innerText property.&quot;;
    document.all.MyText.align = &quot;center&quot;;
    document.body.insertAdjacentHTML(&quot;BeforeEnd&quot;, 
        &quot;&lt;P ALIGN=\&quot;center\&quot;&gt;This text was added using the 
        insertAdjacentHTML property!&lt;/P&gt;&quot;);
}

&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY TOPMARGIN=0 BGPROPERTIES=&quot;FIXED&quot; BGCOLOR=&quot;#FFFFFF&quot; 
    LINK=&quot;#000000&quot; VLINK=&quot;#808080&quot; ALINK=&quot;#000000&quot; 
    onclick=&quot;changeMe()&quot;&gt;

&lt;H2 ID=MyHeading&gt;Dynamic HTML - Dynamic Content Example&lt;/H2&gt;
&lt;HR&gt;
&lt;P ID=MyText&gt;Click anywhere on this page.&lt;/P&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>


</P>
<P>When this code is executed in the browser, you'll notice that the 
heading is changed in several ways. The color, text, and formatting are changed 
using the <I>style.color </I>property and the 
<I>outerHTML</I> property. Also, the alignment of 
text is changed by using the <I>align</I> property and some new text is added to 
the document by using the 
<I>insertAdjacentHTML</I> method.
</P>
<P>The <I>insertAdjacentHTML</I> method has the following syntax:

</P>
<P><PRE>
<I>object</I>.insertAdjacentText(<I>where</I>, <I>text</I>)
</PRE>

</P>
<P>Table 7-1 lists the <I>where</I> parameters for this method and their effects.

</P>
<P><B>Table 7-1.</B> <I> Parameters for the 
</I>insertAdjacentHTML<I> method.</I>

</P>
<P><TABLE CELLPADDING=5 WIDTH="95%">
<TR>
<TH VALIGN="TOP"><B><I>Parameter</I></B></TH>
<TH VALIGN="TOP"><B><I>Description</I></B></TH>
</TR>

<TR>
<TD VALIGN="TOP"><I>BeforeBegin </I></TD>
<TD VALIGN="TOP">Inserts the text immediately before the element</TD>
</TR>

<TR>
<TD VALIGN="TOP"><I>AfterBegin </I></TD>
<TD VALIGN="TOP">Inserts the text after the start of the element but
before all other content in the element</TD>
</TR>
     
<TR>
<TD VALIGN="TOP"><I>BeforeEnd </I></TD>
<TD VALIGN="TOP">Inserts the text immediately before the end of the
element but after all other content in the element</TD>
</TR>

<TR>
<TD VALIGN="TOP"><I>AfterEnd </I></TD>
<TD VALIGN="TOP">Inserts the text immediately after the end of the element</TD>
</TR>
</TABLE>    
     
     
     

</P>
<P>The next example, shown in Figure 7-7, is intended to demonstrate 
some of the differences between the following properties: 
<I>innerText</I>, <I>outerText</I>, 
<I>innerHTML</I>,<I> </I>and <I>outerHTML</I>. The following list describes how each of 
these properties can be applied:

</P>
<UL>
<P><LI><B><I>innerText</I></B>  Sets or retrieves the text between the start and end 
tags of the current element

</LI>
</P>
<P><LI><B><I>outerText</I></B>  Sets or retrieves the text of the current element

</LI>
</P>
<P><LI><B><I>innerHTML</I></B>  Sets or retrieves the HTML between the start and 
end tags of the current element

</LI>
</P>
<P><LI><B><I>outerHTML</I></B>  Sets or retrieves the current element and its 
content in HTML
</LI></P>
</UL>




<P>These properties are useful in manipulating content within a document.

</P>
<P><B>Figure 7-7.</B> <I> DHTML code illustrating the differences between the 
</I>innerText<I>, </I> outerText<I>, </I>innerHTML<I>, and 
</I>outerHTML<I> properties for manipulating content within the browser.</I>     

</P>
<P><PRE>
&lt;HTML&gt;
&lt;HEAD&gt;

&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;TITLE&gt;Dynamic Content&lt;/TITLE&gt;

&lt;SCRIPT ID=clientEventHandlersJS LANGUAGE=javascript&gt;
&lt;!-- 

function submit1_onclick() 
{
    document.all.MyText.innerText = &quot;Changed using innerText&quot;;
}

function submit2_onclick()
{
    document.all.MyText.outerText = &quot;Changed using outerText&quot;;
    alert(&quot;You'll need to click Refresh to get the ID property
        back or you'll get an error!&quot;);
}

function submit3_onclick() 
{
    document.all.MyText.innerHTML = 
        &quot;&lt;B&gt;&lt;I&gt;Changed using innerHTML&lt;/B&gt;&lt;/I&gt;&quot;;
}

function submit4_onclick()
{
    document.all.MyText.outerHTML = 
        &quot;&lt;H4 ID=MyText&gt;&lt;U&gt;Changed using outerHTML&lt;/U&gt;&lt;/H4&gt;&quot;;
}

//--&gt;
&lt;/SCRIPT&gt;

&lt;/HEAD&gt;
&lt;BODY TOPMARGIN=0 BGPROPERTIES=&quot;FIXED&quot; BGCOLOR=&quot;#FFFFFF&quot;
    LINK=&quot;#000000&quot; VLINK=&quot;#808080&quot; ALINK=&quot;#000000&quot;&gt;

&lt;H2&gt;Dynamic HTML - Dynamic Content Example&lt;/H2&gt;
&lt;HR&gt;
&lt;H3 ID=MyText&gt;Example showing functionality of innerText,
    outerText, innerHTML, and outerHTML.&lt;/H3&gt;

&lt;HR&gt;
&lt;INPUT type=&quot;submit&quot; value=&quot;innerText&quot; id=submit1 name=submit1
    LANGUAGE=javascript onclick=&quot;return submit1_onclick()&quot;&gt;
    Changes the text only
&lt;P&gt;
&lt;INPUT type=&quot;submit&quot; value=&quot;outerText&quot; id=submit2 name=submit2
    LANGUAGE=javascript onclick=&quot;return submit2_onclick()&quot;&gt;
    Changes the HTML and text and replaces with just text
&lt;P&gt;
&lt;INPUT type=&quot;submit&quot; value=&quot;innerHTML&quot; id=submit3 name=submit3
    LANGUAGE=javascript onclick=&quot;return submit3_onclick()&quot;&gt;
    Changes the text and adds HTML tags; does not change
        current HTML tags
&lt;P&gt;
&lt;INPUT type=&quot;submit&quot; value=&quot;outerHTML&quot; id=submit4 name=submit4
    LANGUAGE=javascript onclick=&quot;return submit4_onclick()&quot;&gt;
    Changes the text and the HTML
&lt;HR&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>Figure 7-7 allows you to experiment with these various properties and 
see how the text within the browser is altered. The code comes from 
the DynamicContent2.htm file in the Chap07 folder on the CD-ROM. Note that 
if you choose the <I>outerText </I>property you'll lose the ID of the text element 
and you'll need to refresh the page to be able to continue applying various 
properties. The reason for this is that the 
<I>outerText</I> property replaces both the text of the element and its surrounding HTML so that the ID attribute is 
replaced along with all the rest of the HTML formatting.
</P>
<P>Figure 7-8 shows the view within Visual InterDev 6.0 when running 
this code sample.

</P>
<P><A HREF="javascript:fullSize('f07lh08x.htm')"> <IMG SRC="images/f07lh08.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 7-8.</B> <I> The output of DynamicContent2.htm.</I><!-- /CAPTION -->

</P>
<P><div class="note"><blockquote>
<B>Note</B><HR>The <I>innerText</I>, <I>outerText</I>, 
<I>innerHTML</I>, and <I>outerHTML</I> properties do not apply to text elements only. For example, the 
<I>outerText</I> property applies to the following HTML elements: A, ACRONYM, 
ADDRESS, APPLET, AREA, B, BGSOUND, BIG, BLOCKQUOTE, BR, 
BUTTON, CENTER, CITE, CODE, COMMENT, DD, DEL, DFN, DIR, DIV, DL, 
DT, EM, EMBED, FIELDSET, FONT, FORM, H1, H2, H3, H4, H5, H6, HR, 
I, IFRAME, IMG, INPUT, INS, KBD, LABEL, LEGEND, LI, LISTING, 
MAP, MARQUEE, MENU, OBJECT, OL, P, PLAINTEXT, PRE, Q, S, 
SAMP, SELECT, SMALL, SPAN, STRIKE, STRONG, SUB, SUP, 
TABLE, TEXTAREA, TT, U, UL, VAR, XMP. See the Visual InterDev online 
documentation for complete details of which property supports which 
HTML elements.
</blockquote></div>

</P>
<A NAME="119"><H2>Using Design View with DHTML</H2></A><P>Visual InterDev 6.0 supports DHTML in Microsoft Internet Explorer 4 (or 
any other DHTML-capable browser). The Visual InterDev 6.0 editor helps you 
create script for DHTML objects and events by presenting 
statement-completion options for the object model, and also by displaying the object model 
hierarchy in the Script Outline window. As well as scripting directly to the 
Internet Explorer 4 object model, you can choose to have your design-time 
controls (DTCs) create client-side data-binding script.
</P>
<P>There are two ways to place controls on the page from the Toolbox: 
either drag them from the Toolbox or double-click them (placing the control 
in the upper left corner of the page).
</P>
<P>One of the nicest features of DHTML is the ability to absolutely 
position elements on a page. Once a control is on the page, it can be absolutely 
positioned by dragging it to a new location. However, you need to turn this capability 
on before it will work. The Design toolbar, shown in Figure 7-9, contains the 
key. By first selecting the control you are interested in, and then clicking the 
Absolute Positioning button on the toolbar, you can position the control 
anywhere on the page.

</P>
<P><A HREF="javascript:fullSize('f07lh09x.htm')"> <IMG SRC="images/f07lh09.jpg" width=404 height=91 border=0 ALT="Click to view at full size."> </A>
</P>
<P>
<!-- CAPTION --><B>Figure 7-9.</B> <I> The Design toolbar.</I><!-- /CAPTION -->

</P>
<P>Remember that the Design toolbar is active only while you are 
viewing the Design tab. (It's easy to Quick View the page and then wonder why 
the toolbar isn't active.) Also, the control you wish to place absolutely needs to 
be selected with the four-headed arrow (by moving the pointer over the 
control border) before the Absolute Positioning button will be active.
</P>
<P>Here's a little shortcut that can save you time when you are adding a 
lot of controls to a page. Activate Absolute Mode by clicking the Absolute 
Mode button on the Design toolbar. In Absolute Mode, if you place controls on a 
page by double-clicking, it won't have any effect&#8212;the controls will still appear in 
the upper left corner of the page. However, if you drag them from the 
Toolbox, they'll stay right where you drop them.
</P>
<P>Want to see where breaks and other nonvisual HTML elements are 
placed? No problem. Use the Show Details button on the Design toolbar and glyphs 
for nonvisual elements will appear.
</P>
<P>Unfortunately, DTCs cannot be absolutely positioned (as evidenced by 
the fact that none of the Design toolbar buttons are enabled when working 
with DTCs). In order to absolutely position DTCs you'll need to resort to the old 
HTML table tricks.

</P>
</BODY>
</HTML>




