<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>The Browser Capabilities Component</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch17d.htm", "ch17f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="316"><H1>The Browser Capabilities Component</H1></A>
<P>The recent plethora of new Web technologies has created a dilemma for 
Web authors. Which technologies do you use to design your Web pages? 
VBScript (Visual Basic, Scripting Edition), ActiveX controls, Java applets, frames, and 
cascading style sheets are each supported in some browsers but not in others. 
So do you write applications that only the most technically capable browsers 
can use? Or do you write for the lowest common denominator?

</P>
<P>The Browser Capabilities component helps you solve this problem. 
You can check a browser's capabilities and send HTML that you know the 
browser can handle.

</P>
<P>When a browser requests a page from your Web server, it sends 
some information about itself in the HTTP user agent header of the request. 
The Browser Capabilities<B> </B>component compares this information to a list of 
browsers that it keeps in a file named browscap<I>.</I>ini. This file also has information 
about each browser's abilities. The Browser Capabilities component can then 
return information from the browscap.ini file for your use.

</P>
<P>This component doesn't actually know anything more about a 
browser than you tell it in the browscap.ini file. It is strictly an engine for looking 
up already recorded capabilities. The more robust you make your browscap.ini 
file, the more information you'll have available in your application. 
Thankfully, Microsoft has provided a fairly extensive browscap.ini file. It covers 
browsers produced by Microsoft, Netscape, and Oracle. It is installed in different 
directories based on whether you're using Microsoft Windows 95 or Microsoft 
Windows NT and where your installation is. Therefore, do a search 
(Start|Find|Files or Folders) for browscap.ini.

</P>
<A NAME="317"><H2>The browscap.ini File</H2></A><P>The browscap.ini file's layout is like any other .ini file, and it must be in 
the same directory as the component itself (the browscap.dll file). The default 
location for these files in IIS is C:\WINNT\system32\inetsrv.

</P>
<P>Within the browscap.ini file, each browser definition has its own 
section and each section has any number of properties that you can set. You can 
also insert comments in the browscap.ini file, which are indicated by a 
semicolon (;). You can use comments anywhere in the file.

</P>
<P>The HTTP user agent header within browscap.ini defines a 
browser's section. It must be enclosed in brackets, as shown here:

</P>
<P><PRE>
[IE 4.0]
</PRE>

</P>
<P>You can use an asterisk as a wildcard in the HTTP user agent header. 
If the Browser Capabilities component cannot find the exact HTTP header, it 
tries to find the header by substituting any wildcards in the header. If more than 
one header matches the user agent header sent by the browser, the first 
matching header is used. For example,

</P>
<P><PRE>
[Mozilla/2.0 *]
</PRE>

</P>
<P>matches

</P>
<P><PRE>
[Mozilla/2.0 (compatible; MSIE 3.0; AK; Windows 95)]
</PRE>

</P>
<P>and

</P>
<P><PRE>
[Mozilla/2.0 (compatible; MSIE 3.0B; Windows 95;1600,1280)]
</PRE>

</P>
<P>but it does not match

</P>
<P><PRE>
[Mozilla/3.01b1 (Macintosh; I; PPC)]
</PRE>

</P>
<P>Within a section, you define any number of properties and their 
values. A property name must begin with a letter and cannot be longer than 255 
characters. Below is a section from the browscap.ini file that comes with IIS 4.0.

</P>
<P><PRE>
[IE 4.0]
browser=IE
Version=4.0
majorver=4
minorver=0
frames=TRUE
tables=TRUE
cookies=TRUE
backgroundsounds=TRUE
vbscript=TRUE
javascript=TRUE
javaapplets=TRUE
ActiveXControls=TRUE
Win16=False
beta=False
AK=False
SK=False
AOL=False
crawler=False
cdf=True
</PRE>

</P>
<P>A property can have three types of values. By default, a value is a 
string. You can make it an integer by prefacing it with a number sign (#). The 
<I>majorver</I> and <I>minorver</I> properties of Internet Explorer 4.0 are set to integers. You 
can set a property to a Boolean value by assigning it True or False.

</P>
<P>There is one special property named <I>parent</I> whose value is the HTTP 
user agent header of another section from which you want to inherit properties, 
as shown here:

</P>
<P><PRE>
;;ie 4 beta 1
[Mozilla/4.0 (compatible; MSIE 4.0b1; Windows 95)]
parent=IE 4.0
platform=Win95
beta=True
cdf=False
</PRE>

</P>
<P>In this section, the <I>parent</I> property is set to 
<I>IE 4.0. </I>This section inherits all the properties from the IE 4.0 section. It also sets the 
<I>platform</I> property (which is not defined in its parent), sets the 
<I>beta </I>property to True, and sets the 
<I>cdf</I> property to False. The <I>beta</I> property is set to False in the IE 4.0 section, but 
the value is overridden in this section, as is the 
<I>cdf</I> value.

</P>
<P>The browscap.ini file also supports a section for a default browser, 
shown below. You can use this to define what you consider the minimum base 
capabilities that you want to define in your application.

</P>
<P><PRE>
[Default Browser Capability Settings]
browser=Default
Version=0.0
majorver=#0
minorver=#0
frames=False
tables=True
cookies=False
backgroundsounds=False
vbscript=False
javascript=False
javaapplets=False
activexcontrols=False
AK=False
SK=False
AOL=False
beta=False
Win16=False
Crawler=False
cdf=False
AuthenticodeUpdate=
</PRE>

</P>
<P>The programmatic ID of the <I>BrowserType</I> object is 
<I>MSWC.BrowserType</I>, and the DLL that implements the component is named browscap.dll. The 
syntax for creating the object is

</P>
<P><PRE>
&lt;OBJECT RUNAT=server PROGID=MSWC.BrowserType id=oBrowsCap&gt;&lt;/OBJECT&gt;
</PRE>

</P>
<P>This instantiates the <I>BrowserType</I> object and assigns it to the variable 
<I>oBrowsCap.</I>

</P>
<P>The properties in the browscap.ini file define the properties for the 
<I>BrowserType</I> object. To add another property, you simply add the property to the 
.ini file. If the property is not found for a particular browser, it has a value of 
<I>Unknown</I>. If the browser itself is not found in the .ini file and no default 
browser section is defined, all the properties have a value of 
<I>Unknown.</I>

</P>
<P>The <I>BrowserType</I> object has no methods.

</P>
<A NAME="318"><H2>Using the Browser Capabilities Component in an ASP Web page</H2></A><P>The following code example displays the capabilities of the browser on an ASP 
Web page. The code is taken from the BrowserCapabilities.asp file in the 
Components Web project on the CD-ROM. Figure 17-6 shows the page's output.

</P>
<P><PRE>
&lt;%@ Language=VBScript %&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;H2&gt;Browser Capabilities Sample&lt;/H2&gt;
&lt;HR&gt;

&lt;OBJECT RUNAT=server PROGID=MSWC.BrowserType id=oBrowsCap&gt; &lt;/OBJECT&gt;

&lt;Table border=1&gt;
&lt;tr&gt;
&lt;td&gt;Browser Name&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.Browser %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;Browser Version&lt;/td&gt;            
&lt;td&gt; &lt;%=oBrowsCap.Version %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;Major Version&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.Majorver %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;Minor Version&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.Minorver %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;Frame Support&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.Frames %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;Table Support&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.Tables %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;Cookie Support&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.Cookies %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;Background Sound Support&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.BackgroundSounds %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;VBScript Support&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.VBScript %&gt; &lt;/td&gt;
&lt;tr&gt;
&lt;td&gt;JavaScript Support&lt;/td&gt;
&lt;td&gt; &lt;%=oBrowsCap.JavaScript %&gt; &lt;/td&gt;
&lt;/table&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>
<A HREF="javascript:fullSize('f17lh06x.htm')"> <IMG SRC="images/f17lh06.jpg" width=404 height=339 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 17-6.</B> <I>Output from the BrowserCapabilities.asp page.</I><!-- /CAPTION -->

</P>
<P>There are many potential uses for the Browser Capabilities 
component. For example, if you want to play a background sound in your default or 
application home page and the browser is capable, you simply include an 
<I>If&#8230;Then </I>statement to check the browser's ability, as shown below:

</P>
<P><PRE>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;TITLE&gt;Document Title&lt;/TITLE&gt;
&lt;/HEAD&gt;

&lt;BODY&gt;
&lt;%
If Session(&quot;oBrowsCap&quot;).Backgroundsounds Then
%&gt;
    &lt;BGSOUND SRC=&quot;sounds/jingle.wav&quot;&gt;
&lt;%
End If
%&gt;

&lt;!-- Page Content Here --&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>Of course, this is not a particularly dramatic example of what you can 
do with this component. You can, for example, have an application written 
twice&#8212;once for frame-compatible browsers and once for browsers that are not 
frame-compatible. You can also use the 
<I>Redirect</I> method of the <I>Response </I>object to 
jump to the correct point from the default page based on the Browser 
Capabilities component. 

</P>
</BODY>
</HTML>




