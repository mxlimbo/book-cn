<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Certificate Server</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch23c.htm", "ch23e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="411"><H1>Certificate Server</H1></A>
<P>Microsoft Certificate Server is a general-purpose, highly customizable 
server application for managing the issuance, revocation, and renewal of digital 
certificates. Digital certificates are used for public-key cryptography 
applications such as server and client authentication under the Secure Sockets Layer 
(SSL) or Private Communication Technology (PCT) protocols. With Certificate 
Server, organizations can perform authentication in an Internet, intranet, or 
extranet environment through the use of these certificates.

</P>
<P>Certificate Server is primarily for Web applications that require 
authentication and secure communication by using SSL. However, it is also applicable 
to other certificate-based applications such as Secure Mulitpurpose Internet 
Mail Extensions (S/MIME), Secure Electronics Transactions (SET) protocol, 
and Authenticode. Certificate Server can issue certificates for both clients and 
servers in the X.509 version 3 format.

</P>
<A NAME="412"><H2>Installing Certificate Server</H2></A><P>Installation of Certificate Server is accomplished by using the Windows NT 
4.0 Option Pack. The total disk space requirements for Certificate Server are 
just 11.8 MB. In fact, 9.9 MB of that space is occupied by the Certificate Server 
online documentation. The minimum hardware requirements for Certificate Server 
are the same as those for IIS 4.0. The installation is a wizard-driven process that 
takes only a couple of minutes to complete. During installation, you'll be 
prompted to either choose to create a root certificate for the certificate authority 
being created or to create a certificate request file that you can use to obtain a 
certificate from another CA. How you respond to this prompt should be based 
upon whether you want Certificate Server to be the root CA at the top of the 
CA hierarchy or you want it to be a nonroot CA that participates in an 
already established CA hierarchy. 

</P>
<P>After you have completed the installation of Certificate Server, you 
will need to either reboot your machine or manually start the Certificate 
Authority service. For a manual start, choose Start|Settings|Control Panel and then 
choose Services. You should then select the Certificate Authority service from the 
list in the Services dialog box and select Start, as shown in Figure 23-1.

</P>
<P>
<A HREF="javascript:fullSize('f23LH01x.htm')"> <IMG SRC="images/f23LH01.JPG" width=404 height=224 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-1.</B> <I>The Certificate Authority service in the Services dialog box in 
the Windows NT 4.0 Control Panel.</I><!-- /CAPTION -->

</P>
<A NAME="413"><H2>Certificate Server Architecture</H2></A><P>Certificate Server has a server engine and database as well as other 
modules that communicate with the server engine to perform various tasks. 
External applications, such as those written in Microsoft Visual Basic, Microsoft 
Visual C++, Microsoft Visual J++, and Visual InterDev (Active Server Pages), can 
interact with the server engine via COM interfaces. The other modules in 
the architecture include administration tools, policy module, extension 
handlers, intermediary, and exit modules, as shown in Figure 23-2.

</P>
<P>
<A HREF="javascript:fullSize('F23lh02x.htm')"> <IMG SRC="images/F23lh02.JPG" width=404 height=226 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-2.</B> <I>The Certificate Server architecture, showing the server engine and 
the server database modules.</I><!-- /CAPTION -->

</P>
<P>Some of the interfaces available in Certificate Server are shown in 
Table 23-1. This will be of interest later on as we start writing ASP code within 
Visual InterDev 6.0 to programmatically access Certificate Server functionality.
</P>
<P>
<B>Table 23-1.</B> <I>Interfaces imported and exported by the server engine of Certificate Server.</I>
</P>
<P>
<table cellpadding=5 width="95%">

<TR>
<TH VALIGN="top"><B><I>Interface</I></B></TH>
<TH VALIGN="top"><B><I>Description</I></B></TH>
</TR>

<TR>
<TD VALIGN="top"><I>ICertConfig</I></TD>
<TD VALIGN="top"> Used by clients to get information about a server</TD>
</TR>

<TR>
<TD VALIGN="top"><I>ICertRequest</I></TD>
<TD VALIGN="top">Used to send a request to the server and get the result of the request</TD></TR>

<TR>
<TD VALIGN="top"><I>ICertAdmin</I></TD>
<TD VALIGN="top">Used by administration programs to manage requests, certificates, and revocation</TD>
</TR>

<TR>
<TD VALIGN="top"><I>ICertServerPolicy</I></TD>
<TD VALIGN="top">Used by the policy module to get and set certificate and request properties</TD>
</TR>

<TR>
<TD VALIGN="top"><I>ICertServerExit</I></TD>
<TD VALIGN="top">Used by exit modules to get and set certificate and request properties</TD>
</TR>

<TR>
<TD VALIGN="top"><I>ICertExit</I></TD>
<TD VALIGN="top"> Exported by exit modules; used by the server engine to deliver finished certificates and revocation information</TD>
</TR>

<TR>
<TD VALIGN="top"><I>ICertPolicy</I></TD>
<TD VALIGN="top">Exported by the policy module; used by the 
server engine to check requests and get properties 
for certificates</TD>
</TR>
</TABLE>

</P>
<P>To work with Certificate Server, you access it via the browser. You can 
get to the administration tools at<I> 
http://localhost/certsrv</I>. Figure 23-3 shows the 
main administration page for Certificate Server.

</P>
<P>
<A HREF="javascript:fullSize('f23LH03x.htm')"> <IMG SRC="images/f23LH03.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-3.</B> <I>The main administration page for Certificate Server.</I><!-- /CAPTION -->

</P>
<P>Here you can access four different items: the Certificate Administration 
Log Utility, the Certificate Administration Queue Utility, the Certificate 
Enrollment Tools, and the Certificate Server Documentation. Interestingly enough, many 
of these utilities are written in Active Server Pages. The database used to 
store certificate information is a Microsoft Access database named certsrv.mdb. As 
you can see in Figure 23-2, the server database is divided into two parts: the 
server queue and the server log. The server queue maintains a list of all 
certificate requests, and the server log maintains copies of all issued certificates. The 
certificate enrollment page has several links for installing CA certificates, 
processing certificate requests, and requesting client authentication certificates 
for Microsoft Internet Explorer and Netscape Navigator.

</P>
<A NAME="414"><H2>Installing a CA Certificate into Your Browser</H2></A><P>A CA certificate is the digital certificate that authenticates the certificate 
authority that you are using. It's essentially the ID card for the CA. For your browser 
to enter into a dialog with a CA, the CA's certificate needs to be installed into 
your browser.

</P>
<P>To install a CA certificate into your browser, you can either install a 
certificate from a third-party CA such as VeriSign or install the root CA 
certificate that has been generated for you by Certificate Server.

</P>
<P>To install a root CA certificate into the Internet Explorer 4.0 browser 
from Certificate Server, follow these steps:

</P>
<OL>
<P><LI>Make sure that Certificate Server is installed and has been 
configured as a root CA.

</LI>
</P>
<P><LI>Go into the main administration page of Certificate Server at 
<I>http://localhost/certsrv</I>, and click the Certificate Enrollment 
Tools hyperlink.

</LI>
</P>
<P><LI>Select the Install Certificate Authority Certificates option.

</LI>
</P>
<P><LI>Select the certificate that you have generated from Certificate 
Server by clicking the appropriate hyperlink, as shown in Figure 23-4.

</LI>
</P>
<P><LI>In the File Download dialog box, choose Open This File From 
Its Current Location and click OK.

</LI>
</P>
<P><LI>Click OK in the New Site Certificate dialog box.
</LI>
</P>
</OL>




<P>Within Internet Explorer 4.0, you can check that the CA certificate has 
been installed correctly by choosing Internet Options from the View menu and 
then selecting the Content tab. Next click the Authorities button in the 
Certificates group box. You'll now be presented with a list of CAs whose certificates 
have been installed into your browser. From here you have the ability either to 
view the details of the certificate or to delete the certificate. 

</P>
<P>
<A HREF="javascript:fullSize('f23LH04x.htm')"> <IMG SRC="images/f23LH04.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 23-4.</B> <I>The Certificate Authority Certificate List page. This page 
allows you to install a CA certificate into your browser.</I><!-- /CAPTION -->

</P>
</BODY>
</HTML>




