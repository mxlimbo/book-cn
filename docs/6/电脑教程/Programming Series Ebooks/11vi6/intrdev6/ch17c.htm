<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Using Server Objects from the Toolbox</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch17b.htm", "ch17d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="310"><H1>Using Server Objects from the Toolbox</H1></A>
<P>Some interesting server-side ActiveX components are available to the 
Visual InterDev developer via the Server Objects tab of the Visual InterDev 6.0 
Toolbox. Figure 17-4 below shows the available components. These 
components address common challenges facing Web developers, such as 
determining the type of browser that is requesting a page, sending e-mail from 
within ASP code, or reading and writing text files. These components can save 
you many hours of development time while they increase the functionality 
and interactivity of your applications.

</P>
<P>
<IMG SRC="images/f17lh04.gif" width=159 height=458 border="0">

</P>
<P>
<!-- CAPTION --><B>Figure 17-4.</B> <I> The Server Objects tab of the Visual InterDev 6.0 Toolbox showing the server objects available for use in your applications.</I><!-- /CAPTION -->

</P>
<P>To access the server objects on the Toolbox, all you need to do is 
open a new or existing ASP Web page within the Visual InterDev environment. 
This will enable all of the server object icons on the Server Objects tab so that 
you can drag them from the Toolbox onto your Web page.

</P>
<P><div class="note"><blockquote>
<B>NOTE</B><HR>The list of objects on the Server Objects tab is predefined. 
This means that the list is the same no matter what workstation or server 
you are on. There is a chance that a server object that is displayed on 
the Toolbox might not actually be installed on your server. Always be sure 
to test your pages to ensure they are running correctly and the relevant 
server objects are installed on your server. The server objects are part of the 
IIS 4.0 installation, so if they are missing you'll want to install them from 
the Windows NT 4.0 Option Pack.
</blockquote></div>

</P>
<P>When you drag an object from the Server Object tab of the Toolbox 
onto your ASP Web page, the editor will create an &lt;OBJECT&gt; block for you with 
the correct RUNAT and PROGID attributes. After specifying the id that you 
would like to use for the object, you can reference it in your script. For example, 
if you drag a Collaboration Data Objects for Windows NT Server (CDONTS) 
Library <I>NewMail</I> object onto your Web page, the &lt;OBJECT&gt; block looks like this:

</P>
<P><PRE>
&lt;OBJECT RUNAT=server PROGID=CDONTS.NewMail id=OBJECT1&gt;&lt;/OBJECT&gt;
</PRE>

</P>
<P>First you'll want to rename the id for the <I>NewMail</I> object to something more meaningful, such as <I>oNewMail</I>:

</P>
<P><PRE>
&lt;OBJECT RUNAT=server PROGID=CDONTS.NewMail id=oNewMail&gt;&lt;/OBJECT&gt;
</PRE>

</P>
<P>Now you can reference the <I>NewMail</I> object in your script, as shown here:

</P>
<P><PRE>
&lt;%
oNewMail.From = nick.evans@us.pwcglobal.com
oNewMail.To = nick.evans@us.pwcglobal.com
oNewMail.Subject = &quot;CDONTS&quot;
oNewMail.Body = &quot;This NewMail object makes sending e-mail simple!&quot;
oNewMail.Send
Set oNewMail = Nothing
%&gt;
</PRE>

</P>
<P>The complete ASP code for this example would look like this:

</P>
<P><PRE>
&lt;@ Language=VBScript %&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;OBJECT RUNAT=server PROGID=CDONTS.NewMail id=oNewMail&gt;&lt;/OBJECT&gt;

&lt;%
oNewMail.From = nick.evans@us.pwcglobal.com
oNewMail.To = nick.evans@us.pwcglobal.com
oNewMail.Subject = &quot;CDONTS&quot;
oNewMail.Body = &quot;This NewMail object makes sending e-mail simple!&quot;
oNewMail.Send
Set oNewMail = Nothing
%&gt;

&lt;P&gt;&amp;nbsp;&lt;/P&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

</P>
<P>In this listing, you'll notice that the &lt;OBJECT&gt; block lies within the 
HTML source code and not within the ASP script blocks. We'll be learning more 
about the CDONTS objects for working with e-mail later in this chapter.

</P>
<P>Returning to the Toolbox, you'll see that the components listed on 
the Server Objects tab are as follows:

</P>
<UL>
<P><LI><B>ADO Command</B> ActiveX Data Objects <I>Command</I> object for specifying the parameters necessary to execute a database command such as a SQL statement
</LI>
</P>
<P><LI><B>ADO Connection</B> ActiveX Data Objects <I>Connection</I> object for specifying the parameters necessary to make a database connection
</LI>
</P>
<P><LI><B>ADO Recordset</B> ActiveX Data Objects <I>Recordset</I> object that stores the resultset from a database command
</LI>
</P>
<P><LI><B>Ad Rotator</B> Automatically rotates advertisements displayed on 
a page according to a specified schedule
</LI>
</P>
<P><LI><B>Browser Capabilities</B> Determines the capabilities, type, and 
version of each browser that accesses your site
</LI>
</P>
<P><LI><B>Content Linking</B> Creates tables of contents for Web pages 
and links them sequentially, like pages in a book
</LI>
</P>
<P><LI><B>My Info</B> Creates a <I>MyInfo</I> object that keeps track of the site 
administrator's name, address, and so on
</LI>
</P>
<P><LI><B>Dictionary</B> VBScript object that stores data key and item pairs
</LI>
</P>
<P><LI><B>Filesystem Object</B> VBScript object that provides access to 
file input and output
</LI>
</P>
<P><LI><B>CDONTS NewMail</B> <I>NewMail</I> object for sending e-mail 
message; part of the Microsoft CDONTS Library
</LI>
</P>
<P><LI><B>CDONTS Session</B> <I>Session</I> object for storing session-wide 
settings and options; part of the Microsoft CDONTS Library
</LI>
</P>
<P><LI><B>Index Server Query</B> Object for writing customized queries 
against Index Server
</LI>
</P>
<P><LI><B>Index Server Utility</B> Object that provides various utilities for 
developers who are using the Index Server <I>Query</I> object
</LI>
</P>
<P><LI><B>MSMQ Query</B> Microsoft Message Queue <I>Query</I> object
</LI>
</P>
<P><LI><B>MSMQ QueueInfo</B> Microsoft Message Queue 
<I>QueueInfo</I> object
</LI>
</P>
<P><LI><B>MSMQ Message</B> Microsoft Message Queue <I>Message</I> object
</LI>
</P>
<P><LI><B>MSMQ MailEMail</B> Microsoft Message Queue <I>MailEMail</I> object
</LI></P>
</UL>

<P>In addition to these components, IIS 4.0 also provides the following 
components that are not shown on the Toolbox but can be used nonetheless:

</P>
<UL>
<P><LI><B>Content Rotator</B> Similar to the Ad Rotator above but can 
work with any type of content&#8212;including text, images, or hyperlinks
</LI>
</P>
<P><LI><B>Counters</B> Creates a <I>Counters</I> object that can create, store, 
increment, and retrieve any number of individual counters
</LI>
</P>
<P><LI><B>Page Counter</B> Creates a 
<I>PageCounter</I> object that counts and displays the number of times a Web page has been opened
</LI>
</P>
<P><LI><B>Permission Checker</B> Creates a <I>PermissionChecker</I> object that uses the password authentication protocols in IIS to determine whether a Web user has been granted permissions to read a file
</LI>
</P>
<P><LI><B>Status</B> Creates a <I>Status</I> object that contains server status 
information; currently only available on Personal Web Server for Macintosh
</LI>
</P>
<P><LI><B>Tools</B> Creates a <I>Tools</I> object that has a variety of utilities
</LI></P>
</UL>

<P>For more information on these additional components, please see 
the online Internet Information Server documentation within the Windows NT 
4.0 Option Pack documentation. This documentation can be found by 
choosing Start|Programs|Windows NT 4.0 Option Pack|Product Documentation.

</P>
<P>In this chapter, we'll take a look at some of the above components 
in greater detail. Since the ADO components have been covered in earlier 
chapters, and the MSMQ components have their own chapter, we'll concentrate 
on the following components:

</P>
<UL>
<P><LI>Ad Rotator
</LI>
</P>
<P><LI>Browser Capabilities
</LI>
</P>
<P><LI>Content Linking
</LI>
</P>
<P><LI>Dictionary
</LI>
</P>
<P><LI>Filesystem Object
</LI>
</P>
<P><LI>CDONTS NewMail
</LI>
</P>
<P><LI>CDONTS Session
</LI>
</P>
<P><LI>Index Server Query
</LI>
</P>
<P><LI>Index Server Utility
</LI>
</P>
<P><LI>Permission Checker
</LI></P>
</UL>

<P>Sample code for all of these components is contained on the 
CD-ROM under the Components Web project. There's a main page named 
default.htm that gives you links to all of the examples. Figure 17-5 shows the main 
Component Samples page.

</P>
<P>
<A HREF="javascript:fullSize('f17lh05x.htm')"> <IMG SRC="images/f17lh05.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 17-5.</B> <I>The Component Samples page from the Components Web project on the companion CD-ROM has hyperlinks to all the code samples.</I><!-- /CAPTION -->

</P>

</BODY>
</HTML>




