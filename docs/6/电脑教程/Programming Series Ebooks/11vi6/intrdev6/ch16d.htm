<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="Library.css" TYPE="text/css">
<TITLE>Using the XML Data Source Object</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch16c.htm", "ch16e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>
<A NAME="301"><H1>Using the XML Data Source Object</H1></A>
<P>To use the XML data source object, you'll need to ensure that you have 
the XMLDSO.class file installed on your Web server. You can obtain this class 
file by downloading the Microsoft XML Parser in Java from the Microsoft Web 
site. After installation, the class file should be located in the following 
folder: c:\msxml\classes\com\ms\xml\dso.

</P>
<P>Now all we need to do is to create an XML file to use as our data file, 
an HTML file that contains the XML data source applet, plus some 
data-bound HTML elements to display the data. The code below shows the source code 
for xml.htm. This file is included on the CD-ROM under the CHAP16 folder 
along with the other relevant files.
</P>
<P><PRE>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META NAME=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio 6.0&quot;&gt;
&lt;TITLE&gt;&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;H2&gt;Simple Table (Using XML Data Source Object)&lt;/H2&gt;
&lt;HR&gt;
&lt;APPLET CODE=com.ms.xml.dso.XMLDSO.class
    ID=&quot;xmldso&quot;
    WIDTH=&quot;0&quot;
    HEIGHT=&quot;0&quot;
    MAYSCRIPT=&quot;true&quot;&gt;
    &lt;PARAM NAME=&quot;url&quot; VALUE=&quot;xml.xml&quot;&gt;
&lt;/APPLET&gt;

&lt;TABLE ID=table border=2 width=&quot;50%&quot; datasrc=#xmldso cellpadding=5&gt;
&lt;THEAD&gt;
&lt;TH&gt;1st&lt;/TH&gt;
&lt;TH&gt;2nd&lt;/TH&gt;
&lt;/THEAD&gt;
&lt;TR&gt;
&lt;TD&gt;&lt;SPAN datafld=&quot;FIRST&quot; dataformatas=&quot;HTML&quot;&gt;&lt;/SPAN&gt;&lt;/TD&gt;
&lt;TD&gt;&lt;SPAN datafld=&quot;SECOND&quot; dataformatas=&quot;HTML&quot;&gt;&lt;/SPAN&gt;&lt;/TD&gt;
&lt;/TR&gt;
&lt;/TABLE&gt;

&lt;/BODY&gt;
&lt;/HTML&gt; 
</PRE>

</P>
<P>You'll notice in the code that the &lt;APPLET&gt; tag is used to define the 
XML data source object. The URL attribute in the &lt;PARAM&gt; tag is used to specify 
the URL location of the XML file to read. In this case, the file is named xml.xml 
and the contents are the same as the sample XML file listed earlier in this 
chapter. The width and height of the applet are set to 0 so that the applet does not 
display on screen.

</P>
<P>Notice that an HTML table is used to display the data from the XML 
file. The DATASRC attribute of the table element is set to #XMLDSO, which is 
the name assigned to this XML data source applet. The DATAFLD attributes for 
the table cells are set to FIRST and SECOND. These are the names of the tags 
that were defined in the XML file. The DATAFORMATAS attribute has been set 
to HTML.

</P>
<P>Figure 16-4 shows the HMTL page as it appears in the Internet 
Explorer 4.0 browser.

</P>
<P>As you can see from this sample, it is very easy to write HTML code 
that can read an XML file and display the data on screen. The powerful part of 
this technique is that it is extensible. The XML file can use whatever tags are 
necessary to represent the data structures involved.

</P>
<P>
<A HREF="javascript:fullSize('f16lh04x.htm')"> <IMG SRC="images/f16lh04.jpg" width=404 height=271 border=0 ALT="Click to view at full size."> </A>

</P>
<P>
<!-- CAPTION --><B>Figure 16-4.</B> <I>The xml.htm file, which uses the XML data source object to display the data from an XML file. </I><!-- /CAPTION -->

</P>
</BODY>
</HTML>




