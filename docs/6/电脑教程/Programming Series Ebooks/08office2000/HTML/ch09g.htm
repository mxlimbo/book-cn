<HTML>
<HEAD>
<TITLE>The Mortgage Variables Form</TITLE>
<link rel="STYLESHEET" type="text/css" href="webcomp.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch09f.htm">[Previous]</A> <A HREF="ch09h.htm">[Next]</A><P>

<A NAME="189"><H1>The Mortgage Variables Form</H1></A>

<P>When first running this solution, you will see a form presented in your browser 
asking you for the assorted loan variables mentioned earlier. The page initially looks 
like Figure 9-2.</P>

<P>
<A HREF="javascript:fullSize('f09pi02x.htm')"> <img src="images/f09pi02.JPG" width=404 height=195 border=0 ALT="Click to view at full size."> </A>
</P><P>
<!-- CAPTION --><B>Figure 9-2.</B> <I>The mortgage calculation input form.</I><!-- /CAPTION -->
</P>

<P>This form is generated from the ASP script, and certain parts are included 
only if the browser supports COM controls. Here is the section of the Default.asp 
page where I generate the form:</P>

<P><table cellpadding=5 width="95%"><tr><td>
<PRE>
<img src="images/grayvellip.JPG" width=3 height=13 border="0">
' ASP code above
If m_fUseCSS Then
%&gt;
&lt;td valign=middle&gt;&lt;p 
style=&quot;font-family:Tahoma;font-size:18pt;font-weight:bold;&quot;&gt;
The Mortgage Calculator&lt;/p&gt;&lt;/td&gt;
&lt;%
Else
%&gt;
&lt;td valign=middle&gt;&lt;p&gt;&lt;font face=Tahoma size=5&gt;&lt;b&gt;
The Mortgage Calculator&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;/td&gt;
&lt;%
End If
%&gt;
&lt;td align=right&gt;&lt;img src="PoweredByMSOWC.gif"&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;

&lt;form action=&quot;Default.asp&quot; method=Get&gt;
&lt;p&gt;&lt;font face=Verdana size=2&gt;
I'm interested in mortgage information for a house that costs $
&lt;input type=&quot;text&quot; name=&quot;Price&quot; size=8 value=&lt;%= m_nPrice %&gt;&gt;
and I am willing to pay
&lt;input type=&quot;text&quot; name=&quot;PctDown&quot; size=2 value=&lt;%= m_nPctDown * 100 %&gt;&gt;
% as a down payment. I also want to pay an extra $
&lt;input type=&quot;text&quot; name=&quot;AddPayment&quot; size=8 value=&lt;%= m_nAddPayment %&gt;&gt;
each payment toward reducing the principal. 
Assume that I want a
&lt;input type=&quot;text&quot; name=&quot;Years&quot; size=2 value=&lt;%= m_nYears %&gt;&gt;
year loan at
&lt;input type=&quot;text&quot; name=&quot;Rate&quot; size=3 value=&lt;%= m_nRate * 100 %&gt;&gt;
% interest.

&lt;% If m_BrowserInfo.ActiveXControls Then %&gt;
&lt;br&gt;
&lt;input type=&quot;checkbox&quot; name=Interactive id=chkInteractive
&lt;% If m_fInteractive Then %&gt;

 checked 
&lt;% End If %&gt;
onclick=&quot;chkPayTable.disabled=(chkInteractive.checked);&quot;
&gt;
&lt;label for=chkInteractive&gt;
Return an interactive Spreadsheet control
&lt;/label&gt;
&lt;% End If %&gt;

&lt;br&gt;
&lt;input type=&quot;checkbox&quot; name=PayTable id=chkPayTable
&lt;% If m_fPayTable Then %&gt;
 checked 
&lt;% End If %&gt;
&lt;% If m_fInteractive Then %&gt;
 disabled
&lt;% End If %&gt;
&gt;
&lt;label for=chkPayTable&gt;
Show me a full payment table
&lt;/label&gt;

&lt;p&gt;
&lt;input type=&quot;submit&quot; value=&quot;Calculate My Mortgage!&quot; id=btnSubmit&gt;
&lt;/font&gt;&lt;/p&gt;
&lt;/form&gt;
<img src="images/grayvellip.JPG" width=3 height=13 border="0">
</pre></td></tr></table></p>

<P>At the beginning of this code and HTML segment, I use the m_fUseCSS flag 
to determine what kind of formatting I should use for the form header. If the flag is 
True, I can use more precise formatting of the fonts. The main part of the form is a 
standard HTML form, but it is arranged in a sentence-building manner. Near the end of the 
form, I use the ActiveXControls property of the BrowserType object to determine 
whether the client browser supports COM controls. If it does, I emit a check box (the 
Interactive check box) that the user can check to get the calculation results in an interactive 
Spreadsheet control instead of static HTML. If not, I don't emit the check box and the 
user will never know what he or she is missing. (This is why I'm not in marketing.) </P>

<P>Note that I also include a small in-line onClick event handler for the 
Interactive check box. It makes no sense to exclude the payment table from the 
Spreadsheet control, so I disable the PayTable check box if the Interactive check box is 
currently checked.</P>

</BODY>
</HTML>





