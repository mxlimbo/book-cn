<HTML>
<HEAD>
<TITLE>Key Elements of the Programming Model, Chapter 4</TITLE>
<link rel="STYLESHEET" type="text/css" href="webcomp.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch04f.htm">[Previous]</A> <A HREF="ch04h.htm">[Next]</A><P>

<A NAME="123"><H1>Key Elements of the Programming Model</H1></A>

<P>The tables in this section provide a quick synopsis of the key elements in the 
PivotTable component's programming model. When you sit down to write a new program 
using the PivotTable control, refer to this section for a reminder of what 
properties, methods, and events to use.</P>

<P><B>Table 4-1.</B> <I>Binding to data.</I></P>

<P>
<table cellpadding=5 width="95%">
<tr>
<th><I>Property</I>  </th>
<th><I>Description</I>  </th></tr>
<tr>
<td valign="top">PivotTable.ConnectionString  </td>
<td valign="top">Set this to a valid connection string to hook up the PivotTable control to the data source.  </td></tr>
<tr>
<td valign="top">PivotTable.CommandText  </td>
<td valign="top">Set this to a SQL statement or whatever command text the provider will accept. CommandText is used only for tabular data sources.  </td></tr>
<tr>
<td valign="top">PivotTable.DataMember  </td>
<td valign="top">Set this to the name of the OLAP cube you want to use or the name of the data set in the DSC referred to by the DataSource property.  </td></tr>
<tr>
<td valign="top">PivotTable.DataSource  </td>
<td valign="top">Set this to an instance of the DSC to use it as the data source. DataSource also will return the DSC even when you use the built-in ConnectionString property.  </td></tr>   
</table></p>
 
<P><B>Table 4-2.</B> <I>Adjusting and saving the view layout.</I></P>

<P>
<table cellpadding=5 width="95%">
<tr>
<th><I>Property or Method</I>  </th>
<th><I>Description</I>  </th></tr>
<tr>
<td valign="top">PivotView.Fieldsets  </td>
<td valign="top">This property contains all available fieldsets that you can use in the report.  </td></tr>
<tr>
<td valign="top">PivotView.Totals  </td>
<td valign="top">This property contains all available totals that you can use in the report.   </td></tr>
<tr>
<td valign="top">InsertFieldset  </td>
<td valign="top">Use this method on the row, column, or filter axis to insert a fieldset on the axis.  </td></tr>    
<tr>
<td valign="top">PivotDataAxis.InsertTotal  </td>
<td valign="top">Use this method on the data axis to insert a total into the report.   </td></tr>
<tr>
<td valign="top">PivotField.IsIncluded   </td>
<td valign="top">Set this property to False to leave a field of a fieldset out of the report. Use IsIncluded to determine whether the field is in the report.  </td></tr>
<tr>
<td valign="top">Expanded  </td>
<td valign="top">Set this property to True to expand a field or member and show its children. Retrieve the value of Expanded to determine whether a field or member is currently expanded.   </td></tr>     
<tr>
<td valign="top">PivotView.AutoLayout  </td>
<td valign="top">Use this method to clear the view for an OLAP data source or to put all fields in the detail area for a tabular source.   </td></tr>
<tr>
<td valign="top">PivotView.AddTotal  </td>
<td valign="top">Use this method to create a new total from a detail field.  </td></tr>
<tr>
<td valign="top">PivotField.SortDirection  </td>
<td valign="top">Use this property to set which way a field should be sorted or to get the field's current sort order.  </td></tr>      
<tr>
<td valign="top">PivotField.SortOn  </td>
<td valign="top">Use this property to make the field's members sort by their total values instead of by their captions.  </td></tr>
<tr>
<td valign="top">PivotField.SortOnScope  </td>
<td valign="top">Use this property to sort a set of members based on a total, but only for a certain scope of members on the other axis.  </td></tr>
<tr>
<td valign="top">PivotFieldset.FilterMember  </td>
<td valign="top">Use this property to get or set the currently selected member of a fieldset on the filter axis.  </td></tr>
<tr>
<td valign="top">PivotField.FilterMembers  </td>
<td valign="top">Use this property to get the current set of filtered members for a given field.  </td></tr>    
<tr>
<td valign="top">PivotField.FilterFunction  </td>
<td valign="top">Use this property to set or determine the filter function being used with the FilterMembers property. The filter function can include or exclude members, or there might be no filtering.  </td></tr>
<tr>
<td valign="top">PivotTable.XMLData  </td>
<td valign="top">Use this property to retrieve the definition of the current report as a large string that you can save and later reset.  </td></tr>
<tr>
<td valign="top">PivotView.TotalOrientation  </td>
<td valign="top">Use this property to make the PivotTable control display the total captions as row headings instead of column headings.  </td></tr>
<tr>
<td valign="top">PivotGroupAxis.DisplayEmptyMembers  </td>
<td valign="top">Use this property to force the PivotTable control to display rows or columns that are completely empty.  </td></tr> 
</table></p>

<P><B>Table 4-3.</B> <I>Customizing and formatting the view.</I></P>    

<P>
<table cellpadding=5 width="95%">
<tr>
<th><I>Property</I>  </th>
<th><I>Description</I>  </th></tr>    
<tr>
<td valign="top">PivotTable.AutoFit  </td>
<td valign="top">Use this property to turn off the AutoFit behavior, especially for a form-based environment such as Visual Basic.  </td></tr>
<tr>
<td valign="top">PivotView.TitleBar  </td>
<td valign="top">Use this property to adjust the title bar's caption and formatting.  </td></tr>
<tr>
<td valign="top">PivotTable.DisplayToolbar,<br> PivotTable.DisplayFieldList,<br>PivotTable.DisplayPropertyToolbox</td>
<td valign="top">Use these properties to control 
visibility of elements such as the toolbar, field list, and Property Toolbox</td></tr>
<tr>
<td valign="top">PivotTotal.NumberFormat  </td>
<td valign="top">Use this property to format the numbers of a total.  </td></tr>
<tr>
<td valign="top">PivotField.SubtotalBackColor  </td>
<td valign="top">Use this property to make the background color of a subtotal different than that of the numbers that contributed to the subtotal. SubtotalBackColor is useful for making a visual distinction among different levels of totals in a large report.  </td></tr>
<tr>
<td valign="top">PivotField.SubtotalFont   </td>
<td valign="top">Use this property to differentiate the font used for subtotals from the font used for the numbers that contributed to the subtotals.  </td></tr>   
<tr>
<td valign="top">PivotTable.MemberExpand   </td>
<td valign="top">Use this property to make the PivotTable control automatically expand all fields and members when added to the view.  </td></tr>    
</table></p>

<P><B>Table 4-4.</B> <I>Noteworthy events.</I></P>

<P>
<table cellpadding=5 width="95%">
<tr>
<th> <I>Event</I></th>
<th><I>Description</I></th></tr>  
<tr>
<td valign="top">QueryComplete  </td>
<td valign="top">Raised after the PivotTable control has executed a query against the data source, which is commonly a reaction to a change in the report's layout. This is a good time to adjust the report title and any other user interface elements that need to be synchronized with the report.  </td></tr>
<tr>
<td valign="top">Click  </td>
<td valign="top">Fired when a user clicks anywhere on the report. Use the Selection property to determine where.  </td></tr>
<tr>
<td valign="top">DblClick   </td>
<td valign="top">Same as Click, but is fired when the user double-clicks. Useful for triggering a jump to another page to show details behind an aggregate or perhaps to display the Property Toolbox or your own formatting user interface.  </td></tr>
<tr>
<td valign="top">SelectionChange  </td>
<td valign="top">Fired whenever the selection has changed in the report. Mostly useful when you have other elements on your page or form that should change when new values are selected.  </td></tr>
<tr>
<td valign="top">PivotTableChange  </td>
<td valign="top">Fired for various reasons when using a tabular data source. The <I>Reason </I>parameter tells you what happened, which includes events such as a new total being created or a total being deleted.  </td></tr>
<tr>
<td valign="top">ViewChange   </td>
<td valign="top">Fired often, so be careful about doing too much in the event handler. Any slight change in the view causes this event to fire; the <I>Reason </I>parameter indicates what happened. See PivotViewReasonEnum in the OWC online help file (Msowcvba.chm) for a complete list of reasons.  </td></tr>    
</table></p>

</BODY>
</HTML>





