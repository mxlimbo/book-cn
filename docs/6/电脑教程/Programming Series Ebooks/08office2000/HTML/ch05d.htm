<HTML>
<HEAD>
<TITLE>Using Remote Data Services</TITLE>
<link rel="STYLESHEET" type="text/css" href="webcomp.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch05c.htm">[Previous]</A> <A HREF="ch05e.htm">[Next]</A><P>

<A NAME="130"><H1>Using Remote Data Services</H1></A>

<P>I briefly mentioned RDS in <A HREF="ch04a.htm">Chapter 4</A> as a mechanism for retrieving data by 
routing a command through a web server. I also alluded to it earlier in this chapter as a 
way to avoid the cross-domain data access warning. Although I will not describe 
the operational details of RDS here, I will discuss the features of the DSC that make 
using RDS easier. For more general information on RDS, see the RDS documentation 
in the OLE DB SDK (which is quite detailed) and the various white papers 
available at <A HREF="http://www.microsoft.com/data" TARGET="_window2">http://www.microsoft.com/data</A>.</P>

<P>The DSC exposes a property at its top-level interface named 
UseRemoteProvider. By default, this property is set to False and the DSC uses whatever OLE DB 
provider you specify in the provider attribute of your connection string. However, if you 
set this property to True, the DSC alters the connection string you specify so that it 
uses the RDS provider. If you are already familiar with RDS, you know that the RDS 
provider needs two pieces of information to retrieve data:</P>

<UL>
<P><LI>The name of a web server on which the RDS server components reside.</LI></P>

<P><LI>The name of the real data provider that RDS will use on the web server.</LI></P>
</UL>

<P>When the DSC alters your connection string, it uses the name of the web 
server from which the page originates for the first setting and uses the value you 
indicate in the provider attribute as the name for the real data provider on the server. The 
DSC also alters your connection string to use the Data Shape Provider (mentioned 
earlier) whether or not you use RDS.</P>

<P>For example, suppose you use the following connection string:</P>

<P><table cellpadding=5 width="95%"><tr><td>
<PRE>
Provider=sqloledb;Data Source=MySQLServer;
Initial Catalog=Northwind;User Id=sa;Password=;
</pre></td></tr></table></p>

<P>After you set the UseRemoteProvider property to True, the DSC changes 
your connection string to this:</P>

<P><table cellpadding=5 width="95%"><tr><td>
<PRE>
Provider=MSDataShape.1;Extended Properties=&quot;REMOTE PROVIDER=sqloledb;
REMOTE SERVER=http://<I>web server</I>;EXTENDED PROPERTIES='INITIAL 
CATALOG=Northwind;'&quot;;Persist Security Info=True;Connect Timeout=15;
Data Source=MySQLServer;User ID=sa;Data Provider=MS Remote
</pre></td></tr></table></p>

<P>Because RDS is set to use the same web server from which the page 
originated, the data access is considered to be in the same domain. Therefore, you will not 
see any cross-domain data access warnings, regardless of the zone in which the page 
runs. RDS is useful for avoiding these warnings, but it does require extra setup and 
configuration on the web server. Since the RDS client provider is included with the Office 
Web Components setup, no extra setup steps are needed on the client machine.</P>

</BODY>
</HTML>





