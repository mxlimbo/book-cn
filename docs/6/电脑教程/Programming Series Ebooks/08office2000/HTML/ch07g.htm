<HTML>
<HEAD>
<TITLE>Automatically Generating a Title</TITLE>
<link rel="STYLESHEET" type="text/css" href="webcomp.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch07f.htm">[Previous]</A> <A HREF="ch07h.htm">[Next]</A><P>

<A NAME="163"><H1>Automatically Generating a Title</H1></A>

<P>The PivotTable control offers a title bar at the top of the view, enabling you or 
the user to specify a meaningful title for the report. However, while users browse the 
data, it is often helpful to generate an automatic title based on what the user has 
included in the report. This title then can be suggested as the title of the report when saved, 
which is what occurs in the Save Report button's Click event handler described earlier.</P>

<P>Generating an automatic title is easy. The following code shows one 
method for doing so:</P>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
Sub AutoTitlePivot(ptable)
    Dim sTitle
    Dim sSep
    Dim sBy
    Dim sFor
    Dim sAnd
    Dim ttl
    Dim fset
    Dim pview
        
    sTitle = &quot;&quot;
    
    ' Constant string tokens used to build the title
    sSep = &quot;, &quot;
    sBy = &quot; by &quot;
    sFor = &quot; for &quot;
    sAnd = &quot; and &quot;
    
    ' Grab the active view
    Set pview = ptable.ActiveView
    
    ' Start by including the names of the totals used
    If pview.DataAxis.Totals.Count &gt; 0 Then
        For Each ttl In pview.DataAxis.Totals
            sTitle = sTitle &amp; ttl.Caption &amp; sSep
        Next
        sTitle = Left(sTitle, Len(sTitle) - Len(sSep))
    Else
        sTitle = &quot;(No Totals)&quot;
    End If 'Some totals in the report
        
    ' Next put &quot; by &lt;row fieldsets&gt;&quot;
    If pview.RowAxis.FieldSets.Count &gt; 0 Then
        sTitle = sTitle &amp; sBy
        For Each fset In pview.RowAxis.FieldSets
            sTitle = sTitle &amp; fset.Caption &amp; sSep
        Next
        sTitle = Left(sTitle, Len(sTitle) - Len(sSep))
    End If 'Fieldset(s) on row axis

    ' Next put &quot; by &lt;col fieldsets&gt;&quot;
    If pview.ColumnAxis.FieldSets.Count &gt; 0 Then
        sTitle = sTitle &amp; sBy
        For Each fset In pview.ColumnAxis.FieldSets
            sTitle = sTitle &amp; fset.Caption &amp; sSep
        Next
        sTitle = Left(sTitle, Len(sTitle) - Len(sSep))
    End If 'Fieldset(s) on column axis
    
    ' Finally, include any filters
    If pview.FilterAxis.FieldSets.Count &gt; 0 Then
        sTitle = sTitle &amp; sFor
        For Each fset In pview.FilterAxis.FieldSets
            sTitle = sTitle &amp; fset.Caption &amp; &quot;=&quot; &amp; _
                fset.FilterMember.Caption &amp; sAnd
        Next
        sTitle = Left(sTitle, Len(sTitle) - Len(sAnd))
    End If 'Fieldset(s) on filter axis
    
    pview.TitleBar.Caption = sTitle

End Sub 'AutoTitlePivot()
</pre></td></tr></table></p>


<P>This method starts by declaring a number of variables and giving them 
default values. These variables are used as the separator values in the eventual title, and 
you can change these variables to use different separators. The code begins by 
concatenating all total captions in the view, separating them using the sSep variable. It 
then concatenates the fieldset captions on the Row axis if any exist. It continues by 
concatenating the Column axis fieldset captions and then concatenating any 
fieldset captions placed on the Filter axis, noting their current filter members. For 
example, if you use the Quick Pivot user interface to build a report that shows Store Sales 
by Promotions by Time filtered by Product, the automatic title generated by this 
method is &quot;Store Sales by Promotions by Time for Product=All Products&quot;. If you change 
the filter field to show only the sales for the Drink product family, the last part of the 
title changes to &quot;Product=Drink&quot;.</P>

</BODY>
</HTML>





