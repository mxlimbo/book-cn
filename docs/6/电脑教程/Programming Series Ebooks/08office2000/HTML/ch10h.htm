<HTML>
<HEAD>
<TITLE>Handling Errors in the HTML Page</TITLE>
<link rel="STYLESHEET" type="text/css" href="webcomp.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch10g.htm">[Previous]</A> <A HREF="ch10i.htm">[Next]</A><P>

<A NAME="203"><H1>Handling Errors in the HTML Page</H1></A>

<P>Any control obtaining real-time data from a remote source must be prepared to 
deal with communication errors. As noted earlier, the Stock Ticker control sets the 
Internet Transfer control's RequestTimeout property to ensure that the HTTP request 
eventually returns. If the request times out, it passes the error information back to 
the web page through the NewData event. Let's look at how the HTML page 
handles the error condition:</P>

<P><table cellpadding=5 width="95%"><tr><td>
<PRE>
Sub StockTicker_NewData(fError, ErrText)
    If fError Then
        Dim nReponse
        window.status = &quot;Problems obtaining new stock information!&quot;
        nResponse = MsgBox(&quot;Unable to load new stock information &quot; &amp; _
            &quot;because...&quot; &amp; _
            vbCrLf &amp; vbCrLf &amp; ErrText &amp; vbCrLf &amp; vbCrLf &amp; _
            &quot;Would you like to work off line with simulated data?&quot;, _
            vbYesNo + vbCritical)

        If nResponse = vbYes Then
            rbOffline_onClick
        End If
    Else
        window.status = &quot;Completed loading new stock data.&quot;
    End If
End Sub 'StockTicker_NewData()
</pre></td></tr></table></p>

<P>The Stock Ticker control itself does not display error information in a 
message box. This is intentional because you should always pass error information up to 
the highest user interface level possible, allowing that level to display the error. In 
this case, the higher user interface level is the web page.</P>

<P>The web page's NewData event handler checks the error flag, and if True, it 
sets the browser's status bar to indicate that an error has occurred and displays the 
error text returned from the Stock Ticker control in a message box. It wraps a question 
around the error text, asking the user if he or she wants to work off line instead. 
If the user responds with a &quot;yes,&quot; the code sets the Stock Ticker control's SimulatedData 
property to True by calling the Click event handler of the Simulate Data radio button. 
If the error flag was False, the code simply updates the status bar to reflect a 
successful fetching of new data.</P>

</BODY>
</HTML>





