<html>
<HEAD>
<TITLE>Chapter 10 -- Windows Common Controls: Part I</TITLE>
<LINK REL=STYLESHEET HREF="Library.css" TYPE="text/css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch09d.htm", "ch10b.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>



<font size="+3">Chapter 10</font>

<A NAME="409"><h1>Windows Common Controls: Part I</h1></A>
<p>Apart from the intrinsic controls described in <a href="ch03a.htm">Chapter 3</a>, the Microsoft 
Windows common controls are probably the most widely used controls in Microsoft Visual 
Basic applications. The main reason for their popularity is that they contribute to 
creating the Windows look-and-feel more than any other group of controls. For example, 
a Windows Explorer-like application with a TreeView control on the left and a 
ListView control on the right immediately reminds users of Windows Explorer itself, 
thus making for a familiar interface.</p>

<p>Windows common controls were first introduced in Windows 95. The 
initial group of these controls included the TreeView, ListView, ImageList, Toolbar, 
StatusBar, TabStrip, and Slider controls. Visual Basic 4&#8212;the first 32-bit version of this 
language&#8212;offered an OLE Custom Control (OCX) that provided access to their features. 
After this initial release, Microsoft manufactured several new common controls as well as 
more powerful versions of the original ones. But the OCXs that came with Visual Basic 
5 (and its three service packs) were never significantly updated, which meant 
that Visual Basic programmers couldn't use these newer controls in their applications 
(with the exceptions of the new Animation and UpDown controls). Until recently, to 
use such newer controls or to fully exploit the capabilities of the original controls, 
Visual Basic developers had to resort to third-party Microsoft ActiveX controls or to 
complex API programming.</P>

<p>Visual Basic 6 has remedied this problem. It now includes all the tools you 
need to fully take advantage of the features of nearly all existing common controls. A 
few Windows common controls are still missing from the newer versions of the 
OCX files (most notably, the IP Address control), but in most cases you won't need 
to purchase any additional custom controls to give your Visual Basic applications a 
modern user interface.</P>

<p>Most of the Windows common controls come in the MsComCtl.ocx file. 
This file contains all the original common controls, plus the ImageCombo control. 
Another file, MsComCt2.ocx, includes the code for five additional controls: 
Animation, UpDown, MonthView, DateTimePicker, and FlatScrollBar. I describe these 
controls in <a href="ch11a.htm">Chapter 11</a>. Note that these two files correspond to the outdated files 
ComCtl32.ocx and ComCt232.ocx that were distributed with Visual Basic 5. Visual Basic 6 
doesn't replace the older OCX files and can peacefully coexist with Visual Basic 5 and 
applications developed with that version of the language.</P>

<p>Visual Basic 6 also includes a third OCX file, ComCt332.ocx, which adds 
support for yet another common control, the CoolBar control (also described in <a href="ch11a.htm">Chapter 11</a>). This file has been available to Visual Basic 5 developers, who had to download it 
from the Microsoft web site, but the file is now included in the Visual Basic package.</P>

<P>
<img src="images/new.jpg" width=102 height=87 border="0">
</P>

<p>OCX files that are distributed with Visual Basic 6 have an interesting 
feature. While the older ComCtl32.ocx and ComCt232.ocx files were just intermediaries 
between Visual Basic and the system DLLs that included the actual code for the 
controls, the newer versions are self-contained and include all the necessary code 
for manipulating the controls. Needless to say, newer files are bigger than their 
predecessors&#8212;MsComCtl.ocx is more than 1 MB&#8212;but this approach simplifies the 
distribution of Visual Basic applications and reduces the chance of conflicts with 
programs already installed on the end user's machine.</P>

<p>In this chapter, I describe the features of all the Windows common 
controls included in MsComCtr.ocx, while the <a href="ch11a.htm">next chapter</a> covers all the controls 
in MsComCt2.ocx and ComCt232.ocx. To test the code presented here, you first 
make the controls available to your Visual Basic environment. To do so, execute the 
Components command from the Project menu (or just press the Ctrl+T key 
combination) to display the Components dialog box similar to the one in Figure 10-1, and then 
select the OCXs that interest you, as shown in Figure 10-2.</P>

<p>When you load into the Visual Basic 6 environment a project built with a previous version of the language that contains references to older versions of Windows common controls, a message box appears asking whether you want to upgrade those controls with their newer versions. For the maximum compatibility with existing applications, you might decide to continue to use the older controls, even 
though upgrading to the newer versions is the best choice if you want to improve the 
application's user interface and functionality. You can turn this warning off by 
deselecting the Upgrade ActiveX Controls check box on the General tab of the Project Properties dialog box.</P>

<p>
<A HREF="javascript:fullSize('F10ph01x.htm')"> <img src="images/F10ph01.JPG" width=404 height=359 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><B>Figure 10-1.</B> <i>The Components dialog box, with all the Windows common controls OCXs selected.</i><!--/caption-->
</p>

<p>
<img src="images/F10ph02.GIF" width=382 height=323 border="0">
<p>
<!--caption--><B>Figure 10-2.</B> <i>The common controls in the Toolbox.</i><!--/caption-->


</BODY>
</HTML>





