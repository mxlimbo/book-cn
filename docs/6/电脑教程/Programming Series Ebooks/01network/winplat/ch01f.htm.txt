<HTML>
<HEAD>
<TITLE>Miscellaneous NetBIOS Commands</title>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</head>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch01e.htm" , "ch01g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>



<A NAME="17"><H1>Miscellaneous NetBIOS Commands</H1></A>

<p>All of the commands discussed so far deal in some way with setting up a session, sending or receiving data through a session or a datagram, and related subjects. A few commands deal exclusively in getting information. These commands are the adapter status command (<i>NCBASTAT</i>) and the find name command (<i>NCBFINDNAME</i>), which are discussed in the following sections. The final section deals with matching LANA numbers to their protocols in a programmatic fashion. (This is not actually a NetBIOS function; we'll discuss it because it can gather useful NetBIOS information for you.)</p>

<A NAME="18"><h2>Adapter Status (<i>NCBASTAT</i>)</h2></A>
<p>The adapter status command is useful for obtaining information about the local computer and its LANA numbers. Using this command is also the only way to programmatically find the machine's MAC address from Windows 95 and Windows NT 4. With the advent of the IP Helper functions for Windows 2000 and Windows 98 (discussed in Appendix A), there is a more generic interface for finding the MAC address; however, for the other Win32 platforms, using the adapter status command is your only valid option.</p>

<p>The command and its syntax are fairly easy to understand, but two ways of calling the function affect what data is returned. The adapter status command returns an <i>ADAPTER_STATUS</i> structure followed by a number of <i>NAME_BUFFER</i> structures. The structures are defined as follows:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
typedef爏truct燺ADAPTER_STATUS爗
牋牋UCHAR牋燼dapter_address[6];
牋牋UCHAR牋爎ev_major;
牋牋UCHAR牋爎eserved0;
牋牋UCHAR牋燼dapter_type;
牋牋UCHAR牋爎ev_minor;
牋牋WORD牋牋duration;
牋牋WORD牋牋frmr_recv;
牋牋WORD牋牋frmr_xmit;
牋牋WORD牋牋iframe_recv_err;
牋牋WORD牋牋xmit_aborts;
牋牋DWORD牋爔mit_success;
牋牋DWORD牋爎ecv_success;
牋牋WORD牋牋iframe_xmit_err;
牋牋WORD牋牋recv_buff_unavail;
牋牋WORD牋牋t1_timeouts;
牋牋WORD牋牋ti_timeouts;
牋牋DWORD牋爎eserved1;
牋牋WORD牋牋free_ncbs;
牋牋WORD牋牋max_cfg_ncbs;
牋牋WORD牋牋max_ncbs;
牋牋WORD牋牋xmit_buf_unavail;
牋牋WORD牋牋max_dgram_size;
牋牋WORD牋牋pending_sess;
牋牋WORD牋牋max_cfg_sess;
牋牋WORD牋牋max_sess;
牋牋WORD牋牋max_sess_pkt_size;
牋牋WORD牋牋name_count;
}燗DAPTER_STATUS,