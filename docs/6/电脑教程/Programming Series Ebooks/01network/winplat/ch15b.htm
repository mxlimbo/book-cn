<HTML>
<HEAD>
<TITLE>Properties</title>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</head>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch15a.htm" , "ch15c.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>



<A NAME="460"><H1>Properties</H1></A>

<p>Now that you have an idea of what functionality the control provides, let's look at the properties exposed by the control. Table 15-1 contains a list of the properties available for affecting the control's behavior and for obtaining information about the control's state.</p>

<p><b>Table 15-1.</b> <i>Winsock control properties</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th><i>Property Name</i></th>
			<th><i>Return Value</i></th>
			<th><i>Read-Only?</i></th>
			<th><i>Description</i></th>
		</tr>
		
		<tr>
			<td valign="top"><i>BytesReceived</i></td>
			<td valign="top"><i>Long</i></td>
			<td valign="top">Yes</td>
			<td valign="top">Returns the number of bytes pending in the receive buffer. Use the <i>GetData</i> method to retrieve the data.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>LocalHostName</i></td>
			<td valign="top"><i>String</i></td>
			<td valign="top">Yes</td>
			<td valign="top">Returns the local machine name.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>LocalIP</i></td>
			<td valign="top"><i>String</i></td>
			<td valign="top">Yes</td>
			<td valign="top">Returns a string of the dotted decimal IP address of the local machine.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>LocalPort</i></td>
			<td valign="top"><i>Long</i></td>
			<td valign="top">No</td>
			<td valign="top">Returns or sets the local port to use. Specifying 0 for the port tells the system to randomly choose an available port. Generally, only a client uses 0.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>Protocol</i></td>
			<td valign="top"><i>Long</i></td>
			<td valign="top">No</td>
			<td valign="top">Returns or sets the protocol for the control, which supports either TCP or UDP. The constant values to set are <i>sckTCPProtocol</i> and <i>sckUDPProtocol</i>, which correspond to 0 and 1 respectively.</td>
		</tr>

		<tr>
			<td valign="top"><i>RemoteHost</i></td>
			<td valign="top"><i>String</i></td>
			<td valign="top">No</td>
			<td valign="top">Returns or sets the remote machine name. You can use either the string host name or the dotted decimal string representation.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>RemoteHostIP</i></td>
			<td valign="top"><i>String</i></td>
			<td valign="top">Yes</td>
			<td valign="top">Returns the IP address of the remote machine. For TCP connections, this field is set upon a successful connection. For UDP operations, this field is set upon the <i>DataArrival</i> event, which then contains the IP address of the sending machine.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>RemotePort</i></td>
			<td valign="top"><i>Long</i></td>
			<td valign="top">No</td>
			<td valign="top">Returns or sets the remote port to connect to.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>SocketHandle</i></td>
			<td valign="top"><i>Long</i></td>
			<td valign="top">Yes</td>
			<td valign="top">Returns a value that corresponds to the socket handle.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>State</i></td>
			<td valign="top"><i>Integer</i></td>
			<td valign="top">Yes</td>
			<td valign="top">Returns the state of the control, which is an enumerated type. See Table 15-2 for the socket state constants.</td>
		</tr>
		
	</table>
</p>

<p>After reading <a href="ch07a.htm">Chapter 7</A>, you should be familiar with these basic properties. They are clearly analogous to the basic Winsock functions presented in the client/server examples discussed in <a href="ch07a.htm">Chapter 7</A>. A few properties that don't relate well to the Winsock API do need to be set to use the control properly. First the <i>Protocol</i> property needs to be set in order to tell the control what type of socket you're looking for&#8212;either <i>SOCK_STREAM</i> or <i>SOCK_DGRAM</i>. The control performs the actual socket creation under the hood, and this property is the only control you have over it. The <i>SocketHandle</i> property can be read after a connection succeeds or after a server binds to wait for connections. This is useful if you want to pass the handle to other Winsock API functions imported from a DLL. The <i>State</i> property can be used to obtain information about what the control is currently doing. This is important because the control is asynchronous, and events can be fired at any time. Use this property to make sure that the socket is in a valid state for any subsequent operations. Table 15-2 contains the possible socket states and their meanings.</p>

<p><b>Table 15-2.</b> <i>Socket states</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th><i>Constant</i></th>
			<th><i>Value</i></th>
			<th><i>Meaning</i></th>
		</tr>
		
		<tr>
			<td valign="top"><i>sckClosed</i></td>
			<td valign="top">0</td>			
			<td valign="top">Default. Closed.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckOpen</i></td>
			<td valign="top">1</td>			
			<td valign="top">Open.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckListening</i></td>
			<td valign="top">2</td>			
			<td valign="top">Listening for connections.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckConnectionPending</i></td>
			<td valign="top">3</td>			
			<td valign="top">Connection request has arrived but has not completed yet.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckResolvingHost</i></td>
			<td valign="top">4</td>			
			<td valign="top">Host name is being resolved.</td>
		</tr>
		
		<tr>
			<td valign="top"><i>sckHostResolved</i></td>
			<td valign="top">5</td>			
			<td valign="top">Host name resolution has completed.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckConnecting</i></td>
			<td valign="top">6</td>			
			<td valign="top">Connection request started but has not completed.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckConnected</i></td>
			<td valign="top">7</td>			
			<td valign="top">Connection completed.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckClosing</i></td>
			<td valign="top">8</td>			
			<td valign="top">Peer has initiated a close.</td>
		</tr>

		<tr>
			<td valign="top"><i>sckError</i></td>
			<td valign="top">9</td>			
			<td valign="top">An error has occurred.</td>
		</tr>
		
	</table>
</p>

</BODY>
</HTML>




