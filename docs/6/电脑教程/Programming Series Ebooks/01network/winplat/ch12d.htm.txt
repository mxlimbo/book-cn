<HTML>
<HEAD>
<TITLE>Terminating QOS</title>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</head>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12c.htm" , "ch12e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>



<A NAME="377"><H1>Terminating QOS</H1></A>

<p>In the previous section, you learned how to invoke QOS on a socket. Next we'll examine the termination of QOS guarantees. Each of the following events causes a termination of RSVP and Traffic Control processing for a socket:</p>

<ul>
<p><li> Closing a socket via the <i>closesocket</i> function</li></p>

<p><li> Shutting down a socket via the <i>shutdown</i> function</li></p>

<p><li> Calling <i>WSAConnect</i> with a null peer address</li></p>

<p><li> Calling <i>WSAIoctl</i> and <i>SIO_SET_QOS</i> with the <i>SERVICETYPE_NOTRAFFIC</i> or the <i>SERVICE_TYPE_BESTEFFORT</i> service type</li></p>
</ul>



<p>Except for the second item in the list, these events are self-explanatory. Remember that the <i>shutdown</i> function can signal the cessation of either sending or receiving data, which will result in the termination of the flow of data for only that direction. In other words, if <i>shutdown</i> is called with <i>SD_SEND</i>, QOS will still be in effect for data being received.</p>

<A NAME="378"><H2>Provider-Specific Objects</H2></A>

<p>The provider-specific objects covered in this section are passed as part of the <i>ProviderSpecific</i> field of the <i>QOS</i> structure. Either they return QOS information to your application via the <i>FD_QOS</i> event or you can pass them along with the other QOS parameters to a <i>WSAIoctl</i> call with the <i>SIO_SET_QOS</i> option to refine the behavior of QOS.</p>

<p>Every provider-specific object contains a <i>QOS_OBJECT_HDR</i> structure as its first member. This structure identifies the type of the provider-specific object. This is necessary because these provider objects are most commonly returned within the <i>QOS</i> structure after a call to <i>SIO_GET_QOS</i>. Using the <i>QOS_OBJECT_HDR</i>, your application can identify each object and decode its significance. The object header is defined as</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
typedef爏truct牋
{
牋牋ULONG牋燨bjectType;
牋牋ULONG牋燨bjectLength;