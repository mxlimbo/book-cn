<HTML>
<HEAD>
	<link rel="STYLESHEET" type="text/css" href="Library.css">
<TITLE>Creating Multicolumn Reports</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch06d.htm", "ch06f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="213"><H1>Creating Multicolumn Reports</H1></A>

<P>The samples presented so far in this chapter do not present classic database reports that display multiple columns from one or more underlying tables. You can create this kind of report in at least two ways: using the Report wizard and using manual layout techniques.</P>

<A NAME="214"><H2>Using the Report Wizard</H2></A>

<P>The Report wizard, which has an interface similar to the Simple Query wizard, lets you create a multicolumn report. Figure 6-9 shows a report prepared using the Report wizard. As you can see, the wizard provides a lot of computations. The report's underlying record source counts sales quantity and 
sums extended price by product for each customer. The report also sums the order quantities and prices by customer and overall customers. It then uses these results to compute the percent of total sales and extended price for each 
customer. It also sums the number of records for each customer and prints a 
one-line message with the customer's name and its record count.</P>


<P>The Report wizard can add a flurry of formatting touches as 
well. Figure 69 shows one set of choices. Using spacing and horizontal lines, the 
layout distinguishes the report's title from the rest of the report. You can also 
choose from several different field layouts. The layout in the figure places the 
grouping variable&#8212;<I>CompanyName</I>&#8212;on the far left of report pages. Note that that 
this layout required no code.</P>


<P><A HREF="javascript:fullSize('F06QH09x.htm')"> <img src="Images/F06QH09.JPG" width=404 height=344 border=0 ALT="Click to view at full size."> </A>
</P><P><!-- CAPTION --><B>Figure 6-9.</B> <I>This excerpt from a report shows some of the Report wizard's calculations and formatting options.</I><!-- /CAPTION -->
</P>


<A NAME="215"><H2>Creating a Custom Report</H2></A>

<P>When you need a special arrangement of controls on a report as well as unique computations, you must lay out the report manually. Figure 6-10 shows excerpts from a custom report whose functionality is similar to the report in Figure 
6-9. This custom report has simpler formatting to make it easier to follow. The 
top window shows the sales by product for a customer along with the sums for 
order quantities and extended price and the percentages of the grand total for 
both items. The bottom window shows the continuation of the report for the 
second customer. The Page Footer section shows the date of the report, the 
current report page, and the total number of pages.</P>


<P><A HREF="javascript:fullSize('F06QH10x.htm')"> <img src="Images/F06QH10.JPG" width=404 height=544 border=0 ALT="Click to view at full size."> </A>
</P><P><!-- CAPTION --><B>Figure 6-10.</B> <I>Excerpts from a custom multicolumn report.</I><!-- /CAPTION -->
</P>


<P>Figure 6-11 shows the Design view of the report in Figure 6-10. Nearly all the controls on the report are labels or text boxes. You should generally assign string constants to labels and set their caption property to the string constant. The text in the Report Header section is in a label.</P>


<P>Controls that display numeric fields or string expressions are always text boxes. The first string expression appears in the CompanyName<I> </I>Header section. It is a concatenation of a string constant and the <I>CompanyName </I>field in the report's record source. The Detail section appears next. Its three text boxes each reference a field. Since these controls do not combine the field into an expression, there is no need for a leading equal sign (=) or for placing the 
field name in brackets.</P>


<P><A HREF="javascript:fullSize('F06QH11x.htm')"> <img src="Images/F06QH11.JPG" width=404 height=368 border=0 ALT="Click to view at full size."> </A>
</P><P><!-- CAPTION --><B>Figure 6-11.</B> <I>The report in Figure 6-10 in Design view.</I><!-- /CAPTION -->
</P>


<P>The four right-hand controls in the CompanyName Footer section contain expressions for computing the sum of sales orders and extended price for each customer, along with each customer's percentage of the total sales quantity 
and extended price. The following table shows the control names and their expressions. The expressions for the percentages rely on two controls that appear 
in the Report Footer sections, <I>txtGrandOrders 
</I>and <I>txtGrandExtPrice</I>. These controls compute the total sales quantity and extended price across all customers.</P>


<P>
<B>Expressions for Sums and Percentages in Figure 6-11</B></P>

<p><table cellpadding="5" width="95%">
<TR><TH valign="top"><I>Control</I></TH>
<TH valign="top"><I> Expression</I></TH></TR>


<TR><TD valign="top"><i>txtCustOrders</i></TD>
<TD valign="top">Sum([Orders])</TD></TR>


<TR><TD valign="top"><i>txtCustExtPrice</i></TD>
<TD valign="top">Sum([ExtPrice])</TD></TR>


<TR><TD valign="top"><i>txtOrdersPercent</i></TD>
<TD valign="top">=[txtCustOrders]/[txtGrandOrders]</TD></TR>


<TR><TD valign="top"><i>txtExtPricePercent</i></TD>
<TD valign="top">=[txtCustExtPrice]/[txtGrandExtPrice]</TD></TR>


<TR><TD valign="top"><i>txtGrandOrders</i></TD>
<TD valign="top">=Sum([Orders])</TD></TR>


<TR><TD valign="top"><i>txtGrandExtPrice</i></TD>
<TD valign="top">=Sum([ExtPrice])</TD></TR>
</table>
</P>


<P>The sums for individual customers and the grand total refer directly to the underlying field values, <I>Orders </I>and 
<I>ExtPrice</I>. The percentage calculations for individual customers refer to control names that, in turn, depend on field values.</P>


<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</B><HR>By default, Access gives a text box control the same name as 
the field to which it binds. To avoid confusion, you can give the controls different names. For example, if a field name is 
<I>Orders</I>, you can change the name of a text box control that references it to <I>txtOrders</I>. This makes it easy for you to read expressions and determine whether they reference a 
field value or a control.
</BLOCKQUOTE></DIV></P>


<P>Notice in Figure 6-10 that the date of a report prints at the bottom of a page, but there is a leading string constant. If you want to apply a format, such as the Long Date format, you must isolate the <I>Now </I>function in a text box by itself. Figure 6-11 shows two concatenated text boxes containing the 
leading text string and the trailing formatted value of the 
<I>Now </I>function.</P>


<P>The right side of the report shown in Figure 6-11 uses two keywords, <I>Page </I>and <I>Pages</I>, that identify the current report page and the total number of pages in the report. (These keywords do not appear in the figure.) Notice that 
you can include these keywords in string expressions.</P>


</BODY>
</HTML>




