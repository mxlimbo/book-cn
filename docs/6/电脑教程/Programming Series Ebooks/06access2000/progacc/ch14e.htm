<HTML>
<HEAD>
	<link rel="STYLESHEET" type="text/css" href="Library.css">
<TITLE>Data Access in Non-Access Applications</TITLE>


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch14d.htm", "ch14f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="434"><H1>Data Access in Non-Access Applications</H1></A>

<p>Recall that ODE offers three routes to data: the Data Environment designer, the ADO Data Control, and the ADO object model. You might initially feel most comfortable with the ADO object model route. (See <a href="ch02a.htm">Chapter 2</a> for an introduction to the ADO object model; other chapters offer additional details). The following sample populates an Excel worksheet with ADO <i>Connection </i>and <i>Recordset </i>objects. It copies the field names from the Northwind <i>Products </i>table to the first row of an Excel worksheet. Then it copies field values for successive rows from the recordset down the worksheet. The sample runs from the VBA project associated with a workbook file.</p>

<p>
	<table cellpadding=5 width="95%">
		<tr>
			<td>
<pre>Sub northwind2XL()
Dim cnn1 As ADODB.Connection
Dim rst1 As ADODB.Recordset
Dim RowCnt, FieldCnt As Integer

'Create instances of the connection and recordset objects.
    Set cnn1 = New ADODB.Connection
    Set rst1 = New ADODB.Recordset

'Set cnn1.ConnectionString to Northwind DSN.
    cnn1.ConnectionString = &quot;DSN=Northwind&quot;

'Open connection and recordset.
    cnn1.Open
    Set rst1.ActiveConnection = cnn1
    rst1.Source = &quot;Select * FROM Products&quot;
    rst1.Open , , adOpenStatic, adLockOptimistic

'Write in column headings in first row.
    RowCnt = 1
    For FieldCnt = 0 To rst1.Fields.Count - 1
        Cells(RowCnt, FieldCnt + 1).Value = _
            rst1.Fields(FieldCnt).Name
        Rows(1).Font.Bold = True
    Next FieldCnt
   
'Fill rows with records, starting at row 2.
    RowCnt = 2
    While Not rst1.EOF
        For FieldCnt = 0 To rst1.Fields.Count - 1
            Cells(RowCnt, FieldCnt + 1).Value = _
                rst1.Fields(FieldCnt).Value
        Next FieldCnt
        rst1.MoveNext
        RowCnt = RowCnt + 1
    Wend

End Sub</pre></td>
		</tr>
	</table>
</p>

<p>The connection string for the <i>Connection </i>object relies on a DSN object. The DSN in the sample points at the Northwind database, but it can specify any DSN . Using a DSN simplifies the design of the connection string syntax because you can use the graphical procedure from the ODBC icon in the Control Panel to specify the connection to a database. Also notice the standard syntax for specifying a connection and basing a recordset on it.</p>

<p>The procedure applies the <i>Cells </i>property, which implicitly refers to the <i>ActiveWorksheet </i>object in the Excel object model. You specify individual cells of a worksheet by denoting a row index followed by a column index. Setting the index values inside of loops lets the code move across columns within a row and down the rows of a worksheet.</p>

</BODY>
</HTML>




