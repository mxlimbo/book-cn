<HTML>
<HEAD>
<TITLE>Suspending and Resuming a Process</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch07b.htm">[Previous]</A> <A HREF="ch07d.htm">[Next]</A><P>

<A NAME="98"><H1>Suspending and Resuming a Process</H1></A>

<p>The concept of suspending or resuming a process doesn't exist
for Windows since processes are never scheduled CPU time. However, I have been asked numerous times how to suspend all of the threads in a process. Windows does allow one process to suspend all the threads in another process, but the process doing the suspending must be a debugger. Specifically, the process must call functions such as <i>WaitForDebugEvent</i> and <i>ContinueDebugEvent</i>.</p>

<p>Windows doesn't offer any other way to suspend all threads in a process because of race conditions. For example, while the threads are suspended, a new thread might be created. Somehow the system must suspend any new threads during this window of time. Microsoft has integrated this functionality into the debugging mechanism of the system.</p>

<p>While you cannot create an absolutely perfect <i>SuspendProcess</i> function, you can create an implementation of this function that works well in many situations. Here is my implementation of a <i>SuspendProcess</i> function:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
VOID燬uspendProcess(DWORD燿wProcessID,燘OOL爁Suspend)爗

牋