<HTML>
<HEAD>
<TITLE>Injecting a DLL Using Windows Hooks</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch22c.htm">[Previous]</A> <A HREF="ch22e.htm">[Next]</A><P>

<A NAME="288"><H1>Injecting a DLL Using Windows Hooks</H1></A>

<p>You can inject a DLL into a process's address space using hooks.
To get hooks to work as they do in 16-bit Windows, Microsoft was forced
to devise a mechanism that allows a DLL to be injected into the address
space of another process.</p>

<p>Let's look at an example. Process A (a utility similar to
Microsoft Spy++) installs a WH_GETMESSAGE hook to see messages
processed by windows in the system. The hook is installed by calling
<i>SetWindowsHookEx</i> as follows:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
HHOOKçˆƒHook