<HTML>
<HEAD>
<TITLE>Placing a Process in a Job</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch05b.htm">[Previous]</A> <A HREF="ch05d.htm">[Next]</A><P>

<A NAME="69"><H1>Placing a Process in a Job</H1></A>

<p>OK, that's it for setting and querying restrictions. Now
let's get back to my <i>StartRestrictedProcess</i> function. After
I place some restrictions on the job, I spawn the process that I intend
to place in the job by calling <i>CreateProcess</i>. However, notice
that I use the CREATE_SUSPENDED flag when calling <i>CreateProcess</i>.
This creates the new process but doesn't allow it to execute any
code. Since the <i>StartRestrictedProcess</i> function is being
executed from a process that is not part of a job, the child process
will also not be part of a job. If I were to allow the child process to
immediately start executing code, it would run out of my sandbox and
could successfully do things that I want to restrict it from doing. So
after I create the child process and before I allow it to start
running, I must explicitly place the process in my newly created job by
calling the following:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
BOOL燗ssignProcessToJobObject(
牋燞ANDLE爃Job,