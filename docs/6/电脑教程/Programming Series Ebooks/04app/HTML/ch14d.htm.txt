<HTML>
<HEAD>
<TITLE>Determining the State of an Address Space</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch14c.htm">[Previous]</A> <A HREF="ch15a.htm">[Next]</A><P>

<A NAME="188"><H1>Determining the State of an Address Space</H1></A>

<p>Windows offers a function that lets you query certain information (for example, size, storage type, and protection attributes) about a memory address in your address space. In fact, the VMMap sample application shown later in this chapter uses this function to produce the virtual memory map dumps that appeared in <A HREF="ch13a.htm">Chapter 13</A>. This function is called <i>VirtualQuery</i>:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
DWORD燰irtualQuery(
牋燣PCVOID爌vAddress,
牋燩MEMORY_BASIC_INFORMATION爌mbi,
牋燚WORD燿wLength);
</pre>
</td></tr></table></p>

<p>Windows also offers a function that allows one process to query memory information about another process:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
DWORD燰irtualQueryEx(
牋燞ANDLE爃Process,