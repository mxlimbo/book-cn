<HTML>
<HEAD>
<TITLE>How to Write Unicode Source Code</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch02h.htm">[Previous]</A> <A HREF="ch02j.htm">[Next]</A><P>

<A NAME="15"><H1>How to Write Unicode Source Code</H1></A>

<p>Microsoft designed the Windows API for Unicode so that it would have
as little impact on your code as possible. In fact, it is possible to
write a single source code file so that it can be compiled with or
without using Unicode&#8212;you need only define two macros (UNICODE and
_UNICODE) to make the change and then recompile.</p>

<A NAME="16"><H2>Unicode Support in the C Run-Time Library</H2></A>

<p>To take advantage of Unicode character strings, some data types have
been defined. The standard C header file, String.h, has been modified
to define a data type named <i>wchar_t</i>, which is the data type of a
Unicode character:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
typedef爑nsigned爏hort爓char_t;
</pre></td></tr></table></p>

<p>For example, if you want to create a buffer to hold a Unicode string
of up to 99 characters and a terminating zero character, you can use
the following statement:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
wchar_t爏zBuffer[100];
</pre></td></tr></table></p>

<p>This statement creates an array of one hundred 16-bit values. Of
course, the standard C run-time string functions, such as <i>
strcpy</i>, <i>strchr</i>, and <i>strcat</i>, operate on ANSI strings
only; they don't correctly process Unicode strings. So, ANSI C also
has a complementary set of functions. Figure 2-1 shows some of the
standard ANSI C string functions followed by their equivalent Unicode
functions.</p>

<p><b>Figure 2-1.</b> <i>Standard ANSI C string functions and their Unicode equivalents</i></p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
char