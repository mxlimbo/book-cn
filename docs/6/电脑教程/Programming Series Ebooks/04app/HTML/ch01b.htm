<HTML>
<HEAD>
<TITLE>You Can Do This Too</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch01a.htm">[Previous]</A> <A HREF="ch01c.htm">[Next]</A><P>

<A NAME="3"><H1>You Can Do This Too</H1></A>

<p>OK, I've shown you how Windows functions indicate errors to
their callers. Microsoft also makes this mechanism available to you for
use in your own functions. Let's say you're writing a function
that you expect others to call. Your function might fail for one reason
or another and you need to indicate that failure back to your
caller.</p> 
<p>To indicate failure, simply set the thread's last error code and
then have your function return FALSE, INVALID_HANDLE_VALUE, NULL, or
whatever is appropriate. To set the thread's last error code, you
simply call</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
VOID燬etLastError(DWORD燿wErrCode);
</pre></td></tr></table></p>

<p>passing into the function whatever 32-bit number you think is
appropriate. I try to use codes that already exist in
WinError.h&#8212;as long as the code maps well to the error I'm
trying to report. If you don't think that any of the codes in
WinError.h accurately reflect the error, you can create your own code.
The error code is a 32-bit number that is divided up into the fields
shown in the following table.</p>


<p><table cellpadding=5 width="95%"><tr>
<th>Bits:</th>
<th>31-30</th>
<th>29</th>
<th>28</th>
<th>27-16</th>
<th>15-0</th>
</tr>
<tr>
<td valign="top">Contents</td>
<td valign="top">Severity</td>
<td valign="top">Microsoft/ customer</td>
<td valign="top">Reserved</td>
<td valign="top">Facility code</td>
<td valign="top">Exception code</td>
</tr>
<tr>
<td valign="top">Meaning</td>
<td valign="top">0 = Success<br>1 = Informational<br>2 = Warning<br>3 = Error</td>
<td valign="top">0 = Microsoft-<br>defined code<br>1 = customer-<br>defined code</td>
<td valign="top">Must be 0</td>
<td valign="top">Microsoft-defined</td>
<td valign="top">Microsoft/customer-defined </td>
</tr>
</table></p>

<p>These fields are discussed in detail in <A HREF="ch24a.htm">Chapter 24</A>. For now, the
only important field you need to be aware of is in bit 29. Microsoft
promises that all error codes they produce will have a 0 in this bit.
If you create your own error codes, you must put a 1 in this bit. This
way, you're guaranteed that your error code will never conflict
with a Microsoft-defined error code that currently exists or is created
in the future.</p>

</BODY>
</HTML>






