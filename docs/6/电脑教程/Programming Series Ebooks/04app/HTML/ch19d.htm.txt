<HTML>
<HEAD>
<TITLE>Building the DLL Module</TITLE>
<link rel="STYLESHEET" type="text/css" href="advwin4.css">
<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch19c.htm">[Previous]</A> <A HREF="ch19e.htm">[Next]</A><P>

<A NAME="253"><H1>Building the DLL Module</H1></A>

<p>When you create a DLL, you create a set of functions that
an executable module (or other DLLs) can call. A DLL can export
variables, functions, or C++ classes to other modules. In real life,
you should avoid exporting variables because this removes a level of
abstraction in your code and makes it more difficult to maintain your
DLL's code. In addition, C++ classes can be exported only if the
modules importing the C++ class are compiled using a compiler from the
same vendor. For this reason, you should also avoid exporting C++
classes unless you know that the executable module developers use the
same tools as the DLL module developers.</p>

<p>When you create a DLL, you should first establish a header file that
contains the variables (type and name) and functions (prototype and
name) that you want to export. This header file must also define any
symbols and data structures that are used with the exported functions
and variables. All of your DLL's source code modules should include
this header file. Also, you must distribute this header file so that it
can be included in any source code that might import these functions or
variables. Having a single header file used by the DLL builder and the
executable builder makes maintenance much easier.</p>

<p>Here is how you should code the single header file to include in
both the executable and the DLL's source code files:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<PRE>
/***************************************************************************
Module:牋MyLib.h
***************************************************************************/


#ifdef燤YLIBAPI

//燤YLIBAPI爏hould燽e燿efined爄n燼ll爋f爐he燚LL's爏ource
//燾ode爉odules燽efore爐his爃eader爁ile爄s爄ncluded.