<HTML>
<HEAD>
<TITLE>Part IV: Linking the Content</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>Part IV: Linking the Content</H1>
<P>Now that you have the home page started and the style sheet defined, you 
are ready to use the Content Linking component to create the magazine. 
The Content Linking component relies on a text file that describes the Web 
pages contained in the online publication. These pages can be hard-coded 
HTML documents that you want to link together, or they can be ASP pages that 
generate your content dynamically. In this project, you will use the Magazine 
data source to generate ASP pages for your magazine content. The data source 
uses query string arguments to specify which article will be displayed.
<H2>
<B>Step 1</B>
</H2>
<P>If you don't already have the Magazine project open, open it. 
Choose New from the File menu. In the New dialog box, add a text file and name the 
file MAGAZINE.TXT. This is the content linking text file, and the entries in 
the file are the Uniform Resource Locators (URLs) of the pages you want 
linked. In this project, the URL will always be the same (since content is generated 
by ASP), but you will pass different arguments to designate the articles. Add 
the following entries to MAGAZINE.TXT to set up the links:
<PRE WIDTH="0">/Magazine/Content.asp?ArticleID=1&#160;&#160;&#160;&#160;Create&#160;ActiveX&#160;Controls
/Magazine/Content.asp?ArticleID=2&#160;&#160;&#160;&#160;Developer&#160;Days&#160;Information
/Magazine/Content.asp?ArticleID=3&#160;&#160;&#160;&#160;CTVBSIG&#160;Information
</PRE>
<P>Save MAGAZINE.TXT, and return to DEFAULT.ASP.
<H2>
<B>Step 2</B>
</H2>
<P>You need to produce a table of contents for the magazine. This table will 
appear on the home page and will be generated using the content linking 
text file. The Content Linking component gives you several methods for 
returning the contents of the text file, enabling you to find out how many entries are 
in the file and to access them one at a time. When you read each item, you 
will dynamically generate a hyperlink to the appropriate document and 
display the hyperlink in a table. Add the following code to the BODY section 
of DEFAULT.ASP, just below the &lt;HR&gt; tag you inserted earlier:
<PRE WIDTH="0">&lt;%
`&#160;Variables
Dim&#160;objLinker
Dim&#160;i

`&#160;Create&#160;Content&#160;Linking&#160;component
Set&#160;objLinker&#160;=&#160;Server.CreateObject(&quot;MSWC.NextLink&quot;)
%&gt;

&lt;!-- Generate&#160;table&#160;of&#160;contents
from&#160;Content&#160;Linking&#160;list --&gt;
&lt;H1&gt;Table&#160;of&#160;Contents&lt;/H1&gt;

&lt;TABLE&gt;
&lt;%
For&#160;i&#160;=&#160;1&#160;to&#160;objLinker.GetListCount(&quot;Magazine.txt&quot;)
%&gt;
&#160;&#160;&#160;&#160;&lt;TR&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;TD&gt;&lt;IMG&#160;SRC=&quot;/Chapter8/Images/Bullet.gif&quot;&gt;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;TD&gt;&lt;H3&gt;&lt;A&#160;HREF=&quot;&lt;%=objLinker.GetNthURL(&quot;Magazine.txt&quot;,&#160;i)%&gt;&quot;&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;%=objLinker.GetNthDescription(&quot;Magazine.txt&quot;,&#160;i)%&gt;&lt;/A&gt;&lt;/H3&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;/TD&gt;
&#160;&#160;&#160;&#160;&lt;/TR&gt;
&lt;%Next%&gt;
&lt;/TABLE&gt;
</PRE>
<H2>
<B>Step 3</B>
</H2>
<P>Save your work, and preview DEFAULT.ASP in Internet Explorer by 
selecting Browse With from the File menu. In the Browse With dialog box, 
choose Internet Explorer. You should see the table of contents displayed on the 
home page, as shown in Figure 8-5.<P>
<img src="pictures/F08XF05.JPG" width=600 height=454 border=0><P>
<B>Figure 8-5.</B>


<I>The magazine cover page.</I>








</BODY>
</HTML>
