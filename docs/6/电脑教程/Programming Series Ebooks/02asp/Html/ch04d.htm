<HTML>
<HEAD>
<TITLE>Data Binding</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>Data Binding</H1>
<P>Database publishing is by far the most common use of Internet technology 
today. While client-side scripting is useful for validating data input fields 
and while Dynamic HTML contributes considerably to the quality of the user 
interface, no real business problem can be solved without allowing data 
access. In the past, data access on the Web depended on the server querying the 
database and formatting a Web page with the resulting records. The 
outstanding feature of the methodology is a constant string of round-trips to the 
server for each new query on the database. Although this method is functional, it 
does present problems. Making many trips to the server is slow going, and the 
updating of pages can be affected by many factors other than the speed of 
the query, resulting in an unsatisfying user experience.<P>
Internet Explorer 4.0 changes the very nature of data access on the 
Web by supporting <I>current-record data 
binding</I>. Binding data on the client means that a view of data from the data source can be browsed and edited without 
the client having to return to the server for an update. Web pages created 
with binding respond more quickly than their server-side counterparts, 
resulting in a superior user interface and application.<P>
In order to bind data to an object, IE 4.0 introduces two new HTML 
attributes: DATASRC and DATAFLD. These two attributes are used to bind 
an HTML element to a particular column in a recordset. DATASRC and 
DATAFLD can be used with the following tags: &lt;TABLE&gt;, &lt;SPAN&gt;, &lt;DIV&gt;, 
&lt;OBJECT&gt;, &lt;PARAM&gt;, &lt;SELECT&gt;, &lt;TEXTAREA&gt;, &lt;IMG&gt;, and &lt;MARQUEE&gt;. 
DATASRC represents a recordset that is generated as a result of executing a 
Structured Query Language (SQL) statement on a data source. DATAFLD is used to 
map one of the fields in the recordset to an individual element such as a text box.<P>
Creating a recordset that can be bound to an element requires the 
use of an ActiveX control. IE 4.0 ships with two ActiveX controls capable of 
creating recordsets from various data sources: the Tabular Data Control (TDC) 
and Remote Data Services (RDS). The TDC is used to access delimited data in 
a text file, while RDS is used to access data in an ODBC data source.


<P>
<H2>
<B>Tabular Data Control</B>
</H2>
<P>The Tabular Data Control (TDC) is an ActiveX control specifically 
designed to access data kept in a delimited text file. The control is fairly simple to 
use and requires setting only a few properties. (<a href="chad.htm">Appendix D</a> contains a 
complete listing of properties and methods supported by the TDC.)<P>
The TDC is inserted in a Web page by using the &lt;OBJECT&gt; tag. As 
with all ActiveX objects, IE 4.0 checks the CLASSID attribute to uniquely 
identify the control. The following code places the TDC in a Web page:
<PRE WIDTH="0">&lt;OBJECT&#160;ID=&quot;Data1&quot;&#160;WIDTH=0&#160;HEIGHT=0&#160;BORDER=&quot;0&quot;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:333C7BC4-460F-11D0-BC04-0080C7055A83&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;DataURL&quot;&#160;VALUE=&quot;DATA.TXT&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;UseHeader&quot;&#160;VALUE=&quot;True&quot;&gt;
&lt;/OBJECT&gt;
</PRE>
<P>Once the TDC is in a Web page, you can bind an appropriate 
HTML element to any field in the data source. Listing 4-12 shows a complete 
example in which the data from a text file is bound to text boxes in the page. The 
result is pictured in Figure 4-4.<P>
The example utilizes the first row of data in the text file as the field 
designations. Setting the UseHeader property to True tells IE 4.0 to use the 
first row of data as the column names. These column names can then be used 
to bind a particular element. For example, the following code binds a text 
box with the Supplier field:
<PRE WIDTH="0">DATASRC=#Data1&#160;DATAFLD=&quot;Supplier&quot;
</PRE>
<P>DATASRC is set to the name of the TDC as defined in the ID 
attribute of the &lt;OBJECT&gt; tag. Note the pound sign (#) placed before the name in 
the DATASRC attribute. This syntax is a required part of the data binding 
specification. DATAFLD is then set to the name of the field in the text file.



<P>
<B>Listing 4-12.</B> <I>Using the Tabular Data Control.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META&#160;NAME=&quot;GENERATOR&quot;&#160;Content=&quot;Microsoft&#160;Visual&#160;InterDev&#160;1.0&quot;&gt;
&lt;META&#160;HTTP-EQUIV=&quot;Content-Type&quot;&#160;content=&quot;text/html;&#160;
&#160;&#160;&#160;&#160;charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;Tabular&#160;Data&#160;Control&lt;/TITLE&gt;

&lt;SCRIPT&#160;LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--

&#160;&#160;&#160;&#160;Sub&#160;cmdNext_OnClick
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;The&#160;TDC&#160;has&#160;a&#160;RecordSet&#160;property&#160;that
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;allows&#160;access&#160;to&#160;the&#160;data&#160;in&#160;the&#160;text&#160;file
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Document.frmData.Data1.Recordset.MoveNext

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;If&#160;Document.frmData.Data1.Recordset.EOF&#160;Then
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Document.frmData.Data1.Recordset.MoveLast
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;End&#160;If
&#160;&#160;&#160;&#160;End&#160;Sub

&#160;&#160;&#160;&#160;Sub&#160;cmdPrev_OnClick
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Document.frmData.Data1.Recordset.MovePrevious

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;If&#160;Document.frmData.Data1.Recordset.BOF&#160;Then
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Document.frmData.Data1.Recordset.MoveFirst
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;End&#160;If
&#160;&#160;&#160;&#160;End&#160;Sub

--&gt;
&lt;/SCRIPT&gt;

&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;FORM&#160;NAME=&quot;frmData&quot;&gt;

&lt;!--&#160;The&#160;Tabular&#160;Data&#160;Control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;Data1&quot;&#160;WIDTH=0&#160;HEIGHT=0&#160;BORDER=&quot;0&quot;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:333C7BC4-460F-11D0-BC04-0080C7055A83&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;DataURL&quot;&#160;VALUE=&quot;DATA.TXT&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;UseHeader&quot;&#160;VALUE=&quot;True&quot;&gt;
&lt;/OBJECT&gt;

&lt;!--&#160;The&#160;following&#160;fields&#160;are&#160;bound&#160;to&#160;the&#160;data&#160;
source&#160;using&#160;DATASRC&#160;and&#160;DATAFLD&#160;--&gt;
&lt;INPUT&#160;ID=&quot;lngProductID&quot;&#160;TYPE=&quot;TEXT&quot;&#160;SIZE=2
&#160;&#160;&#160;&#160;DATASRC=#Data1&#160;DATAFLD=&quot;ProductID&quot;&gt;&lt;P&gt;
&lt;INPUT&#160;ID=&quot;strSupplier&quot;&#160;TYPE=&quot;TEXT&quot;&#160;SIZE=50
&#160;&#160;&#160;&#160;DATASRC=#Data1&#160;DATAFLD=&quot;Supplier&quot;&gt;&lt;P&gt;

&lt;INPUT&#160;ID=&quot;strManufacturer&quot;&#160;TYPE=&quot;TEXT&quot;&#160;SIZE=50
&#160;&#160;&#160;&#160;DATASRC=#Data1&#160;DATAFLD=&quot;Manufacturer&quot;&gt;&lt;P&gt;

&lt;INPUT&#160;TYPE=&quot;BUTTON&quot;&#160;NAME=&quot;cmdNext&quot;&#160;VALUE=&quot;Next&quot;&gt;
&lt;INPUT&#160;TYPE=&quot;BUTTON&quot;&#160;NAME=&quot;cmdPrev&quot;&#160;VALUE=&quot;Prev&quot;&gt;

&lt;/FORM&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>



</blockquote><HR>
<P><img src="pictures/F04XF04.GIF" width=580 height=355 border=0><P>
<B>Figure 4-4.</B>


<I>The Tabular Data Control.</I>
<H2>
<B>Remote Data Services</B>
</H2>
<P>Although binding to delimited text files can be useful, most business data 
is maintained in relational databases. Accessing these databases is the job 
of Remote Data Services (RDS). RDS is capable of creating recordsets from 
any ODBC data source running on the server and bringing that data to the client.<P>
Normally, accessing an ODBC data source by the client requires that 
the client have the appropriate ODBC driver installed. This scenario 
generally requires a substantial client setup process to access the data. However, any 
setup at all on the Web is virtually impossible given the fact that a client cannot 
be controlled on the Internet in the same manner that a typical client/server 
setup might be controlled by a developer. So without any guarantee that an 
ODBC driver is present on the client, how can a recordset from the server be 
made available to the client?<P>
The answer is that RDS uses a proxy/stub system. Proxies and stubs 
are not new. In fact, proxy/stub pairs are at the core of all remote 
communication between distributed objects. In a proxy/stub pair, data is packed by the 
stub on the server side and sent to the proxy on the client side; once the client 
receives the data, it is unpacked and presented for display. This method of 
packing and unpacking data across a distance is called 
<I>marshaling. </I>Marshaling is used extensively not only by RDS but also by such technologies as the 
Component Object Model (COM), which is the heart of ActiveX technology.<P>
RDS depends on a server-side component to pack the data. In fact, 
you must install the server-side portion of RDS in order to use client-side 
data binding. The proxy cannot work without the stub. Fortunately, installing 
the server-side portion of RDS is a minor task. You can find the setup for RDS 
on the CD-ROM that accompanies this books.<P>
Once the server is set up, you can use the client-side portion of 
RDS known as the Advanced Data Control (ADC). The ADC is as simple to use 
as the Tabular Data Control. Listing 4-13 on the following page shows a 
complete example of binding data to a grid control in a Web page. When utilizing 
the ADC, you have to set only three properties to get a simple connection: 
Connect, Server, and SQL. The Connect property is the ODBC connection string for 
the data source. Server is generally the name of the Web server where the 
data source is located (and where the server-side portion of the ADC resides). 
SQL is simply the Structured Query Language statement to run. (<a href="chad.htm">Appendix D</a> 
lists all the properties and methods for the ADC.)<P>
Once the ADC is in a Web page, data binding is accomplished in the 
same fashion that it is with the Tabular Data Control. This means that you can 
use the DATASRC and DATAFLD attributes to bind to the same elements that 
are supported by the TDC. The sample code binds to a grid where all of the 
fields are displayed at once, so only the DATASRC attribute is set for the grid.


<P>
<B>Listing 4-13.</B>


<I>Using the Advanced Data Control.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META&#160;NAME=&quot;GENERATOR&quot;&#160;Content=&quot;Microsoft&#160;Developer&#160;Studio&quot;&gt;
&lt;META&#160;HTTP-EQUIV=&quot;Content-Type&quot;&#160;content=&quot;text/html;&#160;
&#160;&#160;&#160;&#160;charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;Advanced&#160;Data&#160;Control&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;FORM&gt;

&lt;!--&#160;NOTE:&#160;In&#160;this&#160;example,&#160;you&#160;must&#160;define&#160;an&#160;
ODBC&#160;data&#160;source&#160;named&#160;Biblio.&#160;See&#160;Chapter&#160;2
for&#160;help.--&gt;

&lt;!--&#160;The&#160;Advanced&#160;Data&#160;Control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;Data1&quot;&#160;HEIGHT=10&#160;WIDTH=10
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:BD96C556-65A3-11D0-983A-00C04FC29E33&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;SQL&quot;&#160;VALUE=&quot;SELECT&#160;*&#160;FROM&#160;Publishers&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;SERVER&quot;&#160;VALUE=&quot;http://scot-winnt&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;CONNECT&quot;&#160;VALUE=&quot;DSN=Biblio&quot;&gt;
&lt;/OBJECT&gt;

&lt;!--&#160;A&#160;data-bound&#160;grid&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;MSFlexGrid1&quot;&#160;WIDTH=548&#160;HEIGHT=180&#160;DATASRC=&quot;#Data1&quot;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:6262D3A0-531B-11CF-91F6-C2863C385E30&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;_ExtentX&quot;&#160;VALUE=&quot;14499&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;_ExtentY&quot;&#160;VALUE=&quot;4763&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;_Version&quot;&#160;VALUE=&quot;327680&quot;&gt;
&lt;/OBJECT&gt;

&lt;/FORM&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>
</blockquote><HR>








</BODY>
</HTML>
