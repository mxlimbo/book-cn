<HTML>
<HEAD>
<TITLE>Part VI: Capturing Customer Data</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>Part VI: Capturing Customer Data</H1>
<P>In this part of the project, you will save the additional information 
provided by the user. The data can be used later for mailing lists or for list server 
applications. Capturing the additional data is a simple matter of using ActiveX 
Data Objects (ADO) to write a new record to the Customers table.
<H2>
<B>Step 1</B>
</H2>
<P>If you don't already have the EMailInfo project open, open it now. 
 Add the following code to the BODY section of MAIL.ASP:
<P><HR><BLOCKQUOTE>
<B>NOTE:</b> The SQL string in this step can be difficult to create. 
Pay close attention to the use of single quotes and double quotes. 
Single quotes designate text in the SQL language, while double quotes 
are used by VBScript to create strings.
</BLOCKQUOTE><HR><P>
<PRE WIDTH="0">&lt;%
` Add the customer data
Dim strSQL

`&#160;Build SQL string
strSQL = &quot;INSERT INTO Customers (FirstName,LastName,Address1,&quot;
strSQL = strSQL &amp; &quot;Address2,City,State,Zip,EMail)&quot;
strSQL = strSQL &amp; &quot;VALUES (`&quot; &amp; Request.Form(&quot;txtFirstName&quot;) &amp; &quot;`&quot;
strSQL = strSQL &amp; &quot;,'&quot; &amp; Request.Form(&quot;txtLastName&quot;) &amp; &quot;`&quot;
strSQL = strSQL &amp; &quot;,'&quot; &amp; Request.Form(&quot;txtAddress1&quot;) &amp; &quot;`&quot;
strSQL = strSQL &amp; &quot;,'&quot; &amp; Request.Form(&quot;txtAddress2&quot;) &amp; &quot;`&quot;
strSQL = strSQL &amp; &quot;,'&quot; &amp; Request.Form(&quot;txtCity&quot;) &amp; &quot;`&quot;
strSQL = strSQL &amp; &quot;,'&quot; &amp; Request.Form(&quot;txtState&quot;) &amp; &quot;`&quot;
strSQL = strSQL &amp; &quot;,'&quot; &amp; Request.Form(&quot;txtZip&quot;) &amp; &quot;`&quot;
strSQL = strSQL &amp; &quot;,'&quot; &amp; Request.Form(&quot;txtEMail&quot;) &amp; &quot;`)&quot;

` Execute statement
objConnection.Execute strSQL

` Destroy objects
objRecordset.Close
objConnection.Close
Set objRecordset = Nothing
Set objConnection = Nothing
%&gt;
</PRE>
<P>Save your project.
<H2>
<B>Step 2</B>
</H2>
<P>Test all the aspects of your new e-mail information system.








</BODY>
</HTML>
