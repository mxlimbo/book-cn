<HTML>
<HEAD>
<TITLE>ActiveX Controls</TITLE>
</HEAD>
<BODY BGCOLOR = "#ffffff">
<H1>ActiveX Controls</H1>
<P>In addition to the data binding provided by new ActiveX controls, 
Internet Explorer 4.0 also supports impressive multimedia features through 
ActiveX controls. The multimedia controls that ship with IE 4.0 are intended to 
create fast, capable graphics and sound without the long download times 
typically associated with multimedia Web content. This section briefly examines the 
new multimedia controls and their uses. Look for a complete reference to 
these controls on the CD-ROM that accompanies this book.
<H2>
<B>Structured Graphics Control</B>
</H2>
<P>The Structured Graphics control is an ActiveX control used for creating 
graphics from simple vectors. Using the control, you can create an image as a 
series of lines and shapes. The image can be as complex as you like, but you 
must specify exactly how to draw it. The specification is delivered through a set 
of &lt;PARAM&gt; tags associated with the control. Each &lt;PARAM&gt; tag specifies 
an instruction such as the color or the shape of the drawing. The following 
code generates a rectangle:
<PRE WIDTH="0">&lt;OBJECT&#160;ID=&quot;MyShape&quot;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:5FD6A143-372A-11D0-A521-0080C78FEE85&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Line0001&quot;&#160;VALUE=&quot;Rect(0,0,50,20,0)&quot;&gt;
&lt;/OBJECT&gt;
</PRE>
<P>A &lt;PARAM&gt; tag for the control always specifies a line number for 
the NAME attribute and a drawing instruction for the VALUE attribute. The 
lines must begin with 0001 and increase by one for each new instruction. Failing 
to sequence the lines correctly causes the drawing to stop.
<H2>
<B>Path Control</B>
</H2>
<P>The Path control is an ActiveX control that defines a sequence of 
<I>x,y</I> coordinates. Once the path is defined, you can specify another ActiveX control 
or HTML element that will follow the path. In this way, you can create a 
complicated animation path and have images and controls follow the path on the 
Web page. Defining the path is a simple matter of using two &lt;PARAM&gt; tags 
to specify the set of <I>x</I> coordinates and matching 
<I>y</I> coordinates referenced to an interval of time, or tick. For example, if you want to define a path that 
moves an image from the lower left corner of the browser to the upper right 
corner, you can use the following &lt;OBJECT&gt; tag:
<PRE WIDTH="0">&lt;OBJECT&#160;ID=&quot;pthSquare&quot;&#160;&#160;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:E0E3CC60-6A80-11D0-9B40-00A0C903AA7F&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;AutoStart&quot;&#160;VALUE=-1&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;XSeries&quot;&#160;VALUE=&quot;0,0;100,640&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;YSeries&quot;&#160;VALUE=&quot;0,480;100,0&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;EdgeAction&quot;&#160;VALUE=&quot;2&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;TickInterval&quot;&#160;VALUE=10&gt;
&lt;/OBJECT&gt;
</PRE>
<P>Note how the XSeries and YSeries properties use a tick/coordinate 
pair to define the position of an object. With such pairs, you can simply define 
key positions at key moments and the Path control takes care of interpolating 
the position of the object at intermediate ticks. TickInterval is used to specify 
the duration of a tick. This example takes 1 second to cross the browser 
because a single tick occurs every 10 milliseconds and it takes 100 ticks to complete 
the animation. The AutoStart property determines whether the path 
animation occurs immediately after the page is loaded, and EdgeAction defines 
behavior after the path is complete. In this case, the animation begins 
immediately and keeps looping. Listing 4-14 shows the Path control and the 
Structured Graphics control creating a bouncing ball.


<P>
<B>Listing 4-14.</B> <I>A bouncing ball created with the Path control.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META&#160;NAME=&quot;GENERATOR&quot;&#160;Content=&quot;Microsoft&#160;Developer&#160;Studio&quot;&gt;
&lt;META&#160;HTTP-EQUIV=&quot;Content-Type&quot;&#160;content=&quot;text/html;&#160;
&#160;&#160;&#160;&#160;charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;Bouncing&#160;Ball&lt;/TITLE&gt;

&lt;SCRIPT&#160;LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--

&#160;&#160;&#160;&#160;Sub&#160;Window_OnLoad()
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pathBall.Target&#160;=&#160;objBall.Style
&#160;&#160;&#160;&#160;End&#160;Sub

--&gt;
&lt;/SCRIPT&gt;

&lt;/HEAD&gt;

&lt;BODY&#160;BGCOLOR=&quot;BLACK&quot;&#160;TEXT=&quot;RED&quot;&gt;

&lt;!--&#160;Structured&#160;Graphics&#160;control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;objBall&quot;
STYLE=&quot;position:absolute;height:70;width:110;top:0;left:0;zindex:0&quot;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:5FD6A143-372A-11D0-A521-0080C78FEE85&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Line0001&quot;&#160;VALUE=&quot;SetLineColor(255,255,255)&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Line0002&quot;&#160;VALUE=&quot;SetFillColor(255,0,0,0,0,255)&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Line0003&quot;&#160;VALUE=&quot;SetFillSTYLE(1)&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Line0004&quot;&#160;VALUE=&quot;SetLineSTYLE(1)&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Line0005&quot;&#160;VALUE=&quot;Oval(0,-25,50,50,0)&quot;&gt;
&lt;/OBJECT&gt;

&lt;!--&#160;Path&#160;control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;pathBall&quot;&#160;&#160;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:E0E3CC60-6A80-11D0-9B40-00A0C903AA7F&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=AutoStart&#160;VALUE=-1&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=XSeries&#160;VALUE=&quot;0,0;30,0;45,0;52,0;55,0&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=YSeries&#160;VALUE=&quot;0,0;30,80;45,160;52,240;55,320&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=EdgeAction&#160;VALUE=&quot;1&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=TickInterval&#160;VALUE=10&gt;
&lt;/OBJECT&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>



</blockquote><HR>

<H2>
<B>Sequencer Control</B>
</H2>
<P>The Sequencer control is an ActiveX control that you can use to sequence 
a series of actions. These actions can include calling VBScript functions, 
manipulating ActiveX control properties and methods, and accessing intrinsic 
HTML controls. The Sequencer control allows you to synchronize behavior 
among scripts and objects by defining a set of actions to occur across the page.
<P>Just as the Structured Graphics control uses a series of &lt;PARAM&gt; tags 
to define a vector graphic, the Sequencer control uses a 
series of &lt;PARAM&gt; tags to define a series of actions. Here is the basic syntax for the Sequencer control:
<PRE WIDTH="0">&lt;OBJECT&#160;ID=<I>object</I>
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:37992B41-F5E3-11CF-97DF-00A0C90FEE54&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Action<I>x</I>&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VALUE=&quot;AT&#160;<I>Time</I>,&#160;<I>RepeatCount</I>,&#160;<I>RepeatRate&#160;Action</I>,&#160;<I>TieBreak</I>&quot;&gt;
</PRE>
<P>Action<I>x</I> is the NAME attribute of the &lt;PARAM&gt; tag and is structured 
as an integer beginning with 0001. The actions specified by the Sequencer 
control must be in order as &lt;PARAM&gt; tags starting with 0001. The VALUE 
attribute specifies which action to take. 
<I>Time</I> is when to take the action, specified 
in minutes:seconds:milliseconds after the sequence begins. 
<I>RepeatCount</I> is the number of times to repeat the action, where 
-1 is an infinite loop. <I>RepeatRate </I>defines the interval at which the action should be repeated, specified in 
the minutes:seconds:milliseconds format. <I>Action 
</I>is the act performed by the Sequencer, and <I>TieBreak 
</I>is a priority number assigned to the action in case 
two actions conflict. For example, the following code calls a VBScript 
function named Animate every second in an infinite loop:
<PRE WIDTH="0">&lt;OBJECT&#160;ID=&quot;Sequencer1&quot;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:37992B41-F5E3-11CF-97DF-00A0C90FEE54&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Action0001&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VALUE=&quot;AT&#160;00:00:00,&#160;-1,&#160;00:01:00&#160;Animate(),&#160;1&quot;<I>&gt;</I>
</PRE>
<H2>
<B>Sprite Control</B>
</H2>
<P>The Sprite control is an ActiveX control that provides frame-based 
animation for your Web page. To use the control, you must define a series of images 
that will create the frames of an animated sequence. Once the images are 
defined, you can control when and how the animation plays. This makes the 
Sprite control superior to both an animated GIF, which cannot be controlled, and 
a movie, which generally takes longer to download. The Sprite control can 
also use an associated Sprite Frame Source object, which allows you to create 
animated frames as a grid of images. This means, for example, that you can 
download a single GIF file that contains all of the animation frames, structured 
in a grid format that the Sprite Frame Source object can provide as discrete 
frames to the Sprite control.<P>
Listing 4-15 shows a complete example using a series of GIF images of 
the earth. The images are stored together in a single file named 
EARTHGRID.GIF. (See Figure 4-5.) The file contains 18 images in total, arranged in two 
columns of 9 images.


<P>
<B>Listing 4-15.</B> <I>The Sprite control.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META&#160;NAME=&quot;GENERATOR&quot;&#160;Content=&quot;Microsoft&#160;Visual&#160;InterDev&#160;1.0&quot;&gt;
&lt;META&#160;HTTP-EQUIV=&quot;Content-Type&quot;&#160;content=&quot;text/html;&#160;
&#160;&#160;&#160;&#160;charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;The&#160;Sprite&#160;Control&lt;/TITLE&gt;

&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;!--&#160;The&#160;Sprite&#160;control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;Earth&quot;&#160;HEIGHT=50&#160;WIDTH=50
CLASSID=&quot;CLSID:FD179533-D86E-11D0-89D6-00A0C90833E6&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Repeat&quot;&#160;VALUE=-1&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;PlayRate&quot;&#160;VALUE=1&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;InitialFrame&quot;&#160;VALUE=1&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;FrameMap&quot;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VALUE=&quot;1,100,,;2,100,,;3,100,,;4,100,,;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;5,100,,;6,100,,;7,100,,;8,100,,;9,100,,;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;10,100,,;11,100,,;12,100,,;13,100,,;14,100,,;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;15,100,,;16,100,,;17,100,,;18,100,,;&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;NumFrames&quot;&#160;VALUE=18&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;NumFramesAcross&quot;&#160;VALUE=9&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;NumFramesDown&quot;&#160;VALUE=2&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;SourceURL&quot;&#160;VALUE=&quot;EARTHGRID.GIF&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;MouseEventsEnabled&quot;&#160;VALUE=&quot;False&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;AutoStart&quot;&#160;VALUE=-1&gt;
&lt;/OBJECT&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>



</blockquote><HR>
<P><img src="pictures/F04XF05.GIF" width=454 height=100 border=0>
<P><B>Figure 4-5.</B>


<I>EARTHGRID.GIF.</I>
<H2>
<B>Transitions Control</B>
</H2>
<P>The Transitions control is an ActiveX control that can create 
professional fades, wipes, and cuts between visible objects on the Web page. The 
control is placed in a page utilizing an &lt;OBJECT&gt; tag that specifies the type of 
transition. You connect the control to a particular object by intercepting 
the painting functions of the object you want to affect. For example, to apply 
a Transitions control named MyTrans to an &lt;IMG&gt; tag named MyGIF, you 
could use the following code:
<PRE WIDTH="0">MyGIF.StopPainting(MyTrans)
MyGIF.StartPainting(100)
</PRE>
<P>The StopPainting method ties the Transitions control to the 
selected element. The StartPainting method starts the transition. The duration of 
the transition is determined by the value passed to StartPainting. The value 
represents the speed of the transition in milliseconds. Listing 4-16 shows a 
simple example of a transition applied to text on a Web page.


<P>
<B>Listing 4-16.</B> <I>Transition of text on a Web page.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META&#160;NAME=&quot;GENERATOR&quot;&#160;Content=&quot;Microsoft&#160;Developer&#160;Studio&quot;&gt;
&lt;META&#160;HTTP-EQUIV=&quot;Content-Type&quot;&#160;content=&quot;text/html;&#160;
&#160;&#160;&#160;&#160;charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;Transitions&#160;Control&lt;/TITLE&gt;

&lt;SCRIPT&#160;LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--

&#160;&#160;&#160;&#160;Sub&#160;Window_OnLoad
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Intercept&#160;the&#160;painting&#160;process
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;txtDivision.StopPainting(Transition1)

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Set&#160;the&#160;text&#160;color
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;txtHeader.Style.Color&#160;=&#160;&quot;Black&quot;

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Start&#160;the&#160;transition
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;txtDivision.StartPainting(2000)
&#160;&#160;&#160;&#160;End&#160;Sub

--&gt;
&lt;/SCRIPT&gt;

&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;!--&#160;Transitions&#160;control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;Transition1&quot;&#160;WIDTH=11&#160;HEIGHT=11
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:EEE70103-6A8F-11D0-BD28-00A0C908DB96&quot;&gt;

&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Clsid&quot;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VALUE=&quot;{EB8F50E2-85D1-11D0-9D9D-00A0C908DB96}&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;TransitionStyle&quot;&#160;VALUE=&quot;1&quot;&gt;
&lt;/OBJECT&gt;

&lt;!--&#160;The&#160;text&#160;to&#160;transition&#160;--&gt;
&lt;DIV&#160;ID=&quot;txtDivision&quot;&#160;
&#160;&#160;&#160;&#160;STYLE=&quot;position:relative;&#160;height:100;&#160;width:200;&quot;&gt;
&lt;H1&#160;ID=&quot;txtHeader&quot;&#160;STYLE=&quot;color:white;&quot;&gt;Text&#160;Transition&lt;/H1&gt;
&lt;/DIV&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>



</blockquote><HR>
<H2>
<B>Visual Filter Control</B>
</H2>
<P>The Visual Filter control is an ActiveX control that applies effects such 
as shadows, flips, and lights to visible elements on the Web page. Multiple 
effects can be grouped under a single ActiveX control through the use of 
&lt;PARAM&gt; tags. Each series of tags designates an effect that you identify with a 
unique integer. The following code shows how to create a light source on the page:
<PRE WIDTH="0">&lt;OBJECT&#160;ID=&quot;objLight&quot;&#160;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:DA9E9D23-3661-11D0-BDC2-00A0C908DB96&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Effect0.Clsid&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VALUE=&quot;{F1631E43-47F8-11D0-80D4-00AA006EC537}&quot;&gt;
&lt;/OBJECT&gt;
</PRE>
<P>Once the effect is created, you must apply it to an element on the 
page by setting the Filter property of the element. &lt;DIV&gt;, &lt;IMG&gt;, and 
&lt;OBJECT&gt; tags support the Filter property. Listing 4-17 shows a complete example.


<P>
<B>Listing 4-17.</B> <I>The Visual Filter control.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;SCRIPT&#160;LANGUAGE=&quot;VBScript&quot;&gt;

&lt;!--

&#160;&#160;&#160;&#160;Sub&#160;Window_OnLoad
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Add&#160;a&#160;point&#160;of&#160;light

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Call&#160;objLight(0).AddPoint(0,&#160;0,&#160;250,&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;255,&#160;0,&#160;0,&#160;90)

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Set&#160;the&#160;filter&#160;on&#160;the&#160;object
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;txtDivision.Filter&#160;=&#160;objLight
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;objLight.Refresh
&#160;&#160;&#160;&#160;End&#160;Sub

&#160;&#160;&#160;&#160;Sub&#160;Document_OnMouseMove()
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Move&#160;the&#160;light&#160;source
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Call&#160;objLight(0).MoveLight(0,&#160;Window.Event.x,&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Window.Event.y,&#160;250,&#160;-1)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;objLight.Refresh
&#160;&#160;&#160;&#160;End&#160;Sub

--&gt;
&lt;/SCRIPT&gt;
     
&lt;BODY&#160;BGCOLOR=&quot;BLACK&quot;&gt;
&lt;!--&#160;The&#160;Visual&#160;Filter&#160;control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;objLight&quot;&#160;WIDTH=11&#160;HEIGHT=11
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:DA9E9D23-3661-11D0-BDC2-00A0C908DB96&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Effect0.Clsid&quot;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VALUE=&quot;{F1631E43-47F8-11D0-80D4-00AA006EC537}&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Effect0.ID&quot;&#160;VALUE=&quot;Filter1&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Effect0.Enabled&quot;&#160;VALUE=&quot;-1&quot;&gt;
&#160;&#160;&#160;&#160;&lt;PARAM&#160;NAME=&quot;Effect0.LightsAmount&quot;&#160;VALUE=&quot;100&quot;&gt;
&lt;/OBJECT&gt;

&lt;!--&#160;The&#160;text&#160;to&#160;light&#160;up&#160;--&gt;
&lt;DIV&#160;ID=&quot;txtDivision&quot;&#160;
&#160;&#160;&#160;&#160;STYLE=&quot;position:relative;&#160;width:100%;&#160;
&#160;&#160;&#160;&#160;height:100%;&#160;left:0;&#160;top:0&quot;&gt;

&lt;CENTER&gt;
&lt;FONT&#160;COLOR=&quot;WHITE&quot;&#160;FACE=&quot;Verdana&quot;&#160;SIZE=&quot;100pt&quot;&gt;
Lights
&lt;/FONT&gt;
&lt;/CENTER&gt;

&lt;/DIV&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>



</blockquote><HR>
<H2>
<B>Mixer Control</B>
</H2>
<P>With all the great visual multimedia effects to experiment with, don't 
forget audio! The Mixer control is an ActiveX control that mixes together 
different sound wave files. You can play individual wave files or combine wave files 
inside channels. The control uses both Sound and Channel objects to handle 
the WAV files and associated channels. Adding a sound to the control is a 
matter of using the NewSound method. Sounds can easily be played using the 
Play method of the Sound object. Listing 4-18 produces an example that plays 
a familiar WAV file when a Web page is loaded.


<P>
<B>Listing 4-18.</B> <I>The Mixer control.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META&#160;NAME=&quot;GENERATOR&quot;&#160;Content=&quot;Microsoft&#160;Developer&#160;Studio&quot;&gt;
&lt;META&#160;HTTP-EQUIV=&quot;Content-Type&quot;&#160;content=&quot;text/html;&#160;
&#160;&#160;&#160;&#160;charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;Mixer&#160;Control&lt;/TITLE&gt;

&lt;SCRIPT&#160;LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--

&#160;&#160;&#160;&#160;'&#160;Variable&#160;for&#160;Sound&#160;object
&#160;&#160;&#160;&#160;Public&#160;Wave

&#160;&#160;&#160;&#160;Sub&#160;Window_OnLoad
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Declare&#160;Sound&#160;object
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set&#160;Wave&#160;=&#160;objSound.NewSound(&quot;URLWav&quot;)

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Load&#160;wave&#160;file
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Wave.LoadMedia&#160;&quot;The&#160;Microsoft&#160;Sound.wav&quot;,&#160;2

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Play&#160;wave&#160;file
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Wave.Play
&#160;&#160;&#160;&#160;End&#160;Sub
--&gt;
&lt;/SCRIPT&gt;

&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;H1&gt;Try&#160;leaving&#160;and&#160;returning&#160;to&#160;this&#160;page!&lt;/H1&gt;

&lt;!--&#160;The&#160;Mixer&#160;control&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;objSound&quot;
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:9A7D63C1-5391-11D0-8BB6-0000F803A803&quot;&gt;
&lt;/OBJECT&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>



</blockquote><HR>
<H2>
<B>The Microsoft Agent</B>
</H2>
<P>Using a browser to explore the Internet is simple. The challenge is to find 
what you want when you arrive at a Web site. Web sites are usually designed 
with creative considerations, not standardization, in mind, so each presents a 
unique landscape to the bewildered user. Even familiar sites can be updated 
frequently. The result of this confusion is that most people resort to simply using 
search services and blindly following hyperlinks until they stumble upon some 
useful information.<P>
The Microsoft Agent is an ActiveX control that provides a friendly 
assistant to help explore Internet sites. This assistant can be programmed 
by the site developer to help users find information. 
In the current version, a developer can choose from three different standard characters or create 
a new character.<P>
Programming a Web page to host the Agent is as simple as placing 
any ActiveX control in a page. Simply use the &lt;OBJECT&gt; tag with the 
appropriate CLASSID attribute, and the Agent is available. Because the Agent ships 
with IE 4.0, you are guaranteed that it will always be available on the client machine. 
 The following code shows the &lt;OBJECT&gt; tag for the Agent:
<PRE WIDTH="0">&lt;OBJECT&#160;ID=&quot;Agent1&quot;&#160;WIDTH=32&#160;HEIGHT=32
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:F5BE8BD2-7DE6-11D0-91FE-00C04FD701A5&quot;&gt;
&lt;/OBJECT&gt;
</PRE>
<P>When the control is available, you must load the selected character 
before it can be displayed. You can load more than one character into the 
Agent control, and they will all be managed as members of the Characters 
collection. When loading a character, you simply provide the filename and a name for 
the character to use in the Characters collection.<P>
Once loaded, the Agent can be displayed by calling the Show method. 
The Agent supports speech and movement to present the personality. It can 
speak any text string provided to the Speak method and can move to any pixel 
location specified in the MoveTo method. Listing 4-19 shows a complete 
example that allows you to display, move, and converse with the standard Agent 
characters shown in Figure 4-6.<P>
The Agent can do more than simply move and speak. It can also 
receive voice or mouse input and can perform tasks such as navigating to a desired 
Web page. These features are explored in detail in the project in <a href="ch07a.htm">Chapter 7</a>.


<P>
<B>Listing 4-19.</B> <I>Using the Microsoft Agent.</I>
<HR><BLOCKQUOTE>
<PRE WIDTH="0">
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META&#160;NAME=&quot;GENERATOR&quot;&#160;Content=&quot;Microsoft&#160;Developer&#160;Studio&quot;&gt;
&lt;META&#160;HTTP-EQUIV=&quot;Content-Type&quot;&#160;content=&quot;text/html;&#160;
&#160;&#160;&#160;&#160;charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;Document&#160;Title&lt;/TITLE&gt;

&lt;SCRIPT&#160;LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--
&#160;&#160;&#160;&#160;Sub&#160;Window_OnLoad
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Dimension&#160;variables
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim&#160;Agents
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim&#160;AgentPath

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Set&#160;variables
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set&#160;Agents&#160;=&#160;Document.frmAgent.Agent1.Characters
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;AgentPath&#160;=&#160;&quot;c:\program&#160;files\microsoft&#160;agent\characters\&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Load&#160;characters
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Agents.Load&#160;&quot;GENIE&quot;,&#160;AgentPath&#160;&amp;&#160;&quot;Genie.acs&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Agents.Load&#160;&quot;ROBOT&quot;,&#160;AgentPath&#160;&amp;&#160;&quot;Robby.acs&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Agents.Load&#160;&quot;WIZARD&quot;,&#160;AgentPath&#160;&amp;&#160;&quot;Merlin.acs&quot;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;End&#160;Sub

&#160;&#160;&#160;&#160;Sub&#160;cmdSpeech_OnClick()
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Declare&#160;variables
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim&#160;MyAgent
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim&#160;MyForm
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim&#160;AgentName

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Get&#160;data
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set&#160;MyForm&#160;=&#160;Document.frmAgent
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set&#160;MyAgent&#160;=&#160;Document.frmAgent.Agent1
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;AgentName&#160;=&#160;MyForm.lstAgents.Value

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MyAgent.Characters(AgentName).Show
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MyAgent.Characters(AgentName).Speak&#160;MyForm.txtSpeech.Value
&#160;&#160;&#160;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Window.Event.CancelBubble&#160;=&#160;True
&#160;&#160;&#160;&#160;End&#160;Sub

&#160;&#160;&#160;&#160;Sub&#160;Document_OnClick()
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;' Declare&#160;variables
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim&#160;MyAgent
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dim&#160;AgentName

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'&#160;Get&#160;data
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set&#160;MyForm&#160;=&#160;Document.frmAgent
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Set&#160;MyAgent&#160;=&#160;Document.frmAgent.Agent1
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;AgentName&#160;=&#160;MyForm.lstAgents.Value
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MyAgent.Characters(AgentName).MoveTo&#160;Window.Event.X,&#160;_
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Window.Event.Y
&#160;&#160;&#160;&#160;End&#160;Sub
--&gt;
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;FORM&#160;NAME=&quot;frmAgent&quot;&gt;
&lt;!--&#160;The&#160;Microsoft&#160;Agent&#160;--&gt;
&lt;OBJECT&#160;ID=&quot;Agent1&quot;&#160;WIDTH=32&#160;HEIGHT=32
&#160;&#160;&#160;&#160;CLASSID=&quot;CLSID:F5BE8BD2-7DE6-11D0-91FE-00C04FD701A5&quot;&gt;
&lt;/OBJECT&gt;

&lt;P&gt;

&lt;INPUT&#160;TYPE=&quot;TEXT&quot;&#160;NAME=&quot;txtSpeech&quot;&#160;VALUE=&quot;Dynamic&#160;HTML&#160;is&#160;Cool!&quot;&gt;
&lt;INPUT&#160;TYPE=&quot;BUTTON&quot;&#160;NAME=&quot;cmdSpeech&quot;&#160;VALUE=&quot;Speak!&quot;&gt;
&lt;/P&gt;


&lt;SELECT&#160;NAME=&quot;lstAgents&quot;&#160;SIZE=3&gt;
&#160;&#160;&#160;&#160;&lt;OPTION&#160;VALUE=&quot;GENIE&quot;&#160;SELECTED&gt;Genie
&#160;&#160;&#160;&#160;&lt;OPTION&#160;VALUE=&quot;WIZARD&quot;&gt;Merlin
&#160;&#160;&#160;&#160;&lt;OPTION&#160;VALUE=&quot;ROBOT&quot;&gt;Robby
&lt;/SELECT&gt;

&lt;/FORM&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>


</blockquote><HR>
<P><img src="pictures/F04XF06.GIF" width=581 height=387 border=0><P>
<B>Figure 4-6.</B>


<I>The Microsoft Agent.</I>
</BODY>
</HTML>
