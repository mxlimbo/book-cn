<html>
<head>
<title>网络编程基础篇之PERL</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<link rel="stylesheet" href="ebook.css" type="text/css">
</head>
<body leftmargin="0" topmargin="0" background="bg.jpg">
<table width="100%" cellspacing="0">
  <tr>
    <td valign="top" bgcolor="#FFD26A">
      <table width="180" height="100%">
        <tr align="center" valign="top">
          <td>
            <p><img src="image.jpg"></p>
            <p><a href="list.htm"><img src="bd.gif" border="0"></a><br>
              <a href="07.htm"><img src="ap.gif" border="0"></a></p>
          </td>
        </tr>
        <tr align="center" valign="bottom">
          <td><a href="09.htm"><img src="np.gif" border="0"></a></td>
        </tr>
      </table>
    </td>
    <td valign="top">
      <blockquote>
        <div align="center"><img src="title.gif"></div>
        <!--正文开始-->
        <font color="#0000FF"> 子程序</font>
        <p> <font color="#0000FF"> 一、定义</font> <br>
 &nbsp;&nbsp;子程序即执行一个特殊任务的一段分离的代码，它可以使减少重复代码且使程序易读。PERL中，子程序可以出现在程序的任何地方。定义方法为：<br>
&nbsp;&nbsp;sub subroutine{<br>
&nbsp;&nbsp;&nbsp;&nbsp;statements;<br>
&nbsp;&nbsp;}<br>
          <font color="#0000FF"> 二、调用</font> <br>
&nbsp;&nbsp;调用方法如下：<br>
          <font color="#0000FF"> 1、用&amp;调用</font> <br>
&nbsp;&nbsp;&amp;subname;<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;sub subname{<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;}<br>
          <font color="#0000FF"> 2、先定义后调用</font> ，可以省略&amp;符号<br>
&nbsp;&nbsp;sub subname{<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;subname;<br>
          <font color="#0000FF"> 3、前向引用</font> ，先定义子程序名，后面再定义子程序体<br>
&nbsp;&nbsp;sub subname;<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;subname;<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;sub subname{<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;}<br>
          <font color="#0000FF"> 4、用do调用</font> <br>
&nbsp;&nbsp;do my_sub(1, 2, 3);等价于&amp;my_sub(1, 2, 3);<br>
          <font color="#0000FF"> 三、返回值</font> <br>
&nbsp;&nbsp;缺省的，子程序中最后一个语句的值将用作返回值。语句return
(retval);也可以推出子程序并返回值retval，retval可以为列表。<br>
          <font color="#0000FF"> 四、局部变量</font> <br>
&nbsp;&nbsp;子程序中局部变量的定义有两种方法：my和local。其区别是：my定义的变量只在该子程序中存在；而local定义的变量不存在于主程序中，但存在于该子程序和该子程序调用的子程序中(在PERL4中没有my)。定义时可以给其赋值，如：<br>
&nbsp;&nbsp;my($scalar) = 43;<br>
&nbsp;&nbsp;local(@array) = (1, 2, 3);<br>
          <font color="#0000FF"> 五、子程序参数传递</font> <br>
          <font color="#0000FF"> 1、形式</font> <br>
&nbsp;&nbsp;&amp;sub1(&amp;number1, $number2, $nubmer3);<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;sub sub1{<br>
&nbsp;&nbsp;&nbsp;&nbsp;my($number1, $number2, $number3) = @_;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;}<br>
          <font color="#0000FF"> 2、传送数组</font> <br>
&nbsp;&nbsp;&amp;addlist (@mylist);<br>
&nbsp;&nbsp;&amp;addlist ("14", "6",
"11");<br>
&nbsp;&nbsp;&amp;addlist ($value1, @sublist, $value2);<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;sub addlist {<br>
&nbsp;&nbsp;&nbsp;&nbsp;my (@list) = @_;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;}<br>
参数为数组时，子程序只将它赋给一个数组变量。如<br>
&nbsp;&nbsp;sub twolists {<br>
&nbsp;&nbsp;&nbsp;&nbsp;my (@list1, @list2) = @_;<br>
&nbsp;&nbsp;}<br>
中@list2必然为空。但简单变量和数组变量可以同时传递：<br>
&nbsp;&nbsp;&amp;twoargs(47, @mylist); # 47赋给$scalar，@mylist赋给@list<br>
&nbsp;&nbsp;&amp;twoargs(@mylist); # @mylist的第一个元素赋给$scalar，其余的元素赋给@list<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;sub twoargs {<br>
&nbsp;&nbsp;&nbsp;&nbsp;my ($scalar, @list) = @_;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;}<br>
          <font color="#0000FF"> 六、递归子程序</font> <br>
&nbsp;&nbsp;PERL中，子程序可以互相调用，其调用方法与上述相同，当调用该子程序本身时，即成了递归子程序。递归子程序有两个条件：1、除了不被子程序改变的变量外，所有的变量必须的局部的；2、该子程序要含有停止调用本身的代码。<br>
          <font color="#0000FF"> 七、用别名传递数组参数</font> <br>
1、用前面讲到的调用方法&amp;my_sub(@array)将把数组@array的数据拷贝到子程序中的变量@_中，当数组很大时，将会花费较多的资源和时间，而用别名传递将不做这些工作，而对该数组直接操作。形式如：<br>
&nbsp;&nbsp;@myarray = (1, 2, 3, 4, 5);<br>
&nbsp;&nbsp;&amp;my_sub(*myarray);<br>
&nbsp;&nbsp;sub my_sub {<br>
&nbsp;&nbsp;&nbsp;&nbsp;my (*subarray) = @_;<br>
&nbsp;&nbsp;}<br>
2、此方法类似于C语言中的传递数组的起始地址指针，但并不一样，在定义数组的别名之后，如果有同名的简单变量，则对该变量也是起作用的。如：<br>
&nbsp;&nbsp;$foo = 26;<br>
&nbsp;&nbsp;@foo = ("here's", "a",
"list");<br>
&nbsp;&nbsp;&amp;testsub (*foo);<br>
&nbsp;&nbsp;...<br>
&nbsp;&nbsp;sub testsub {<br>
&nbsp;&nbsp;&nbsp;&nbsp;local (*printarray) = @_;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;$printarray = 61;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;当子程序执行完，主程序中的$foo的值已经成了61，而不再是26了。<br>
3、用别名的方法可以传递多个数组，如：<br>
&nbsp;&nbsp;@array1 = (1, 2, 3);<br>
&nbsp;&nbsp;@array2 = (4, 5, 6);<br>
&nbsp;&nbsp;&amp;two_array_sub (*array1, *array2);<br>
&nbsp;&nbsp;sub two_array_sub {<br>
&nbsp;&nbsp;&nbsp;&nbsp;my (*subarray1, *subarray2) = @_;<br>
&nbsp;&nbsp;} <br>
&nbsp;&nbsp;在该子程序中，subarray1是array1的别名，subarray2是array2的别名。<br>
          <font color="#0000FF"> 八、预定义的子程序</font> <br>
&nbsp;&nbsp;PERL5预定义了三个子程序，分别在特定的时间执行，它们是：BEGIN子程序在程序启动时被调用；END子程序在程序结束时被调用；AUTOLOAD子程序在找不到某个子程序时被调用。你可以自己定义它们，以在特定时间执行所需要的动作。如：<br>
&nbsp;&nbsp;BEGIN&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;print("Hi! Welcome to
Perl!\n");<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;AUTOLOAD{<br>
&nbsp;&nbsp;&nbsp;&nbsp;print("subroutine $AUTOLOAD not
found\n"); # 变量$AUTOLOAD即未找到的子程序名<br>
&nbsp;&nbsp;&nbsp;&nbsp;print("arguments passed:
@_\n");<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;若同一个预定义子程序定义了多个，则BEGIN顺序执行，END逆序执行。<br>
<br>
        <!--正文结束-->
      <center>
      <hr>
      <p>本书由<a href="http://www.huiniao.com/">【灰鸟资讯】</a>免费制作<br>
          想要更多的免费电子图书，请光临<br>
          <a href="http://www.huiniao.com">http://www.huiniao.com</a></p>
      </center>
      </blockquote>
    </td>
  </tr>
</table>
</body>
</html>
