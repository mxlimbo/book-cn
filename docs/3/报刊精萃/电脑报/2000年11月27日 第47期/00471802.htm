 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>《电脑报》电子版 -- VFP中调用API函数启动邮件程序</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极飞翔聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/all.html'>2000年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->47期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{VFP中调用API函数启动邮件程序}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{VFP中调用API函数启动邮件程序}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　我们启动一个非Visual FoxPro的应用程序，经常使用的是RUN命令。使用RUN命令只需要应用程序的文件名及其路径，比如我们需要从Visual 
      FoxPro中启动位于C:\PWIN98目录下的计算器程序CALC.EXE，就可以使用命令RUN C:\PWIN98\CALC.EXE来实现。该命令还有其他的一些参数，用来控制应用程序被激活时的状态，具体可以参考Visual 
      FoxPro的帮助文件。<br>
      　　但是，在很多情况下我们并不能够清楚地知道所需要启动的应用程序的文件名及其位置。比如我们需要启动用户机器上缺省的WWW浏览器并连接到某一个网站地址，该用户使用的可能是IE，也可能是NetScape，还有可能是其他的浏览器软件如Opera，这时候RUN命令就显得无能为力了。<br>
      　　我们知道，在桌面上或者是资源管理器里双击某个文件时，Windows 就会自动调用与该文件相关联的应用程序来对其进行处理。比如我们在桌面上双击某个DOC文件，Windows就会启动Word并将该DOC文件打开。在这个过程中Windows使用了一个名为ShellExecute 
      的Win32 API函数，其功能是打开或者是打印某个指定的文件，这个文件可以是一个可执行文件，也可以是一个文档。这个命令包含在Windows自带的SHELL32.DLL文件中，调用的语法为：<br>
      　　HINSTANCE ShellExecute(<br>
      　　HWND hwnd, // 指向调用本命令之父窗口的句柄<br>
      　　LPCTSTR lpOperation, //指定本命令所要执行的动作<br>
      　　LPCTSTR lpFile, // 指定本命令所要操作的文件<br>
      　　LPTSTR lpParameters, // 指定操作文件时所使用的参数<br>
      　　LPCTSTR lpDirectory, // 指定本命令所使用的缺省路径<br>
      　　INT nShowCmd // 指定文件被打开时的状态<br>
      　　);<br>
      　　以下这段程序介绍了在Visual FoxPro中声明ShellExecute函数并调用缺省的电子邮件软件向wushanpy@sina.com发送电子邮件的方法。<br>
      　　＊ 声明ShellExecute函数<br>
      　　DECLARE INTEGER ShellExecute IN shell32.DLL INTEGER HWND,;<br>
      　　STRING lpszOP, ;<br>
      　　STRING lpszFile, ;<br>
      　　STRING lpszParams, ;<br>
      　　STRING lpszDir, ;<br>
      　　INTEGER fsshowcmd<br>
      　　＊ 声明GetDesktopWindow函数，该函数激活Windows桌面<br>
      　　DECLARE INTEGER GetDesktopWindow IN win32api<br>
      　　＊ 指定从Windows桌面上运行ShellExecute函数<br>
      　　HWND = GetDesktopWindow()<br>
      　　lpszOP = ″″<br>
      　　＊ 指定ShellExecute操作的文件为mailto:wushanpy@sina.com<br>
      　　lpszFile = ″mailto:wushanpy@sina.com″<br>
      　　lpszParams = ″″<br>
      　　＊ 指定ShellExecute的缺省目录为C:\<br>
      　　lpszDir = ″C:\″<br>
      　　fsshowcmd = 1<br>
      　　＊ 执行ShellExecute命令<br>
      　　LNRETURN = ShellExecute(HWND, lpszOP, lpszFile, lpszParams, lpszDir,fsshowcmd)<br>
      　　如果需要启动缺省的WWW浏览器并连接到某个站点，只需要将参数lpszFile换成该站点的URL地址即可。关于ShellExecute命令的其他用法，可以参考Visual 
      FoxPro所提供的Win32 API 帮助。<br>
      　　（福建　潘泳）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://www.cpcw.com/download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
