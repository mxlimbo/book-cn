 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 用VB编写“红绿灯”程序</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极飞翔聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><A HREF='http://www.cpcw.com'>《电脑报》电子版</A> 
      &gt; <A HREF='http://www.cpcw.com/all.html'>2000年</A> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->46期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{用VB编写“红绿灯”程序}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{用VB编写“红绿灯”程序}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　平时我们在过马路的时候常常会看到指挥交通的红绿灯，它的权利可大了，要是我们可以控制它就好了，虽然在现实生活中办不到，就让我们编写一个虚拟的红绿灯程序，也来过过控制红绿灯的瘾。<br>
      　　下面我们就开始编写吧。<br>
      　　第一件事当然是新建一个工程，然后引入所需控件。在“红绿灯”程序中，我们需要用到的控件有：OptionButton（选项按钮）、Image（图像框）及Timer（时钟）控件。引入两个OptionButton，其中Option1的Caption设置为“红灯”，Option2的Caption设置为“绿灯”；Image1的Picture属性设置为红灯图片，选择一张红灯图片（读者可以自己创建一个红灯及绿灯图片）。设计好的程序界面如图1。<br>
      　　好了，现在我们开始添加程序代码。<br>
      　　我们要求程序能够通过我们所选择的是红灯或绿灯来显示相应的图像，实现的原理就是当我们单击“红灯”时显示红灯图片，单击“绿灯”时显示绿灯图片，只要用户准备好这两张图片后，要实现这个功能就非常的容易了。其具体的程序代码如下：<br>
      　　双击Option1（即红灯）控件，添加如下代码：（黑体部分为系统自动生成的代码，下同）<br>
      　　Private Sub Option1_Click()<br>
      　　′显示红灯图片<br>
      　　On Error GoTo LoadErr　′当载入图片发生错误时跳到LoadErr处<br>
      　　If Option1.Value=True Then　′当单击了Option1控件时<br>
      　　Image1.Picture=LoadPicture(″C:\Windows\Desktop\red.jpg″)　′载入red.jpg图片，并显示在Image1控件中。<br>
      　　End If<br>
      　　LoadErr:　′设置捕获错误标签<br>
      　　If Err.Number=53 Then　′当发生错误时<br>
      　　　MsgBox Err.Description,vbOKOnly＋vbCritical,″错误″　′显示错误信息<br>
      　　End If<br>
      　　End Sub<br>
      　　上面一段代码中有一句“On Error Goto LoadErr”，该句是用作捕获程序错误的，当程序执行过程中发生了错误则跳到处理错误语句处执行。在这段代码中，如果在载入图片时发生了错误（通常是所要载入的文件不存在或路径错误）则跳到LoadErr处执行LoadErr后的程序代码。<br>
      　　在VB中，所有的程序错误都是用数字表示的，如53则表示未找到文件的错误码，其实要知道哪个错误码表示哪种错误也并不难，当你在VB中运行这个程序时，如果出现了错误，会有一个错误的提示框，在该提示框中则有该错误的错误码。如果我们没有在该段程序中加入“On 
      Error Goto LoadErr”语句及给出错误的文件名或文件路径的话，则会出现如图2所示的提示框。<br>
      　　LoadPicture是载入图片的函数，其中第一个参数则是所要载入图片的完整路径，当然在本例中这个路径是固定了的，所要想使其路径随程序路径的变化而变化则需要使用App.Path值，可以写成Image1.Picture=LoadPicture(App.Path＆″\red.jpg″)，其中App.Path返回的值则是程序所在的路径，当然red.jpg必须放在程序所在的同一目录中。<br>
      　　双击Option2（即绿灯）控件，添加如下代码：<br>
      　　Private Sub Option2_Click()<br>
      　　′显示绿灯图片<br>
      　　On Error GoTo LoadErr　′当载入图片发生错误时跳到LoadErr处<br>
      　　If Option2.Value=True Then　′当单击了Option2控件时<br>
      　　Image1.Picture=LoadPicture(″C:\Windows\Desktop\green.jpg″)　′载入green.jpg图片，并显示在Image1控件中。<br>
      　　End If<br>
      　　LoadErr:　′设置标签<br>
      　　If Err.Number=53 Then　′当发生错误时<br>
      　　　MsgBox Err.Description,vbOKOnly＋vbCritical,″错误″　′显示错误信息<br>
      　　End If<br>
      　　End Sub<br>
      　　OK！现在我们就可以单击F5键运行一下，看看我们自制的“红绿灯”程序吧。点击一下“绿灯”看看，红灯变成绿灯了吧？再试试红灯，怎样？现在我们就可以控制红绿灯了吧。<br>
      　　如何才能让“红绿灯”自动更换呢？要实现这个功能也非常简单，只要加入Timer（时钟）控件，将Timer1的Interval设置为3000（即3秒）。其原理就是每隔3秒更换一种图片，这样便实现了自动更换。<br>
      　　双击Timer1控件，添加如下代码：<br>
      　　Private Sub Timer1_Timer()<br>
      　　′实现自动化<br>
      　　If Option1.Value=True Then　′如果当前显示的是红灯<br>
      　　　Option2.Value=True　′使Option2被选中，执行Option2中的代码（即显示绿灯）<br>
      　　Else<br>
      　　　Option1.Value=True　′使Option1被选中，执行Option1中的代码（即显示红灯）<br>
      　　End If<br>
      　　End Sub<br>
      　　单击F5键运行一下，每隔3秒钟即换一种颜色显示。就这么几句代码就实现了自动化，简单吧？<br>
      　　如果你有什么疑问，欢迎写信与我交流，我的E－mail是：vber@21cn.com。<br>
      （伟子）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://www.cpcw.com/download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@yesky.com'>YESKY网站</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
