 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>《电脑报》电子版 -- 用VC＋＋在单文档界面中创建多个视图（下）</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极飞翔聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/all.html'>2000年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->47期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{用VC＋＋在单文档界面中创建多个视图（下）}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{用VC＋＋在单文档界面中创建多个视图（下）}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　 // 删除视图<br>
      　　 pWndToDelete－&gt;DestroyWindow();<br>
      　　 pDoc－&gt;m_bAutoDelete = TRUE;<br>
      　　 ......<br>
      　　 }<br>
      　　 用户定义的回调函数:<br>
      　　 BOOL CALLBACK MyWndEnumProc(HWND hWnd, LPARAM ppWndLPARAM)<br>
      　　 {<br>
      　　 CWnd＊ pWndChild = CWnd::FromHandlePermanent(hWnd);<br>
      　　 CWnd＊＊ ppWndTemp = (CWnd＊＊)ppWndLPARAM;<br>
      　　 if( pWndChild ＆＆ pWndChild－&gt;IsKindOf(RUNTIME_CLASS(CView)) )<br>
      　　 {<br>
      　　 // 发现任何从CView继承的子窗口，将子窗口指针传递出去<br>
      　　 ＊ppWndTemp = pWndChild;<br>
      　　 // 停止继续搜索 <br>
      　　 return FALSE;<br>
      　　 }<br>
      　　 else<br>
      　　 {<br>
      　　 ＊ppWndTemp = NULL;<br>
      　　 // 继续搜索<br>
      　　 return TRUE;<br>
      　　 }}<br>
      　　 2．创建新的视图<br>
      　　 CDocument＊ pCurrentDoc = ((CFrameWnd＊) m_pMainWnd)－&gt;GetActiveDocument();<br>
      　　 // 初始化创建上下文相关指针<br>
      　　 CCreateContext newContext;<br>
      　　 newContext.m_pNewViewClass = RUNTIME_CLASS(CView1);<br>
      　　 newContext.m_pCurrentDoc = pCurrentDoc;<br>
      　　 newContext.m_pNewDocTemplate = NULL;<br>
      　　 newContext.m_pLastView = NULL;<br>
      　　 newContext.m_pCurrentFrame = NULL;<br>
      　　 CView＊ pNewView = STATIC_DOWNCAST(CView, CreateView(＆newContext));<br>
      　　 if( pNewView == NULL )<br>
      　　 {<br>
      　　 return FALSE;<br>
      　　 }<br>
      　　 // 使用CreateView创建的视图不能自动调用OnInitialUpdate函数，需要人工调用OnInitialUpdate函数或者发送WM_INITIALUPDATE消息<br>
      　　 pNewView－&gt;OnInitialUpdate(); <br>
      　　 // 使用CreateView创建的视图不会自动显示并且激活，需要人工操作<br>
      　　 pNewView－&gt;ShowWindow(SW_SHOW); <br>
      　　 SetActiveView(pNewView);<br>
      　　 RecalcLayout();<br>
      　　注：RUNTIME_CLASS宏含义<br>
      　　每一个从CObject类继承的类，在定义DECLARE_DYNAMIC、DECLARE_DYNCREATE、DECLARE_SERIAL三个中任意一个宏时都会产生一个CRuntimeClass结构的静态对象，RUNTIME_CLASS返回的就是这个对象的指针，这个对象包含了其基类和本身在运行时刻的信息。以上是笔者在编写多个视应用在单文档的程序时整理出来的两种方法，因为VC＋＋的强大和灵活，笔者相信还有更加巧妙的方法实现这个功能，希望这篇文章能够起到抛砖引玉的作用，也希望广大VC＋＋编程爱好者对本文能够给予批评和指正。　　<br>
      （北京　周伟）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://www.cpcw.com/download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
