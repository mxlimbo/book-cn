 
<HTML>
<!-- #BeginTemplate "/模板/game.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2812'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- Quake3不一样的修改——PAK文件深入研究（下）</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极飞翔聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='http://www.cpcw.com'>《电脑报》电子版</A> 
      &gt; <A HREF='http://www.cpcw.com/all.html'>2000年</A> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->48期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="game.html">游戏广场</a><!-- #EndEditable -->&gt; 
      <!-- #BeginEditable "%B1%EA%CC%E2" -->{Quake3不一样的修改——PAK文件深入研究（下）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{Quake3不一样的修改——PAK文件深入研究（下）}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　自己动手做效果包，补充包<br>
      　　Quake3的pk3文件由于是用Winzip打开，故创建自己的pk3文件与修改pak文件不同。由于pk3文件内的文件都要求有自己的目录结构，故打包时需要带相对路径。一般我是按目录结构先放置好我的一批文件，全部选取后再用右键点击它们，在弹出的快捷菜单中选择add 
      to zip选项即可。加入某个已有的pk3包也不失为一个好办法。<br>
      　　会做pk3包后就要开始做自己的扩充包了，举几个例子，权当抛砖引玉。<br>
      　　例一，Quake大赛推出了q3dm13,q3dm6的修改版（也叫tmp版），还有日趋流行的ZTNDM1、pro mode下的q3jdm8a等地图，它们平时都是零乱地以cpldm6.pk3,cpldm13.pk3,ztn3dm1.pk3等形式单独地放在baseq3目录下，随着各种效果包、补充地图的增多，管理起来很不方便。于是我就将他们从各自的pk3文件里取出，解压到同一目录里，再打成一个名为maps.pk3的包，看起来清爽多了。这属于地图补充包。<br>
      　　例二，每次调用最常玩的dm13、dm6、t2、t4很麻烦，要选半天。在pak0.pk3里有一个scripts目录，里面有一个arenas.txt文件。它记载了每张地图是哪种模式，缺省的bots是谁，在地图选单里的出现顺序是怎样。修改它就可以解决这个问题。下面我以其中的一段t4的描述字段为例介绍一下：<br>
      　　{／／以大括号为起始<br>
      　　map “q3tourney4” ／／地图名，即必须有q3tourney4.bsp文件在maps／下<br>
      　　bots “anarki” ／／用这张地图时缺省加入机器人，要加其他的bot写他的名字即可，用空格隔开<br>
      　　longname “Vertical Vengeance” ／／地图的名字，这个可以随便乱取<br>
      　　timelimit 10 ／／ <br>
      　　fraglimit 0 ／／<br>
      　　type“single ffa tourney”／／地图支持的游戏模式，你可以把q3dm17加到tourney模式里，专练railgun<br>
      　　}<br>
      　　你只要将常用地图的描述字段放到该文件的前面，每次进地图选单时它们就会出现在最前面了。如果要做一张地图，以pk3形式给别人用，那么在pk3文件里的scripts目录下就要建立一个XXX.arena文件——XXX为地图文件名。它是一个文本文件，里面写入这个文件的描述字段。如果有多张地图的话，可以不止一段。以后再进游戏，在第一级选单里就可选地图了。<br>
      　　例三，用例二可加入一些原来在地图选单里看不见的地图，但是有些地图包只给了地图文件和描述文件，在地图选单里却没有可以预览的图片。解决这个问题就要回顾一下前面提到的levelshots目录了。在英语里，往往不用“map”而用“level”来代表地图，levelshots／下都是各张地图的预览图片。它们都是128×128 
      16M色也称为24bit色的jpg图片。但根据我的实验，发现只要是jpg图片，不管多大都可以用。<br>
      　　要做一张预览图片，首先要用Ultraedit打开q3config.cfg文件（因为它是Unix下的文本，只有用Ultraedit才能正常打开），将一个键设定为抓图键，如bind 
      F12“&quot;screenshot”。进入游戏后在地图里，以旁观者模式选一个好角度，按F12即可抓一张图。<br>
      　　抓图时要注意：<br>
      　　1.在抓图前，把所有的图像参数设置设为最高，这样抓出来的图片才好看；<br>
      　　2.在Console里用“cg_draw2d 0”命令清除屏幕上的多余显示，如果你是在游戏模式下还要用“cg_drawgun 0”来消除枪的显示。当然也可以在q3config.cfg里用bind 
      F5“toggle cg_drawgun”和bind F6“toggle cg_draw2d”来简化这些操作。toggle的意思是在只有0，1两值时切换到另一值，按一下是1，再按一下是0。<br>
      　　3.当用“screenshot”连续抓图时，图片以shot0000.TGA，shot0001.TGA……的形式存放在游戏时所用mod的目录screenshots下，如在pro 
      mode下抓图则在Quake3 arena／pro／screenshots／下。<br>
      　　4.当前Quake3的图像设置决定抓出的图片格式，也就是说如果是在32bit色，1024×768下抓的图则所得图片也是这个格式。<br>
      　　另外，大家特别要注意的是，千万不要用Photoshop的save as a copy命令将TGA图转为jpg格式，而必须用Acdsee在浏览器模式下的tools→convert来转换为jpg图。得到所需的正确格式的jpg图片后，将其更名为你所希望代表的地图的名字。只要将其放到pk3文件的levelshots／目录下即可。(见图1)<br>
      　　四张最常用地图已经存在tournament的第一面；地图预览图片加上了“我爱QⅢ”的字样；如果是像我那样修改已有的预览图片的话，由于修改图片后，Photoshop会自动加一个layer(层）以记载改动的结果，所以在存盘前一定要将原有的layer和后来Photoshop加上这个layer合并才可存为其它所需的格式。用菜单中的layer→merge 
      layers或“Ctrl＋E”完成合并步骤；准星在“Ⅲ”之上。<br>
      　　例四，改Console里的背景。方法同上，改pak0.pk3里的／gfx／misc／console01.tga即可。<br>
      　　例五，自己做准星。准星是在pak0.pk3文件里的／gfx／2d／目录下的crosshaira.TGA——crosshairj.TGA。它们是32×32的32bit即16M＋色的TGA格式的图片。它们的大小其实并没有限制，只要准星在正中即可。TGA图片分为两种，一种是前面的普通的TGA图片，只有RGB三个8bit色彩通道，即24bit色;另一种就是准星的TGA，有三个8位色彩通道和一个8位alpha通道，共32bit。在pak0.pk3里有很多图片如icons／目录下的就是后一种格式的TGA图片。Quake3就是利用那个多出来的alpha通道来确定准星形状。如果直接用Acdsee来看则都是一个个白色的方块，因为它无法将alpha通道单独显示出来。<br>
      　　先以改造为例。任取一个准星文件如crosshaira.TGA，用Photoshop打开。选取菜单中的windows→show layers到show 
      actions里任意一项，唤出一个子窗口，暂称为channel窗口。选择其上的channel标签，即可看到RGB和alpha通道了。要显示alpha通道里的图形，只要在alpha通道前的小方格内点击一下即可，此时会在方格内出现一只眼睛的图案，而图片底色变为浅红，白色准星图案显出。但这只是显示，只有点击alpha通道使之变为蓝底后，才可编辑alpha通道里的图形。RGB通道决定颜色，alpha通道决定形状。现在你可以发挥你的想象力，做出你自己喜欢的准星啦!<br>
      　　如果已有TGA图片，可是缺乏alpha通道，则只要在channel窗口里点击最下面的一个像折了一角的书的按钮就可以添加一个alpha通道了（它的右边是一个垃圾箱样的图标）。<br>
      　　完成的图片应为TGA格式，如果做了修改后Photoshop不允许存为原有的TGA格式而是要求存为PSD格式，则是由于修改导致了一个新layer的产生，解决方法见例三里最后四个条款里的第三条。将最终图片放回pk3文件里的／gfx／2d／下即可，我建议还是做一个新的pk3,这样可以避免每次修改试用准星还要把pak0.pk3重新打一次包。<br>
      　　准星颜色我推荐用亮绿色，在周围景物中很明显，效果不错。}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp; </TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="file:///C%7C/WINDOWS/Desktop/download/yeskye.js">
</script>
    </TD>
    <TD> 《电脑报》版权所有，<A HREF='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</A>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
