 
<HTML>
<!-- #BeginTemplate "/Templates/oa.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2812'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --玩转Excel函数之旅（四）</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><a href='http://www.yesky.com' target="_blank"><img src='images/logo.gif' width='140' height='60' alt='天极网' border='0'></a></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com'>《电脑报》电子版</a> 
      &gt; <A href="http://www.cpcw.com/issue/all.html">2000年</A> &gt; <a href="http://www.cpcw.com/issue/all.html"><!-- #BeginEditable "%C6%DA" -->44期<!-- #EndEditable --></a> 
      &gt;<!-- #BeginEditable "%C0%B8%C4%BF" --> <a href="oa.html">OA专刊</a><!-- #EndEditable -->&gt; 
      <!-- #BeginEditable "%B1%EA%CC%E2" -->{玩转Excel函数之旅（四）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{玩转Excel函数之旅（四）}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%C4%DA%C8%DD" -->{　　前面介绍过求和函数(SUM)，它能对选取区域内的数据进行按行(或列)求和，但在实际应用中，经常需要进行有条件的数据汇总。本期介绍的总计函数(SUMIF)，将为你解决这个问题；另外介绍的分类汇总函数(SUBTOTAL)，可以很容易地计算分类汇总。这两个函数的作用都十分强大，利用它可以简化条件汇总和分类汇总。<br>
      　　如图1的样表，是某百货公司下属的四个门市部，都销售同样的商品；假设其中的四个售货员，轮流在四个门市部工作，样表是他们在一段时间内的营业销售情况，(其中的“金额”可以用公式计算，方法是在F2中输入公式“=D2＊E2”进行计算，然后按照前面讲述过的拖动进行复制的方法，即可求出各门市部各种商品的销售金额)。下面将举例说明用总计函数(SUMIF)，分别按门市部、售货员、某一商品、某一范围进行有关的汇总；用分类汇总函数(SUBTOTAL)，分别计算某门市部商品数量的平均值、某门市部的商品数量之和、某门市部货物类别的数目、某门市部最大销售量和最便宜的单价。<br>
      　　一、对固定的单元格区域进行命名<br>
      　　上期已介绍过对一定的单元格区域进行命名的方法，应该值得注意和学会运用，因为命名单元格区域对灵活运用函数是十分重要的，它将为运用函数带来极大的方便。这里先按上期介绍过的方法，利用菜单中的“插入/名称/定义”命令，在“定义名称”的对话框中，分别添加对如下区域的命名：把“A2～A17”命名为“门市部”，把“B2～B17”命名为“售货员”，把“C2～C17”命名为“类别”，下面的几项依次命名为“数量”、“单价”、“金额”。<br>
      　　二、用总计函数(SUMIF)分别按门市部、售货员、商品类别、某一条件进行有关的汇总<br>
      　　1． 按门市部进行汇总<br>
      　　以“门市部3”进行金额的汇总为例：按我们都已熟悉的方法，首先选取存放数据的单元格，然后选取函数“SUMIF”，在弹出的“粘贴函数”对话框中，设置如图2，其中的“Range”为选取的区域，这个区域(前面已定义为“门市部”)是下面条件判断的依据、“Criteria”为计算条件，它将判断选取区域中哪些单元格(即“门市部3”)符合计算要求、“Sum_range”为求和区域，这个区域中的数值(“金额”)用于真正的求和。<br>
      　　2． 按售货员进行汇总<br>
      　　以“刘芳”的销售数量为例，与上述方法一样，只要在“粘贴函数”对话框图中，在“Range”项输入“售货员”，在“Criteria”项中输入“″刘芳″”，在“Sum_range”项中输入“数量”。<br>
      　　3． 按商品类别进行汇总<br>
      　　以“茶叶”的销售金额为例，只要在“粘贴函数”对话框图中，在“Range”项输入“类别”，在“Criteria”项中输入“″茶叶″”，在“Sum_range”项中输入“金额”。<br>
      　　4．按一定条件进行汇总<br>
      　　如计算除“矿泉水”之外的货款：在“粘贴函数”对话框图中，在“Range”项输入“类别”，在“Criteria”项中输入“″&lt;&gt;矿泉水″”、在“Sum_range”项中输入“金额”。<br>
      　　以上按不同的条件进行了“数量”或“金额”的汇总，如果双击存放“门市部3”金额的单元格，其中的计算公式为：“=SUMIF(门市部,″门市部3″,金额)”，如果需要计算其它门市部的汇总金额，只须把计算公式利用“复制”和“粘贴”命令，复制至相对应的单元格后，把“门市部3”修改为其它门市部即可汇总出其它门市部的金额了。 
      同样方法，可完成对各“售货员”的汇总、各类商品的汇总。图3是以上各项汇总数据的样表，剩余的各项(如各门市部、各种商品的销售数量)的汇总，大家不妨一试。不难看出，利用函数进行计算时，相对固定的单元格区域命名后，减少了频繁选取单元格区域的次数，给我们操作带来了极大的方便。<br>
      　　三、分类汇总函数(SUBTOTAL)的应用<br>
      　　分类汇总函数(SUBTOTAL)不仅仅是一个求和函数，还能够对给定区域内的数值进行其它计算(见图4)，它的语法结构为：<br>
      　　SUBTOTAL(function_num,ref1)<br>
      　　其中的“function_num”是计算类型编号，为一个1到11的数字，它规定所要进行的计算类型，图4为计算类型编号及具体含义；“ref1”为进行汇总数据的单元格区域。<br>
      　　应用举例如下：<br>
      　　1． 计算“门市部2”的“数量”平均值<br>
      　　选定函数后，弹出“粘贴函数”对话框中，在“Function_num”项中输入计算类型“1”，单击“Ref1”右侧的按钮，选取“门市部2”对应的“数量”单元格区域(D6～D9)，如图5，按“确定”按钮完成。<br>
      　　2． 计算“门市部4”中的数量之和<br>
      　　与计算“门市部2”的“数量”平均值相似，计算类型(“Function_num”)为“9”，汇总单元格区域(“Ref1”)为“D14:D17”。<br>
      　　3． 计算“门市部2”的商品“类别”数目<br>
      　　与上例相似的操作，计算类型(“Function_num”)为“2”，汇总单元格区域为“C6:C9”。<br>
      　　4． 计算最大的销售数量<br>
      　　计算类型(“Function_num”)为“4”，汇总单元格区域(“Ref1”)为“D2:D17”。<br>
      　　5． 计算 “门市部2”中的最便宜的单价<br>
      　　计算类型(“Function_num”)为“5”，汇总单元格区域(“Ref1”)为“E6:E9”。<br>
      　　分类汇总函数的应用是十分灵活的，这是它与使用菜单中“数据/分类汇总”命令的最大差别，如果应用菜单中的分类汇总命令，往往是对于有标题的某个区域而进行的分类汇总，这样的应用有时缺乏必要的灵活性，不利于实际中的灵活运用，所以应该学会利用分类汇总函数进行分类汇总，这在我们的实际工作中是非常有用的。<br>
      　　总结：对指定条件的区域进行汇总和分类汇总，这是我们在实际工作中经常遇到的，利用总计函数(SUMIF)和分类汇总函数(SUBTOTAL)一般就能够处理这些工作，而且具有比较强的灵活性。}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://www.cpcw.com/download/yeskye.js">
</script>
    </TD>
    <TD> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@yesky.com'>YESKY网</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
