 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 用VB实现文件下载</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极飞翔聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><A HREF='http://www.cpcw.com'>《电脑报》电子版</A> 
      &gt; <a href='http://www.cpcw.com/all.html'>2000年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->50期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{用VB实现文件下载}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{用VB实现文件下载}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{下载文件是每个网友都经常做的事，大家一般都是用一些专用软件如“网络蚂蚁”来完成。但是，如果要自己编写一个程序，实现下载一个特定的文件（如下载相关的网页并显示出来）又该怎么做呢？不要急，看了下面的介绍你就会知道实现文件的下载其实是很简单的。<br>
      在ＶＢ中有一个 Ｗｉｎｓｏｃｋ 控件，通过它可以实现文件的下载。下面我首先介绍一下该控件的主要属性、方法和事件：<br>
      ＬｏｃａｌＰｏｒ属性：设置本地计算机使用的端口（一般设置为０）；<br>
      Ｐｒｏｔｏｃｏｌ属性：设置Ｗｉｎｓｏｃｋ控件使用的协议，ＴＣＰ或ＵＤＰ（一般设置为０）；<br>
      ＲｅｍｏｔｅＰｏｒｔ属性：设置要连接的远端计算机端口（８０为ＨＴＴＰ２１为ＦＴＰ，２５为ＳＭＴＰ）；<br>
      ＲｅｍｏｔｅＨｏｓｔ 属性：设置用于标识远程计算机的名称（ＲｅｍｏｔｅＰｏｒｔ 属性如果为 ８０ 则设置为“ｓｏｈｕ．ｃｏｍ”或“ｓｉｎａ．ｃｏｍ．ｃｎ”，如果为 
      ２５ 则设置为“ｓｍｔｐ．２１ｃｎ．ｃｏｍ”）；<br>
      Ｃｏｎｎｅｃｔ方法：要求连接到远程计算机；<br>
      Ｃｌｏｓｅ方法：关闭连接；<br>
      ＳｅｎｄＤａｔａ方法：将数据发送给远程计算机；<br>
      ＧｅｔＤａｔａ方法：获取当前的数据块并将其存储在变体类型的变量中；<br>
      Ｃｏｎｎｅｃｔ事件：当一个Ｃｏｎｎｅｃｔ操作完成时发生；<br>
      Ｃｌｏｓｅ事件：当Ｃｌｏｓｅ操作完成时发生；<br>
      ＤａｔａＡｒｒｉｖａｌ事件：接收数据时发生；<br>
      下面我们就来实现文件的下载功能，并以下载搜狐网站的首页为例：<br>
      Ｏｐｔｉｏｎ Ｅｘｐｌｉｃｉｔ<br>
      Ｄｉｍ ｍｙａｌｌ Ａｓ Ｓｔｒｉｎｇ<br>
      Ｐｒｉｖａｔｅ Ｓｕｂ Ｆｏｒｍ＿Ｌｏａｄ<br>
      ′建立连接<br>
      Ｗｉｎｓｏｃｋ１．Ｐｒｏｔｏｃｏｌ＝０<br>
      Ｗｉｎｓｏｃｋ１．ＲｅｍｏｔｅＨｏｓｔ ＝ ″ｓｏｈｕ．ｃｏｍ′如果想下载″新浪″首页，则换为 ｓｉｎａ．ｃｏｍ．ｃｎ<br>
      Ｗｉｎｓｏｃｋ１．ＲｅｍｏｔｅＰｏｒｔ ＝ ８０<br>
      Ｗｉｎｓｏｃｋ１．Ｃｏｎｎｅｃｔ ′开始提取数据<br>
      Ｅｎｄ Ｓｕｂ<br>
      Ｐｒｉｖａｔｅ Ｓｕｂ Ｗｉｎｓｏｃｋ１＿Ｃｏｎｎｅｃｔ<br>
      Ｄｉｍ ｓｔｒＣｏｍｍａｎｄ Ａｓ Ｓｔｒｉｎｇ<br>
      Ｄｉｍ ｓｔｒＷｅｂＰａｇｅ Ａｓ Ｓｔｒｉｎｇ<br>
      ｓｔｒＷｅｂＰａｇｅ ＝ ″ｈｔｔｐ／／ｗｗｗ．ｏｓｈｕ．ｃｏｍ／″ ′指定网页，这里是指搜狐的首页<br>
      ｓｔｒＣｏｍｍａｎｄ ＝ ″ＧＥＴ ″ ＋ ｓｔｒＷｅｂＰａｇｅ ＋ ″ ＨＴＴＰ／１．０″ ＋ ｖｂＣｒＬｆ<br>
      ｓｔｒＣｏｍｍａｎｄ ＝ ｓｔｒＣｏｍｍａｎｄ ＋ ″Ａｃｃｅｐｔ ／″ ＋ ｖｂＣｒＬｆ<br>
      ｓｔｒＣｏｍｍａｎｄ ＝ ｓｔｒＣｏｍｍａｎｄ ＋ ″Ａｃｃｅｐｔ ｔｅｘｔ／ｈｔｍｌ″ ＋ ｖｂＣｒＬｆ<br>
      ｓｔｒＣｏｍｍａｎｄ ＝ ｓｔｒＣｏｍｍａｎｄ ＋ ｖｂＣｒＬｆ<br>
      Ｗｉｎｓｏｃｋ１．ＳｅｎｄＤａｔａ ｓｔｒＣｏｍｍａｎｄ ′发送命令<br>
      Ｅｎｄ Ｓｕｂ<br>
      Ｐｒｉｖａｔｅ Ｓｕｂ Ｗｉｎｓｏｃｋ１＿ＤａｔａＡｒｒｉｖａｌＢｙＶａｌ ｂｙｔｅｓＴｏｔａｌ Ａｓ Ｌｏｎｇ <br>
      ′开始下载，收到数据时，发生ＤａｔａＡｒｒｉｖａｌ事件<br>
      Ｏｎ Ｅｒｒｏｒ Ｒｅｓｕｍｅ Ｎｅｘｔ<br>
      Ｄｉｍ ｗｅｂＤａｔａ Ａｓ Ｓｔｒｉｎｇ<br>
      Ｗｉｎｓｏｃｋ１．ＧｅｔＤａｔａ ｗｅｂＤａｔａ ｖｂＳｔｒｉｎｇ<br>
      ｍｙａｌｌ ＝ ｍｙａｌｌ ＋ ｗｅｂＤａｔａ ′取得相关的网页文件<br>
      Ｅｎｄ Ｓｕｂ<br>
      Ｐｒｉｖａｔｅ Ｓｕｂ Ｗｉｎｓｏｃｋ１＿Ｃｌｏｓｅ ′当下载完成时发生。<br>
      ′自己定义相关的操作<br>
      ′ｍｙａｌｌ 是下载的网页，你可以把它显示在文本框中，也可把它保存为文件，也可通过一些自定义的函数进行信息的提取，限于篇幅，这里就不介绍了。<br>
      Ｗｉｎｓｏｃｋ１．Ｃｌｏｓｅ ′关闭 Ｗｉｎｓｏｃｋ<br>
      Ｅｎｄ Ｓｕｂ<br>
      到此为止，相信你已了解如何在ＶＢ中通过 Ｗｉｎｓｏｃｋ 控件下载文件了。本程序在 ＶＢ６．０、Ｗｉｎ９８ 环境下运行正常，如果你还有什么问题，可到 
      ｗｗｗ．ｄ１ｖｂ．ｃｏｍ来，我们一起讨论。（湖北 艾军）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://www.cpcw.com/download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
