 
<HTML>
<!-- #BeginTemplate "/模板/internet.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- ＤＨＴＭＬ模拟菜单</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'>&nbsp;</TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><a href='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></a></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极飞翔聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
  <TR> 
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='http://www.cpcw.com'>《电脑报》电子版</A> 
      &gt; <A HREF='http://www.cpcw.com/all.html'>2000年</A> &gt; <a href="index.html">50期<!-- #BeginEditable "%C6%DA" --><!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="internet.html">大众网络</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->ＤＨＴＭＬ模拟菜单<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->ＤＨＴＭＬ模拟菜单<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD> <!-- #BeginEditable "%C4%DA%C8%DD" -->{ 在以前的ＨＴＭＬ里，元素的位置只能依次排列，我们很难精确地定位与控制网页中的一些元素。ＣＳＳ２Ｃａｓｃａｄｉｎｇ 
      Ｓｔｙｌｅ Ｓｈｅｅｔ Ｌｅｖｅｌ ２，层叠样式单第二版的布局Ｌａｙｏｕｔ属性出现并得到浏览器的广泛支持之后，我们不仅可以静态地实现以上目的，而且可以根据鼠标、键盘、时间等预定义好的外界事件动态地改变布局。时下非常流行的网页中“活动的层”便是它的一种形象的运用，我们这里要讲的是如何运用这些属性结合一些ＤＨＴＭＬ对象在网页中实现类似Ｗｉｎｄｏｗｓ窗口的下拉菜单（如图所示）。请看以下代码及详细说明。<br>
      ＜－－ 以下部分应该插在代码的＜ｈｅａｄ＞之后 －－＞<br>
      ＜ｓｔｙｌｅ＞＜－－<br>
      ／ 这是一些ＣＳＳ样式。其中″ｂｔｎＴＤ″是按钮在被按下之前“凸起”的样式类：边框被设置为宽度为１个像素的实线，其中左边框和上边框颜色为浅色（这里为白色），右下边框为深色（深灰色），如果背景为灰色的ＨＴＭＬ元素（如单元格）使用这个样式的话，那就非常像一个“凸出”的按钮；“ｂｔｎＤＴＤ”是按钮被按下时“凹下”的样式。 
      ／<br>
      ．ｂｔｎＴＤ  ｂｏｒｄｅｒ－ｌｅｆｔ １ ｓｏｌｉｄ ＃ｆｆｆｆｆｆ ｂｏｒｄｅｒ－ｒｉｇｈｔ １ ｓｏｌｉｄ ＃８０８０８０<br>
      ｂｏｒｄｅｒ－ｔｏｐ １ ｓｏｌｉｄ ＃ｆｆｆｆｆｆ ｂｏｒｄｅｒ－ｂｏｔｔｏｍ １ ｓｏｌｉｄ ＃８０８０８０ <br>
      ．ｂｔｎＤＴＤ  ｂｏｒｄｅｒ－ｌｅｆｔ １ ｓｏｌｉｄ ＃８０８０８０ ｂｏｒｄｅｒ－ｒｉｇｈｔ １ ｓｏｌｉｄ ＃ｆｆｆｆｆｆ<br>
      ｂｏｒｄｅｒ－ｔｏｐ １ ｓｏｌｉｄ ＃８０８０８０ ｂｏｒｄｅｒ－ｂｏｔｔｏｍ １ ｓｏｌｉｄ ＃ｆｆｆｆｆｆ <br>
      ｔｄ  ｆｏｎｔ－ｆａｍｉｌｙ 宋体 ｆｏｎｔ－ｓｉｚｅ ９ｐｔ <br>
      －－＞＜／ｓｔｙｌｅ＞<br>
      ＜ｓｃｒｉｐｔ ｌａｎｇｕａｇｅ＝″ＪａｖａＳｃｒｉｐｔ″＞＜－－<br>
      ／／判断哪个按钮被按下的全局变量<br>
      ｖａｒ ｉｎｔＢｌｎＣｌｋ＝０ <br>
      ／／鼠标经过、离开、点击更改单元格ＣＳＳ样式的函数<br>
      ｆｕｎｃｔｉｏｎ ｍＯｖｒＯｕｔｏｂｊＳｒｃ<br>
      ｖａｒ ａｒｇｖａｒｇｃｂｌｎＡｃｔｉｖｅｓｔｒＣｏｌｏｒｓｔｒＢｇＣｏｌｏｒｓｔｒＣｌａｓｓｓｔｒＣｌａｓｓＤｓｔｒＣｕｒｓｏｒ<br>
      ａｒｇｖ＝ｍＯｖｒＯｕｔ．ａｒｇｕｍｅｎｔｓａｒｇｃ＝ａｒｇｖ．ｌｅｎｇｔｈ<br>
      ／默认情况下不将当前对象置为“激活”／<br>
      ｂｌｎＡｃｔｉｖｅ＝ａｒｇｃ＞１﹖ｅｖａｌａｒｇｖ［１］ｆａｌｓｅ<br>
      ／默认鼠标经过当前对象的样式为“凸出的按钮形”／<br>
      ｓｔｒＣｌａｓｓ＝ａｒｇｃ＞２ ＆＆ ａｒｇｖ［２］＝′′﹖ａｒｇｖ［２］′ｂｔｎＴＤ′<br>
      ／默认鼠标点击的时候当前对象为“凹下的按钮形”／<br>
      ｓｔｒＣｌａｓｓＤ＝ａｒｇｃ＞３ ＆＆ ａｒｇｖ［３］＝′′﹖ａｒｇｖ［３］′ｂｔｎＤＴＤ′<br>
      ／将当前对象激活时候的前景色为白色、背景色为蓝色、鼠标样式为手形／<br>
      ｓｔｒＣｏｌｏｒ＝′＃ｆｆｆｆｆｆ′ｓｔｒＢｇＣｏｌｏｒ＝′＃００００８０′ｓｔｒＣｕｒｓｏｒ＝′ｈａｎｄ′<br>
      ／ＩＥ４及其更高版本才支持这些ＪａｖａＳｃｒｉｐｔ对ＣＳＳ样式的动态改变／<br>
      ｉｆｄｏｃｕｍｅｎｔ．ａｌｌ<br>
      ／／将当前对象的鼠标样式置为参数传递值<br>
      ｏｂｊＳｒｃ．ｓｔｙｌｅ．ｃｕｒｓｏｒ＝ｓｔｒＣｕｒｓｏｒ <br>
      ／／如果是鼠标进入当前对象范围<br>
      ｉｆｏｂｊＳｒｃ．ｃｏｎｔａｉｎｓｅｖｅｎｔ．ｆｒｏｍＥｌｅｍｅｎｔ <br>
      ／设置为活动样式／<br>
      ｉｆｂｌｎＡｃｔｉｖｅ ｏｂｊＳｒｃ．ｂｇＣｏｌｏｒ＝ｓｔｒＢｇＣｏｌｏｒｏｂｊＳｒｃ．ｓｔｙｌｅ．ｃｏｌｏｒ＝ｓｔｒＣｏｌｏｒ <br>
      ／当前对象不需要置为活动样式的时候，如果本来的样式是“凸出的按钮形”则置为“凹下的按钮形”，反之亦然／<br>
      ｅｌｓｅ ｏｂｊＳｒｃ．ｃｌａｓｓＮａｍｅ＝ｉｎｔＢｌｎＣｌｋ＝０﹖ｓｔｒＣｌａｓｓＤｓｔｒＣｌａｓｓ <br>
      ／／鼠标离开当前对象区域<br>
      ｅｌｓｅ ｉｆｏｂｊＳｒｃ．ｃｏｎｔａｉｎｓｅｖｅｎｔ．ｔｏＥｌｅｍｅｎｔ <br>
      ／／将这些样式置为默认值<br>
      ｏｂｊＳｒｃ．ｂｇＣｏｌｏｒ＝′′ｏｂｊＳｒｃ．ｓｔｙｌｅ．ｃｏｌｏｒ＝′′ｏｂｊＳｒｃ．ｃｌａｓｓＮａｍｅ＝′′  <br>
      <br>
      ／ 显示／隐藏层的通用函数。用ｏｂｊＮＳ、ｏｂｊＩＥ、ｓｔｒＳｔｕ作为参数，其中ｏｂｊＮＳ和ｏｂｊＩＥ分别是Ｎｅｔｓｃａｐｅ和ＩＥ的“层”对象，ｓｔｒＳｔｕ为层的状态。因为篇幅所限，请查看本文尾部说明。 
      ／<br>
      ｆｕｎｃｔｉｏｎ ｓｈｏＨｉｄＬａｙｅｒｓ <br>
      ／ 调用上面的函数，显示／隐藏参数传递的层，这样是为了简化代码。这里不给出详细函数。／<br>
      ｆｕｎｃｔｉｏｎ ｓｈｏｗＬａｙｅｒｉｎｔＣｕｒｒｅｎｔ<br>
      ／／－－＞＜／ｓｃｒｉｐｔ＞＜／ｈｅａｄ＞<br>
      ＜ｂｏｄｙ ｏｎＭｏｕｓｅＤｏｗｎ＝″ｉｆｗｉｎｄｏｗ．ｅｖｅｎｔ．ｓｒｃＥｌｅｍｅｎｔ．ｓｔｙｌｅ．ｃｏｌｏｒ＝＝′′ ｓｈｏｗＬａｙｅｒ１′ｈｉｄｅ′″＞<br>
      ＜－－ 以上ｂｏｄｙ部分的作用是当鼠标没有按下任何按钮的时候隐藏所有应该隐藏的“菜单”。以下是两个用ＣＳＳ布局定义的层，名为“ｍｅｎｕ”的层的初始状态为：在屏幕上的绝对位置为（１２１２），可视，层ｚ－ｉｎｄｅｘ属性为１００；“ｍｅｎｕ１”为不可视。 
      －－＞<br>
      ＜ｄｉｖ ｉｄ＝″ｍｅｎｕ″ ｓｔｙｌｅ＝″ｐｏｓｉｔｉｏｎａｂｓｏｌｕｔｅｖｉｓｉｂｉｌｉｔｙ ｖｉｓｉｂｌｅｌｅｆｔ１２ｐｘｔｏｐ１２ｐｘ 
      ｚ－ｉｎｄｅｘ １００″＞＜ｔａｂｌｅ ｂｏｒｄｅｒ＝″１″ ｃｅｌｌｓｐａｃｉｎｇ＝″０″ ｃｅｌｌｐａｄｄｉｎｇ＝″２″ ｂｇｃｏｌｏｒ＝″＃ｃ０ｃ０ｃ０″ 
      ｂｏｒｄｅｒｃｏｌｏｒ＝″＃ｃ０ｃ０ｃ０″＞<br>
      ＜ｔｒ＞＜ｔｄ ｏｎＭｏｕｓｅＯｖｅｒ＝″ｍＯｖｒＯｕｔｔｈｉｓ″ ｏｎＭｏｕｓｅＯｕｔ＝″ｍＯｖｒＯｕｔｔｈｉｓ″ ｏｎＣｌｉｃｋ＝″ｍＯｖｒＯｕｔｔｈｉｓｆａｌｓｅ′ｂｔｎＤＴＤ′ｓｈｏｗＬａｙｅｒ１″＞天极网＜／ｔｄ＞＜／ｔｒ＞<br>
      ＜／ｔａｂｌｅ＞＜／ｄｉｖ＞<br>
      ＜ｄｉｖ ｉｄ＝″ｍｅｎｕ１″ ｓｔｙｌｅ＝″ｐｏｓｉｔｉｏｎａｂｓｏｌｕｔｅｖｉｓｉｂｉｌｉｔｙ ｈｉｄｄｅｎｌｅｆｔ１１ｐｘｔｏｐ３４ｐｘ 
      ｚ－ｉｎｄｅｘ １″＞＜ｔａｂｌｅ ｂｏｒｄｅｒ＝″０″ ｃｅｌｌｐａｄｄｉｎｇ＝″２″ ｃｅｌｌｓｐａｃｉｎｇ＝″０″ ｂｇｃｏｌｏｒ＝″＃ｃ０ｃ０ｃ０″ 
      ｃｌａｓｓ＝″ｂｔｎＴＤ″＞<br>
      ＜ｔｒ＞＜ｔｄ ｏｎＭｏｕｓｅＯｖｅｒ＝″ｍＯｖｒＯｕｔｔｈｉｓｔｒｕｅ″ ｏｎＭｏｕｓｅＯｕｔ＝″ｍＯｖｒＯｕｔｔｈｉｓ″ ｗｉｄｔｈ＝″１００％″ｎｏｗｒａｐ 
      ｏｎＣｌｉｃｋ＝″ｗｉｎｄｏｗ．ｌｏｃａｔｉｏｎ＝′ｈｔｔｐ／／ｗｗｗ．ｐｃｗｃｌｕｂ．ｃｏｍ／′ｓｈｏｗＬａｙｅｒ１′ｈｉｄｅ′″＞电脑报读者俱乐部＜／ｔｄ＞＜／ｔｒ＞<br>
      ＜／ｔａｂｌｅ＞＜／ｄｉｖ＞<br>
      因为篇幅所限，一些函数不能详细给出及说明，如果需要完整代码请访问以下链接：ｈｔｔｐ／／ｃｔｓｉｇｈｔ．ｔｏｐｃｏｏｌ．ｎｅｔ／ｄｏｃｕｍｅｎｔｓ／ｍｅｎｕ．ｈｔｍｌ。<br>
      陕西 周辉腾}<!-- #EndEditable -->　　　　　　　　　　　　　 </TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://www.cpcw.com/download/yeskye.js">
</script>
    </TD>
    <TD> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
