 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 用VB编写登录程序</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com/" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0" alt="天极聊天室"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <A HREF='http://www.cpcw.com/all.html'>2000年</A> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->45期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{用VB编写登录程序}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{用VB编写登录程序}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　编者按：在前几期编程乐园中，我们一同学习了一些关于VB编程的基本概念和语法规则。但离开实例学习编程，无疑是枯燥无味、事倍功半的，所以我们在此推出“看实例，学编程”栏目，邀请富有经验的PFans介绍他们的典型实例，希望对PFans的编程之旅有所帮助。<br>
      　　我们都知道，在进入Windows操作系统时会出现一个登录对话框，要求用户输入密码后才能进入Windows。我们用VB也可以编写这样的登录窗口，其具体方法如下：<br>
      　　界面设计：<br>
      　　打开“VB6.0”，出现“新建工程”对话框，选择“标准EXE”单击“打开”即可新建一个工程。新建一个工程后，VB自动生成了一个窗体，其默认的名称是Form1，且显示的标题也是Form1，显然与我们要编写的程序不符。我们可以更改这些设置，方法是：点击Form1窗体，在右边的属性窗口中（如图1）的“名称”后输入“Denglu”（在后面讲的Denglu就是指的这个窗体），在“Caption”后输入“登录窗口”。窗体设置好后，我们便可以将控件放置到这个窗体中去了。<br>
      　　“登录窗口”中主要用到的是TextBox(文本框)控件，该控件主要是用于接收用户输入的文字并显示出来。在该程序中我们便可以使用TextBox控件接收用户输入的信息来判断是否是合法的用户。另外，我们还将用到Label（标签）控件及CommandButton（命令按钮）控件。Label控件用来显示“用户名”及“密码”标题；CommandButton控件用来设计“确定”及“取消”按钮。下面我们将这些控件放置到窗体中：在工具箱中选择“Label”控件（如图2），在窗体中拖动鼠标直到一定的大小，然后在属性窗口中的“Caption”属性后为输入“用户名”，然后在其下方再拖动一个Label控件，将Caption的值改为“密码：”；在工具箱中选择“TextBox”控件（如图3），在“用户名”后拖动一个TextBox控件，用同样的方法在“密码：”后拖动一个TextBox控件，然后在“属性窗口”中将Text的值改为空（即删除默认的Text1），为了不显示出用户输入的密码，我们将第二个TextBox控件的PasswordChar属性设置为＊（如图5），这样在用户输入密码时显示的就是＊了；在工具箱中选择“CommandButton”控件（如图4），将其拖动到窗体的下方（一共两个），分别设置其Caption属性为“确定”和“取消”。调整好这些控件的位置（如图6）后即可完成界面的设计。<br>
      　　程序代码：<br>
      　　该程序的主要目的是要判断输入的用户名是否合法，所以我们首先编写判断用户名的程序代码。双击“确定”按钮，添加如下的程序代码：（黑体部分为系统自动生成的代码，楷体为注释）<br>
      　　Private Sub Command1_Click()<br>
      　　′判断是否输入了用户名<br>
      　　If Text1.Text=″″ Then　′如果Text1为空，即没有输入用户<br>
      　　　MsgBox ″请输入用户名！″,vbOKOnly＋vbCritical,″错误″<br>
      　　　Exit Sub　′退出这个过程<br>
      　　Else　′如果输入了用户名<br>
      　　　If Text1.Text=″软件世界″ And Text2.Text=″12345″ Then　′如果输入的用户名是″软件世界″且密码为″12345″<br>
      　　　　MsgBox ″你是合法用户，欢迎进入！″,vbOKOnly＋vbInformation,″欢迎进入″<br>
      　　　Else　′如果不是″软件世界″或密码不是″12345″<br>
      　　　　MsgBox ″用户名或密码错误！″,vbOKOnly＋vbCritical,″错误″<br>
      　　　　Text1.Text=″″<br>
      　　　　Text2.Text=″″　′清空Text1及Text2控件中的文本内容，让用户重新输入<br>
      　　　End If<br>
      　　End If<br>
      　　End Sub<br>
      　　在这一段代码中，我们使用了If…Then…Else…End If。这是一个条件判断语句，If Text1.Text=″″ Then这句代码则是判断Text1是否为空，如果为空，这个条件就成立，则执行Then后的语句，如果Text1不为空，则这个条件不成立，程序将会跳到Else处，执行Else后的语句。<br>
      　　程序测试：<br>
      　　现在我们可以单击“F5”键来运行这个程序，看看其运行效果。直接单击“确定”按钮，将会弹出一个对话框（如图7）；在“用户名”后输入“软件世界”，“密码：”后输入“12345”，再单击“确定”按钮，此时便会出现一个“欢迎进行”的信息框（如图8）。怎么样，一个属于自己的“登录窗口”就制作好了。<br>
      　　但这个程序目前还只能判断在程序中已设置好了的用户名及密码，没有灵活性，你可以发挥你的聪明才智，使其能够判断多个合法的用户及密码。如果你有什么疑问，欢迎写信与我交流，我的E－mail地址是：vber@21cn.com。<br>
      （重庆　杜伟）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="file:///C%7C/WINDOWS/Desktop/download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
