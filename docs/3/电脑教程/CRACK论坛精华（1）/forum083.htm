<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<p><span class="p9"><span class="p9">求救：我想破解家庭象册这个软件，可始终不成功，请各位老师指点迷津。谢谢！！！ </span></span></p>
<p><span class="p9"><font color="#6666FF">回复：</font></span></p>
<p><span class="p9"><span class="p9"><font color=blue>标 题:</font>注册码很好找，用bpx __vbaStrCmp做断点即可，但是写注册机要花点功夫 
  (955字)<br>
  <font color=blue>发信人:</font>郭大志<br>
  <font color=blue>时 间:</font>2000-6-7 9:51:12 <br>
  <font color=blue>详细信息:</font><br>
  </span></span></p>
<blockquote><span class="p9"><span class="p9"> 先加载MSVBVM60.DLL的符号表（最好不要同时加载MSVBVM50.DLL和MSVBVM60.DLL的符号表，否则断点应为bpx 
  MSVBVM60!__vbaStrCmp），用bpx __vbaStrCmp设断点之后看见如下的指令段： <br>
  <br>
  0167:00707F0C&nbsp; CALL&nbsp; &nbsp; &nbsp; 006FCE50&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //计算注册号 <br>
  0167:00707F11&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,[EBP-18] <br>
  0167:00707F14&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[007320FC] <br>
  0167:00707F1A&nbsp; PUSH&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  //假注册号 <br>
  0167:00707F1B&nbsp; PUSH&nbsp; &nbsp; &nbsp; EDX&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  //正确的注册号 <br>
  0167:00707F1C&nbsp; CALL&nbsp; &nbsp; &nbsp; [MSVBVM60!__vbaStrCmp] <br>
  0167:00707F22&nbsp; TEST&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  0167:00707F24&nbsp; JNZ&nbsp; &nbsp; &nbsp; 007080A9 <br>
  <br>
  跟踪进 CALL&nbsp; &nbsp; &nbsp; 006FCE50则可以看见生成注册号的过程。根据程序指令可以证实微软的VB6程序确实是真正的EXE，跟用VC、Delphi等编译得到的EXE没有太大分别，而早期的VB4、VB3程序根本不能叫做真正的EXE程序。 
  <br>
  <br>
  另外，要写注册机的话最好先用SmartCheck看一下生成注册码的大致流程，然后再用SoftICE跟。困难在于微软没有公布MSVBVM50.DLL中的函数接口，所以该DLL中的函数的作用和参数都要靠猜。 
  </span></span></blockquote>
<hr>
<p>&nbsp; </p>
</body>
</html>
