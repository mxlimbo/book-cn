<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>Netcaptor5.5浏览器右上角广告窗口的去除方法 (3千字)<br>
<font color=blue>发信人:</font>看雪<br>
<font color=blue>时 间:</font>2000-4-13 20:46:08 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 1、Netcaptor是一浏览器，它內部的主要工具是套用你 IE 中的，但它提供了許多 IE 沒有的方便性，譬如你可以同時浏览多个网页，而不需开多个窗口，只需在浏览器下方就可以随时切换；你也可以利用浮动工具条上的按钮选项，快速设定不要 
  Load 图片以加快浏览速度。&nbsp; <br>
  但它有一严重缺点是在右止角有一广告窗口，很烦人，特别是脱机浏览时，一会跳出出错框：告知未连上广告商服务器，因此将这广告窗口除去显得十分必要。 <br>
  2、开始时，我也没找到有效办法能去除些广告，后来偶而发现Netcaptor运行时，会在其目录下生成两个文件：ad2.htm和ad2.gif，此时打开ad2.htm则页面却是广告窗口的内容。而Netcaptor广告窗口象一小的浏览器，猜想这小浏览器一定是打开ad2.htm来显示广告的，而ad2.htm内容是动态变化，Netcaptor关闭时，此文件却消失了。因此可判断Netcaptor启动初始化时，在广告窗口初始化时需要读取ad2.htm，好！就以此我入口点。 
  <br>
  3、我用得是Netcaptor5.5,本来想装6.0的，但是不知怎么不能安装成功。 <br>
  用W32DASM打开Netcaptor的主文件，NetCaptor.exe，查找字符串ad2.htm，如下： <br>
  <br>
  * Possible StringData Ref from Code Obj ->"ad2.gif" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004CD83D B928E44C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  004CE428 <br>
  :004CD842 8B55E8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov edx, dword ptr [ebp-18] <br>
  :004CD845 E82666F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00403E70 
  <br>
  :004CD84A 8B45D4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-2C] <br>
  :004CD84D E81ABAF3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0040926C 
  <br>
  :004CD852 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test al, al <br>
  :004CD854 0F8596000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne 004CD8F0&lt;--------------------此处改成JMP004CD8F0 
  <br>
  :004CD85A 8B45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-04] <br>
  :004CD85D 80B8D407000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp byte ptr [eax+000007D4], 
  00 <br>
  :004CD864 7423&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; je 004CD889 <br>
  <br>
  * Possible StringData Ref from Code Obj ->"AD_GI2" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004CD866 6838E44C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 004CE438 
  <br>
  <br>
  * Possible StringData Ref from Code Obj ->"RT_HTML" <br>
  <br>
  <br>
  ———————————————————————————————————————— <br>
  :004CD8F0 8D45D4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-2C] <br>
  <br>
  * Possible StringData Ref from Code Obj ->"ad2.htm" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004CD8F3 B960E44C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  004CE460 <br>
  :004CD8F8 8B55E8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov edx, dword ptr [ebp-18] <br>
  :004CD8FB E87065F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00403E70 
  <br>
  :004CD900 8B45D4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-2C] <br>
  :004CD903 E85CBAF3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00409364 
  <br>
  :004CD908 8D45D4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-2C] <br>
  <br>
  * Possible StringData Ref from Code Obj ->"ad2.htm" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004CD90B B960E44C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  004CE460 <br>
  :004CD910 8B55E8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov edx, dword ptr [ebp-18] <br>
  :004CD913 E85865F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00403E70 
  <br>
  :004CD918 8B45D4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-2C] <br>
  :004CD91B E84CB9F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0040926C 
  <br>
  :004CD920 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test al, al <br>
  :004CD922 0F8596000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne 004CD9BE&lt;--------------------此处改成JMP 
  004CD9BE <br>
  :004CD928 8B45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-04] <br>
  :004CD92B 80B8D407000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp byte ptr [eax+000007D4], 
  00 <br>
  :004CD932 7423&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; je 004CD957 <br>
  <br>
  * Possible StringData Ref from Code Obj ->"AD_HTM2" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004CD934 6870E44C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 004CE470 
  <br>
  <br>
  * Possible StringData Ref from Code Obj ->"RT_HTML" <br>
  这样改了上面两处后，就可跳过ad2.htm和ad2.gif的调用，以前的广告窗口不再出现了，但有点缺憾，就是那块地方空着，看着不舒服，如能让菜单能向右移移就好了，我想肯定能修改，只是本人功底有限，不知这工具栏是如何实现的，希望高手指点为感！ 
  <br>
  我想此法适合Netcaptor各个版本。 <br>
  2000年4月13日 </span></blockquote>
<hr>
</body>
</html>
