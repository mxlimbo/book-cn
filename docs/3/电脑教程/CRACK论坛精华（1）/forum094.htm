<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>试试这个软件（内有下在地址及说明) (81字)<br>
<font color=blue>发信人:</font>copyyour<br>
<font color=blue>时 间:</font>2000-6-12 0:16:17<br>
<font color=blue>阅读次数:</font>98<br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote> <span class="p9">&lt;&lt;MP3音乐管理大师>> <br>
  <br>
  <br>
  http://go.163.com/~xiongjingcheng/soft/mp3gl_setup.exe </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>搞定 (3千字)<br>
  <font color=blue>发信人:</font>郭大志<br>
  <font color=blue>时 间:</font>2000-6-16 15:11:49 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 用SoftICE和SmartCheck结合将这个VB6程序搞定。 <br>
  注册号是很好找的，用rtcMsgBox或MultiByteToWideChar设断点， <br>
  看见如下的判断： <br>
  0167:004C546D&nbsp; 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:004C546E&nbsp; FF1568104000&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 
  &nbsp; [00401068] <br>
  0167:004C5474&nbsp; 8B45E4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-1C] <br>
  0167:004C5477&nbsp; 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:004C5478&nbsp; FF1550104000&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 
  &nbsp; [00401050] <br>
  0167:004C547E&nbsp; 8B3DB4114000&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; EDI,[004011B4] <br>
  0167:004C5484&nbsp; 8BD0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,EAX <br>
  0167:004C5486&nbsp; 8D4DE8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; LEA&nbsp; &nbsp; &nbsp; ECX,[EBP-18] <br>
  0167:004C5489&nbsp; FFD7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; &nbsp; EDI <br>
  0167:004C548B&nbsp; 8D4DE4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; LEA&nbsp; &nbsp; &nbsp; ECX,[EBP-1C] <br>
  0167:004C548E&nbsp; FF15FC114000&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 
  &nbsp; [004011FC] <br>
  0167:004C5494&nbsp; 8D4DD8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; LEA&nbsp; &nbsp; &nbsp; ECX,[EBP-28] <br>
  0167:004C5497&nbsp; FF15F8114000&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 
  &nbsp; [004011F8] <br>
  0167:004C549D&nbsp; E85EF5FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004C4A00 <br>
  0167:004C54A2&nbsp; 8B4DE8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,[EBP-18] <br>
  0167:004C54A5&nbsp; 8B1528704C00&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; EDX,[004C7028] <br>
  0167:004C54AB&nbsp; 51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //错误的注册码 <br>
  0167:004C54AC&nbsp; 52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; &nbsp; EDX&nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //正确的注册码 <br>
  0167:004C54AD&nbsp; FF15D4104000&nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; &nbsp; 
  &nbsp; [004010D4]&nbsp; &nbsp; &nbsp; //比较注册码 <br>
  0167:004C54B3&nbsp; 85C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; TEST&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  0167:004C54B5&nbsp; 0F85C5010000&nbsp; &nbsp; &nbsp; &nbsp; JNZ&nbsp; &nbsp; 
  &nbsp; 004C5680 <br>
  <br>
  这个软件必须写注册机，先用SoftICE跟一下，经过漫长的跟踪后发现它在下面的地方将你的软件编号的第k个字符乘以(k+1)。 <br>
  <br>
  0167:004C4B29&nbsp; DB856CFFFFFF&nbsp; &nbsp; &nbsp; &nbsp; FILD&nbsp; &nbsp; 
  &nbsp; DWORD PTR [EBP-0094] <br>
  0167:004C4B2F&nbsp; C745A805000000&nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp; 
  DWORD PTR [EBP-58],00000005 <br>
  0167:004C4B36&nbsp; DD9D64FFFFFF&nbsp; &nbsp; &nbsp; &nbsp; FSTP&nbsp; &nbsp; 
  &nbsp; REAL8 PTR [EBP-009C] <br>
  0167:004C4B3C&nbsp; DC8D64FFFFFF&nbsp; &nbsp; &nbsp; &nbsp; FMUL&nbsp; &nbsp; 
  &nbsp; REAL8 PTR [EBP-009C]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; //相乘 <br>
  0167:004C4B42&nbsp; DD5DB0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; FSTP&nbsp; &nbsp; &nbsp; REAL8 PTR [EBP-50] <br>
  0167:004C4B45&nbsp; DFE0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; FSTSW&nbsp; AX <br>
  0167:004C4B47&nbsp; A80D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; TEST&nbsp; &nbsp; &nbsp; AL,0D <br>
  0167:004C4B49&nbsp; 0F85A0020000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JNZ&nbsp; 
  &nbsp; &nbsp; 004C4DEF <br>
  <br>
  比如我的软件编号为174078570，它在前面添个0，变成0174078570，然后就有： <br>
  0 乘以 1&nbsp; ＝0 <br>
  1 乘以 2&nbsp; ＝2 <br>
  7 乘以 3&nbsp; ＝21 <br>
  4 乘以 4&nbsp; ＝16 <br>
  0 乘以 5&nbsp; ＝0 <br>
  7 乘以 6&nbsp; ＝42 <br>
  8 乘以 7&nbsp; ＝56 <br>
  5 乘以 8&nbsp; ＝40 <br>
  7 乘以 9&nbsp; ＝63 <br>
  0 乘以 10 ＝0 <br>
  <br>
  之后用SoftICE就跟丢了。改用SmartCheck，发现它把上面的乘积串成一个字符串“0221160425640630”， <br>
  然后取该串的前9个字符“022116042”，然后将该串转换成相应的十进制数22116042，该数对应的十六进制表示为15176CA，再在十六进制表示的前面和后面各加上软件作者的姓名的声母H、P，就得到了注册号H15176CAP。 
  <br>
  <br>
  注册机： <br>
  <br>
  #include &lt;stdio.h> <br>
  #include &lt;string.h> <br>
  <br>
  void main(void) <br>
  { <br>
  <br>
  &nbsp; &nbsp; char buf[128] = "0"; <br>
  &nbsp; &nbsp; char SerialStr[128], CodeStr[128]; <br>
  &nbsp; &nbsp; int k; <br>
  &nbsp; &nbsp; long RegCode; <br>
  <br>
  &nbsp; &nbsp; printf("请输入你的软件编号: "); <br>
  &nbsp; &nbsp; gets(SerialStr); <br>
  <br>
  &nbsp; &nbsp; strcat(buf, SerialStr); <br>
  &nbsp; &nbsp; CodeStr[0] = '\0'; <br>
  &nbsp; &nbsp; for (k = 0; k &lt; strlen(buf); k++) <br>
  &nbsp; &nbsp; { <br>
  &nbsp; &nbsp; &nbsp; &nbsp; sprintf(SerialStr, "%d", ((buf[k] - '0') * (k+1)) 
  &amp; 0xFF); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; strcat(CodeStr, SerialStr); <br>
  &nbsp; &nbsp; } <br>
  <br>
  &nbsp; &nbsp; CodeStr[9] = '\0'; <br>
  &nbsp; &nbsp; sscanf(CodeStr, "%lu", &amp;RegCode); <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; printf("你的注册号是: "); <br>
  &nbsp; &nbsp; printf("H%lXP\n", RegCode); <br>
  } </span></blockquote>
<hr>
</body>
</html>
