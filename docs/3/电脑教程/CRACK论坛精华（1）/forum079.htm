<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>破解用Vboxs420.dll加密的WebDrive 2.2 (1千字)<br>
<font color=blue>发信人:</font>郭大志<br>
<font color=blue>时 间:</font>2000-6-6 8:54:06 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> WebDrive 2.2(主程序webdrive.exe长度106,828字节） <br>
  http://www.riverfrontsoftware.com <br>
  <br>
  这个东西用VBox 4.20加密的，只有一个DLL即vboxs420.dll。我的SoftICE 4.05用SoftICE Backdoor Keeper打过补丁，没看见它检测到SoftICE。用bpx 
  DialogBoxParamaA设断点，等它显示Nag时就会断下来，按一下f12，然后点击Try按钮，就会看见如下的代码： <br>
  <br>
  :10002FA0&nbsp; CALL&nbsp; &nbsp; &nbsp; [EAX+2C]&nbsp; &nbsp; //若未过期则在EAX中返回B164 
  <br>
  :10002FA3&nbsp; CMP&nbsp; &nbsp; &nbsp; EAX,EBX&nbsp; &nbsp; <br>
  :10002FA5&nbsp; JNZ&nbsp; &nbsp; &nbsp; 10002FBA&nbsp; &nbsp; //这个地方如果不跳走就说明程序出错了 
  <br>
  :10002FA7&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[1006EDB8] <br>
  :10002FAC&nbsp; PUSH&nbsp; &nbsp; &nbsp; EDI <br>
  :10002FAD&nbsp; PUSH&nbsp; &nbsp; &nbsp; FF <br>
  :10002FAF&nbsp; PUSH&nbsp; &nbsp; &nbsp; ESI <br>
  :10002FB0&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,[EAX+04] <br>
  :10002FB3&nbsp; CALL&nbsp; &nbsp; &nbsp; 100282F0 <br>
  :10002FB8&nbsp; JMP&nbsp; &nbsp; &nbsp; 10002FF1 <br>
  :10002FBA&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[1006EDB8] <br>
  :10002FBF&nbsp; PUSH&nbsp; &nbsp; &nbsp; 00 <br>
  :10002FC1&nbsp; PUSH&nbsp; &nbsp; &nbsp; 1000322F <br>
  :10002FC6&nbsp; PUSH&nbsp; &nbsp; &nbsp; DWORD PTR [EAX+3C] <br>
  :10002FC9&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[100696B0] <br>
  :10002FCE&nbsp; PUSH&nbsp; &nbsp; &nbsp; 000000CB <br>
  :10002FD3&nbsp; PUSH&nbsp; &nbsp; &nbsp; DWORD PTR [EAX+08] <br>
  :10002FD6&nbsp; CALL&nbsp; &nbsp; &nbsp; [USER32!DialogBoxParamA]&nbsp; //显示Nag 
  <br>
  :10002FDC&nbsp; MOV&nbsp; &nbsp; &nbsp; ESI,EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //若选Try则EAX为0，选Quit则为1 <br>
  :10002FDE&nbsp; CALL&nbsp; &nbsp; &nbsp; 100031B0 <br>
  :10002FE3&nbsp; PUSH&nbsp; &nbsp; &nbsp; ESI <br>
  :10002FE4&nbsp; CALL&nbsp; &nbsp; &nbsp; 10002FF5 <br>
  :10002FE9&nbsp; AND&nbsp; &nbsp; &nbsp; DWORD PTR [1006EDB8],00 <br>
  :10002FF0&nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  :10002FF1&nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  :10002FF2&nbsp; POP&nbsp; &nbsp; &nbsp; ESI <br>
  :10002FF3&nbsp; POP&nbsp; &nbsp; &nbsp; EBX <br>
  :10002FF4&nbsp; RET <br>
  <br>
  按几下F12就到如下的地方： <br>
  <br>
  :00406B8A&nbsp; PUSH&nbsp; &nbsp; &nbsp; 01 <br>
  :00406B8C&nbsp; CALL&nbsp; &nbsp; &nbsp; 004063D0&nbsp; &nbsp; &nbsp; //在这里头显示Nag 
  <br>
  :00406B91&nbsp; ADD&nbsp; &nbsp; &nbsp; ESP,04 <br>
  :00406B94&nbsp; TEST&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  :00406B96&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 00406DE8&nbsp; &nbsp; &nbsp; //过期则跳走 
  <br>
  :00406B9C&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,0040F320 <br>
  :00406BA1&nbsp; CALL&nbsp; &nbsp; &nbsp; 004016E0 <br>
  :00406BA6&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,0040F348 <br>
  <br>
  很显然，只要不要让它跳走即可，由于Vboxs420.dll和webdrive.exe均变换过，而且结合得比较紧密（就是所吹的injection）写一个process 
  patcher即可，它没有CRC校验。跳过JZ前面的那个CALL则连Nag也没有了。 </span></blockquote>
<hr>
</body>
</html>
