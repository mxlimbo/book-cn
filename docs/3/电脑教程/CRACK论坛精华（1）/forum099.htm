<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>WebZIP 3.71.508 (5千字)<br>
<font color=blue>发信人:</font>dr0<br>
<font color=blue>时 间:</font>2000-6-24 16:08:01 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> http://www.spidersoft.com <br>
  <br>
  这个软件用如下的指令段判断注册码。经过几次试探发现该函数返回0xC8 <br>
  则显示“Tnank you for registering WebZip!”。 <br>
  <br>
  0167:004E7402&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBP-08] <br>
  0167:004E7405&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,EBX <br>
  0167:004E7407&nbsp; CALL&nbsp; &nbsp; &nbsp; 004E75A4&nbsp; &nbsp; &nbsp; &nbsp; 
  //这里头判断注册码 <br>
  0167:004E740C&nbsp; SUB&nbsp; &nbsp; &nbsp; EAX,000000C8&nbsp; &nbsp; //返回C8表示注册码正确 
  <br>
  0167:004E7411&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 004E741B <br>
  0167:004E7413&nbsp; DEC&nbsp; &nbsp; &nbsp; EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; //返回C9则错误 <br>
  0167:004E7414&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 004E743E <br>
  0167:004E7416&nbsp; DEC&nbsp; &nbsp; &nbsp; EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; //返回CA则错误 <br>
  0167:004E7417&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 004E744B <br>
  0167:004E7419&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E745D&nbsp; &nbsp; &nbsp; &nbsp; 
  //返回其它值 <br>
  <br>
  跟进上面的那个CALL，看见函数体如下： <br>
  <br>
  0167:004E75A4&nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP <br>
  0167:004E75A5&nbsp; MOV&nbsp; &nbsp; &nbsp; EBP,ESP <br>
  0167:004E75A7&nbsp; ADD&nbsp; &nbsp; &nbsp; ESP,-10 <br>
  0167:004E75AA&nbsp; PUSH&nbsp; &nbsp; &nbsp; EBX <br>
  0167:004E75AB&nbsp; PUSH&nbsp; &nbsp; &nbsp; ESI <br>
  0167:004E75AC&nbsp; PUSH&nbsp; &nbsp; &nbsp; EDI <br>
  0167:004E75AD&nbsp; XOR&nbsp; &nbsp; &nbsp; ECX,ECX <br>
  0167:004E75AF&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-08],ECX <br>
  0167:004E75B2&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-04],ECX <br>
  0167:004E75B5&nbsp; MOV&nbsp; &nbsp; &nbsp; EDI,EDX <br>
  0167:004E75B7&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,EAX <br>
  0167:004E75B9&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  0167:004E75BB&nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP <br>
  0167:004E75BC&nbsp; PUSH&nbsp; &nbsp; &nbsp; 004E76E9 <br>
  0167:004E75C1&nbsp; PUSH&nbsp; &nbsp; &nbsp; DWORD PTR FS:[EAX] <br>
  0167:004E75C4&nbsp; MOV&nbsp; &nbsp; &nbsp; FS:[EAX],ESP <br>
  0167:004E75C7&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  0167:004E75CA&nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:004E75CB&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,EDI <br>
  0167:004E75CD&nbsp; CALL&nbsp; &nbsp; &nbsp; 0040407C <br>
  0167:004E75D2&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,EAX <br>
  0167:004E75D4&nbsp; DEC&nbsp; &nbsp; &nbsp; EDX <br>
  0167:004E75D5&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,00000002 <br>
  0167:004E75DA&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,EDI <br>
  0167:004E75DC&nbsp; CALL&nbsp; &nbsp; &nbsp; 00404284 <br>
  0167:004E75E1&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04]&nbsp; //你输入的注册码的后两个字符 
  <br>
  0167:004E75E4&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,004E7704&nbsp; // "1Y" <br>
  0167:004E75E9&nbsp; CALL&nbsp; &nbsp; &nbsp; 0040418C&nbsp; &nbsp; &nbsp; //比较 
  <br>
  0167:004E75EE&nbsp; JNZ&nbsp; &nbsp; &nbsp; 004E75F7&nbsp; &nbsp; &nbsp; //若最后两位是1Y 
  <br>
  0167:004E75F0&nbsp; MOV&nbsp; &nbsp; &nbsp; ESI,0000016D&nbsp; //则为错误的注册码 <br>
  0167:004E75F5&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E7632 <br>
  0167:004E75F7&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  0167:004E75F9&nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP <br>
  0167:004E75FA&nbsp; PUSH&nbsp; &nbsp; &nbsp; 004E7619 <br>
  0167:004E75FF&nbsp; PUSH&nbsp; &nbsp; &nbsp; DWORD PTR FS:[EAX] <br>
  0167:004E7602&nbsp; MOV&nbsp; &nbsp; &nbsp; FS:[EAX],ESP <br>
  0167:004E7605&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04]&nbsp; //注册码的后两位 <br>
  0167:004E7608&nbsp; CALL&nbsp; &nbsp; &nbsp; 0040977C&nbsp; &nbsp; &nbsp; //转换成整数 
  <br>
  0167:004E760D&nbsp; MOV&nbsp; &nbsp; &nbsp; ESI,EAX&nbsp; &nbsp; &nbsp; &nbsp; 
  //保存在esi中 <br>
  0167:004E760F&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  0167:004E7611&nbsp; POP&nbsp; &nbsp; &nbsp; EDX <br>
  0167:004E7612&nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  0167:004E7613&nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  0167:004E7614&nbsp; MOV&nbsp; &nbsp; &nbsp; FS:[EAX],EDX <br>
  0167:004E7617&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E7632 <br>
  0167:004E7619&nbsp; JMP&nbsp; &nbsp; &nbsp; 0040355C <br>
  0167:004E761E&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,000000C9 <br>
  0167:004E7623&nbsp; CALL&nbsp; &nbsp; &nbsp; 004038B8 <br>
  0167:004E7628&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E76CE <br>
  0167:004E762D&nbsp; CALL&nbsp; &nbsp; &nbsp; 004038B8 <br>
  0167:004E7632&nbsp; TEST&nbsp; &nbsp; &nbsp; ESI,ESI&nbsp; &nbsp; &nbsp; //后两位为00吗？ 
  <br>
  0167:004E7634&nbsp; JNZ&nbsp; &nbsp; &nbsp; 004E7661&nbsp; &nbsp; //不为00则错误 
  <br>
  0167:004E7636&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  0167:004E7639&nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:004E763A&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBX+6C] <br>
  0167:004E763D&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBX+34] <br>
  0167:004E7640&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,ESI <br>
  0167:004E7642&nbsp; CALL&nbsp; &nbsp; &nbsp; 004E5298 <br>
  0167:004E7647&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04]&nbsp; //正确的注册码 <br>
  0167:004E764A&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,EDI&nbsp; &nbsp; &nbsp; //你输入的假注册码 
  <br>
  0167:004E764C&nbsp; CALL&nbsp; &nbsp; &nbsp; 0040418C&nbsp; &nbsp; &nbsp; //比较注册码 
  <br>
  0167:004E7651&nbsp; JNZ&nbsp; &nbsp; &nbsp; 004E765A <br>
  0167:004E7653&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,000000C8&nbsp; //返回C8表示OK <br>
  0167:004E7658&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E76CE <br>
  0167:004E765A&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,000000C9&nbsp; //返回C9则错误 <br>
  0167:004E765F&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E76CE <br>
  0167:004E7661&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  0167:004E7664&nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:004E7665&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBX+6C] <br>
  0167:004E7668&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBX+34] <br>
  0167:004E766B&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,ESI <br>
  0167:004E766D&nbsp; CALL&nbsp; &nbsp; &nbsp; 004E5298 <br>
  0167:004E7672&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  0167:004E7675&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,EDI <br>
  0167:004E7677&nbsp; CALL&nbsp; &nbsp; &nbsp; 0040418C <br>
  0167:004E767C&nbsp; JNZ&nbsp; &nbsp; &nbsp; 004E76C9 <br>
  0167:004E767E&nbsp; INC&nbsp; &nbsp; &nbsp; DWORD PTR [EBX+44] <br>
  0167:004E7681&nbsp; LEA&nbsp; &nbsp; &nbsp; EDX,[EBP-08] <br>
  0167:004E7684&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,EBX <br>
  0167:004E7686&nbsp; CALL&nbsp; &nbsp; &nbsp; 004E8660 <br>
  0167:004E768B&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBP-08] <br>
  0167:004E768E&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBX+34] <br>
  0167:004E7691&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403E50 <br>
  0167:004E7696&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  0167:004E7698&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBX+3C],EAX <br>
  0167:004E769B&nbsp; CALL&nbsp; &nbsp; &nbsp; 0040AD24 <br>
  0167:004E76A0&nbsp; CALL&nbsp; &nbsp; &nbsp; 00402BAC <br>
  0167:004E76A5&nbsp; SUB&nbsp; &nbsp; &nbsp; EAX,01 <br>
  0167:004E76A8&nbsp; SBB&nbsp; &nbsp; &nbsp; EDX,00 <br>
  0167:004E76AB&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-10],EAX <br>
  0167:004E76AE&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-0C],EDX <br>
  0167:004E76B1&nbsp; FILD&nbsp; &nbsp; &nbsp; QWORD PTR [EBP-10] <br>
  0167:004E76B4&nbsp; FSTP&nbsp; &nbsp; &nbsp; REAL8 PTR [EBX+48] <br>
  0167:004E76B7&nbsp; WAIT <br>
  0167:004E76B8&nbsp; ADD&nbsp; &nbsp; &nbsp; [EBX+40],ESI <br>
  0167:004E76BB&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,EBX <br>
  0167:004E76BD&nbsp; CALL&nbsp; &nbsp; &nbsp; 004E7B50 <br>
  0167:004E76C2&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,000000CA&nbsp; //返回CA也错误 <br>
  0167:004E76C7&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E76CE <br>
  0167:004E76C9&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,000000C9&nbsp; //返回C9则错误 <br>
  0167:004E76CE&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  0167:004E76D0&nbsp; POP&nbsp; &nbsp; &nbsp; EDX <br>
  0167:004E76D1&nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  0167:004E76D2&nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  0167:004E76D3&nbsp; MOV&nbsp; &nbsp; &nbsp; FS:[EAX],EDX <br>
  0167:004E76D6&nbsp; PUSH&nbsp; &nbsp; &nbsp; 004E76F0 <br>
  0167:004E76DB&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-08] <br>
  0167:004E76DE&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,00000002 <br>
  0167:004E76E3&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403E20 <br>
  0167:004E76E8&nbsp; RET <br>
  0167:004E76E9&nbsp; JMP&nbsp; &nbsp; &nbsp; 00403810 <br>
  0167:004E76EE&nbsp; JMP&nbsp; &nbsp; &nbsp; 004E76DB <br>
  0167:004E76F0&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,EBX&nbsp; &nbsp; //函数的返回值 <br>
  0167:004E76F2&nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  0167:004E76F3&nbsp; POP&nbsp; &nbsp; &nbsp; ESI <br>
  0167:004E76F4&nbsp; POP&nbsp; &nbsp; &nbsp; EBX <br>
  0167:004E76F5&nbsp; MOV&nbsp; &nbsp; &nbsp; ESP,EBP <br>
  0167:004E76F7&nbsp; POP&nbsp; &nbsp; &nbsp; EBP <br>
  0167:004E76F8&nbsp; RET <br>
  <br>
  由此得到一个注册码： <br>
  User Name:&nbsp; &nbsp; dr0 <br>
  Serial No:&nbsp; &nbsp; China <br>
  Reg Key:&nbsp; &nbsp; &nbsp; AE33536C8300 <br>
  <br>
  注册成功的标志是下面的选项可以使用： <br>
  菜单View－>Options－>General Settings－>Turn off banner ad insertion。 </span></blockquote>
<hr>
</body>
</html>
