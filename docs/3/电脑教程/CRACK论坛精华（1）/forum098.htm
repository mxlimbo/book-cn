<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>自然码输入系统2000 for NT/2K破解（PECOMPACT壳)，见笑啦:) 
(3千字)<br>
<font color=blue>发信人:</font>shizg<br>
<font color=blue>时 间:</font>2000-6-24 8:41:16 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 发信人: shizg (刀客☆永远的痛), 信区: Hacker <br>
  标&nbsp; 题: Re: 大自然输入系统2000 for NT/2K到期了:( <br>
  发信站: BBS 水木清华站 (Fri Jun 23 14:00:12 2000) <br>
  &nbsp; <br>
  我将破解的文件放到lib.pku/incoming/zrm_crack/zrm32.exe <br>
  覆盖安装目录下的原文件就可以了。 <br>
  下面内容供有兴趣的朋友看，否则有点像灌水，呵呵。 <br>
  ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ <br>
  &nbsp; <br>
  这东东是加Pecompact壳的，有关PECompact壳可以看很多FTP站点介绍，可以压缩 <br>
  exe,dll等，最高可达20%，太酷。可惜有关这软件的脱壳不多，我尝试用pcdump <br>
  脱，但没有成功（哪位有成功经验，请告诉我，谢谢）。只好用TRW2000(S-ICE一样）来自己脱，倒是很顺利，脱壳后， <br>
  就很easy了。有兴趣的朋友，可以自己脱试试。 <br>
  提示：441ac8附近，有一条指令push 4196e3，这就是真正的入口了。前面有一段 <br>
  是反复解码，不要搞晕了，呵呵。 <br>
  在4196e3处，你将发现熟悉的pe文件开头的代码，如果是trw2000，直接makepe， <br>
  就完全脱壳了。S-Ice可以装icedump来脱，具体我就不说了。 <br>
  &nbsp; <br>
  下面就是将脱壳后的程序关于过期代码解除掉。下命令bpx getsystemtime，运行 <br>
  脱出来的的程序，中断，f12跳出后，下面就是一大堆比较日期，如下： <br>
  4185e8是不能去的，去了就过期了。 <br>
  倒数第2句41858c是要去的，否则会提示你快到期了。就这两点。 <br>
  &nbsp; <br>
  * Reference To: KERNEL32.GetSystemTime, Ord:0000h <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004184F8 FF15B8F04100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call dword ptr 
  [0041F0B8] <br>
  :004184FE 0FB745F0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movzx 
  eax, word ptr [ebp-10] <br>
  :00418502 8D4810&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [eax+10] <br>
  :00418505 81F9E0070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp ecx, 000007E0 
  <br>
  :0041850B 7C10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jl 0041851D <br>
  :0041850D 0FB74DF2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movzx 
  ecx, word ptr [ebp-0E] <br>
  :00418511 83C119&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add ecx, 00000019 <br>
  :00418514 83F91F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp ecx, 0000001F <br>
  :00418517 0F8FCB000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jg 004185E8 
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:0041850B(C) <br>
  | <br>
  :0041851D 8D48DA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [eax-26] <br>
  :00418520 81F9AA070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp ecx, 000007AA 
  <br>
  :00418526 0F8FBC000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jg 004185E8 
  <br>
  :0041852C 8D48BD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [eax-43] <br>
  :0041852F 81F98D070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp ecx, 0000078D 
  <br>
  :00418535 7F10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jg 00418547 <br>
  :00418537 0FB74DF2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movzx 
  ecx, word ptr [ebp-0E] <br>
  :0041853B 83C137&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add ecx, 00000037 <br>
  :0041853E 83F93B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp ecx, 0000003B <br>
  :00418541 0F8CA1000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jl 004185E8 
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:00418535(C) <br>
  | <br>
  :00418547 8D48CF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [eax-31] <br>
  :0041854A 81F99F070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp ecx, 0000079F 
  <br>
  :00418550 0F8C92000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jl 004185E8 
  <br>
  :00418556 83C056&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add eax, 00000056 <br>
  :00418559 33F6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; xor esi, esi <br>
  :0041855B 3D26080000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp eax, 
  00000826 <br>
  :00418560 752A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 0041858C <br>
  :00418562 0FB745F2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movzx 
  eax, word ptr [ebp-0E] <br>
  :00418566 83C05F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add eax, 0000005F <br>
  :00418569 83F865&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp eax, 00000065 <br>
  :0041856C 751E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 0041858C <br>
  :0041856E 0FB745F6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movzx 
  eax, word ptr [ebp-0A] </span></blockquote>
<hr>
</body>
</html>
