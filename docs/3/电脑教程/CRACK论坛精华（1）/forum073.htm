<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>oicq build 0425 的不完全破解 (3千字)<br>
<font color=blue>发信人:</font>小楼<br>
<font color=blue>时 间:</font>2000-5-28 20:25:49 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> oicq build 0425 的不完全破解 <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; 申明：本文单纯从程序角度谈了oicq build 0425 的破解问题。欢 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 迎阅读、指教。但本人对由使用本文进行的一切活动不负任 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 何责任。 <br>
  <br>
  <br>
  &nbsp; &nbsp; 如果你可以得到某人的oicq谈话记录文件，而又对他与其好友的谈话记录感兴趣，你会如何呢？用oicq谈话阅读器？可惜它不支持0220以后的版本；再说其作者也会叫你用“穷举法”来得到密码，如果设置的密码在9位以上，用“穷举法”的时间以日、月计，你就别想了。 
  <br>
  &nbsp; &nbsp; 其实我们可以毫不费力的进入观看。 <br>
  &nbsp; &nbsp; 首先将谈话文件夹（如7145021）放入oicq安装目录下，再在oicq\dat目录下用ultraedit打开oicq2000.cfg，在 
  00000009h处记录了所使用帐号的个数，后面即为帐号，只要按照“ 07 00 00 00 帐号的ascii码”形式（如 07 00 00 00 31 
  31 32 35 34 31 34） 加入即可。若帐号小于7位，还需用 20 补足位数（如 07 00 00 00 31 31 32 35 34 31 
  20）。 <br>
  &nbsp; &nbsp; 这样你运行oicq build 0425 后，要看的帐号就出现了，选它，随便填个密码。用trw bpx hmemcpy设断后，按下“登录”，程序为trw阻断。 
  <br>
  bd&nbsp; &nbsp; 中断断点 <br>
  f12&nbsp; 按44下，改 <br>
  f10&nbsp; 走， <br>
  直到 <br>
  :004370E7 E808A6FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004316F4 
  <br>
  :004370EC 3BC3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; cmp eax, ebx&nbsp; &lt;-- ebx恒为0， <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; eax可为0或1 <br>
  :004370EE 0F858F010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne 00437283&nbsp; 
  &lt;-- 不跳就失败 <br>
  :004370F4 A130D34E00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, 
  dword ptr [004ED330] <br>
  :004370F9 8945E4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov dword ptr [ebp-1C], eax <br>
  :004370FC 8D45E4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-1C] <br>
  <br>
  * Possible Reference to String Resource ID=33357: "揺? <br>
  !焮U勂 <br>
  " <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004370FF 684D820000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 0000824D 
  <br>
  :00437104 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  :00437105 C645FC04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov 
  [ebp-04], 04 <br>
  :00437109 E8B707FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004278C5 
  <br>
  :0043710E 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; pop ecx <br>
  :0043710F 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; pop ecx <br>
  :00437110 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebx <br>
  :00437111 6804010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 00000104 
  <br>
  :00437116 FF75E4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  push [ebp-1C] <br>
  :00437119 E830650500&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0048D64E&nbsp; 
  &lt;--密码错误画面 <br>
  所以将&nbsp; &nbsp; 004370EE 0F858F010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  jne 00437283 <br>
  改为&nbsp; &nbsp; &nbsp; 004370EE 0F848F010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; je&nbsp; 00437283 <br>
  后，你就可以进入这一帐号了。 <br>
  <br>
  &nbsp; &nbsp; 如果还被设置了本地密码，你就先只能随便填个密码喽。用bpx hmemxpy设断后，f12要按56下，直到你来到 <br>
  :00432E5D 8D4DF0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [ebp-10] <br>
  :00432E60 7525&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 00432E87&nbsp; &lt;-- 不跳就失败，所以要让它跳 <br>
  :00432E62 E864350500&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004863CB 
  <br>
  :00432E67 E954FFFFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp 00432DC0 
  <br>
  这样你就可以进入他的帐号，看看它的聊天记录，他的好友名单...... <br>
  <br>
  &nbsp; &nbsp; 所以我要说，腾讯公司是个不负责任的公司。它应该将输入的密码换算后，作为密钥来解开被加密的谈话记录，而不是仅将其作直接比较。 
  <br>
  <br>
  &nbsp; &nbsp; 关于密码的破解，实在让我感到烦琐，所以就没有去深追。有兴趣的朋友可以参考如下： <br>
  1、:0046E987 F3&nbsp; &nbsp; &nbsp; repz&nbsp; <br>
  &nbsp; :0046E988 A7&nbsp; &nbsp; &nbsp; cmpsd&nbsp; &lt;--edi放置了经变换后的输入密码，esi放置了加密后正确密码值。共比较16位，两者相等表示密码正确。 
  <br>
  &nbsp; :0046E989 7427&nbsp; &nbsp; je 0046E9B2 <br>
  <br>
  2、整个密码的最重要的变形、换算在 <br>
  :00442B40 030E&nbsp; &nbsp; add ecx, dword ptr [esi] <br>
  ..... <br>
  :0044343B C3&nbsp; &nbsp; &nbsp; ret&nbsp; &lt;--很有规律，但也太烦 <br>
  <br>
  3、由此得到的数字又经 <br>
  :004434D5 E821F6FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00442AFB&nbsp; 
  &lt;--f8进入，即为第3步 <br>
  :004434DA 8B44241C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov 
  eax, dword ptr [esp+1C] <br>
  :004434DE 8B0E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov ecx, dword ptr [esi] <br>
  :004434E0 83C40C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esp, 0000000C <br>
  :004434E3 8BD1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov edx, ecx <br>
  ...... <br>
  :00443556 C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; ret <br>
  变换，得到第2步中的edi值。 </span></blockquote>
<hr>
</body>
</html>
