<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>如何计算 “IQ网际搜寻家99” 注册码 (4千字)<br>
<font color=blue>发信人:</font>小楼<br>
<font color=blue>时 间:</font>2000-5-15 23:46:32 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 如何计算 “IQ网际搜寻家99” 注册码 <br>
  <br>
  &nbsp; “IQ网际搜寻家99”是资讯人公司出品的一个功能十分强大的搜索引擎，获得zdnet五星奖。 <br>
  &nbsp; 下载地址http://www.inforian.com/ ，约3M左右，可以支持中文GB、BIG5、英文等语言。 <br>
  &nbsp; &nbsp; 开始我在网上找了一个注册码，但每次运行时程序都会叫你去资讯人公司主页注册。当然你是不能注册的，因为这个注册码早就被注册了。忍无可忍之下，今天我准备将其注册码计算方式找到，自己注册一个。 
  <br>
  &nbsp; &nbsp; IQ99.exe被shrink3.4压过，你可以用deshrink1.6解压，不过不这样作也没关系，因为其比较程序是在checknodll.dll中。 
  <br>
  <br>
  首先，你要随便输入一个注册码，01234567895 （11位） <br>
  trw2000中下断点 <br>
  bpx hmemcpy <br>
  g <br>
  回到IQ99.exe中，按下“注册”按钮，trw跳出。 <br>
  bd&nbsp; 中断断点 <br>
  F12&nbsp; 14下 <br>
  F10&nbsp; 走到 <br>
  <br>
  * Possible StringData Ref from Code Obj ->"bCheckSerialNumber" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004C2CD1 A168205000&nbsp; &nbsp; &nbsp; mov eax, dword ptr [00502068] <br>
  :004C2CD6 E8B512F4FF&nbsp; &nbsp; &nbsp; call 00403F90 <br>
  :004C2CDB 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push eax <br>
  :004C2CDC 8B45F4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebp-0C] 
  <br>
  :004C2CDF 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push eax <br>
  <br>
  * Reference To: kernel32.GetProcAddress, Ord:0000h <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004C2CE0 E8BB2EF4FF&nbsp; &nbsp; &nbsp; Call 00405BA0 <br>
  :004C2CE5 8BF8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edi, eax <br>
  :004C2CE7 89FB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ebx, edi <br>
  :004C2CE9 85FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; test edi, edi&nbsp; 
  &lt;--没有输入，失败 <br>
  :004C2CEB 7417&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je 004C2D04 <br>
  :004C2CED 8B45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword ptr [ebp-04] 
  <br>
  :004C2CF0 E89B12F4FF&nbsp; &nbsp; &nbsp; call 00403F90 <br>
  :004C2CF5 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push eax <br>
  :004C2CF6 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push esi <br>
  :004C2CF7 FFD3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call ebx&nbsp; &nbsp; 
  &nbsp; &lt;--** <br>
  :004C2CF9 83C408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add esp, 00000008 <br>
  :004C2CFC 3C01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp al, 01&nbsp; &nbsp; 
  &lt;--以al=1作为注册标志 <br>
  :004C2CFE 7504&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne 004C2D04&nbsp; &lt;--跳则失败 
  <br>
  :004C2D00 C645FB00&nbsp; &nbsp; &nbsp; &nbsp; mov [ebp-05], 00 <br>
  <br>
  现在你要进入:004C2CF7 FFD3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call ebx 中看看al是如何被赋值的，F8进入 
  <br>
  这就进入了checknodll.dll领域了。 <br>
  :100010EB 83F90B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp ecx, 0000000B&nbsp; &lt;--注册码是否11位？ 
  <br>
  :100010EE 0F85AA000000&nbsp; &nbsp; jne 1000119E <br>
  :100010F4 33FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor edi, edi <br>
  ...... <br>
  :10001111&nbsp; mov [esp+0C], 00000007&nbsp; &lt;-- 1&nbsp; - <br>
  :10001119&nbsp; mov [esp+10], 00000011&nbsp; &lt;-- 2&nbsp; | <br>
  :10001121&nbsp; mov [esp+14], 00000017&nbsp; &lt;-- 3&nbsp; | <br>
  :10001129&nbsp; mov [esp+18], 00000025&nbsp; &lt;-- 4&nbsp; | <br>
  :10001131&nbsp; mov [esp+1C], 0000002F&nbsp; &lt;-- 5&nbsp; |--依次对应注册码 <br>
  :10001139&nbsp; mov [esp+20], 00000035&nbsp; &lt;-- 6&nbsp; |&nbsp; 1-9位 <br>
  :10001141&nbsp; mov [esp+24], 00000043&nbsp; &lt;-- 7&nbsp; | <br>
  :10001149&nbsp; mov [esp+28], 00000049&nbsp; &lt;-- 8&nbsp; | <br>
  :10001151&nbsp; mov [esp+2C], 00000053&nbsp; &lt;-- 9&nbsp; - <br>
  :10001159&nbsp; mov eax, ebx <br>
  :1000115B&nbsp; xor ecx, ecx <br>
  :1000115D&nbsp; lea edx, dword ptr [esp+0C] <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:10001174(C) <br>
  | <br>
  :10001161 0FBE3C31&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movsx edi, byte ptr [ecx+esi] 
  <br>
  :10001165 83EF30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sub edi, 00000030&nbsp; 
  &nbsp; &nbsp; &nbsp; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &lt;--依次取1-9位注册码的数字 <br>
  :10001168 0FAF3A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imul edi, dword ptr 
  [edx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &lt;--各位数与上述数字对应相乘 <br>
  :1000116B 03C7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add eax, edi&nbsp; 
  &lt;--总和给eax <br>
  :1000116D 41&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc ecx 
  <br>
  :1000116E 83C204&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add edx, 00000004 
  <br>
  :10001171 83F909&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp ecx, 00000009 
  <br>
  :10001174 7CEB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jl 10001161 <br>
  :10001176 0FBE4E09&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movsx ecx, byte ptr [esi+09] 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &lt;-- 第十位注册码的ascii码给ecx <br>
  :1000117A 0FBE560A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movsx edx, byte ptr [esi+0A] 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &lt;-- 第十一位注册码的ascii码给edx <br>
  :1000117E 8D0C89&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea ecx, dword ptr 
  [ecx+4*ecx] <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &lt;-- ecx=5*第十位注册码的ascii码 <br>
  :10001181 BE64000000&nbsp; &nbsp; &nbsp; &nbsp; mov esi, 00000064 <br>
  :10001186 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop edi 
  <br>
  :10001187 8D8C4AF0FDFFFF&nbsp; &nbsp; lea ecx, dword ptr [edx+2*ecx-00000210] 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &lt;-- ecx=&nbsp; 第十一位注册码的ascii码 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + (A*第十位注册码的ascii码) <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - 210 <br>
  :1000118E 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cdq <br>
  :1000118F F7FE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idiv esi&nbsp; 
  &nbsp; &nbsp; &lt;-- edx为eax/64的余数 <br>
  :10001191 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor eax, eax 
  <br>
  :10001193 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop esi 
  <br>
  :10001194 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop ebx 
  <br>
  :10001195 3BCA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp ecx, edx&nbsp; 
  &lt;-- 比较 <br>
  :10001197 0F94C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sete al&nbsp; &nbsp; 
  &nbsp; &lt;-- al赋值 <br>
  <br>
  所以我计算出一个：01234567804 <br>
  不要用这个去网站注册，因为我已经用了。要注册，自己算。 <br>
  不知谁将这个计算式作一注册机？请在其中写上我的名字：小楼 <br>
  谢谢。 </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>如何除去“IQ网际搜寻家99”中“网上注册”窗口 (881字)<br>
  <font color=blue>发信人:</font>小楼<br>
  <font color=blue>时 间:</font>2000-5-16 20:17:54 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 如何除去“IQ网际搜寻家99”中“网上注册”窗口 <br>
  &nbsp; &nbsp; 今天我算出了“iq网际搜索99”的注册码计算方法，当然要去其网站登记为“合法用户”--主要是为了除去每次运行时出现的那个“网上注册”破窗户。谁知道在线注册后，破窗仍旧出现。所以，我就写了封e-mail给他们，要求服务——谁叫我是“正式用户”呢，当然要享受这一“权利”。 
  <br>
  &nbsp; &nbsp; 老美动作就是快，上午同时寄出的两封信，一封给总部，一封给它国内子公司。现在我收到了总部的答复，给了我一个补丁程序，说run 
  it , and ok.当然我执行了，问题就解决了。 <br>
  &nbsp; &nbsp; 但是它作了些什么？脑子一转，猜它在注册表中作了记号。联想到微软是在注册表中加入"register"=1作为注册标志。就在[HKEY_USERS\.DEFAULT\Software\Inforia\Quest\SYSTEM]中找，果然，其注册标志为 
  <br>
  [HKEY_USERS\.DEFAULT\Software\Inforia\Quest\SYSTEM] <br>
  "RegistrationDone"="1" <br>
  将之改为"0"，破窗再次出现。有意思的是，若去掉注册表中的注册码，但保留"RegistrationDone"="1"，会叫你填入注册码，但不会出现”网上注册“的窗口。 
  </span></blockquote>
<hr>
</body>
</html>
