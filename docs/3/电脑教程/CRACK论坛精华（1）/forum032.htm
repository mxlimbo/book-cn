<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>用 softice 脱 aspack 2.1 的壳 (7千字)<br>
<font color=blue>发信人:</font>故我（KEN）<br>
<font color=blue>时 间:</font>2000-4-2 20:50:53 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 工具: softice,procdump, SoftICE Backdoor Keeper, frogsice 
  0.43, icedump <br>
  &nbsp; &nbsp; &nbsp; SoftICE Backdoor Keeper 到这边抓 <br>
  &nbsp; &nbsp; &nbsp; http://protools.exit.de/files/debuggers/ex-sibdk1.zip <br>
  &nbsp; &nbsp; &nbsp; 他说这个应该是适合所有的 softice 版本,我用 softice 4.05 测试没问题 <br>
  <br>
  前言: <br>
  <br>
  这个档案也是用 asprotect 保护的 <br>
  此版的 asprotect 会检测 softice, 且还会用 int 3 去检测 <br>
  只用&nbsp; frogsice 是无效的, 因此要配合 SoftICE Backdoor Keeper <br>
  把ex-sibdk1 解开,放到 softice 的目录,运行他,他为去改 winice.exe <br>
  改完了再重开机,就可以 下 bpint 3 了 <br>
  若没有运行这个,下 bpint 3 是拦不到 int 3 的 <br>
  还有一点,这个程序,未进入 OEP 之前 <br>
  地址每次运行都会变,所以我写的地址,当然叶丝谕你的不一样 <br>
  这个要注意的. <br>
  <br>
  ok, go!! <br>
  <br>
  1: 先用 procdump 观看一下 aspack, <br>
  &nbsp; size of image 是 0007A000 <br>
  &nbsp; image og base 是 00400000 <br>
  &nbsp; 看一下 section <br>
  &nbsp; .idata 的 visual offset 是 46000 <br>
  &nbsp; 这个应该是放 import table 的地方 <br>
  <br>
  2: 运行 frogsice,还有icedump, 按 ctrl-d 进入 softice, 下 bpint 3 <br>
  &nbsp; 就是要拦截 int 3, 因为有运行过&nbsp; <br>
  &nbsp; 运行 aspack2.1 <br>
  &nbsp; aspack2.1 会检测 sice 和 ntice <br>
  &nbsp; sice 要去欺骗他, ntice 不要欺骗他,不然会当机 <br>
  &nbsp; 到了拦截 int 3 时&nbsp; , 就是这边,下 e eip 0 <br>
  &nbsp; 故意让他生成例外.在下 bpm 446000 <br>
  &nbsp; 为什么要下 446000 ? 是因为 400000+46000 = 446000 <br>
  <br>
  014F:004D2AD5&nbsp; CC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; INT&nbsp; &nbsp; &nbsp; 3&nbsp; ;&nbsp; 光标停在这边 <br>
  014F:004D2AD6&nbsp; EB02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; &nbsp; 004D2ADA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004D2AD8&nbsp; E9025DEB02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 
  &nbsp; 033887DF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004D2ADD&nbsp; E9FF33C05A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 
  &nbsp; 5B0D5EE1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004D2AE2&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004D2AE3&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; <br>
  014F:004D2AE4&nbsp; 648910&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; FS:[EAX],EDX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004D2AE7&nbsp; EB0A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; &nbsp; 004D2AF3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004D2AE9&nbsp; E9121AFFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 
  &nbsp; 004C4500&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004D2AEE&nbsp; E8791BFFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004C466C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004D2AF3&nbsp; 8A154C8F4D00&nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; DL,[004D8F4C]&nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004D2AF9&nbsp; 8B45F4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP-0C]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  <br>
  3: <br>
  下完了 bpm 446000 , 不要按 F10 或&nbsp; F8, 直接按 F5, <br>
  按 四次 F5,仔细看一下 ds:446000 的下方, 此时 import table 应该是 <br>
  正确的 import table 了, 可以 dump 出来了, <br>
  用 icedump 来 dump, 下 pagein d 446000 2000 c:\temp\aspack.import <br>
  名字可以自定. <br>
  <br>
  再按 2 次 F12,按第一次 F12 会等约10~20 秒才回到 softice <br>
  我也不知道为什么 <br>
  按完了两次, 会到这边 <br>
  <br>
  014F:004BEDB4&nbsp; 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  XOR&nbsp; &nbsp; &nbsp; EAX,EAX&nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDB6&nbsp; 5A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004BEDB7&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004BEDB8&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004BEDB9&nbsp; 648910&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; FS:[EAX],EDX&nbsp; <br>
  014F:004BEDBC&nbsp; EB13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; &nbsp; 004BEDD1&nbsp; ; 若过期了,当到了这边可下 <br>
  &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;r eip&nbsp; 004BEE50 
  (当然,我的地址一定和你的地址不一样)&nbsp; &nbsp; &nbsp; &nbsp; <br>
  <br>
  014F:004BEDBE&nbsp; E96914FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 
  &nbsp; 004B022C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDC3&nbsp; 66B80D00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AX,000D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDC7&nbsp; E870F1FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004BDF3C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDCC&nbsp; E8C715FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004B0398&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDD1&nbsp; 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  XOR&nbsp; &nbsp; &nbsp; EAX,EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDD3&nbsp; 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; <br>
  014F:004BEDD4&nbsp; 68F1ED4B00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; 
  &nbsp; &nbsp; 004BEDF1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDD9&nbsp; 64FF30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; 
  &nbsp; &nbsp; DWORD PTR FS:[EAX] <br>
  014F:004BEDDC&nbsp; 648920&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; FS:[EAX],ESP&nbsp; &nbsp; &nbsp; <br>
  014F:004BEDDF&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP+08]&nbsp; &nbsp; &nbsp; <br>
  014F:004BEDE2&nbsp; E80DFCFFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004BE9F4&nbsp; ; 会跑出过期的消息,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDE7&nbsp; 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  XOR&nbsp; &nbsp; &nbsp; EAX,EAX&nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDE9&nbsp; 5A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004BEDEA&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004BEDEB&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004BEDEC&nbsp; 648910&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; FS:[EAX],EDX&nbsp; <br>
  014F:004BEDEF&nbsp; EB13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; &nbsp; 004BEE04&nbsp; &nbsp; &nbsp; <br>
  014F:004BEDF1&nbsp; E93614FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 
  &nbsp; 004B022C&nbsp; &nbsp; &nbsp; <br>
  014F:004BEDF6&nbsp; 66B81100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AX,0011&nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEDFA&nbsp; E83DF1FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004BDF3C&nbsp; &nbsp; &nbsp; <br>
  014F:004BEDFF&nbsp; E89415FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004B0398&nbsp; &nbsp; &nbsp; <br>
  014F:004BEE04&nbsp; 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  XOR&nbsp; &nbsp; &nbsp; EAX,EAX&nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEE06&nbsp; 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  <br>
  014F:004BEE07&nbsp; 683DEE4B00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; 
  &nbsp; &nbsp; 004BEE3D&nbsp; &nbsp; &nbsp; <br>
  014F:004BEE0C&nbsp; 64FF30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; 
  &nbsp; &nbsp; DWORD PTR FS:[EAX] <br>
  014F:004BEE0F&nbsp; 648920&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; FS:[EAX],ESP&nbsp; <br>
  014F:004BEE12&nbsp; B83CDF4B00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; EAX,004BDF3C&nbsp; <br>
  014F:004BEE17&nbsp; 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEE18&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP+08]&nbsp; <br>
  014F:004BEE1B&nbsp; 8B4810&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; ECX,[EAX+10]&nbsp; <br>
  014F:004BEE1E&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP+08]&nbsp; <br>
  014F:004BEE21&nbsp; 8B5004&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EDX,[EAX+04]&nbsp; <br>
  014F:004BEE24&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP+08]&nbsp; <br>
  014F:004BEE27&nbsp; 8B00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EAX,[EAX]&nbsp; &nbsp; <br>
  014F:004BEE29&nbsp; E80AF6FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004BE438&nbsp; &nbsp; &nbsp; <br>
  014F:004BEE2E&nbsp; A2305D4C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp; 
  &nbsp; [004C5D30],AL <br>
  014F:004BEE33&nbsp; 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  XOR&nbsp; &nbsp; &nbsp; EAX,EAX&nbsp; &nbsp; &nbsp; <br>
  014F:004BEE35&nbsp; 5A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEE36&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEE37&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEE38&nbsp; 648910&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; FS:[EAX],EDX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>
  014F:004BEE3B&nbsp; EB13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  JMP&nbsp; &nbsp; &nbsp; 004BEE50&nbsp; &nbsp; <br>
  014F:004BEE3D&nbsp; E9EA13FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JMP&nbsp; &nbsp; 
  &nbsp; 004B022C&nbsp; &nbsp; <br>
  014F:004BEE42&nbsp; 66B80E00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; AX,000E&nbsp; &nbsp; <br>
  014F:004BEE46&nbsp; E8F1F0FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004BDF3C&nbsp; &nbsp; <br>
  014F:004BEE4B&nbsp; E84815FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004B0398&nbsp; &nbsp; <br>
  014F:004BEE50&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP+08]&nbsp; SS:006AFE14=00465C57&nbsp; &nbsp; <br>
  014F:004BEE53&nbsp; 8D4818&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEA&nbsp; 
  &nbsp; &nbsp; ECX,[EAX+18] <br>
  014F:004BEE56&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP+08] <br>
  014F:004BEE59&nbsp; 8B10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  MOV&nbsp; &nbsp; &nbsp; EDX,[EAX]&nbsp; &nbsp; <br>
  014F:004BEE5B&nbsp; 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EBP+08] <br>
  014F:004BEE5E&nbsp; 8B401C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; 
  &nbsp; &nbsp; EAX,[EAX+1C] <br>
  014F:004BEE61&nbsp; E85EF6FFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL&nbsp; 
  &nbsp; &nbsp; 004BE4C4&nbsp; &nbsp; ; 按 F8,追进去&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; <br>
  014F:004BEE66&nbsp; 5F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  014F:004BEE67&nbsp; 5E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ESI&nbsp; &nbsp; <br>
  014F:004BEE68&nbsp; 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; EBX <br>
  014F:004BEE69&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  014F:004BEE6A&nbsp; 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  <br>
  <br>
  在 cs:014F:004BEE61&nbsp; CALL&nbsp; &nbsp; &nbsp; 004BE4C4&nbsp; <br>
  追进去之后, 就可以看到 POPAD <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  PUSH EAX&nbsp; ; 此时 eax = 442238 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  CALL xxxxxxxx&nbsp; ; 按 F8 追进去 <br>
  <br>
  <br>
  所以 OEP 是 442238&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; <br>
  看要用 icedump 或是 procdump 来 dump 都可以 <br>
  dump 完了之后 <br>
  把刚刚的 import table 的信息覆盖到不正确的 import table <br>
  用&nbsp; procdump 去改刚刚 dump 出来的 exe <br>
  改 Entry point = 42238 , Import table 的&nbsp; RVA = 46000, <br>
  若是用 icedump dump 的, <br>
  还要多一个步骤 <br>
  把 所有的 section 的 <br>
  PSize = VSize <br>
  offset = RVA <br>
  改完了,应该就没问题了,也没有过期了, 检测 softice 了 </span></blockquote>
<hr>
</body>
</html>
