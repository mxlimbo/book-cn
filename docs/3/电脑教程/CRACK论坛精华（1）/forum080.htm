<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>Touch Typing version 98 3.3的注册机 (925字)<br>
<font color=blue>发信人:</font>郭大志<br>
<font color=blue>时 间:</font>2000-6-6 20:29:30 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> www.shetef.com <br>
  这个软件的主页上还有个注册表监视工具和文件读写监视工具。Touch Typing是用VB5写的。破解的关键在于__vbaStrComp( )和rtcR8ValFromBStr( 
  )。 <br>
  <br>
  #include &lt;stdio.h> <br>
  #include &lt;string.h> <br>
  <br>
  void main(void) <br>
  { <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; char SerialStr[64]="Touch-Typing_000"; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; char PasswordStr[64]="PA00"; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; char buf[64]; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; long serial; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; long password; <br>
  <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; printf("KeyGen for Touch Typing version 98 3.3.\n"); 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; printf("Input a magic number: "); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; scanf("%lu", &amp;password); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; sprintf(buf,"%lu", password); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; buf[6] = '\0'; <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; sscanf(buf, "%lu", &amp;password); <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; strcat(PasswordStr, buf); <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; serial = password * 142L + 48935L; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; sprintf(buf, "%lu", serial); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; strcat(SerialStr, buf); <br>
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; printf("Your serial:&nbsp; "); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; puts(SerialStr); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; printf("Your password: "); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; puts(PasswordStr); <br>
  } </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>顺便再说一下，破解VB程序最好能熟悉一下x86常用的浮点运算指令。若不懂浮点指令则无法写这个程序的注册机 
  (2千字)<br>
  <font color=blue>发信人:</font>郭大志<br>
  <font color=blue>时 间:</font>2000-6-7 10:24:29 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 另外，在SoftICE中敲wf命令可以把x86的浮点寄存器栈窗口打开，便于观察浮点运算的过程。rtcR8ValFromBStr( 
  )负责把一个字符串转换成一个浮点数，在rtcR8ValFromBStr( )的函数体的尾部会把转换得到的浮点数用FLD指令加载到浮点寄存器中，如下所示，在执行完指令FLD 
  REAL8 PTR [EBP-08]后敲“dl ebp-8”命令可以看见局部变量[ebp-8]中存放的是转换后的浮点数，且浮点寄存器ST0中也存放该数。然后跟踪，看它如何处理ST0中的这个数即可。 
  <br>
  <br>
  MSVBVM50!rtcR8ValFromBstr <br>
  0167:7998D1FE&nbsp; PUSH&nbsp; &nbsp; &nbsp; EBP <br>
  0167:7998D1FF&nbsp; MOV&nbsp; &nbsp; &nbsp; EBP,ESP <br>
  0167:7998D201&nbsp; SUB&nbsp; &nbsp; &nbsp; ESP,10 <br>
  0167:7998D204&nbsp; PUSH&nbsp; &nbsp; &nbsp; ESI <br>
  0167:7998D205&nbsp; PUSH&nbsp; &nbsp; &nbsp; EDI <br>
  0167:7998D206&nbsp; MOV&nbsp; &nbsp; &nbsp; EDI,[EBP+08] <br>
  0167:7998D209&nbsp; TEST&nbsp; &nbsp; &nbsp; EDI,EDI <br>
  0167:7998D20B&nbsp; JNZ&nbsp; &nbsp; &nbsp; 7998D21B <br>
  0167:7998D20D&nbsp; FLD&nbsp; &nbsp; &nbsp; REAL8 PTR [7999C918] <br>
  0167:7998D213&nbsp; POP&nbsp; &nbsp; &nbsp; EDI <br>
  0167:7998D214&nbsp; POP&nbsp; &nbsp; &nbsp; ESI <br>
  0167:7998D215&nbsp; MOV&nbsp; &nbsp; &nbsp; ESP,EBP <br>
  0167:7998D217&nbsp; POP&nbsp; &nbsp; &nbsp; EBP <br>
  0167:7998D218&nbsp; RET&nbsp; &nbsp; &nbsp; 0004 <br>
  0167:7998D21B&nbsp; PUSH&nbsp; &nbsp; &nbsp; EDI <br>
  0167:7998D21C&nbsp; CALL&nbsp; &nbsp; &nbsp; [798B19E4] <br>
  0167:7998D222&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,EAX <br>
  0167:7998D224&nbsp; MOV&nbsp; &nbsp; &nbsp; ESI,EAX <br>
  0167:7998D226&nbsp; MOV&nbsp; &nbsp; &nbsp; AX,[EDI] <br>
  0167:7998D229&nbsp; TEST&nbsp; &nbsp; &nbsp; AX,AX <br>
  0167:7998D22C&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 7998D25D <br>
  0167:7998D22E&nbsp; CMP&nbsp; &nbsp; &nbsp; AX,0009 <br>
  0167:7998D232&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 7998D252 <br>
  0167:7998D234&nbsp; CMP&nbsp; &nbsp; &nbsp; AX,000A <br>
  0167:7998D238&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 7998D252 <br>
  0167:7998D23A&nbsp; CMP&nbsp; &nbsp; &nbsp; AX,000D <br>
  0167:7998D23E&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 7998D252 <br>
  0167:7998D240&nbsp; CMP&nbsp; &nbsp; &nbsp; AX,0020 <br>
  0167:7998D244&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 7998D252 <br>
  0167:7998D246&nbsp; CMP&nbsp; &nbsp; &nbsp; AX,3000 <br>
  0167:7998D24A&nbsp; JZ&nbsp; &nbsp; &nbsp; &nbsp; 7998D252 <br>
  0167:7998D24C&nbsp; MOV&nbsp; &nbsp; &nbsp; [ECX],AX <br>
  0167:7998D24F&nbsp; ADD&nbsp; &nbsp; &nbsp; ECX,02 <br>
  0167:7998D252&nbsp; ADD&nbsp; &nbsp; &nbsp; EDI,02 <br>
  0167:7998D255&nbsp; MOV&nbsp; &nbsp; &nbsp; AX,[EDI] <br>
  0167:7998D258&nbsp; TEST&nbsp; &nbsp; &nbsp; AX,AX <br>
  0167:7998D25B&nbsp; JNZ&nbsp; &nbsp; &nbsp; 7998D22E <br>
  0167:7998D25D&nbsp; MOV&nbsp; &nbsp; &nbsp; [ECX],AX <br>
  0167:7998D260&nbsp; PUSH&nbsp; &nbsp; &nbsp; 05 <br>
  0167:7998D262&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-10] <br>
  0167:7998D265&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-08],ESI <br>
  0167:7998D268&nbsp; MOV&nbsp; &nbsp; &nbsp; WORD PTR [EBP-10],0008 <br>
  0167:7998D26E&nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:7998D26F&nbsp; CALL&nbsp; &nbsp; &nbsp; 7998D657 <br>
  0167:7998D274&nbsp; MOV&nbsp; &nbsp; &nbsp; EDI,EAX <br>
  0167:7998D276&nbsp; PUSH&nbsp; &nbsp; &nbsp; ESI <br>
  0167:7998D277&nbsp; CALL&nbsp; &nbsp; &nbsp; [798B1988] <br>
  0167:7998D27D&nbsp; TEST&nbsp; &nbsp; &nbsp; EDI,EDI <br>
  0167:7998D27F&nbsp; JGE&nbsp; &nbsp; &nbsp; 7998D289 <br>
  0167:7998D281&nbsp; PUSH&nbsp; &nbsp; &nbsp; 00 <br>
  0167:7998D283&nbsp; PUSH&nbsp; &nbsp; &nbsp; EDI <br>
  0167:7998D284&nbsp; CALL&nbsp; &nbsp; &nbsp; 798BB385 <br>
  0167:7998D289&nbsp; FLD&nbsp; &nbsp; &nbsp; REAL8 PTR [EBP-08]&nbsp; //这里是在取转换结果 
  <br>
  0167:7998D28C&nbsp; JMP&nbsp; &nbsp; &nbsp; 7998D213 </span></blockquote>
<hr>
</body>
</html>
