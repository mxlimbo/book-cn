<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>初学者(10) (8千字)<br>
<font color=blue>发信人:</font>liutong<br>
<font color=blue>时 间:</font>2000-5-14 11:11:20 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 软件名称：&nbsp; Battery Bar <br>
  软件版本：&nbsp; 1.07 <br>
  软件大小：&nbsp; 907.00 <br>
  软件授权：&nbsp; 共享软件 <br>
  使用平台：&nbsp; Win95/98/NT <br>
  发布公司：&nbsp; http://www.nistech.com/ <br>
  软件简介：&nbsp; 能显示出你的笔记本电脑的电池还能用多长时间，电量剩余的百分比。 <br>
  软件下载：&nbsp; bat_bar.zip <br>
  <br>
  设断点:bpx hmemcpy <br>
  按F12 12次(第13次出错误画面) <br>
  然后按F10若干次可找到下面程序段 <br>
  :00406542 E88D300300&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004395D4 
  <br>
  :00406547 8D4DF8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [ebp-08] <br>
  :0040654A 8B01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov eax, dword ptr [ecx] <br>
  :0040654C 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  :0040654D 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebx <br>
  :0040654E E889010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004066DC 
  &lt;----此CALL是计算注册码,我改下面的跳转不成功 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; 
  &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; 才找到这儿 <br>
  :00406553 83C40C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esp, 0000000C <br>
  :00406556 3C01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; cmp al, 01 <br>
  :00406558 0F94C2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  sete dl <br>
  :0040655B 83E201&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  and edx, 00000001 <br>
  :0040655E 8D45F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-08] <br>
  :00406561 52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push edx <br>
  :00406562 BA02000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edx, 
  00000002 <br>
  :00406567 FF4E1C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  dec [esi+1C] <br>
  :0040656A E8D5660600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CC44 
  <br>
  :0040656F FF4E1C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  dec [esi+1C] <br>
  :00406572 8D45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-04] <br>
  :00406575 BA02000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov edx, 
  00000002 <br>
  :0040657A E8C5660600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CC44 
  <br>
  :0040657F 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; pop ecx <br>
  :00406580 84C9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test cl, cl <br>
  :00406582 0F84F1000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je 00406679&nbsp; 
  &lt;-----若在此改变程序方向 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; 可显示注册成功,但若重新 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; 启动程序,看About项,:-{ <br>
  <br>
  进入004066DC,按F10若干次后,找到计算注册码的部分,就是下面这段: <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:0040689D(C) <br>
  | <br>
  :004067B7 8BF3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov esi, ebx <br>
  :004067B9 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push esi <br>
  :004067BA 8D45F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-08] <br>
  :004067BD 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  :004067BE E801630600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CAC4 
  <br>
  :004067C3 83C408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esp, 00000008 <br>
  :004067C6 8D45F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-08] <br>
  :004067C9 E8E2650600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CDB0 
  <br>
  :004067CE 0375F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esi, dword ptr [ebp-08] <br>
  :004067D1 4E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; dec esi <br>
  :004067D2 803E00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp byte ptr [esi], 00 <br>
  :004067D5 7534&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 0040680B <br>
  :004067D7 8BF3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov esi, ebx <br>
  :004067D9 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push esi <br>
  :004067DA 8D55F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea edx, dword ptr [ebp-08] <br>
  :004067DD 52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push edx <br>
  :004067DE E8E1620600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CAC4 
  <br>
  :004067E3 83C408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esp, 00000008 <br>
  :004067E6 8D45F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-08] <br>
  :004067E9 E8C2650600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CDB0 
  <br>
  :004067EE 8BC7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov eax, edi <br>
  :004067F0 B91A000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  0000001A <br>
  :004067F5 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; cdq <br>
  :004067F6 F7F9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; idiv ecx <br>
  :004067F8 0375F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esi, dword ptr [ebp-08] <br>
  :004067FB 8955C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov dword ptr [ebp-38], edx <br>
  :004067FE 8B45C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-38] <br>
  :00406801 4E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; dec esi <br>
  :00406802 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; cdq <br>
  :00406803 33C2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; xor eax, edx <br>
  :00406805 2BC2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; sub eax, edx <br>
  :00406807 0441&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; add al, 41 <br>
  :00406809 8806&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov byte ptr [esi], al <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:004067D5(C) <br>
  | <br>
  :0040680B 8BF3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov esi, ebx <br>
  :0040680D 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push esi <br>
  :0040680E 8D4DF8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [ebp-08] <br>
  :00406811 51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ecx <br>
  :00406812 E8AD620600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CAC4 
  <br>
  :00406817 83C408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esp, 00000008 <br>
  :0040681A 8D45F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-08] <br>
  :0040681D E88E650600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CDB0 
  <br>
  :00406822 0375F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esi, dword ptr [ebp-08] <br>
  :00406825 4E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; dec esi <br>
  :00406826 0FBE3E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  movsx edi, byte ptr [esi] <br>
  :00406829 8BF3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov esi, ebx <br>
  :0040682B 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push esi <br>
  :0040682C 8D45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-04] <br>
  :0040682F 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  :00406830 E88F620600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CAC4 
  <br>
  :00406835 83C408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esp, 00000008 <br>
  :00406838 8D45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-04] <br>
  :0040683B E870650600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CDB0 
  <br>
  :00406840 8D045B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebx+2*ebx]&lt;----给EAX赋值 <br>
  :00406843 B91A000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  0000001A &lt;----后面作为除数 <br>
  :00406848 C1E003&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  shl eax, 03&nbsp; &lt;----EAX乘以8 <br>
  :0040684B 0375FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esi, dword ptr [ebp-04]&nbsp; <br>
  :0040684E 2BC3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; sub eax, ebx &lt;----EAX=EAX-EBX <br>
  :00406850 4E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; dec esi <br>
  :00406851 03C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; add eax, eax &lt;----EAX=EAX*2 <br>
  :00406853 03C7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; add eax, edi <br>
  :00406855 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; cdq <br>
  :00406856 F7F9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; idiv ecx&nbsp; &nbsp; &lt;-----做除法 <br>
  :00406858 8955C4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov dword ptr [ebp-3C], edx <br>
  :0040685B B905000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx, 
  00000005&nbsp; &lt;-----注册码4位一组,中间用'-'隔开 <br>
  :00406860 8B45C4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-3C] <br>
  :00406863 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; cdq <br>
  :00406864 33C2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; xor eax, edx <br>
  :00406866 2BC2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; sub eax, edx <br>
  :00406868 0441&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; add al, 41&nbsp; &lt;-----EAX=EAX+41 <br>
  :0040686A 8806&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov byte ptr [esi], al&nbsp; &lt;----加后的数值即是注册码的一位 <br>
  :0040686C 8BC3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov eax, ebx <br>
  :0040686E 99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; cdq <br>
  :0040686F F7F9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; idiv ecx <br>
  :00406871 85D2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test edx, edx <br>
  :00406873 751E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jne 00406893 <br>
  :00406875 8BF3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov esi, ebx <br>
  :00406877 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push esi <br>
  :00406878 8D45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-04] <br>
  :0040687B 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  :0040687C E843620600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CAC4 
  <br>
  :00406881 83C408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esp, 00000008 <br>
  :00406884 8D45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea eax, dword ptr [ebp-04] <br>
  :00406887 E824650600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0046CDB0 
  <br>
  :0040688C 0375FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add esi, dword ptr [ebp-04] <br>
  :0040688F 4E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; dec esi <br>
  :00406890 C6062D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov byte ptr [esi], 2D <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:00406873(C) <br>
  | <br>
  :00406893 8D3C5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea edi, dword ptr [ebx+2*ebx] <br>
  :00406896 83C709&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  add edi, 00000009 <br>
  :00406899 43&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; inc ebx <br>
  :0040689A 83FB13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp ebx, 00000013 <br>
  :0040689D 0F8E14FFFFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jle 004067B7&nbsp; 
  &nbsp; &lt;----比较19位注册码未计算完,返回 <br>
  <br>
  举例: <br>
  用户名:LiuTong <br>
  对于ASCII为:4C 69 75 54 6F 6E 67 <br>
  计算过程: <br>
  &nbsp; &nbsp; &nbsp; &nbsp; EAX=3*EBX EAX=EAX*8 EAX=EAX-EBX&nbsp; EAX=EAX*2&nbsp; 
  EAX=EAX+输入用户名&nbsp; EAX=余数(EAX/26)+41 <br>
  以下数据为十六进制 <br>
  EBX=1&nbsp; EAX=3&nbsp; &nbsp; EAX=18&nbsp; &nbsp; EAX=17&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=2E&nbsp; &nbsp; EAX=2E+4C=7A&nbsp; &nbsp; &nbsp; &nbsp; EAX=12+41=53 
  <br>
  EBX=2&nbsp; EAX=6&nbsp; &nbsp; EAX=30&nbsp; &nbsp; EAX=2E&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=5C&nbsp; &nbsp; EAX=5C+69=C5&nbsp; &nbsp; &nbsp; &nbsp; EAX=F+41=50&nbsp; 
  <br>
  EBX=3&nbsp; EAX=9&nbsp; &nbsp; EAX=48&nbsp; &nbsp; EAX=45&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=8A&nbsp; &nbsp; EAX=8A+75=FF&nbsp; &nbsp; &nbsp; &nbsp; EAX=15+41=56 
  <br>
  EBX=4&nbsp; EAX=C&nbsp; &nbsp; EAX=60&nbsp; &nbsp; EAX=5C&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=B8&nbsp; &nbsp; EAX=B8+54=102&nbsp; &nbsp; &nbsp; EAX=8+41=49 <br>
  EBX=5&nbsp; EAX=F&nbsp; &nbsp; EAX=78&nbsp; &nbsp; EAX=73&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=E6&nbsp; &nbsp; EAX=E6+6F=155&nbsp; &nbsp; &nbsp; EAX=3+41=44 <br>
  EBX=6&nbsp; EAX=12&nbsp; &nbsp; EAX=90&nbsp; &nbsp; EAX=8A&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=114&nbsp; &nbsp; EAX=114+6E=182&nbsp; &nbsp; &nbsp; EAX=16+41=57 
  <br>
  EBX=7&nbsp; EAX=15&nbsp; &nbsp; EAX=A8&nbsp; &nbsp; EAX=A1&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=142&nbsp; &nbsp; EAX=142+67=1A9&nbsp; &nbsp; &nbsp; EAX=9+41=4A <br>
  EBX=8&nbsp; EAX=18&nbsp; &nbsp; EAX=C0&nbsp; &nbsp; EAX=B8&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=170&nbsp; &nbsp; EAX=170+20=190&nbsp; &nbsp; &nbsp; EAX=A+41=4B <br>
  EBX=9&nbsp; EAX=1B&nbsp; &nbsp; EAX=D8&nbsp; &nbsp; EAX=CF&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=19E&nbsp; &nbsp; EAX=19E+20=1BE&nbsp; &nbsp; &nbsp; EAX=4+41=45 <br>
  EBX=A&nbsp; EAX=1E&nbsp; &nbsp; EAX=F0&nbsp; &nbsp; EAX=E6&nbsp; &nbsp; &nbsp; 
  &nbsp; EAX=1CC&nbsp; &nbsp; EAX=1CC+20=1EC&nbsp; &nbsp; &nbsp; EAX=18+41=59 
  <br>
  EBX=B&nbsp; EAX=21&nbsp; &nbsp; EAX=108&nbsp; EAX=FD&nbsp; &nbsp; &nbsp; &nbsp; 
  EAX=1FA&nbsp; &nbsp; EAX=1FA+20=21A&nbsp; &nbsp; &nbsp; EAX=12+41=53 <br>
  EBX=C&nbsp; EAX=24&nbsp; &nbsp; EAX=120&nbsp; EAX=114&nbsp; &nbsp; &nbsp; EAX=228&nbsp; 
  &nbsp; EAX=228+20=248&nbsp; &nbsp; &nbsp; EAX=C+41=4D <br>
  EBX=D&nbsp; EAX=27&nbsp; &nbsp; EAX=138&nbsp; EAX=12B&nbsp; &nbsp; &nbsp; EAX=256&nbsp; 
  &nbsp; EAX=256+20=276&nbsp; &nbsp; &nbsp; EAX=6+41=47 <br>
  EBX=E&nbsp; EAX=2A&nbsp; &nbsp; EAX=150&nbsp; EAX=142&nbsp; &nbsp; &nbsp; EAX=284&nbsp; 
  &nbsp; EAX=284+20=2A4&nbsp; &nbsp; &nbsp; EAX=0+41=41 <br>
  EBX=F&nbsp; EAX=2D&nbsp; &nbsp; EAX=168&nbsp; EAX=159&nbsp; &nbsp; &nbsp; EAX=2B2&nbsp; 
  &nbsp; EAX=2B2+20=2D2&nbsp; &nbsp; &nbsp; EAX=14+41=55 <br>
  EBX=10&nbsp; EAX=30&nbsp; &nbsp; EAX=180&nbsp; EAX=170&nbsp; &nbsp; &nbsp; EAX=2E0&nbsp; 
  &nbsp; EAX=2E0+20=300&nbsp; &nbsp; &nbsp; EAX=E+41=4F <br>
  EBX=11&nbsp; EAX=33&nbsp; &nbsp; EAX=198&nbsp; EAX=187&nbsp; &nbsp; &nbsp; EAX=30E&nbsp; 
  &nbsp; EAX=30E+20=32E&nbsp; &nbsp; &nbsp; EAX=8+41=49 <br>
  EBX=12&nbsp; EAX=36&nbsp; &nbsp; EAX=1B0&nbsp; EAX=19E&nbsp; &nbsp; &nbsp; EAX=33C&nbsp; 
  &nbsp; EAX=33C+20=35C&nbsp; &nbsp; &nbsp; EAX=2+41=43 <br>
  EBX=13&nbsp; EAX=39&nbsp; &nbsp; EAX=1C8&nbsp; EAX=1B5&nbsp; &nbsp; &nbsp; EAX=36A&nbsp; 
  &nbsp; EAX=36A+20=38A&nbsp; &nbsp; &nbsp; EAX=16+41=57 <br>
  <br>
  整理后注册码应为:SPVI-WJKE-SMGA-OICW </span></blockquote>
<hr>
</body>
</html>
