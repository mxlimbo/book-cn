<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><span class="p9"><font color=blue>标 题:</font>用w32dasm破解trw2000 
1.06时间限制 (2千字)<br>
<font color=blue>发信人:</font>sunwk(小楼）<br>
<font color=blue>时 间:</font>2000-3-3 14:47:14 <br>
<font color=blue>详细信息:</font><br>
</span> </span>
<blockquote><span class="p9"> 解除TRW2000 1.06的时间限制 <br>
  工具： <br>
  Procdump1.6.2 <br>
  Hiew6.1 <br>
  W32dasm8.93 <br>
  <br>
  &nbsp; 首先用W32dasm载入TRW2000.EXE，但将告诉你“W32dasm执行了非法程序”，它崩溃了。 <br>
  &nbsp; 在Procdump中选择 PEeditor\指定文件 TRW2000.EXE\SECTIONS, 你会发现 .data 的 characteristics值为C0000040,将之改为60000020,保存后再用W32dasm载入,OK! 
  <br>
  &nbsp; 反汇编后选 refs/string data references,找到"The vention is too old, please",双击后见到如下： 
  <br>
  * Possible StringData Ref from Data Obj ->"This version is too old , please 
  " <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ->"visit http://trw2000.yeah.net 
  " <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ->"to get update." 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004018CD 682CF14100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 0041F12C 
  <br>
  <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:004016CA(U) <br>
  | <br>
  :004018D2 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebx <br>
  <br>
  向上找见 <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Addresses: <br>
  |:0040164D(C), :00401675(C) <br>
  &nbsp; ~~~~~~~~&nbsp; &nbsp; &nbsp; ~~~~~~~~ <br>
  | <br>
  :004018C6 6A10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push 00000010 <br>
  <br>
  * Possible StringData Ref from Data Obj ->"ERROR" <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :004018C8 6828F24100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 0041F228&nbsp; 
  &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <br>
  <br>
  就到:0040164D(C)及:00401675(C) <br>
  :00401643 056C070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add eax, 
  0000076C <br>
  :00401648 3DD0070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp eax, 
  000007D0&nbsp; &lt;----1 <br>
  :0040164D 0F8F73020000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jg 004018C6&nbsp; 
  &nbsp; &nbsp; &nbsp; ***2 <br>
  :00401653 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push ebx <br>
  :00401654 8D4DE8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea ecx, dword ptr [ebp-18] <br>
  :00401657 E8AFDC0000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 0040F30B 
  <br>
  :0040165C 8B4010&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [eax+10] <br>
  :0040165F 40&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; inc eax <br>
  :00401660 83F802&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp eax, 00000002&nbsp; &lt;----3 <br>
  :00401663 7E16&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jle 0040167B&nbsp; &nbsp; &nbsp; &nbsp; ***4 <br>
  <br>
  猜到了吗? <br>
  1 :00401648 3DD0070000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp eax, 
  000007D0&nbsp; 比较年份--2000年(000007D0) <br>
  2 :0040164D 0F8F73020000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jg 004018C6&nbsp; 
  &nbsp; &nbsp; &nbsp; 若大于2000年则过期 <br>
  3 :00401660 83F802&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  cmp eax, 00000002&nbsp; 比较月份--2月(00000002) <br>
  4 :00401663 7E16&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; jle 0040167B&nbsp; &nbsp; &nbsp; 若不大于2月就跳过前面的过期提示 <br>
  <br>
  知道如何作了? <br>
  1 改 3DD0070000 <br>
  &nbsp; 为 3D34080000&nbsp; 可以用到2100年(那时可就干不动这活喽!) <br>
  2 改 7E16 <br>
  &nbsp; 为 EB16&nbsp; &nbsp; &nbsp; &nbsp; 直接跳到开始 <br>
  &nbsp; <br>
  完成了吗?运行TRW2000,它告诉你执行了非法程序。WHY？别忘了我们前面用过Procdump，只要用它将TRW2000.EXE\SECTIONS\ 
  .data 的 characteristics值由60000020改回C0000040 ,保存后运行TRW2000,OK! <br>
  <br>
  附: 1 TRW2000确实是一个好程序,不象TRW0.75版本动不动就死机。目前它的升级非常快。劝各位还是尽量用最新的版本吧，不要象我没事找使干。写这篇文章的目的是告诉大家：如何改动程序来使W32dasm工作。 
  <br>
  &nbsp; &nbsp; 2 TRW2000版的注册费要六、七十元，我不愿花这么多钱来注册。谁有注册版本，能否E-MAIL我，在此先行谢过。 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 孙悟空之七十二变 </span></blockquote>
<hr>
</body>
</html>
