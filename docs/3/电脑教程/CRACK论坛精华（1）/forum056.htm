<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>IP搜索客 1.61 注册码计算 (2千字)<br>
<font color=blue>发信人:</font>小楼<br>
<font color=blue>时 间:</font>2000-5-16 11:19:48 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> IP搜索客 1.61 注册码计算 <br>
  <br>
  &nbsp; &nbsp; 这个软件可以根据对方的IP地址查到他的位置和ISP.可以轻松的查出给你发信人的位置,你就可以知道你的那些通过E-mail交流的网友都是哪里的人了以及他的ISP.(如:上海CHINANET(163)用户).本软件使用屏幕取词式操作(和金山词霸一样),只需将鼠标指到IP地址上就可以将它的地理位置在鼠标下方的浮动窗口中显示出来,并且可以将显示的内容复制到剪贴板. 
  <br>
  &nbsp; &nbsp; 下载地址 http://greenstuff.363.net <br>
  <br>
  首先随便输入147258369，得到告示：注册码错误。 <br>
  然后用ultraedit打开ipseeker.exe，找到“注册码错误”，改为aaaaa，你还会找到“注册成功”，也改为dddd。保存后用W32DASM反汇编，如下 
  <br>
  * Possible StringData Ref from Data Obj ->"dddddd"&nbsp; 注册成功 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :00403E54 68D8414300&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 004341D8 
  <br>
  :00403E59 8BC8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov ecx, eax <br>
  :00403E5B E8034B0200&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00428963 
  <br>
  <br>
  ...... <br>
  <br>
  * Possible StringData Ref from Data Obj ->"aaaaaaaaaa"&nbsp; 注册失败 <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <br>
  :00403EC9 68B4414300&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 004341B4 
  <br>
  :00403ECE 8BC8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov ecx, eax <br>
  :00403ED0 E88E4A0200&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00428963 
  <br>
  <br>
  向上看， <br>
  :00403D64 8BCE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov ecx, esi <br>
  :00403D66 E8E5040000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00404250&nbsp; 
  &lt;-- 比较核心 <br>
  :00403D6B 85C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test eax, eax&nbsp; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;-- 注册标志，eax=1 <br>
  :00403D6D 0F8427010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je 00403E9A 
  <br>
  <br>
  <br>
  在:00403D66 E8E5040000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00404250&nbsp; 
  进入，走到 <br>
  * Referenced by a (U)nconditional or (C)onditional Jump at Address: <br>
  |:004044F6(C) <br>
  | <br>
  :004044D8 8A10&nbsp; &nbsp; mov dl, byte ptr [eax] <br>
  :004044DA 8ACA&nbsp; &nbsp; mov cl, dl <br>
  :004044DC 3A16&nbsp; &nbsp; cmp dl, byte ptr [esi] <br>
  :004044DE 751C&nbsp; &nbsp; jne 004044FC <br>
  :004044E0 84C9&nbsp; &nbsp; test cl, cl <br>
  :004044E2 7414&nbsp; &nbsp; je 004044F8 <br>
  :004044E4 8A5001&nbsp; mov dl, byte ptr [eax+01] <br>
  :004044E7 8ACA&nbsp; &nbsp; mov cl, dl <br>
  :004044E9 3A5601&nbsp; cmp dl, byte ptr [esi+01] <br>
  :004044EC 750E&nbsp; &nbsp; jne 004044FC <br>
  :004044EE 83C002&nbsp; add eax, 00000002 <br>
  :004044F1 83C602&nbsp; add esi, 00000002 <br>
  :004044F4 84C9&nbsp; &nbsp; test cl, cl <br>
  :004044F6 75E0&nbsp; &nbsp; jne 004044D8 <br>
  <br>
  这里就是注册码比较的计算。 <br>
  每次程序依次取两位，放入byte ptr [esi]，byte ptr [esi+1]，与eax, eax+1比较。如此循环。这样正确的注册码只要在 <br>
  :004044DC 3A16&nbsp; &nbsp; cmp dl, byte ptr [esi] 处 d eax, d eax+1即可。 <br>
  如此抄下，最后我的注册码为 ：5FBA49AD1C7CA39B </span></blockquote>
<hr>
</body>
</html>
