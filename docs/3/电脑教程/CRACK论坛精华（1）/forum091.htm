<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>大家不妨来试试这个软件的破解！ (108字)<br>
<font color=blue>发信人:</font>guest<br>
<font color=blue>时 间:</font>2000-6-12 21:17:20 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> FlashFXP V1.2 Build 602 <br>
  下载地址： <br>
  http://software.wx88.net/ftpfiles/internet/int-ftpm/ffxp1.2.602.zip<br>
  或：http://www.flashfxp.com/preview/ffxp1.2.602.zip </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>FlashFXP 1.2.602 破解 (2千字)<br>
  <font color=blue>发信人:</font>冰毒<br>
  <font color=blue>时 间:</font>2000-6-16 8:23:36 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 这个程序的原来似乎是用UPX加壳的,这次却换用PECompact加壳了. 手动脱壳不难. 程序入口是一对PUSHFD/PUSHAD,在第一个CALL时F8进入,F10往下走一阵. 
  找到POPAD/POPFD这对指令,在其上设断. 拦下,F10到RET行时便可用Procdump脱壳了. EOP=518024. <br>
  注册信息以加密过的形式存放在FlashFxp.ini中,程序启动时读入并解码还原. 因此,设断 bpx getprivateprofilestringa 
  do "dd *(ss:(esp+8))". 运行程序,第2次拦截,数据窗中见到Serial的字样. F12回到程序, F10往下两行,EDX中便是密文形式的序号. 
  设断bpr. 可以见到程序将序号转放到内存的另一处,同样对这一处设断bpr. 拦下后跟踪,来到 <br>
  <br>
  .0047DFFE: 8B4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; eax,[ebp][00008] <br>
  .0047E001: 8B55F0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; edx,[ebp][-0010] /在此行设断 <br>
  .0047E004: E83F5CF8FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call&nbsp; &nbsp; .000403C48 <br>
  .0047E009: 33C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp; eax,eax <br>
  <br>
  可以见到EDX中先后出现解码后的序号和姓名(即我们输入的注册信息). 然后F10来到 <br>
  <br>
  .00509EB4: E8739FEFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call&nbsp; &nbsp; .000403E2C /(1) <br>
  .00509EB9: 83F802&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; eax,002 /注册码长度大于姓名长度的2倍? <br>
  .00509EBC: 0F8EBA000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  jle&nbsp; &nbsp; &nbsp; .000509F7C /不是则跳开(这里应使其不跳) <br>
  .00509EC2: 8B45F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; eax,[ebp][-0008] <br>
  .00509EC5: 8B55FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; edx,[ebp][-0004] <br>
  .00509EC8: E86FA0EFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call&nbsp; &nbsp; .000403F3C&nbsp; /(2) <br>
  .00509ECD: 0F85A9000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  jne&nbsp; &nbsp; &nbsp; .000509F7C /这里使其不跳 <br>
  .00509ED3: 8B45FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; eax,[ebp][-0004] <br>
  .00509ED6: E8718CFAFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call&nbsp; &nbsp; .0004B2B4C /(3) <br>
  .00509EDB: 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; test&nbsp; &nbsp; &nbsp; al,al <br>
  .00509EDD: 750B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; jne&nbsp; &nbsp; &nbsp; .000509EEA /这里使其不跳 <br>
  .00509EDF: 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; ebp <br>
  .00509EE0: E81FFBFFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call&nbsp; &nbsp; .000509A04 /(4) <br>
  .00509EE5: 59&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp; &nbsp; ecx <br>
  .00509EE6: 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; test&nbsp; &nbsp; &nbsp; al,al <br>
  .00509EE8: 752D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; jne&nbsp; &nbsp; &nbsp; .000509F17 /这里使其跳 <br>
  .00509EEA: C605582F520001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; 
  &nbsp; &nbsp; b,[000522F58],001 <br>
  .00509EF1: 6A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; 000 <br>
  .00509EF3: 6A00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; 000 <br>
  .00509EF5: 6875040000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push&nbsp; &nbsp; &nbsp; 000000475 <br>
  .00509EFA: A1482F5200&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; mov&nbsp; &nbsp; &nbsp; eax,[000522F48] <br>
  .00509EFF: E8E003F3FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; call&nbsp; &nbsp; .00043A2E4 <br>
  <br>
  附带说一下,跟踪时可见到程序中一个不小的黑名单. 另外,如果只Patch (1)(2)两处,你可以试试会发生什么. :) 不脱壳直接对程序进行Patch也行,具体做法可参考"侠客之家"IceBird的教程. 
  </span></blockquote>
<hr>
<p><span class="p9"><font color=blue>标 题:</font>注册机 (4千字)<br>
  <font color=blue>发信人:</font>郭大志<br>
  <font color=blue>时 间:</font>2000-6-16 10:38:58 <br>
  <font color=blue>详细信息:</font><br>
  </span></p>
<blockquote><span class="p9"> 原来它对名字还有些限制，昨天没仔细看，还以为是有假注册码，被它骗了。 <br>
  1、它要求名字中必须有空格，即名字由First Name和Last Name构成，且以空格格开； <br>
  2、名字的第一个字母必须大写，最好把First Name和Last Name的第一个字母都大写； <br>
  3、名字的长度要大于等于4； <br>
  4、如冰毒所说的，名字的前几个字母不要和黑名单中的重合了，即如果黑名单中的名字是你的名字的子串，就begger off。 <br>
  <br>
  它用同一个子程序来判断注册码。 <br>
  第一次调用这个子程序把INI文件中的注册码密文变成明文； <br>
  第二次调用这个子程序把INI文件中的名字的密文变成明文； <br>
  第三次则调用该子程序对注册码的明文进行变换，如果变换的结果等于你的名字，则OK，否则game over。 <br>
  <br>
  该段子程序如下，用SoftICE跟一下就清楚了。 <br>
  <br>
  0167:0047DF3B&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-2C] <br>
  0167:0047DF3E&nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:0047DF3F&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,00000002 <br>
  0167:0047DF44&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,00000001 <br>
  0167:0047DF49&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  0167:0047DF4C&nbsp; CALL&nbsp; &nbsp; &nbsp; 00404030 <br>
  0167:0047DF51&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,[EBP-2C] <br>
  0167:0047DF54&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-28] <br>
  0167:0047DF57&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,0047E064 <br>
  0167:0047DF5C&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403E78 <br>
  0167:0047DF61&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-28] <br>
  0167:0047DF64&nbsp; CALL&nbsp; &nbsp; &nbsp; 00408D84 <br>
  0167:0047DF69&nbsp; MOV&nbsp; &nbsp; &nbsp; EDI,EAX&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; //两个字符转换成一个数a <br>
  0167:0047DF6B&nbsp; MOV&nbsp; &nbsp; &nbsp; DWORD PTR [EBP-14],00000003 <br>
  0167:0047DF72&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-2C] <br>
  0167:0047DF75&nbsp; PUSH&nbsp; &nbsp; &nbsp; EAX <br>
  0167:0047DF76&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,00000002 <br>
  0167:0047DF7B&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBP-14] <br>
  0167:0047DF7E&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  0167:0047DF81&nbsp; CALL&nbsp; &nbsp; &nbsp; 00404030 <br>
  0167:0047DF86&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,[EBP-2C] <br>
  0167:0047DF89&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-28] <br>
  0167:0047DF8C&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,0047E064 <br>
  0167:0047DF91&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403E78 <br>
  0167:0047DF96&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-28] <br>
  0167:0047DF99&nbsp; CALL&nbsp; &nbsp; &nbsp; 00408D84 <br>
  0167:0047DF9E&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,EAX&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; //两个字符转换成一个数b <br>
  0167:0047DFA0&nbsp; CMP&nbsp; &nbsp; &nbsp; ESI,[EBP-0C] <br>
  0167:0047DFA3&nbsp; JGE&nbsp; &nbsp; &nbsp; 0047DFA8 <br>
  0167:0047DFA5&nbsp; INC&nbsp; &nbsp; &nbsp; ESI <br>
  0167:0047DFA6&nbsp; JMP&nbsp; &nbsp; &nbsp; 0047DFAD <br>
  0167:0047DFA8&nbsp; MOV&nbsp; &nbsp; &nbsp; ESI,00000001 <br>
  0167:0047DFAD&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-08] <br>
  0167:0047DFB0&nbsp; MOVZX&nbsp; &nbsp; EAX,BYTE PTR [ESI+EAX-01]&nbsp; //取出一个常数 
  <br>
  0167:0047DFB5&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EBX&nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; //异或 <br>
  0167:0047DFB7&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-18],EAX <br>
  0167:0047DFBA&nbsp; CMP&nbsp; &nbsp; &nbsp; EDI,[EBP-18]&nbsp; &nbsp; &nbsp; 
  //根据大小做不同处理 <br>
  0167:0047DFBD&nbsp; JL&nbsp; &nbsp; &nbsp; &nbsp; 0047DFCE <br>
  0167:0047DFBF&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-18] <br>
  0167:0047DFC2&nbsp; ADD&nbsp; &nbsp; &nbsp; EAX,000000FF <br>
  0167:0047DFC7&nbsp; SUB&nbsp; &nbsp; &nbsp; EAX,EDI <br>
  0167:0047DFC9&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-18],EAX <br>
  0167:0047DFCC&nbsp; JMP&nbsp; &nbsp; &nbsp; 0047DFD1 <br>
  0167:0047DFCE&nbsp; SUB&nbsp; &nbsp; &nbsp; [EBP-18],EDI <br>
  0167:0047DFD1&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-28] <br>
  0167:0047DFD4&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBP-18] <br>
  0167:0047DFD7&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403D54 <br>
  0167:0047DFDC&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBP-28] <br>
  0167:0047DFDF&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-10] <br>
  0167:0047DFE2&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403E34 <br>
  0167:0047DFE7&nbsp; MOV&nbsp; &nbsp; &nbsp; EDI,EBX <br>
  0167:0047DFE9&nbsp; ADD&nbsp; &nbsp; &nbsp; DWORD PTR [EBP-14],02 <br>
  0167:0047DFED&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  0167:0047DFF0&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403E2C <br>
  0167:0047DFF5&nbsp; CMP&nbsp; &nbsp; &nbsp; EAX,[EBP-14] <br>
  0167:0047DFF8&nbsp; JG&nbsp; &nbsp; &nbsp; &nbsp; 0047DF72&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //循环 <br>
  0167:0047DFFE&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP+08] <br>
  0167:0047E001&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,[EBP-10]&nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; //变换后的串 <br>
  0167:0047E004&nbsp; CALL&nbsp; &nbsp; &nbsp; 00403C48 <br>
  <br>
  日期、名字、注册码在注册表中和INI文件中都记录了。 <br>
  <br>
  如下是注册机。一个可用的注册码： <br>
  Name:&nbsp; China Cracker <br>
  Code:&nbsp; 832E09019806CDA317F3D468CEA9 <br>
  <br>
  #include &lt;stdio.h> <br>
  #include &lt;string.h> <br>
  #include &lt;windows.h> <br>
  <br>
  void main(void) <br>
  { <br>
  <br>
  &nbsp; &nbsp; char table[] = { 0xE8, 0x9F, 0x73, 0xF7, 0xFF, 0xEB, 0xB2, <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; 0x01, 0x8B, 0x83, 0x28, 0x03, 0xE8, 0x16, <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; &nbsp; 0x26, 0xFA}; <br>
  &nbsp; &nbsp; unsigned char name[120]; <br>
  &nbsp; &nbsp; signed long&nbsp; code[128]; <br>
  &nbsp; &nbsp; int&nbsp; k; <br>
  &nbsp; &nbsp; int&nbsp; len; <br>
  &nbsp; &nbsp; signed long temp, code1, code2; <br>
  <br>
  &nbsp; &nbsp; printf("Input your name: "); <br>
  &nbsp; &nbsp; gets(name); <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; len = strlen(name); <br>
  <br>
  &nbsp; &nbsp; //用GetTickCount( )模拟随机数 <br>
  &nbsp; &nbsp; code[0] = GetTickCount( ) &amp; 0x000000FFL; <br>
  &nbsp; &nbsp; <br>
  &nbsp; &nbsp; for (k = 0; k &lt; len; k++) <br>
  &nbsp; &nbsp; { <br>
  &nbsp; &nbsp; &nbsp; &nbsp; temp = code[k] + (long)name[k]; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; <br>
  &nbsp; &nbsp; &nbsp; &nbsp; if (temp > 0xFF) <br>
  &nbsp; &nbsp; &nbsp; &nbsp; { <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; code[k+1] = (temp - 0x000000FFL) ^ 
  ((long)table[k] &amp; 0x000000FFL); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; } <br>
  &nbsp; &nbsp; &nbsp; &nbsp; else <br>
  &nbsp; &nbsp; &nbsp; &nbsp; { <br>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; code[k+1] = temp ^ ((long)table[k] 
  &amp; 0x000000FFL); <br>
  &nbsp; &nbsp; &nbsp; &nbsp; } <br>
  &nbsp; &nbsp; } <br>
  <br>
  &nbsp; &nbsp; printf("Your code is: "); <br>
  &nbsp; &nbsp; for ( k = 0; k &lt; (len+1); k++) <br>
  &nbsp; &nbsp; { <br>
  &nbsp; &nbsp; &nbsp; &nbsp; printf("%02X", code[k] &amp; 0xFF); <br>
  &nbsp; &nbsp; } <br>
  &nbsp; &nbsp; printf("\n"); <br>
  } </span></blockquote>
<hr>
</body>
</html>
