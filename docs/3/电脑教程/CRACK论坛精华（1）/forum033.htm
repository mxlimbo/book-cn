<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>脱Insta3D version 2.0（Vbox420)的壳 (2千字)<br>
<font color=blue>发信人:</font>IceBird<br>
<font color=blue>时 间:</font>2000-4-9 0:14:48 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 脱Insta3D version 2.0（Vbox420)的壳 <br>
  <br>
  目标文件：Insta3De.exe （1,149,724 字节） <br>
  <br>
  下载网址：http://www.newhua.com.cn/down/i3d200e.exe <br>
  <br>
  使用工具：Soft-ice 405 、Procdump1.6.5 、Icedump6015 <br>
  <br>
  前言：由于我没找到用Vbox430保护的软件，所以用Insta3D version 2.0代替。Vbox420和Vbox430的脱壳方法差不多，希望这篇文章能起到抛砖引玉的作用。另外请使用Icedump6014或以上版本，我会用到它的新指令‘pagein 
  b’，因为这个指令比‘pagein d'要好:-D <br>
  <br>
  *********************************************************** <br>
  <br>
  启动Windows加载Soft-ice，加载Icedump，运行Procdump32，点击其中的‘Bhrama Server’，运行Insta3D，出现干挠画面。Ctrl-D叫出Sice，下‘Bpx 
  getprocaddress’后退出，点击一下Try，拦下后下‘BD *’清断点，按几次F12（第2次会很长时间）直到这里： <br>
  <br>
  0137:00E80413 FFD6&nbsp; &nbsp; &nbsp; &nbsp; CALL ESI&nbsp; &nbsp; * 这里设断点 
  * <br>
  0137:00E80415 5B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP EBX <br>
  0137:00E80416 85C0&nbsp; &nbsp; &nbsp; &nbsp; TEST EAX,EAX <br>
  0137:00E80418 742E&nbsp; &nbsp; &nbsp; &nbsp; JZ 00E80448 <br>
  0137:00E8041A 6800800000&nbsp; PUSH 00008000 <br>
  0137:00E8041F 6A00&nbsp; &nbsp; &nbsp; &nbsp; PUSH 00 <br>
  0137:00E80421 56&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH ESI <br>
  0137:00E80422 8B750C&nbsp; &nbsp; &nbsp; MOV ESI,[EBP+0C] <br>
  0137:00E80425 FF5678&nbsp; &nbsp; &nbsp; CALL [ESI+78] <br>
  0137:00E80428 8B4508&nbsp; &nbsp; &nbsp; MOV EAX,[EBP+08] <br>
  <br>
  在CALL ESI处设断点（注意你们的内存地址和我的不同，请参照CODE），按一下F5，又被拦下，按F8进入，然后一直按F10来到这里： <br>
  <br>
  0137:00EA0242 55&nbsp; &nbsp; &nbsp; &nbsp; PUSH EBP  <br>
  0137:00EA0243 E8A7000000 CALL 00EA02EF * 这里按F8进入 * <br>
  0137:00EA0248 83C408&nbsp; &nbsp; ADD ESP,08 <br>
  0137:00EA024B 85C0&nbsp; &nbsp; &nbsp; TEST EAX,EAX <br>
  0137:00EA024D 750A&nbsp; &nbsp; &nbsp; JNZ 00EA0259 <br>
  0137:00EA024F 5F&nbsp; &nbsp; &nbsp; &nbsp; POP EDI <br>
  0137:00EA0250 5E&nbsp; &nbsp; &nbsp; &nbsp; POP ESI <br>
  0137:00EA0251 5D&nbsp; &nbsp; &nbsp; &nbsp; POP EBP <br>
  0137:00EA0252 5B&nbsp; &nbsp; &nbsp; &nbsp; POP EBX  <br>
  0137:00EA0253 83C410&nbsp; &nbsp; ADD ESP,10 <br>
  <br>
  在EA0243处按F8进入，之后小心按F10来到这里： <br>
  <br>
  0137:00EA0383 EB1C&nbsp; JMP 00EA03A1  <br>
  0137:00EA0385 8B45F8 MOV EAX,[EBP-08]  <br>
  0137:00EA0388 8B4814 MOV ECX,[EAX+14] <br>
  0137:00EA038B 894DEC MOV [EBP-14],ECX <br>
  0137:00EA038E 8B5DEC MOV EBX,[EBP-14] <br>
  0137:00EA0391 FFE3&nbsp; JMP EBX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  * 这里会跳到主程序 * <br>
  0137:00EA0393 8B55F8 MOV EDX,[EBP-08] <br>
  0137:00EA0396 8B4214 MOV EAX,[EDX+14] <br>
  0137:00EA0399 8945F0 MOV [EBP-10],EAX  <br>
  0137:00EA039C 8B4DF0 MOV ECX,[EBP-10]  <br>
  <br>
  执行到EA0391会跳动到主程序，如下： <br>
  <br>
  0137:004E8E8F CC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INT 3  <br>
  0137:004E8E90 55&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH EBP &nbsp; * 
  我们停在这里 * <br>
  0137:004E8E91 8BEC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV EBP,ESP <br>
  0137:004E8E93 6AFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH FF <br>
  0137:004E8E95 68D8285B00&nbsp; &nbsp; PUSH 005B28D8 <br>
  0137:004E8E9A 6850E14E00&nbsp; &nbsp; PUSH 004EE150 <br>
  0137:004E8E9F 64A100000000&nbsp; MOV EAX,FS:[00000000] <br>
  0137:004E8EA5 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH EAX <br>
  0137:004E8EA6 64892500000000 MOV FS:[00000000],ESP  <br>
  0137:004E8EAD 83C4A4&nbsp; &nbsp; &nbsp; &nbsp; ADD ESP,-5C  <br>
  <br>
  来到4E8E90后开始脱壳，下‘PAGEIN B PROCDUMP32 - DUMPER SERVER’指令，至此脱壳完毕。是不是很快？我只用了30秒:) 
  <br>
  <br>
  ************************************************************ <br>
  <br>
  此软件脱壳后有3M多，由于我的机器比较慢:(所以没有反汇编破解。评估版好象关闭了一项功能，如果哪位高手破了它请告诉小弟或把它帖出来:-) <br>
  <br>
  8/4/2000 <br>
  <br>
  IceBird </span></blockquote>
<hr>
</body>
</html>
