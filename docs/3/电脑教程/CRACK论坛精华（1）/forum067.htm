<html>
<head>
<title>看雪学苑</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style type="text/css">
<!--
.p8 {  font-size: 8pt}
.p9 {  font-size: 9pt}
a:hover {  color: #00FF00}
a {  text-decoration: none}
.p12 {  font-size: 12pt; font-weight: bold; color: #FF3333}
-->
</style>
</head>

<body bgcolor="#FFFFFF">
<span class="p9"><font color=blue>标 题:</font>DDXia主页crackme中的aLoNg3x的破解过程（难度：简单） 
(4千字)<br>
<font color=blue>发信人:</font>cqzrd<br>
<font color=blue>时 间:</font>2000-5-27 9:03:16 <br>
<font color=blue>详细信息:</font><br>
</span>
<blockquote><span class="p9"> 这次破的软件是DDXia主页（http://go.163.com/~ddxia/）中crackme中的aLoNg3x 
  <br>
  （解压后名字为crackme100.exe )，有兴趣的同志可以去下一个来试试。 <br>
  功能：无，专供练手。级别：1。 <br>
  工具：TRW2000121。 <br>
  步骤： <br>
  1、打开后在name框中输入大名，字母数必须>5个，原因在后面会讲到。 <br>
  code框随便输入几个数即可。 <br>
  2、bpx hmemcpy设断。F5 退出。 <br>
  3、再随便输入一个数，TRW弹出。 <br>
  4、pmodule返回程式空间。不断按F10，直到： <br>
  00442CE7 8D55F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea edx, dword ptr [ebp-08] <br>
  00442CEA 8B83E0020000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword 
  ptr [ebx+000002E0] <br>
  00442CF0 E8CB05FEFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004232C0&nbsp; 
  --->获取name及其字数 <br>
  00442CF5 8B45F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-08] <br>
  00442CF8 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; push eax <br>
  00442CF9 8D55F0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  lea edx, dword ptr [ebp-10] <br>
  00442CFC 8B83DC020000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax, dword 
  ptr [ebx+000002DC] <br>
  00442D02 E8B905FEFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 004232C0&nbsp; 
  --->获取code <br>
  00442D07 8B45F0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  mov eax, dword ptr [ebp-10] <br>
  00442D0A 5A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; pop edx <br>
  00442D0B E82CFDFFFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call 00442A3C&nbsp; 
  --->***在此换F8切入。*** <br>
  00442D10 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; test al, al&nbsp; --->若al=0则去死。 <br>
  00442D12 740F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  &nbsp; je 00442D23 <br>
  <br>
  此处是call 00442A3C的内容： <br>
  015F:00442A3C&nbsp; PUSH&nbsp; &nbsp; EBP <br>
  015F:00442A3D&nbsp; MOV&nbsp; &nbsp; &nbsp; EBP,ESP <br>
  015F:00442A3F&nbsp; ADD&nbsp; &nbsp; &nbsp; ESP,BYTE -08 <br>
  015F:00442A42&nbsp; PUSH&nbsp; &nbsp; EBX <br>
  015F:00442A43&nbsp; PUSH&nbsp; &nbsp; ESI <br>
  015F:00442A44&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-08],EDX <br>
  015F:00442A47&nbsp; MOV&nbsp; &nbsp; &nbsp; [EBP-04],EAX <br>
  015F:00442A4A&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  015F:00442A4D&nbsp; CALL&nbsp; &nbsp; 00403BE8 <br>
  015F:00442A52&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-08] <br>
  015F:00442A55&nbsp; CALL&nbsp; &nbsp; 00403BE8 <br>
  015F:00442A5A&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  015F:00442A5C&nbsp; PUSH&nbsp; &nbsp; EBP <br>
  015F:00442A5D&nbsp; PUSH&nbsp; &nbsp; DWORD 00442AE5 <br>
  015F:00442A62&nbsp; PUSH&nbsp; &nbsp; DWORD [FS:EAX] <br>
  015F:00442A65&nbsp; MOV&nbsp; &nbsp; &nbsp; [FS:EAX],ESP <br>
  015F:00442A68&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  015F:00442A6B&nbsp; CALL&nbsp; &nbsp; 00403A34 <br>
  015F:00442A70&nbsp; CMP&nbsp; &nbsp; &nbsp; EAX,BYTE +05&nbsp; --->比较name长度是否>5。 
  <br>
  015F:00442A73&nbsp; JNG&nbsp; &nbsp; &nbsp; 00442AC8&nbsp; &nbsp; &nbsp; --->若不大于则去死。 
  <br>
  015F:00442A75&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  015F:00442A78&nbsp; CALL&nbsp; &nbsp; 00403A34 <br>
  015F:00442A7D&nbsp; MOV&nbsp; &nbsp; &nbsp; EBX,EAX <br>
  015F:00442A7F&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-04] <br>
  015F:00442A82&nbsp; CALL&nbsp; &nbsp; 00403A34 <br>
  015F:00442A87&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,EAX <br>
  015F:00442A89&nbsp; DEC&nbsp; &nbsp; &nbsp; EDX <br>
  015F:00442A8A&nbsp; TEST&nbsp; &nbsp; EDX,EDX <br>
  015F:00442A8C&nbsp; JNG&nbsp; &nbsp; &nbsp; 00442AAE <br>
  015F:00442A8E&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,01&nbsp; &nbsp; --->EAX置1 <br>
  015F:00442A93&nbsp; MOV&nbsp; &nbsp; &nbsp; ECX,[EBP-04] <br>
  015F:00442A96&nbsp; MOVZX&nbsp; &nbsp; ECX,BYTE [ECX+EAX-01]&nbsp; --->取name的第一个字母。 
  <br>
  015F:00442A9B&nbsp; MOV&nbsp; &nbsp; &nbsp; ESI,[EBP-04] <br>
  015F:00442A9E&nbsp; MOVZX&nbsp; &nbsp; ESI,BYTE [ESI+EAX]&nbsp; --->取name的第二个字母。 
  <br>
  015F:00442AA2&nbsp; IMUL&nbsp; &nbsp; ECX,ESI&nbsp; &nbsp; — <br>
  015F:00442AA5&nbsp; IMUL&nbsp; &nbsp; ECX,EAX&nbsp; &nbsp; &nbsp; | <br>
  015F:00442AA8&nbsp; ADD&nbsp; &nbsp; &nbsp; EBX,ECX&nbsp; &nbsp; &nbsp; |&nbsp; 
  该段通过name换算出一个数num <br>
  015F:00442AAA&nbsp; INC&nbsp; &nbsp; &nbsp; EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  | <br>
  015F:00442AAB&nbsp; DEC&nbsp; &nbsp; &nbsp; EDX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
  | <br>
  015F:00442AAC&nbsp; JNZ&nbsp; &nbsp; &nbsp; 00442A93&nbsp; &nbsp; — <br>
  015F:00442AAE&nbsp; MOV&nbsp; &nbsp; &nbsp; EAX,[EBP-08] <br>
  015F:00442AB1&nbsp; CALL&nbsp; &nbsp; 00407670&nbsp; --->获取code并转为Hex放入EAX。 
  <br>
  015F:00442AB6&nbsp; SUB&nbsp; &nbsp; &nbsp; EBX,EAX <br>
  015F:00442AB8&nbsp; CMP&nbsp; &nbsp; &nbsp; EBX,029A&nbsp; --->比较num与code之差是否为029A（666） 
  <br>
  015F:00442ABE&nbsp; JNZ&nbsp; &nbsp; &nbsp; 00442AC4&nbsp; --->若是，则OK按钮可用，否则去死。 
  <br>
  015F:00442AC0&nbsp; MOV&nbsp; &nbsp; &nbsp; BL,01 <br>
  015F:00442AC2&nbsp; JMP&nbsp; &nbsp; &nbsp; SHORT 00442ACA <br>
  015F:00442AC4&nbsp; XOR&nbsp; &nbsp; &nbsp; EBX,EBX <br>
  015F:00442AC6&nbsp; JMP&nbsp; &nbsp; &nbsp; SHORT 00442ACA <br>
  015F:00442AC8&nbsp; XOR&nbsp; &nbsp; &nbsp; EBX,EBX <br>
  015F:00442ACA&nbsp; XOR&nbsp; &nbsp; &nbsp; EAX,EAX <br>
  015F:00442ACC&nbsp; POP&nbsp; &nbsp; &nbsp; EDX <br>
  015F:00442ACD&nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  015F:00442ACE&nbsp; POP&nbsp; &nbsp; &nbsp; ECX <br>
  015F:00442ACF&nbsp; MOV&nbsp; &nbsp; &nbsp; [FS:EAX],EDX <br>
  015F:00442AD2&nbsp; PUSH&nbsp; &nbsp; DWORD 00442AEC <br>
  015F:00442AD7&nbsp; LEA&nbsp; &nbsp; &nbsp; EAX,[EBP-08] <br>
  015F:00442ADA&nbsp; MOV&nbsp; &nbsp; &nbsp; EDX,02 <br>
  015F:00442ADF&nbsp; CALL&nbsp; &nbsp; 004037DC <br>
  015F:00442AE4&nbsp; RET&nbsp; &nbsp; <br>
  <br>
  至此，破解过程完成。有趣的是在该段call内，有一个call（具体哪个我忘了）是判断输 <br>
  入的code的第一个字母是数字异或是-、+、$、x、X、0等，若是则会有另一番判断过程。有兴 <br>
  趣的同志可以自己进去看看。下面是我用TC2写的注册机： <br>
  main() <br>
  {char a[10]; <br>
  int i,j,c;unsigned long k,b; <br>
  aa: printf("Please input your name:"); <br>
  gets(a); <br>
  i=strlen(a); k=i; <br>
  if (i&lt;6||i>10) <br>
  &nbsp; {printf("Length of your name must be in 6 and 10:\n"); <br>
  &nbsp; &nbsp; goto aa;} <br>
  for (j=0;j&lt;i-1;j++) <br>
  &nbsp; { b=a[j]; <br>
  &nbsp; &nbsp; c=a[j+1]; <br>
  &nbsp; &nbsp; b=b*c*(j+1); <br>
  &nbsp; &nbsp; k=k+b; } <br>
  printf("Your code is: %ld\n",k-666);} <br>
  <br>
  ===============&lt;完>================= </span></blockquote>
<hr>
</body>
</html>
