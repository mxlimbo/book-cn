<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Locating the Main Frame Window</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY>
<A NAME="285"><H1>Locating the Main Frame Window</H1></A>
<P>The toolbar and status bar objects you'll be working with are attached to the application's main frame window, not to the view window. How does your view find its main frame window? In an SDI application, you can use the <I>CWnd::GetParentFrame</I> function. Unfortunately, this function won't work in an MDI application because the view's parent frame is the MDI child frame, not the MDI frame window.
<P>If you want your view class to work in both SDI and MDI applications, you must find the main frame window through the application object. The <I>AfxGetApp</I> global function returns a pointer to the application object. You can use that pointer to get the <I>CWinApp</I> data member <I>m_pMainWnd</I>. In an MDI application, AppWizard generates code that sets <I>m_pMainWnd</I>, but in an SDI application, the framework sets 
<I>m_pMainWnd</I> during the view creation process. Once <I>m_pMainWnd</I> is set, you can use it in a view class to get the frame's toolbar with statements such as this:
<P><PRE>CMainFrame* pFrame = (CMainFrame*) AfxGetApp()-&gt;m_pMainWnd;
CToolBar* pToolBar = &amp;pFrame-&gt;m_wndToolBar;</PRE>
<P>
<DIV CLASS=note>
<BLOCKQUOTE>
<IMG SRC="note.jpg" width=123 height=18 BORDER=0><P>
You'll need to cast <I>m_pMainWnd</I> from <I>CFrameWnd*</I> to <I>CMainFrame*</I> because <I>m_wndToolBar</I> is a member of that derived class. You'll also have to make <I>m_wndToolBar</I> public or make your class a friend of <I>CMainFrame</I>.
</BLOCKQUOTE></DIV>
<P>You can use similar logic to locate menu objects, status bar objects, and dialog objects.
<P>
<DIV CLASS=note>
<BLOCKQUOTE>
<IMG SRC="note.jpg" width=123 height=18 BORDER=0><P>
In an SDI application, the value of <I>m_pMainWnd</I> is not set when the view's <I>OnCreate</I> message handler is called. If you need to access the main frame window in your <I>OnCreate</I> function, you must use the <I>GetParentFrame</I> function.
</BLOCKQUOTE></DIV>
<P>
</BODY>
</HTML>



