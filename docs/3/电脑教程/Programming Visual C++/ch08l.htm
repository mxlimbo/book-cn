<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Bindable Properties -- Change Notifications</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY>
<A NAME="190"><H1>Bindable Properties&#151;Change Notifications</H1></A>
<P>If an ActiveX control has a property designated as <U>bindable</U>, the control will send an <I>OnChanged</I> notification to its container when the value of the property changes inside the control. In addition, the control can send an <I>OnRequestEdit</I> notification for a property whose value is about to change but has not yet changed. If the container returns <I>FALSE</I> from its <I>OnRequestEdit</I> handler, the control should not change the property value.
<P>MFC fully supports property change notifications in ActiveX control 
containers, but as of Visual C++ version 6.0, no ClassWizard support was 
available. That means you must manually add entries to your container class's event sink map.
<P>Suppose you have an ActiveX control with a bindable property named Note with a dispatch ID of <I>4</I>. You add an <I>ON_PROPNOTIFY</I> macro to the <I>EVENTSINK</I> macros in this way:
<P><PRE>BEGIN_EVENTSINK_MAP(CAboutDlg, CDialog)
    //{{AFX_EVENTSINK_MAP(CAboutDlg)
    // ClassWizard places other event notification macros here
    //}}AFX_EVENTSINK_MAP
    ON_PROPNOTIFY(CAboutDlg, IDC_MYCTRL1, 4, OnNoteRequestEdit, OnNoteChanged)
END_EVENTSINK_MAP()</PRE>
<P>You must then code the <I>OnNoteRequestEdit</I> and <I>OnNoteChanged</I> functions with return types and parameter types exactly as shown here:
<P><PRE>BOOL CMyDlg::OnNoteRequestEdit(BOOL* pb)
{
    TRACE(&quot;CMyDlg::OnNoteRequestEdit\n&quot;);
    *pb = TRUE; // TRUE means change request granted
    return TRUE;
}

BOOL CMyDlg::OnNoteChanged() 
{
    TRACE(&quot;CMyDlg::OnNoteChanged\n&quot;);
    return TRUE;
}</PRE>
<P>You'll also need corresponding prototypes in the class header, as shown here:
<P><PRE>afx_msg BOOL OnNoteRequestEdit(BOOL* pb);
afx_msg BOOL OnNoteChanged();</PRE>
</BODY>
</HTML>



