<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Using DAO in ODBC Mode -- Snapshots and Dynasets</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY>
<A NAME="794"><H1><B>Using DAO in ODBC Mode&#151;Snapshots and Dynasets</B></H1></A>
<p>You've already heard that DAO goes far beyond ODBC, but let's take things one step at a time. We'll start with DAO snapshots and dynasets, which behave pretty much the same way in DAO as they do in ODBC. You can use snapshots and dynasets with ODBC data sources, ISAM-type files, and Access tables. You write programs using the MFC library classes <I>CDaoDatabase</I> and <I>CDaoRecordset</I>, which are very similar to the ODBC classes <I>CDatabase</I> and <I>CRecordset</I>. There are a few notable differences, however:

<UL>
<P><LI>The <I>CDaoRecordset::GetRecordCount</I> function works differently from the <I>CRecordset::GetRecordCount</I> function. For attached tables and ODBC data sources, <I>CDaoRecordset::GetRecordCount</I> always returns -1. For Access tables and ISAM-type files, it returns the number of records actually read, which is the final count for the recordset only if you have moved to the last record. Unfortunately, DAO has no equivalent for the ODBC <I>CRecordset::GetStatus</I> function, so you can't test a DAO recordset to find out whether the record count is indeed final.
<P><LI>With DAO, you can get and set the absolute position of the current record in a dynaset or a snapshot, you can get and set a percent position, you can find a record containing a matching string, and you can use <U>bookmarks</U> to mark records for later retrieval.
<P><LI>DAO makes it easy to get and set column values without binding. Because values are passed as <I>VARIANT</I>s, you can build dynamic applications that adjust to the database schema at runtime.
</UL>

<p>One important thing to remember about snapshot recordsets is that the record count <U>never</U> <U>changes</U>. With dynasets, the record count changes only if <U>you</U> delete or add records in the dynaset. If another user deletes a record, that record is marked as deleted in your dynaset; if another user adds a record, you don't see that record in your dynaset. If you add a record to a dynaset, that record is added at the end of the dynaset, regardless of the sort order.

</BODY>
</HTML>



