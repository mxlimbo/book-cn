<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Windows Applications and Drag and Drop -- Dobjview</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY>
<A NAME="578"><H1><B>Windows Applications and Drag and Drop&#151;Dobjview</B></H1></A>
<P>I tested EX26B with the Microsoft Office 97 suite. I tried both drag-and-drop and clipboard transfers, with the results shown in the following table.

<p>
<table cellpadding=5 width="95%">
<tr><td valign="top"><b>EX26B</b></td>
<td valign="top"><b>Word</b></td>
<td valign="top"><b>Excel</b></td>
<td valign="top"><b>PowerPoint</b></td></tr>
<tr><td valign="top">Sends clipboard data to</td>
<td valign="top">x</td>
<td valign="top">x (no palettes)</td>
<td valign="top">x</td></tr>
<tr><td valign="top">Accepts clipboard data from</td>
<td valign="top"></td>
<td valign="top"></td>
<td valign="top"></td></tr>
<tr><td valign="top">Sends drag-drop data to</td>
<td valign="top">x</td>
<td valign="top"></td>
<td valign="top">x</td></tr>
<tr><td valign="top">Accepts drag-drop data from</td>
<td valign="top"></td>
<td valign="top"></td>
<td valign="top"></td></tr>
</table>

<P>When I started to investigate why these programs were so uncooperative, I discovered a useful OLE utility called Dobjview (<I>IDataObject</I> viewer). I could use Dobjview to examine a data object on the clipboard, and I could drag objects to the Dobjview window. Here's what I got when I dragged a picture from Microsoft Excel.

<P><A HREF="javascript:fullSize('g26og01x.htm')"> <img src="g26og01.jpg" width=404 height=72 border=0 ALT = "Click to view at full size."> </A>

<P>No <I>CF_DIB</I> format is present. If you want pictures from Excel, you must enhance EX26B to process metafiles. Another alternative is to rewrite the program with compound document support as described in <A HREF="ch28a.htm">Chapter 28</A>. The OLE libraries contain code to display bitmaps and metafiles.

</BODY>
</HTML>



