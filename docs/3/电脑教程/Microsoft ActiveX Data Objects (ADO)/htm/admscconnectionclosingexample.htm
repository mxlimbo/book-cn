<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>关闭连接范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="admscconnectionclosingexample"></a>关闭连接范例 </h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="admscConnectionClosingExample_C">
</object></p>
<p>
把 <a href="adproactiveconnection.htm">ActiveConnection</a> 属性设置为 <b>Nothing </b>将“关闭”目录。关联的集合将被置空。目录中任何通过模式对象创建的对象都将被孤立。这些已缓存对象的任何属性依然可用，但读取属性时如果该属性需要调用提供者，则此操作将会失败。</p>
<pre>Sub CloseConnectionByNothing()

   Dim cnn As New Connection
   Dim cat As New Catalog
   Dim tbl As Table

   cnn.Open "Provider=Microsoft.Jet.OLEDB.4.0;" &amp; _
      "Data Source= c:\Program Files\Microsoft Office\" &amp; _
      "Office\Samples\Northwind.mdb;"
   Set cat.ActiveConnection = cnn
   Set tbl = cat.Tables(0)
   Debug.Print tbl.Type&nbsp;&nbsp;&nbsp; ' 缓存 tbl.Type 信息
   Set cat.ActiveConnection = Nothing
   Debug.Print tbl.Type&nbsp;&nbsp;&nbsp; ' tbl 被孤立
   ' 如果它被缓存，前面的行将成功
   Debug.Print tbl.Columns(0).DefinedSize
   ' 如果该信息未被缓存，前面的行将失败

End Sub
</pre>
<p>
关闭用于“打开”目录的 <b>Connection </b>对象，与将 <b>ActiveConnection </b>属性设置为 <b>Nothing </b>效果相同。</p>
<pre>Sub CloseConnection()

   Dim cnn As New Connection
   Dim cat As New Catalog
   Dim tbl As Table

   cnn.Open "Provider=Microsoft.Jet.OLEDB.4.0;" &amp; _
      "Data Source= c:\Program Files\Microsoft Office\" &amp; _
      "Office\Samples\Northwind.mdb;"
   Set cat.ActiveConnection = cnn
   Set tbl = cat.Tables(0)
   Debug.Print tbl.Type&nbsp;&nbsp;&nbsp; ' 缓存 tbl.Type 信息
   cnn.Close
   Debug.Print tbl.Type&nbsp;&nbsp;&nbsp; ' tbl 被孤立
   ' 如果它被缓存，前面的行将成功
   Debug.Print tbl.Columns(0).DefinedSize
   ' 如果该信息未被缓存，前面的行将失败

End Sub
</pre>
</BODY>
</HTML>
