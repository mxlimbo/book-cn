<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Recordset 对象</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdobjodbrec"></a>Recordset 对象</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjODBRec_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjODBRec_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:属性">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjODBRec_P">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:方法">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjODBRec_M">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:集合">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjODBRec_CO">
</object></p>
<p>
<b>Recordset</b> 对象表示的是来自基本表或命令执行结果的记录全集。任何时候，<b>Recordset</b> 对象所指的当前记录均为集合内的单个记录。</p>
<p>
<a href="mdobjconnection.htm"><img src="objconn.gif" border=0></a><br>
<img src="parchild.gif" border=0><img src="objrecor.gif" border=0><br>
<img src="space.gif" border=0><img src="parchild.gif" border=0><a href="mdcolfields.htm"><img src="colfield.gif" border=0></a></p>
<p class=label>
<b>说明</b></p>
<p>
可使用 <b>Recordset</b> 对象操作来自提供者的数据。使用 ADO 时，通过 <b>Recordset</b> 对象可对几乎所有数据进行操作。所有 <b>Recordset</b> 对象均使用记录（行）和字段（列）进行构造。由于提供者所支持的功能不同，某些 <b>Recordset</b> 方法或属性有可能无效。</p>
<p>
<b>ADOR.Recordset</b> 和 <b>ADODB.Recordset </b>是用来创建 <b>Recordset</b> 对象的 ProgID。由此产生的 <b>Recordset</b> 对象行为相同，与 ProgID 无关。<b>ADOR.Recordset </b>随 Microsoft&reg; Internet Explorer 安装，而 <b>ADODB.Recordset </b>则随 ADO 安装。<b>Recordset</b> 对象的行为受环境（即客户端、服务器、Internet Explorer 等）的影响。这些差异将在属性、方法和事件的“帮助”主题中加以说明。</p>
<p>
在 ADO 中定义了四种不同的游标类型：
<ul type=disc>
<li>
<B><b>动态游标 </b></B>— 用于查看其他用户所作的添加、更改和删除，并用于不依赖书签的 <b>Recordset</b> 中各种类型的移动。如果提供者支持，可使用书签。<br><br></li>
<li>
<B><b>键集游标 </b></B>— 其行为类似动态游标，不同的只是禁止查看其他用户添加的记录，并禁止访问其他用户删除的记录，其他用户所作的数据更改将依然可见。它始终支持书签，因此允许 <b>Recordset</b> 中各种类型的移动。<br><br></li>
<li>
<B><b>静态游标 </b></B>— 提供记录集合的静态副本以查找数据或生成报告。它始终支持书签，因此允许 <b>Recordset </b>中各种类型的移动。其他用户所作的添加、更改或删除将不可见。这是打开客户端 (ADOR) <b>Recordset</b> 对象时唯一允许使用的游标类型。<br><br></li>
<li>
<B><b>仅向前游标 </b></B>— 除仅允许在记录中向前滚动之外，其行为类似静态游标。这样，当需要在 <b>Recordset</b> 中单程移动时就可提高性能。</li>
</ul>
<p>
在打开 <b>Recordset</b> 之前设置 <b>CursorType</b> 属性来选择游标类型，或使用 <a href="mdmthrstopen.htm">Open</a> 方法传递 <b>CursorType</b> 参数。部分提供者不支持所有游标类型。请检查提供者的文档。如果没有指定游标类型，ADO 将默认打开仅向前游标。</p>
<p>
如果 <a href="mdprocursorlocation.htm">CursorLocation</a> 属性被设置为 <b>adUseClient</b> 后打开 <b>Recordset</b>，则在返回的 <b>Recordset </b>对象中，<a href="mdobjfield.htm">Field</a> 对象的 <b>UnderlyingValue</b> 属性不可用。对部分提供者（例如 Microsoft ODBC Provider for OLE DB 连同 Microsoft SQL Server），可以通过使用 <b>Open</b> 方法传递连接字符串，根据以前定义的 <a href="mdobjconnection.htm">Connection</a> 对象独立地创建 <b>Recordset</b> 对象。ADO 仍然创建 <b>Connection</b> 对象，但它不将该对象赋给对象变量。不过，如果正在相同的连接上打开多个 <b>Recordset</b> 对象，就应该显式创建和打开 <b>Connection</b> 对象，由此将 <b>Connection</b> 对象赋给对象变量。如果在打开 <b>Recordset</b> 对象时没有使用该对象变量，即使在传递相同连接字符串的情况下，ADO 也将为每个新的 <b>Recordset</b> 创建新的 <b>Connection</b> 对象。</p>
<p>
可以创建所需数量的 <b>Recordset</b> 对象。</p>
<p>
打开 <b>Recordset</b> 时，当前记录位于第一个记录（如果有），并且 <a href="mdprobof.htm">BOF</a> 和 <a href="mdprobof.htm">EOF</a> 属性被设置为 <b>False</b>。如果没有记录，<b>BOF</b> 和 <b>EOF</b> 属性设置是 <b>True</b>。</p>
<p>
假设提供者支持相关的功能，可以使用 <b>MoveFirst</b>、<b>MoveLast</b>、<b>MoveNext </b>和 <b>MovePrevious</b> 方法以及 <b>Move </b>方法，和 <b>AbsolutePosition</b>、<b>AbsolutePage</b> 和 <b>Filter</b> 属性来重新确定当前记录的位置。仅向前 <b>Recordset</b> 对象只支持 <b>MoveNext</b> 方法。当使用 <b>Move</b> 方法访问每个记录（或枚举 <b>Recordset</b>）时，可使用 <b>BOF</b> 和 <b>EOF</b> 属性查看是否移动已经超过了 <b>Recordset</b> 的开始或结尾。</p>
<p>
<b>Recordset</b> 对象可支持两类更新：立即更新和批更新。使用立即更新，一旦调用 <b>Update</b> 方法，对数据的所有更改将被立即写入基本数据源。也可以使用 <b>AddNew</b> 和 <b>Update</b> 方法将值的数组作为参数传递，同时更新记录的若干字段。</p>
<p>
如果提供者支持批更新，可以使提供者将多个记录的更改存入缓存，然后使用 <b>UpdateBatch</b> 方法在单个调用中将它们传送给数据库。这种情况应用于使用 <b>AddNew</b>、<b>Update </b>和 <b>Delete</b> 方法所做的更改。调用 <b>UpdateBatch</b> 方法后，可以使用 <b>Status</b> 属性检查任何数据冲突并加以解决。</p>
<p class=indent>
<B><b>注意</b></B>&nbsp;&nbsp;&nbsp;要执行不使用 <b>Command</b> 对象的查询，应将查询字符串传递给 <b>Recordset</b> 对象的 <b>Open</b> 方法。但是，在想要保持命令文本并重复执行或使用查询参数时，仍然需要 <b>Command</b> 对象。</p>
<h2></h2>
<h2></h2>
</BODY>
</HTML>
