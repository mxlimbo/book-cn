<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>使 DLL 能够在 DCOM 上运行</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdhowdllmts"></a>使 DLL 能够在 DCOM 上运行</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowDLLmts_C">
</object></p>
<p>
以下步骤概述如何通过 Microsoft&reg; <a href="mddefmicrosofttransactionserver.htm">Transaction Server</a> 使<a href="mddefbusinessobject.htm">业务对象</a> <a href="mddefdll.htm">.dll</a> 能够同时使用 DCOM 以及 Microsoft&reg; Internet Information Server(HTTP)。
<ol>
<li>
在 Transaction Server Explorer 中创建新的软件包。<p class=tl>
可以使用 Transaction Server Explorer 创建软件包并将 DLL 加入其中。这样通过 DCOM 便可以访问 .dll，但将无法通过 IIS 对其访问。（如果在注册表中检查 .dll，则 <b>Inproc</b> 键现在为空；请设置 Activation 属性（我们在稍后给出相应的解释），并在 <b>Inproc</b> 键中添加值。)</P></li>
<li>
将业务对象安装到软件包中。<p class=tl>
-或者-</P><p class=tl>
将 <b>RDSServer.DataFactory </b>对象导入软件包。</P></li>
<li>
将组件的 Activation 属性设置为“在创建者的进程中”。<p class=tl>
为确保可通过同一台计算机上的 DCOM 和 IIS 访问 .dll，必须在 Microsoft Transaction Server Explorer 中设置组件的 Activation 属性。将属性设置为“在创建者的进程中” 之后，会发现注册表中的 <b>Inproc</b> 服务器键已被添加，并指向 Microsoft Transaction Server 替代 .dll。</P></li>
</ol>
<p class=indent>
<b>另请参阅<B>&nbsp;&nbsp;&nbsp;</B></b>关于 Transaction Server 以及如何执行这些步骤的详细信息，请访问位于 http://www.microsoft.com/transaction/ 的 Transaction Server 站点或参考 Microsoft Transaction Server 文档。</p>
</BODY>
</HTML>
