<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>数据构形</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1>&nbsp;<a name="mdmschierarchicalcursorsdatashaping"></a>数据构形</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscHierarchicalCursorsDataShaping_C">
</object></p>
<p>
ADO 使您能够回答其答案可表示为 <b>Recordset </b>的提问。例如，假设您要公司客户的列表，而您有包含名为 Customers 的表的数据库。对表发出查询命令，则 ADO 将返回 <b>Recordset</b>，在 <b>Recordset</b> 中每个行表示一个客户，并且每个行的列拥有能够包含客户的名称、地址、客户 ID 等内容的数据类型。</p>
<p>
“数据构形”使您能够回答其答案可由成形的 <b>Recordset</b> 表示的提问。数据构形定义成形 <b>Recordset </b>的列、由列表示条目之间的关系和数据充填到 <b>Recordset</b> 的方式。</p>
<p>
成形 <b>Recordset</b> 的列可以包含来自数据提供者（如 SQL Server）的数据、对另一个 <b>Recordset</b> 的引用、对 <b>Recordset</b> 一个行进行计算得到的值、对整个 <b>Recordset</b> 的列进行操作所得到的值，或者可以是新虚构的空列。</p>
<p>
在检索包含对另一个 <b>Recordset</b> 的引用的列的值时，ADO 将自动返回由引用表示的实际的 <b>Recordset</b>。包含另一个<b> Recordset</b> 的 <b>Recordset</b> 称为“分级<i> </i>Recordset”或“分级游标”。</p>
<p>
例如，假定您要得到由公司每个客户发出的所有定单的列表。可对包含名为 Customers 和 Orders 的数据库表发出数据构形命令。如同上例一样，ADO 将返回客户记录 <b>Recordset</b>。但是，每行将同时有附加的列，该列引用包含所有该客户定单的 <b>Recordset</b>。</p>
<p>
改进该形状即可获得按州排列的销售总计的列表。在 Customers 表中的地址列包含每个客户的州，而 Orders 表的数量列则包含每个定单的数量。发出不同的数据构形命令，则 ADO 将返回 <b>Recordset</b>，该 <b>Recordset</b> 包含每个州一个行（在此，每个行包含标识州的列）、该州所有定单的销售量总计和对开列该州的所有客户的 <b>Recordset</b> 的引用。访问该客户 <b>Recordset </b>将会发现与前面的范例一样，每个客户行均含有对包含所有该客户定单的 <b>Recordset</b> 的引用。</p>
<p>
Shape 命令语法使您能够通过编程创建成形的 <b>Recordset</b>。然后就可以通过编程或适当的可视化控件，访问 <b>Recordset </b>的组件。</p>
<p>
有关数据构形的详细信息，请参阅如下主题：
<ul type=disc>
<li>
<a href="mdmschierarchicalcursorsdatashapingdetail.htm">数据构形总结</a><br><br></li>
<li>
<a href="mdmscrequiredprovidersfordatashaping.htm">数据构形所需的提供者</a><br><br></li>
<li>
<a href="mdmscshapecommandsingeneral.htm">常规 Shape 命令</a><br><br></li>
<li>
<a href="mdmscshapeappendcommand.htm">Shape Append 命令</a><br><br></li>
<li>
<a href="mdmscshapecomputecommand.htm">Shape Compute 命令</a><br><br></li>
<li>
<a href="mdmscaccessingrowsinhierarchicalrecordset.htm">访问分级 Recordset 中的行</a><br><br></li>
<li>
<a href="mdmscformalshapegrammar.htm">形状语法格式</a></li>
</ul>
</BODY>
</HTML>
