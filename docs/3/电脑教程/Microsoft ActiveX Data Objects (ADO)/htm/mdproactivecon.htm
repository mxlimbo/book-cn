<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>ActiveConnection 属性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdproactivecon"></a>ActiveConnection 属性</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproActiveCon_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproActiveCon_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproActiveCon_A">
</object></p>
<p>
指示指定的 <a href="mdobjcommand.htm">Command</a> 或 <a href="mdobjodbrec.htm">Recordset</a> 对象当前所属的 <a href="mdobjconnection.htm">Connection</a> 对象。</p>
<p class=label>
<b>设置和返回值</b></p>
<p>
设置或返回包含了定义连接或 <b>Connection</b> 对象的字符串。默认情况下为 <b>Null</b> 对象引用。</p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>ActiveConnection</b> 属性可确定在其上将执行指定 <b>Command</b> 对象或打开指定 <b>Recordset</b> 的 <b>Connection</b> 对象。</p>
<p class=label>
<b>命令</b></p>
<p>
对于 <b>Command</b> 对象，<b>ActiveConnection</b> 属性为读/写。</p>
<p>
在将该属性设置为打开的 <b>Connection</b> 对象或有效连接字符串之前，试图调用 <b>Command</b> 对象的 <a href="mdmthcmdexecute.htm">Execute</a> 方法将产生错误。</p>
<p class=indent>
<B><b>Microsoft Visual Basic</b></B>&nbsp;&nbsp;&nbsp;将 <b>ActiveConnection</b> 属性设置为 <b>Nothing</b> 可使 <b>Command</b> 对象与当前 <b>Connection</b> 脱离关联，并使提供者释放数据源上所有关联的资源。然后，可以使 <b>Command</b> 对象与相同的 <b>Connection</b> 对象或其他 <b>Connection</b> 对象关联。某些提供者允许将该属性设置从一个 <b>Connection</b> 更改到另一个 <b>Connection</b>，而不必首先将该属性设置为 <b>Nothing</b>。</p>
<p class=indent>
如果 <b>Command</b> 对象的 <a href="mdcolparameters.htm">Parameter</a> 集合包含提供者提供的参数，那么假如将 <b>ActiveConnection</b> 属性设置为 Nothing 或设置为其他 <b>Connection</b> 对象，将清除集合。如果手工创建 <a href="mdobjparameter.htm">Parameter</a> 对象并使用这些参数填充 <b>Command</b> 对象的 <b>Parameters</b> 集合，则将 <b>ActiveConnection</b> 属性设置为 Nothing 或其他 <b>Connection</b> 对象不会影响 <b>Parameters</b> 集合。</p>
<p class=indent>
关闭与 <b>Command</b> 对象相关联的 <b>Connection</b> 对象将把 <b>ActiveConnection</b> 属性设置为 <b>Nothing</b>。将该属性设置为已关闭的 <b>Connection</b> 对象将产生错误。</p>
<p class=label>
<b>Recordset</b></p>
<p>
对于打开的 <b>Recordset </b>对象或其 <a href="mdprorstsource.htm">Source</a> 属性被设置为有效 <b>Command</b> 对象的 <b>Recordset</b> 对象，<b>ActiveConnection</b> 属性为只读。否则，该属性为读/写。</p>
<p>
可以将该属性设置为有效的 <b>Connection</b> 对象，或设置为有效的连接字符串。这时，提供者可使用该定义创建新的 <b>Connection</b> 对象，并打开连接。另外，提供者可以将该属性设置为新的 <b>Connection</b> 对象，以便向您提供访问扩展错误信息的 <b>Connection</b> 对象或执行其他命令。</p>
<p>
如果使用 <a href="mdmthrstopen.htm">Open</a> 方法的 <b><i>ActiveConnection</i></b> 参数打开 <b>Recordset</b> 对象，<b>ActiveConnection</b> 属性将继承该参数的值。</p>
<p>
如果将 <b>Recordset </b>对象的 <b>Source </b>属性设置为有效 <b>Command </b>对象变量，<b>Recordset </b>的 <b>ActiveConnection</b> 属性将继承 <b>Command </b>对象的 <b>ActiveConnection</b> 属性的设置。</p>
<p class=indent>
<b>远程数据服务用法</b>&nbsp;&nbsp;&nbsp;在客户端 (ADOR) <b>Recordset</b> 对象上使用时，只能将该属性设置为连接字符串或（Microsoft Visual Basic 或 VBScript 中）<b>Nothing</b></p>
</BODY>
</HTML>
