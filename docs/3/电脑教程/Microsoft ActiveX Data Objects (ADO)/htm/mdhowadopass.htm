<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>使用 ADO 将 Recordset 对象传送到中间层</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h4><a name="mdhowadopass"></a>使用 ADO 将 Recordset 对象传送到中间层</h4>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowADOPass_C">
</object></p>
<p>
可以使用<b> ADOR.Recordset</b> 对象将 <a href="mddefrecordset.htm">Recordset</a> 对象从客户端 Web 页面<a href="mddefmarshal.htm">调度</a>到<a href="mddefmiddletier.htm">中间层业务对象</a>。例如，假定用户连接到虚拟购物中心并选定了要购买的物品。选定的物品将显示在虚拟购物车中，该购物车是用 <a href="mdobjdatacontrol.htm">RDS.DataControl</a> 对象实现的，并且缓存在行集合中。当客户单击购买按钮时，<b>ADOR.Recordset </b>对象将被创建并且作为对业务函数 (ApplyUpdates) 的输入参数传送到应用程序服务器。这将使<b> Recordset</b> 被调度到服务器。然后 ApplyUpdates 业务函数连接到 Sales 数据库并应用更新。</p>
<pre>' 客户端 Web 页面的代码。
Sub PurchaseItem_OnClick
   Set rst = ADC1.Recordset

' 以下选项通知记录集在更新时
' 仅返回已更改的记录。由此使得往返更轻松。
   rst.MarshalOptions = adMarshalModifiedOnly

' 调用 MyObj 业务对象的 ApplyUpdates<b> </b>功能
' 并将 ADOR.Recordset 对象作为输入参数传递。
   MyObj.ApplyUpdates rst

End Sub


' 业务对象中的 VB 代码
' ApplyUpdates 是中间层业务对象中的方法。
Sub ApplyUpdates(rst As ADOR.Recordset)

   rst.ActiveConnection =&nbsp; _
      "DSN=SalesDB;UID=SMgr;PWD=password"

' 保存更改记录。
   rst.UpdateBatch

End Sub 
</pre>
</BODY>
</HTML>
