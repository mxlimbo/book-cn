<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Microsoft OLE DB Remoting Provider</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdrefmsremote"></a>Microsoft OLE DB Remoting Provider</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdrefmsremote_C">
</object></p>
<p>
Microsoft OLE DB Remoting Provider 允许在客户端机器上的本地用户调用远程计算机上的数据提供者。如果您是远程计算机上的本地用户，可指定远程计算机的数据提供者参数。然后指定由远程数据提供者使用的参数来访问远程计算机。最终结果是使您象本地用户一样访问远程计算机。</p>
<p class=label>
<b>提供者关键字</b></p>
<p>
要调用 OLE DB Remoting Provider，请在连接字符串中指定如下的关键字和值。（注意提供者名称中的空格。）</p>
<pre>"Provider=<span class=cfe><b>MS Remote</b></span>"
</pre>
<p class=label>
<b>其他关键字</b></p>
<p>
当调用该服务提供者时，将涉及如下关键字。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=48%><b>关键字</b></td>
<td class=label width=52%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=48%><b>Data Source</b></td>
<td width=52%>指定远程数据源的名称。它将被传递到 OLE DB Remoting Provider 进行处理。<p>
该关键字等同于 <b>RDS.DataControl</b> 对象 <a href="mdproconnectprop.htm">Connect</a> 属性。</p>
</td>
</tr>
</table><br>
<p class=label>
<b>动态属性</b></p>
<p>
当调用该服务提供者时，会将如下动态属性添加到 <b>Connection </b>对象的 <b>Properties</b> 集合中。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=48%><b>动态属性名称</b></td>
<td class=label width=52%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=48%><b>DFMode</b></td>
<td width=52%>指示 DataFactory Mode。该字符串指定服务器上所需的 <b>DataFactory</b> 对象版本。在打开请求特定版本的 <b>DataFactory </b>的连接之前，请设置该属性。如果无法得到请求的版本，将尝试使用以前版本。如果没有以前版本，将出现错误。在连接之后，该属性是只读的。<p>
可以是下列有效字符串值：
<ul type=disc>
<li>
“21”—2.1 版（默认）<br><br></li>
<li>
“20”—2.0 版<br><br></li>
<li>
“15”—1.5 版</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=48%><b>Current DFMode</b></td>
<td width=52%>指示服务器上 <b>DataFactory </b>的实际版本号。检查该属性以便查看在 <b>DFMode</b> 属性中请求的版本是否可以得到。<p>
可以是如下可用的 Long 整数值中的一个：
<ul type=disc>
<li>
21—2.1 版（默认）<br><br></li>
<li>
20—2.0 版<br><br></li>
<li>
15—1.5 版</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=48%><b>Handler</b></td>
<td width=52%>字符串值。指示服务器端用于扩展 <b>RDSServer.DataFactory </b>函数的自定义程序（即处理程序）的名称，以及处理程序所使用的任意参数，各项使用逗号分隔(",")。</td>
</tr>
<tr valign=top>
<td width=48%><b>Internet Timeout</b></td>
<td width=52%>指示等待请求传输到服务器并返回所需的最长时间。（按毫秒计算，默认值是 5 分钟。）</td>
</tr>
<tr valign=top>
<td width=48%><b>Remote Provider</b></td>
<td width=52%>指示用于远程服务器的数据提供者的名称。 </td>
</tr>
<tr valign=top>
<td width=48%><b>Remote Server</b></td>
<td width=52%>指示要用于该连接的服务器名和通信协议。该属性等同于 <b>RDS.DataControl</b> 对象 <a href="mdproserverprop.htm">Server</a> 属性。</td>
</tr>
</table><br>
<p>
通过在连接字符串中将可写入动态属性的名称指定为关键字，也可以设置可写入动态属性。例如，通过以下指定将 <b>Internet Timeout</b> 动态属性设置为 5 秒钟：</p>
<pre>Dim cn as New ADODB.Connection
cn.Open "Provider=MS Remote;Internet Timeout=5000"
</pre>
<p>
通过将动态属性的名称指定为 <b>Properties</b> 属性的索引，也可设置或检索动态属性。例如，获得和打印 <b>Internet Timeout</b> 动态属性的当前值，然后设置新值，如：</p>
<pre>Debug.Print cn.Properties("Internet Timeout")
cn.Properties("Internet Timeout") = 5000
</pre>
<p class=label>
<b>说明</b></p>
<p>
在 ADO 2.0 中，OLE DB Remoting Provider 仅能在 <b>Recordset</b> 对象 <b>Open</b> 方法的 <b>ActiveConnection</b> 参数中指定。从 ADO 2.1 开始，也可以在 <b>Connection</b> 对象 <b>Open</b> 方法的 <b>ConnectionString</b> 参数中指定。</p>
<p>
没有<b> RDS.DataControl</b> 对象的 <b>SQL</b> 属性的等同设置。由 <b>Recordset</b> 对象 <b>Open</b> 方法 <b>Source</b> 参数代替。</p>
<p class=label>
<b>举例</b></p>
<p>
这个例子在称为 YourServer 的服务器上，执行对公用数据库创建者表的查询。在 <b>Connection</b> 对象的 <b>Open</b> 方法中提供远程数据源和远程服务器的名称，并在 <b>Recordset</b> 对象的 <b>Open</b> 方法中指定 SQL 查询。<b>Recordset</b> 对象将被返回、编辑、并用来更新数据源。</p>
<pre>Dim rs as New ADODB.Recordset
Dim cn as New ADODB.Connection
cn.Open    "<span class=cfe><b>Provider</b></span>=MS Remote;<span class=cfe><b>Data Source</b></span>=pubs;" &amp; _
         "<span class=cfe><b>Remote Server</b></span>=http://YourServer"
rs.<span class=cfe><b>Open</b></span> "SELECT * FROM authors", cn
...                        'Edit the recordset
rs.<span class=cfe><b>UpdateBatch</b></span>               'Equivalent of RDS <span class=cfe><b>SubmitChanges</b></span>
...</pre>
</BODY>
</HTML>
