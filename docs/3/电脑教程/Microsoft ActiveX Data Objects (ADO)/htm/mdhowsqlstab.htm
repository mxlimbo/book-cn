<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>连接缓冲池的性能和稳定性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h4><a name="mdhowsqlstab"></a>连接缓冲池的性能和稳定性</h4>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowSQLstab_C">
</object></p>
<p>
要确保连接缓冲池的稳定性并且提供其他的性能，必须配置 Microsoft SQL 服务器以便使用 TCP/IP 套接字网络库。</p>
<p>
为此，需要：
<ul type=disc>
<li>
<a href="#mdhowsqlconfig">配置 SQL 服务器计算机以便使用 TCP/IP 套接字。</a><br><br></li>
<li>
<a href="#mdhowwebconfig">配置 Web 服务器以便使用 TCP/IP 套接字。</a></li>
</ul>

<h4><a name="mdhowsqlconfig"></a>配置 SQL 服务器计算机以便使用 TCP/IP 套接字</h4>
<p>
在 SQL 服务器计算机上运行 SQL 服务器安装程序，以便在与数据源的交互操作中可以使用 TCP/IP 套接字网络库。</p>
<p class=label>
<b>在 SQL 服务器计算机上指定 TCP/IP 套接字网络库</b>
<ol>
<li>
从“开始”菜单，指向“程序”，再指向“Microsoft SQL Server 6.5”，然后单击“SQL 安装程序”。<br><br></li>
<li>
双击“继续”，屏幕上将出现“Microsoft SQL Server 6.5 — 选项”对话框。<br><br></li>
<li>
选择“更改网络支持”，然后单击“继续”。<br><br></li>
<li>
确认“TCP/IP 套接字”复选框被选中，然后单击“确定”。<br><br></li>
<li>
单击“继续”以完成指定过程，然后退出安装程序。 </li>
</ol>

<h4><a name="mdhowwebconfig"></a>配置 Web 服务器以便使用 TCP/IP 套接字</h4>
<p>
有两个选项用于配置 Web 服务器以使用 TCP/IP 套接字。用户的行为取决于是从 Web 服务器访问所有 SQL 服务器，还是从 Web 服务器访问特定的 SQL 服务器。</p>
<p>
如果从 Web 服务器访问所有 SQL 服务器，那么需要在 Web 服务器计算机上运行 SQL 服务器客户端配置实用程序。下列步骤将所有通过该 IIS Web 服务器创建 SQL 服务器连接所用的默认网络库更改为使用 TCP/IP 套接字网络库。</p>
<p class=label>
<b>配置 Web 服务器（所有 SQL 服务器） </b>
<ol>
<li>
从“开始”菜单，指向“程序”，再指向“Microsoft SQL Server 6.5”，然后单击“SQL 客户端配置实用程序”。<br><br></li>
<li>
选择“网络库”选项卡。<br><br></li>
<li>
在“默认网络”框中，选择“TCP/IP 套接字”。<br><br></li>
<li>
单击“完成”保存更改并退出实用程序。 </li>
</ol>
<p>
如果从 Web 服务器访问特定的 SQL 服务器，则需要在 Web 服务器计算机上运行 SQL 服务器客户端配置实用程序。要更改特定 SQL 服务器连接的网络库，请在 Web 服务器计算机上按如下步骤配置 SQL 服务器客户端软件。</p>
<p class=label>
<b>配置 Web 服务器（特定的 SQL 服务器） </b>
<ol>
<li>
从“开始”菜单，指向“程序”，再指向“Microsoft SQL Server 6.5”，然后单击“SQL 客户端配置实用程序”。<br><br></li>
<li>
选择“高级”选项卡。<br><br></li>
<li>
在“服务器”框中，键入为使用 TCP/IP 套接字而连接的服务器名称。<br><br></li>
<li>
在“DLL 名称”框中，选择“TCP/IP 套接字”。<br><br></li>
<li>
单击“添加/修改”。现在所有指向该服务器的数据源都将使用 TCP/IP 套接字。<br><br></li>
<li>
单击“完成”。 </li>
</ol>
</BODY>
</HTML>
