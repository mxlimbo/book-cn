<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>步骤 2: 调用服务器程序（RDS 教程）</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdhowstep2invokeserverprogram"></a>步骤 2: 调用服务器程序（RDS 教程）</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowStep2InvokeServerProgram_C">
</object></p>
<p>
<b>您所在的步骤... </b>
<ul type=disc>
<li>
指定在服务器上调用的程序，并获得代理。<br><br></li>
<li>
<b>调用服务器程序，将参数传递给表明数据源和所发命令的服务器程序。</b><br><br></li>
<li>
典型情况下通过使用 ADO，服务器程序从数据源获得 <b>Recordset</b> 对象。<br><br></li>
<li>
服务器程序将最终的 <b>Recordset </b>对象返回客户端应用程序。<br><br></li>
<li>
在客户端，可选择将<b> Recordset </b>对象设置为可视控件易于使用的形式<b>。</b><br><br></li>
<li>
将对 <b>Recordset </b>对象的更改返回服务器，并用来更新数据源。</li>
</ul>
<p>
<b>讨论</b></p>
<p>
当调用客户端代理程序的方法时，服务器上的实际程序将执行该方法。在该步骤中，将在服务器上执行查询。</p>
<p>
<b>A 部分</b>&nbsp;&nbsp;&nbsp;在本教程中，如果不使用 <b>RDSServer.DataFactory</b>，那么执行该步骤最简便方法是使用 <b>RDS.DataControl</b> 对象。<b>RDS.DataControl</b> 将该步骤和上一步骤中的创建代理合并，用于发出查询。</p>
<p>
设置 <b>RDS.DataControl</b> 对象 <a href="mdproserverprop.htm">Server</a> 属性以标识服务器程序被实例化的位置；设置 <a href="mdproconnectprop.htm">Connect</a> 属性以指定访问数据源的连接字符串；设置 <a href="mdprosqlprop.htm">SQL</a> 属性以指定查询命令文本。然后发出 <a href="mdmthrdsrefresh.htm">Refresh</a> 方法使服务器程序与数据源相连接，检索查询指定的行，并将 <b>Recordset</b> 对象返回客户端。</p>
<p>
该教程不使用 <b>RDS.DataControl，</b>仅在这里给出它的形式：</p>
<pre>Sub RDSTutorial2A()
Dim DC as New RDS.DataControl
DC.<span class=cfe><b>Server</b></span> = "http://yourServer"
DC.<span class=cfe><b>Connect</b></span> = "DSN=pubs"
DC.<span class=cfe><b>SQL</b></span> = "SELECT * FROM authors"
DC.<span class=cfe><b>Refresh</b></span>
...
</pre>
<p>
本教程同样不使用 ADO 对象调 RDS，我们仍在这里给出它的形式：</p>
<pre>Dim rs as New ADODB.Recordset
rs.Open "SELECT * FROM authors", "<span class=cfe><b>Provider</b></span>=MS Remote;<span class=cfe><b>Data Source</b></span>=pubs;<span class=cfe><b>Remote Server</b></span>=http://YourServer"
</pre>
<p>
<b>B 部分</b>&nbsp;&nbsp;执行该步骤的一般方法是调用 <b>RDSServer.DataFactory</b> 对象的 <b>Query</b> 方法。该方法使用用于连接数据源的连接字符串，以及用于指定从数据源返回行的命令文本。</p>
<p>
该教程使用<b> RDSServer.DataFactory Query</b> 方法：</p>
<pre>Sub RDSTutorial2B()
Dim DS as New RDS.DataSpace
Dim DF
Dim RS as ADODB.Recordset
Set DF = DS.<span class=cfe><b>CreateObject</b></span>("RDSServer.DataFactory", "http://yourServer")
Set RS = DF.<span class=cfe><b>Query</b></span> ("DSN=pubs", "SELECT * FROM authors")
...
</pre>
<p>
<B><b>下一页</b></B>&nbsp;&nbsp;&nbsp;<a href="mdhowstep3serverobtainsrecordset.htm">步骤 3</a></p>
</BODY>
</HTML>
