<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Execute 方法 (ADO Command)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthcmdexecute"></a>Execute 方法 (ADO Command)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCmdExecute_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCmdExecute_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCmdExecute_A">
</object></p>
<p>
执行在 <a href="mdprocommandtext.htm">CommandText</a> 属性中指定的查询、SQL 语句或存储过程。</p>
<p class=label>
<b>语法</b></p>
<p>
对于按行返回的 <b>Command</b>：</p>
<p>
<b>Set</b> <i>recordset</i> = <i>command</i>.<b>Execute( <i>RecordsAffected</i></b>, <b><i>Parameters</i></b>, <b><i>Options </i>)</b></p>
<p>
对于非按行返回的 <b>Command</b>：</p>
<p>
<i>command</i>.<b>Execute</b> <b><i>RecordsAffected</i></b>, <b><i>Parameters</i></b>, <b><i>Options</i></b></p>
<p class=label>
<b>返回值</b></p>
<p>
返回 <b>Recordset</b> 对象引用。</p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>RecordsAffected&nbsp;&nbsp;&nbsp;</i></b>可选，<b>长整型</b>变量，提供者向其返回操作所影响的记录数目。<b><i>RecordsAffected</i></b> 参数仅应用于操作查询或存储过程。<b><i>RecordsAffected</i></b> 不返回由返回结果的查询或存储过程所返回的记录数目。详细信息，请使用 <a href="mdprorecordcount.htm">RecordCount</a> 属性。</p>
<p>
<b><i>Parameters&nbsp;&nbsp;&nbsp;</i></b>可选，<b>变体型</b>数组，使用 SQL 语句传送的参数值。（用该参数传送时输出参数将不返回正确值。）</p>
<p>
<b><i>Options&nbsp;&nbsp;&nbsp;</i></b>可选，<b>长整型</b>值，指示提供者如何计算 <b>Command</b> 对象的 <a href="mdprocommandtext.htm">CommandText</a> 属性。该值可为下列常量之一：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>常量</b></td>
<td class=label width=67%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdText</b></td>
<td width=67%>指示提供者应按命令的文本定义（如 SQL 语句）来计算 <b>CommandText</b>。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdTable</b></td>
<td width=67%>指示 ADO 应生成 SQL 查询以便从 <b>CommandText</b> 命名的表中返回所有行。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdTableDirect</b></td>
<td width=67%>指示提供者应从 <b>CommandText</b> 命名的表中返回所有行。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdStoredProc</b></td>
<td width=67%>指示提供者应按存储过程计算 <b>CommandText</b>。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdUnknown</b></td>
<td width=67%>指示 <b>CommandText</b> 中的命令类型未知。</td>
</tr>
<tr valign=top>
<td width=33%><b>adAsyncExecute</b></td>
<td width=67%>指示命令应异步执行。</td>
</tr>
<tr valign=top>
<td width=33%><b>adAsyncFetch</b></td>
<td width=67%>指示对由 <b>CacheSize</b> 属性指定的初始数量之后的剩余行应使用异步提取。</td>
</tr>
</table><br>
<p>
本列表中前 4 个常量的详细说明请参见 <a href="mdprocommandtype.htm">CommandType</a> 属性。</p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>Command </b>对象的 <b>Execute </b>方法可执行在对象的 <b>CommandText </b>属性中指定的查询。如果 <b>CommandText </b>属性指定按行返回查询，执行所产生的任何结果都将存储在新的 <b>Recordset </b>对象中。如果该命令不是按行返回查询，则提供者返回关闭的 <b>Recordset </b>对象。某些应用程序语言允许忽略该返回值（如果不需要任何 <b>Recordset</b>）。</p>
<p>
如果查询带有参数，将使用 <b>Command </b>对象中参数的当前值，除非通过 <b>Execute </b>调用传送的参数覆盖它们。可以在调用 <b>Execute </b>方法时通过省略某些参数的新值来覆盖参数子集。指定参数的次序与其在方法中被传送的次序相同。例如，如果有 4 个（或更多）参数并且希望只为第一个和第四个参数传送新值，则可以将 Array(var1,,,var4) 作为 <b>Parameters </b>参数传送。</p>
<p class=indent>
<B><b>注意&nbsp;&nbsp;&nbsp;</b></B> 在<b> Parameters</b><i> </i>参数中传送时输出参数将不返回正确的值。</p>
<p>
该操作结束后将发出 <b>ExecuteComplete</b> 事件。</p>
</BODY>
</HTML>
