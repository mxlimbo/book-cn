<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Update 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthupdate"></a>Update 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthUpdate_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthUpdate_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthUpdate_A">
</object></p>
<p>
保存对 <a href="mdobjodbrec.htm">Recordset</a> 对象的当前记录所做的所有更改。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset</i><b>.Update</b> <b><i>Fields</i>,</b> <b><i>Values</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>Fields&nbsp;&nbsp;&nbsp;</i></b>可选。<b>变体型</b>，代表单个名称；或<b>变体型</b>数组，代表需要修改的字段（一个或多个）名称及序号位置。</p>
<p>
<b><i>Values&nbsp;&nbsp;&nbsp;</i></b>可选。<b>变体型</b>，代表单个值；或<b>变体型</b>数组，代表新记录中字段（单个或多个）值。</p>
<p class=label>
<b>说明</b></p>
<p>
使用<b> Update</b> 方法保存自调用 <a href="mdmthaddnew.htm">AddNew</a> 方法或更改现有记录中任何字段值以来所作的所有更改。<b>Recordset</b> 对象必须支持更新。</p>
<p>
要设置字段值，请进行下列某项操作：
<ul type=disc>
<li>
为 <a href="mdobjfield.htm">Field</a> 对象的 <a href="mdprovalue.htm">Value</a> 属性赋值，并调用 <b>Update</b> 方法。<br><br></li>
<li>
在<b> Update</b> 调用中传送字段名和值作为参数。<br><br></li>
<li>
在 <b>Update </b>调用中传送字段名数组和值数组。</li>
</ul>
<p>
在使用字段和值的数组时，两个数组中必须有相等数量的元素，同时字段名的次序必须匹配字段值的次序。字段和值的数量及次序不匹配将产生错误。</p>
<p>
如果 <b>Recordset</b> 对象支持批更新，那么可以在调用 <a href="mdmthupdatebatch.htm">UpdateBatch</a> 方法之前将一个或多个记录的多个改动缓存在本地。如果在调用<b> UpdateBatch</b> 对象时正在编辑当前记录或者添加新的记录，那么 ADO 将自动调用 <b>Update</b> 方法以便在将批更改传送到提供者之前保存挂起的更改。</p>
<p>
如果在调用<b> Update</b> 方法之前移动出正在添加或编辑的记录，那么 ADO 将自动调用 <b>Update</b> 以便保存更改。如果希望取消对当前记录所做的任何更改或者放弃新添加的记录，则必须调用 <a href="mdmthrdscanupd.htm">CancelUpdate</a> 方法。</p>
<p>
在调用<b> Update </b>方法后当前记录仍为当前记录。</p>
<p>
如果设置了 <a href="mdprodynuniquetable.htm">Unique Table</a> 动态属性，并且 <b>Recordset </b>是对多个表执行 JOIN 操作的结果，那么，<b>Update</b> 方法将无法更新多个表的任何主要关键字。此外，<b>Update</b> 只能更新在 <b>Unique Table</b> 属性中指定的表中的字段。</p>
</BODY>
</HTML>
