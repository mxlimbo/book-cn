<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>CancelBatch 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthcancelbatch"></a>CancelBatch 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCancelBatch_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCancelBatch_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCancelBatch_A">
</object></p>
<p>
取消挂起的批更新。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset</i>.<b>CancelBatch</b> <b><i>AffectRecords</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>AffectRecords&nbsp;&nbsp;&nbsp;</i></b> 可选的 <b>AffectEnum</b> 值，决定<b> CancelBatch</b> 方法所影响记录的数目，可为下列常量之一：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>常量</b></td>
<td class=label width=75%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=25%><b>AdAffectCurrent</b></td>
<td width=75%>仅取消当前记录的挂起更新。</td>
</tr>
<tr valign=top>
<td width=25%><b>AdAffectGroup</b></td>
<td width=75%>对满足当前 <a href="mdprofilter.htm">Filter</a> 属性设置的记录取消挂起更新。使用该选项时，必须将 <b>Filter </b>属性设置为合法的预定义常量之一。</td>
</tr>
<tr valign=top>
<td width=25%><b>AdAffectAll</b></td>
<td width=75%>默认值。取消<b> Recordset</b> 对象中所有记录的挂起更新，包括由当前 <b>Filter </b>属性设置所隐藏的任何记录。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
使用<b> CancelBatch</b> 方法可取消批更新模式下记录集中所有挂起的更新。如果记录集处于立即更新模式，调用不带<b> adAffectCurrent</b> 的<b> CancelBatch</b> 将产生错误。</p>
<p>
如果调用<b> CancelBatch</b> 时正在编辑当前记录或添加新记录，则 ADO 首先调用 <a href="mdmthcancelupdate.htm">CancelUpdate</a> 方法取消所有已被缓存的修改，然后取消记录集中挂起的所有更改。</p>
<p>
有可能在<b> CancelBatch</b> 调用后，特别是在添加新记录时无法确定当前记录。为此，在<b> CancelBatch</b> 调用后将当前记录位置设置为记录集中的已知位置是明智的。例如可调用 <a href="mdmthmovefirst.htm">MoveFirst</a> 方法。</p>
<p>
如果由于与基本数据冲突（如记录已被其他用户删除）而导致取消挂起更新失败，则提供者将向 <a href="mdcolerrors.htm">Errors</a> 集合返回警告，但不终止程序的执行。只有当所有请求的记录都发生冲突时才发生运行时错误。使用 <b>Filter</b> 属性 (<b>adFilterAffectedRecords</b>) 和 <a href="mdprostatus.htm">Status</a> 属性可以对冲突记录进行定位。</p>
</BODY>
</HTML>
