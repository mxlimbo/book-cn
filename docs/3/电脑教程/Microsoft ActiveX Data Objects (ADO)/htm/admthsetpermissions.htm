<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>(Untitled)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="admthsetpermissions"></a>SetPermissions 方法</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="admthSetPermissions_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="admthSetPermissions_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="admthSetPermissions_A">
</object></p>
<p>
设置对象上组或用户的权限。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>GroupOrUser</i><b>.SetPermissions </b><i>Name</i><b>,</b> <i>ObjectType</i><b>,</b> <i>Action</i><b>,</b> <i>Rights </i>[<b>,</b> <i>Inherit</i>]<i> <br>
&nbsp;&nbsp;&nbsp;</i>[<b>,</b> <i>ObjectTypeId</i>]</p>
<p class=label>
<b>参数</b></p>
<p>
<i>Name&nbsp;&nbsp;&nbsp;</i>字符串值。指定需设置其权限的对象的名称。</p>
<p>
<i>ObjectType&nbsp;&nbsp;&nbsp;</i>长整型值。指定需得到其权限的对象的类型。下列常量是 <i>ObjectType </i>的有效值：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>常量</b></td>
<td class=label width=62%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjProviderSpecific</b></td>
<td width=62%>对象是提供者定义的类型。如果 <i>ObjectType </i>是 <b>adPermObjProviderSpecific，</b>并且未提供<i>ObjectTypeId</i>，将出现错误。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjTable</b></td>
<td width=62%>对象是表。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjColumn</b></td>
<td width=62%>对象是列。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjDatabase</b></td>
<td width=62%>对象是数据库。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjProcedure</b></td>
<td width=62%>对象是过程。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjView</b></td>
<td width=62%>对象是视图。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjSchema</b></td>
<td width=62%>对象是模式。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjDomain</b></td>
<td width=62%>对象是域。</td>
</tr>
<tr valign=top>
<td width=38%><b>AdPermObjCollation</b></td>
<td width=62%>对象是序列。</td>
</tr>
<tr valign=top>
<td width=38%><b>AdPermObjSchemaRowset</b></td>
<td width=62%>对象是模式行集合。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjCharacterSet</b></td>
<td width=62%>对象是字符集。</td>
</tr>
<tr valign=top>
<td width=38%><b>adPermObjTranslation</b></td>
<td width=62%>对象是转换。</td>
</tr>
</table><br>
<p>
<i>Action&nbsp;&nbsp;&nbsp;</i>长整型值。指定设置权限时所执行的操作。下列常量是 <i>Action </i>的有效值：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>常量</b></td>
<td class=label width=62%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=38%><b>adAccessGrant</b></td>
<td width=62%>组或用户将至少拥有所请求的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adAccessSet</b></td>
<td width=62%>组或用户恰好具有所请求的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adAccessDeny</b></td>
<td width=62%>组或用户被拒绝所指定的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adAccessRevoke</b></td>
<td width=62%>组或用户具有的任何显式访问权限将被撤消。</td>
</tr>
<tr valign=top>
<td width=38%><b>adAccessAuditSuccess</b></td>
<td width=62%>当成功打开使用所请求的权限的对象时，将对组进行审核。</td>
</tr>
<tr valign=top>
<td width=38%><b>AdAccessAuditFailure</b></td>
<td width=62%>当未能打开使用所请求的权限的对象时，将对组进行审核。</td>
</tr>
</table><br>
<p>
<i>Rights&nbsp;&nbsp;&nbsp;</i>长整型值。包含指示要设置的权限的位掩码。值可以组合。下列常量是 <i>Rights</i> 的有效值：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>常量</b></td>
<td class=label width=62%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=38%><b>adRightExecute</b></td>
<td width=62%>组具有执行对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightRead</b></td>
<td width=62%>组具有读取对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightUpdate</b></td>
<td width=62%>组具有更新对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightInsert</b></td>
<td width=62%>组具有插入对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightDelete</b></td>
<td width=62%>组具有删除对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightReference</b></td>
<td width=62%>组具有引用对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightCreate</b></td>
<td width=62%>组具有创建对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightWithGrant</b></td>
<td width=62%>组具有授予对象上权限的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightDesign</b></td>
<td width=62%>组具有设计对象的权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adRightAll</b></td>
<td width=62%>组具有所有对象上的权限。</td>
</tr>
</table><br>
<p>
<i>Inherit&nbsp;&nbsp;&nbsp;</i>可选，枚举型值。指示对象如何继承这些权限。默认值为 <b>adInheritNone</b>。下列常量是 <i>Inherit </i>的有效值：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>常量</b></td>
<td class=label width=62%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=38%><b>adInheritNone</b></td>
<td width=62%>无继承。</td>
</tr>
<tr valign=top>
<td width=38%><b>adInheritObjects</b></td>
<td width=62%>容器中的无容器对象继承权限。</td>
</tr>
<tr valign=top>
<td width=38%><b>adInheritContainers</b></td>
<td width=62%>主对象包含的其它容器继承输入项。</td>
</tr>
<tr valign=top>
<td width=38%><b>adInheritBoth</b></td>
<td width=62%>主对象包含的对象和其它容器继承输入项。</td>
</tr>
<tr valign=top>
<td width=38%><b>adInheritNoPropagate</b></td>
<td width=62%><b>adInheritObjects </b>和 <b>adInheritContainers </b>标志不传递给继承输入项。</td>
</tr>
<tr valign=top>
<td width=38%><b>adInheritOnly</b></td>
<td width=62%>权限不应用于访问控制列表 (ACL) 与之相连的主对象，但主对象包含的对象继承输入项。</td>
</tr>
</table><br>
<p>
<i>ObjectTypeId&nbsp;&nbsp;&nbsp;</i>可选，变体型值。指定 OLE DB 规范未定义的提供者对象类型的 GUID。如果 <i>ObjectType </i>设置为 <b>adPermObjProviderSpecific</b>，则需要该参数；否则，将不使用它。</p>
<p class=label>
<b>说明</b></p>
<p>
如果提供者不支持为组或用户设置访问权限，将出现错误。</p>
</BODY>
</HTML>
