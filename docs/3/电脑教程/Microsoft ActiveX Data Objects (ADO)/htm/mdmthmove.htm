<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Move 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthmove"></a>Move 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthMove_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthMove_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthMove_A">
</object></p>
<p>
移动 <a href="mdobjodbrec.htm">Recordset</a> 对象中当前记录的位置。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset</i><b>.Move</b> <b><i>NumRecords</i>,</b> <b><i>Start</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>NumRecords&nbsp;&nbsp;&nbsp;</i></b> 带符号<b>长整型</b>表达式，指定当前记录位置移动的记录数。</p>
<p>
<b><i>Start&nbsp;&nbsp;&nbsp;</i></b> 可选，<b>字符串</b>或<b>变体型</b>，用于计算书签。也可为下列 <b>BookmarkEnum</b> 值之一：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>常量</b></td>
<td class=label width=67%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdBookmarkCurrent</b></td>
<td width=67%>默认。从当前记录开始。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdBookmarkFirst</b></td>
<td width=67%>从首记录开始。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdBookmarkLast</b></td>
<td width=67%>从尾记录开始。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
所有<b> Recordset</b> 对象都支持 <b>Move</b> 方法。</p>
<p>
如果 <b>NumRecords</b> 参数大于零，则当前记录位置将向前移动（向记录集的末尾）。如果 <b>NumRecords</b> 小于零，则当前记录位置向后移动（向记录集的开始）。</p>
<p>
如果 <b>Move</b> 调用将当前记录位置移动到首记录之前，则 ADO 将当前记录放置在记录集（<a href="mdprobof.htm">BOF</a> 为 <b>True</b>）的首记录之前。在<b> BOF</b> 属性已经为<b> True</b> 时试图向后移动将产生错误。</p>
<p>
如果 <b>Move</b> 调用将当前记录位置移动到尾记录之后，则 ADO 将当前记录放置在记录集（<a href="mdprobof.htm">EOF</a> 为 <b>True</b>）的尾记录之后。在<b> EOF</b> 属性已经为<b> True</b> 时试图向前移动将产生错误。</p>
<p>
从空的<b> Recordset</b> 对象调用 <b>Move</b> 方法将产生错误。</p>
<p>
如果传送<b> Start</b> 参数，则移动相对于该书签的记录（假定<b> Recordset</b> 对象支持书签）。如果没有指定，则移动相对于当前记录。</p>
<p>
如果使用 <a href="mdprocachesize.htm">CacheSize</a> 属性在本地缓存来自提供者的记录，则在传送将当前记录位置移动到当前缓存的记录组之外的 <b>NumRecords </b>参数时， ADO 将不得不从目标记录开始检索新的记录组。<b>CacheSize </b>属性决定新检索记录组的大小，而目标记录是检索到的第一个记录。</p>
<p>
如果 <b>Recordset </b>对象是仅向前的，则用户仍然可以传送小于零的 <b>NumRecords </b>参数（只要目标在已缓存记录的当前集合中）。如果 <b>Move </b>调用将当前记录位置移动到第一个已缓存记录的前一个记录，将产生错误。因此可使用记录缓存，它在支持仅向前滚动的提供者上支持完全滚动。由于缓存的记录将加载到内存，因此应避免不必要地缓存过多记录。即使仅向前 <b>Recordset </b>对象支持这种方式的向后移动，在任何仅向前的<b> Recordset</b> 对象上调用 <a href="mdmthmovefirst.htm">MovePrevious</a> 方法仍将产生错误。</p>
</BODY>
</HTML>
