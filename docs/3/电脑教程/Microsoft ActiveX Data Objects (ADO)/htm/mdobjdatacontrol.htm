<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>DataControl 对象 (RDS)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdobjdatacontrol"></a>DataControl 对象 (RDS)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjDataControl_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjDataControl_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:属性">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjDataControl_P">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:方法">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjDataControl_M">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:集合">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjDataControl_CO">
</object></p>
<p>
<b>RDS.DataControl</b> 对象将数据查询 <b>Recordset</b> 绑定到一个或多个控件上（例如，文本框、网格控件或组合框），以便在 Web 页显示 <b>ADOR.Recordset</b> 数据。</p>
<p class=label>
<b>语法</b></p>
<p>
<b>&lt;OBJECT CLASSID="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33" ID="</b><i>DataControl</i><b>"</b></p>
<p>
<b>&lt;PARAM NAME="Connect" VALUE="DSN=</b><i>DSNName</i>;<b>UID=</b><i>usr</i><b>;PWD=</b><i>pw</i><b>;"&gt;</b></p>
<p>
<b>&lt;PARAM NAME="Server" VALUE="http://</b><i>awebsrvr</i><b>"&gt;</b></p>
<p>
<b>&lt;PARAM NAME="SQL" VALUE="</b><i>QueryText</i><b>"&gt;</b></p>
<p>
<b>&lt;/OBJECT&gt;</b></p>
<p class=label>
<b>说明</b></p>
<p>
<b>RDS.DataControl</b> 对象的类 ID 是 BD96C556-65A3-11D0-983A-00C04FC29E33。</p>
<p>
对基本应用方案，仅需设置 <b>RDS.DataControl</b> 对象的 <b>SQL</b>、<b>Connect</b> 和 <b>Server</b> 属性，从而自动调用默认业务对象 <a href="mdobjdatafactory.htm">RDSServer.DataFactory</a>。</p>
<p>
<b>RDS.DataControl</b> 中所有的属性都是可选的，因为自定义<a href="mddefbusinessobject.htm">业务对象</a>可以替代它们的功能。</p>
<p>
使用一个<b> RDS.DataControl </b>对象可将单个查询结果链接到一个或多个可视控件。例如，假设您编写请求客户数据查询的代码，如姓名、住所、出生地、年龄及“优先级客户状态”，可使用单个 <b>RDS.DataControl </b>对象分别在三个文本框中显示客户姓名、年龄及居住区，并在复选框中显示“优先级客户状态”，而在网格控件中显示所有的数据。</p>
<p>
使用不同的 <b>RDS.DataControl </b>对象可将多个查询结果链接到不同的可视控件上。例如，假设您使用一个查询获取客户信息，又使用第二个查询获取客户所购买商品的信息。如果要在三个文本框和一个复选框中显示第一个查询的结果，在网格控件中显示第二个查询的结果，则在使用默认业务对象 (RDSServer.DataFactory) 时必须进行如下操作：
<ul type=disc>
<li>
将两个 <b>RDS.DataControl</b> 对象添加到 Web 页。<br><br></li>
<li>
针对两个 <b>RDS.DataControl</b> 对象的每个 <b>SQL</b> 属性，分别编写两个查询。一个 <b>RDS.DataControl </b>对象包含请求客户信息的 SQL 查询，而另一个则包含请求客户所买商品列表的查询。<br><br></li>
<li>
在每个绑定控件的 OBJECT 标记中，指定 DATAFLD 值以便设置将要显示在每个可视控件中的数据值。</li>
</ul>
<p>
对可通过 OBJECT 标记嵌入单个 Web 页的 <b>RDS.DataControl</b> 对象，不存在数目上的限制。</p>
<p>
在 Web 页上定义 <b>RDS.DataControl</b> 对象时，可使用非零 <b>Height</b> 和 <b>Width</b> 值，如 1（以避免包含多余空间）。</p>
<p>
远程数据服务客户端组件已经是 Internet Explorer 4.0 安装程序的一部分，因此， <b>RDS.DataControl </b>对象标记不必包含 CODEBASE 参数。</p>
<p class=label>
<b>已测试控件</b></p>
<p>
下表列出了与 <b>RDS.DataControl</b> 对象以及关联的<a href="mddefclienttier.htm">客户</a>端的组件一起使用并且已经过测试的<a href="mddefdataawarecontrol.htm">数据识别控件</a>。其他控件虽然也可与远程数据服务一起使用，但尚未经过测试。</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=21%><b>控件名</b></td>
<td class=label width=23%><b>文件名</b></td>
<td class=label width=56%><b>类 ID (CLSID)</b></td>
</tr>
<tr valign=top>
<td width=21%>SSDBGrid</td>
<td width=23%>SSDATB32.ocx (Sheridan)</td>
<td width=56%>AC05DC80-7DF1-11d0-839E-00A024A94B3A</td>
</tr>
</table><br>
<p>
使用 Internet Explorer 4.0，只有在 HTML 控件和 ActiveX&reg; 控件被标记为房间模型控件时，才可以使用这两种控件绑定到数据。</p>
<p>
以上所列控件不通过远程数据服务发布，但可以作为 Microsoft&reg; Visual Basic&reg;, Enterprise Edition 的一部分或从 Sheridan Systems, Inc. 购买。</p>
<p class=indent>
<b>重要事项</b>&nbsp;&nbsp;&nbsp; 不能重新分发以任何方式部署为远程数据服务范例组成部分的 ActiveX 控件。它们是作为范例应用程序的组成部分提供的，任何情况下都不可重新分发到其他方。</p>
<p class=indent>
<b>Microsoft Visual Basic 用户</b>&nbsp;&nbsp;&nbsp; <b>RDS.DataControl</b> 仅用于基于 Web 的应用程序。Visual Basic 客户端应用程序不需要它。</p>
</BODY>
</HTML>
