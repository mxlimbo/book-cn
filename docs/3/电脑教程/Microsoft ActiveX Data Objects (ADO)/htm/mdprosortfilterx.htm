<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>FilterColumn、FilterCriterion、FilterValue、SortColumn 和 SortDirection 属性以及 Reset 方法范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdprosortfilterx"></a>FilterColumn、FilterCriterion、FilterValue、SortColumn 和 SortDirection 属性以及 Reset 方法范例</h3>
<p>
以下代码说明了如何在设计时设置 <b>RDS.DataControl Server</b> 参数并使用称为 Pubs 的 ODBC 数据源将其绑定在数据识别控件之上。Pubs 是随 SQL Server 6.5 带来的。要尝试该范例，需要名为 txtSortcolumn、txtSortdirection、txtFiltercolumn、txtCriterion 和 txtFilterValue 的超文本控件以及名为 SortFilter 的 HTML 表单输入按钮。</p>
<pre>&lt;OBJECT CLASSID="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33"
ID=ADC HEIGHT=10 WIDTH=10&gt;
&lt;PARAM NAME="SQL" VALUE="Select * from Sales "&gt;
&lt;PARAM NAME="SERVER" VALUE="http://MyWebServer"&gt;
&lt;PARAM NAME="CONNECT" VALUE="dsn=pubs;UID=sa;PWD=;"&gt;
&lt;/OBJECT&gt;

&lt;!-- Sheridan Grid --&gt;
&lt;Object CLASSID="clsid:AC05DC80-7DF1-11d0-839E-00A024A94B3A"
   CODEBASE="http://MyWebServer
/MSADC/Samples/Sheridan.cab"
   ID=GRID1 
      datasrc=#ADC 
      HEIGHT=125 
      WIDTH=495&gt;
   &lt;PARAM NAME="AllowAddNew" VALUE="TRUE"&gt;
   &lt;PARAM NAME="AllowDelete" VALUE="TRUE"&gt;
   &lt;PARAM NAME="AllowUpdate" VALUE="TRUE"&gt;
   &lt;PARAM NAME="BackColor"&nbsp;&nbsp; VALUE="-2147483643"&gt;
   &lt;PARAM NAME="BackColorOdd"&nbsp; VALUE="-2147483643"&gt;
   &lt;PARAM NAME="ForeColorEven" VALUE="0"&gt;
&lt;/OBJECT&gt;

&lt;Script Language="VBScript"&gt;
&lt;!--
Sub SortFilter_OnClick

   ' 设置数值。txtSortcolumn 是一个超文本框控件。
   ' SortColumn 的值将是用户在 txtSortcolumn 框中指定的文本值。
   If(txtSortcolumn.text &lt;&gt; "") then
      ADC.<span class=cfe><b>SortColumn</b></span> = txtSortcolumn.text
   End If

   ' txtSortdirection 是一个超文本框控件。
   ' SortDirection 的值将是用户在 txtSortdirection 框中指定的文本值。
   Select Case UCASE(txtSortDirection.text)
   Case "TRUE"
      ADC.<span class=cfe><b>SortDirection</b></span> = TRUE
   Case "FALSE"
      ADC.SortDirection = FALSE
   Case Else
      MsgBox "Only true or false are accepted for sort direction"
   End Select

   ' txtFiltercolumn 是一个超文本框控件。
   ' FilterColumn 的值将是用户在 txtFiltercolumn 框中指定的文本值。
   If (txtFiltercolumn.text &lt;&gt; "") Then
      ADC.<span class=cfe><b>FilterColumn</b></span> = txtFiltercolumn.text
   End If

   ' txtCriterion 是一个超文本框控件。
   ' FilterCriterion 的值将是用户在 txtCriterion 框中指定的文本值。
   If (txtCriterion.text &lt;&gt; "") Then
      ADC.<span class=cfe><b>FilterCriterion </b></span>= txtCriterion.text
   End If

   ' txtFilterValue 是一个超文本框控件。
   ' FilterValue 的值将是用户在 txtFilterValue 框中指定的文本值。
   If (txtFilterValue.text &lt;&gt; "") Then
      ADC.<span class=cfe><b>FilterValue</b></span> = txtFilterValue.text
   End If

   ' 在基于指定排序和筛选属性的客户端记录集上执行排序和筛选。
   ' 调用重新设置将显示在数据绑定控件中的结果设置集刷新以显示
   ' 已筛选和已排序的记录集。
   ADC.<span class=cfe><b>Reset</b></span>

End Sub
--&gt;
&lt;/Script&gt;
</pre>
</BODY>
</HTML>
