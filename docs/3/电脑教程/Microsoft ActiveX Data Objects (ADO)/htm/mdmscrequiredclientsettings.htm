<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>所需客户端设置</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdmscrequiredclientsettings"></a>所需客户端设置</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscRequiredClientSettings_C">
</object></p>
<p>
指定下列设置以便使用自定义 DataFactory 处理程序。
<ul type=disc>
<li>
在 <b>Connection</b> 对象的 <b>Provider</b> 属性或者 <b>Connection</b> 对象的连接字符串 “<b>Provider</b>=” 的关键字中指定 “Provider=MS Remote”。<br><br></li>
<li>
设置 <b>CursorLocation</b> 属性为 <b>adUseClient</b>。<br><br></li>
<li>
指定处理程序的名称以便在 <b>RDS.DataControl</b> 对象的 <b>Handler</b> 属性、或者 <b>Recordset</b> 对象的连接字符串“<b>Handler</b>=”的关键字中使用。（不能在 <b>Connection</b> 对象连接字符串中设置处理程序）</li>
</ul>
<p class=indent>
RDS 在称为 <b>MSDFMAP.Handler </b>的服务器上提供默认处理程序。（默认自定义文件被称为 <b>MSDFMAP.INI</b>。）</p>
<h3>范例</h3>
<p>
假设有下列 <b>MSDFMAP.INI </b>节以及数据源名称 AdvWorks 事先已有定义：</p>
<pre>[connect CustomerDataBase]
Access=ReadWrite
Connect="DSN=AdvWorks"

[sql CustomerById]
SQL="SELECT * FROM Customers WHERE CustomerID = ?"
</pre>
<p>
如下代码片段使用 Visual Basic 编写：</p>
<p class=label>
<b>RDS.DataControl 版本</b></p>
<pre>Dim dc as New RDS.DataControl
Set dc.<span class=cfe><b>Handler</b></span> = "MSDFMAP.Handler"
Set dc.<span class=cfe><b>Server</b></span> = "http://YourServer"
Set dc.<span class=cfe><b>Connect</b></span> = "Data Source=CustomerDatabase"
Set dc.<span class=cfe><b>SQL</b></span> = "CustomerById(4)"
dc.<span class=cfe><b>Refresh</b></span>
</pre>
<p class=label>
<b>Recordset 版本</b></p>
<pre>Dim rs as New ADODB.Recordset
rs.CursorLocation = <span class=cfe><b>adUseClient</b></span>
</pre>
<p>
指定 <b>Handler</b> 属性或关键字；<b>Provider</b> 属性或关键字；<b>CustomerById</b> 和 <b>CustomerDatabase</b> 标识符。然后打开 <b>Recordset</b> 对象。</p>
<pre>rs.Open "<span class=cfe><b>CustomerById(4)</b></span>", "<span class=cfe><b>Handler</b></span>=MSDFMAP.Handler;" &amp; _
   "<span class=cfe><b>Provider</b></span>=MS Remote;Data Source=<span class=cfe><b>CustomerDatabase</b></span>;" &amp; _
   "Remote Server=http://YourServer"
</pre>
</BODY>
</HTML>
