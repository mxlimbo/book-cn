<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>访问分级 Recordset 中的行</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdmscaccessingrowsinhierarchicalrecordset"></a>访问分级 Recordset 中的行</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscAccessingRowsInHierarchicalRecordset_C">
</object></p>
<p>
以下范例说明了访问分级 <b>Recordset </b>中的行的所需步骤：
<ol>
<li>
authors 和 titleauthors 表中的 <b>Recordset </b>对象通过 author ID 进行关联。<b> </b><br><br></li>
<li>
外循环显示每个作者的姓名、州/省别和身份。<br><br></li>
<li>
每行所追加的 <b>Recordset </b>都从 <b>Fields </b>集合进行检索并分配给 rstTitleAuthor。<br><br></li>
<li>
内循环显示追加的 <b>Recordset </b>中每行的四个字段。</li>
</ol>
<p>
（<b>StayInSync</b> 属性是为了说明而设置为 FALSE 的，以便您可以在每次外循环中显性地看见子集更改。但是，如果在步骤 3 中的赋值被移动到步骤 2 第一行之前，范例将会更有效，所以赋值只执行一次。然后将 <b>StayInSync</b> 属性设为 TRUE，这样无论 rst 何时移动到新行，rstTitleAuthor 都将隐性和自动地更改为相应的子集。）</p>
<p class=label>
<b>范例</b></p>
<pre>Sub datashape()
 &nbsp;&nbsp; Dim cnn As New ADODB.Connection
 &nbsp;&nbsp; Dim rst As New ADODB.Recordset
 &nbsp;&nbsp; Dim rstTitleAuthor As New ADODB.Recordset

 &nbsp;&nbsp; cnn.Provider = "MSDataShape"
 &nbsp;&nbsp; cnn.Open    "Data Provider=MSDASQL;" &amp; _
               "DSN=vfox;uid=sa;pwd=vfox;database=pubs”
‘步骤 1
 &nbsp;&nbsp; rst.StayInSync = FALSE
 &nbsp;&nbsp; rst.Open    "SHAPE&nbsp; {select * from authors} 
               APPEND ({select * from titleauthor} 
               RELATE au_id TO au_id) AS chapTitleAuthor", 
               cnn
‘步骤 2
 &nbsp;&nbsp; While Not rst.EOF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print    rst("au_fname"), rst("au_lname"), 
                     rst("state"), rst("au_id")
‘步骤 3
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set rstTitleAuthor = rst("chapTitleAuthor").Value
‘步骤 4
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While Not rstTitleAuthor.EOF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print rstTitleAuthor(0), rstTitleAuthor(1), 
                        rstTitleAuthor(2), rstTitleAuthor(3)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rstTitleAuthor.MoveNext
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Wend
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rst.MoveNext
 &nbsp;&nbsp; Wend
End Sub
</pre>
</BODY>
</HTML>
