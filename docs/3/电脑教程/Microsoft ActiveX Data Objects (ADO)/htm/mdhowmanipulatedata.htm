<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>步骤 4：操作数据（ADO 教程）</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdhowmanipulatedata"></a>步骤 4：操作数据（ADO 教程）</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowManipulateData_C">
</object></p>
<p class=label>
<b>您所在的步骤...</b>
<ul type=disc>
<li>
连接数据源。<br><br></li>
<li>
可选择创建表示 SQL 查询命令的对象。<br><br></li>
<li>
可选择在 SQL 命令中将值指定为变量参数。<br><br></li>
<li>
执行命令。如果命令以行返回，将行存储在存储对象中。<br><br></li>
<li>
<b>可选择对数据进行定位、检查、操作和编辑。</b><br><br></li>
<li>
适当情况下，可以使用存储对象中的变更对数据源进行更新。可选择在事务处理中嵌入更新数据。<br><br></li>
<li>
在使用事务之后，可以接受或拒绝在事务中所做的更改。结束事务。 </li>
</ul>
<p class=label>
<b>讨论</b></p>
<p>
大量 <b>Recordset</b> 对象方法和属性可用于对 <b>Recordset</b> 数据行进行检查、定位以及操作。</p>
<p>
<b>Recordset</b> 可看作行数组，在任意给定时间可进行测试和操作的行为“当前行”，在 <b>Recordset</b> 中的位置为“当前行位置”。每次移动到另一行时，该行将成为新的当前行。</p>
<p>
有多种方法可在 <b>Recordset</b> 中显式移动或“定位”（<b>Move</b> 方法）。一些方法（<b>Find</b> 方法）在其操作的附加效果中也能够做到。此外，设置某个属性（<b>Bookmark</b> 属性）同样可以更改行的位置。</p>
<p>
<b>Filter </b>属性用于控制可访问的行（即这些行是“可见的”）。<b>Sort </b>属性用于控制所定位的 <b>Recordset </b>行中的顺序。</p>
<p>
<b>Recordset </b>有一个 <b>Fields </b>集合，它是在行中代表每个字段或列的 <b>Field </b>集，可从 <b>Field </b>对象的<b> Value </b>属性中为字段赋值或检索数据。作为选项，可访问大量字段数据（<b>GetRows </b>和 <b>Update </b>方法）。</p>
<p>
在本教程中，您将要：
<ul type=disc>
<li>
假定将区号为“<b>415</b>”局号并以“<b>5</b>”开头的电话号码更改为虚构的区号“<b>777</b>”。<br><br></li>
<li>
在 <b>au_lname Field </b>对象的 <b>Properties</b> 集合中设置 <b>Optimize </b>属性以提高存储和筛选性能。<br><br></li>
<li>
按作者的姓对 <b>Recordset</b> 使用 <b>Sort</b>（排序）操作。<br><br></li>
<li>
<b>Filter</b>（筛选）<b>Recordset</b>，使作者电话区号为“<b>415</b>”、局号为“<b>5</b>”的行成为仅可访问（即可见的）行。</li>
</ul>
<p>
使用 <b>Move</b> 方法从头至尾对经过排序和筛选的 <b>Recordset</b> 定位。当 <b>Recordset EOF</b> 属性表明已经到达最后一行时停止。在 <b>Recordset</b> 中移动时，显示作者的姓和名以及原始电话号码，然后将 <b>phone</b> 字段中的区号改为“<b>777</b>”。（<b>phone</b> 字段中的电话号码格式为“<b>aaa xxx-yyyy</b>”，其中 <b>aaa</b> 为区号，<b>xxx</b> 为局号。）</p>
<pre>rs("au_lname").Properties("<span class=cfe><b>Optimize</b></span>") = TRUE
rs.<span class=cfe><b>Sort</b></span> = "au_lname ASC"
rs.<span class=cfe><b>Filter</b></span> = "phone LIKE '415 5*'"
rs.<span class=cfe><b>MoveFirst</b></span>
Do While Not rs.<span class=cfe><b>EOF</b></span>
   Debug.Print "Name: " &amp; rs("au_fname") &amp; " " rs("au_lname") &amp; _
      "Phone: " rs("phone") &amp; vbCr
   rs("phone") = "777" &amp; Mid(rs("phone"), 5, 11)
   rs.<span class=cfe><b>MoveNext</b></span>
Loop
</pre>
<p>
<b>下一页<B>&nbsp;&nbsp;&nbsp;</B></b><a href="mdhowupdatedata.htm">步骤 5</a></p>
</BODY>
</HTML>
