<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>记录集持久性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmscrecordsetpersistence"></a>Recordset 持久性</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscRecordsetPersistence_C">
</object></p>
<p>
使用记录集持久性，可以将 <b>Recordset</b> 数据和元数据保存为文件。随后，使用持久文件来重新建立 <b>Recordset</b> 对象。持久文件可以保存在本地驱动器、网络服务器上或者作为 URL 保存在 Web 站点上。</p>
<p>
另外，<b>GetString </b>方法将 <b>Recordset</b> 对象转换成表单，在表单中列和行使用指定的字符分界。</p>
<p class=label>
<b>详细资料</b></p>
<p>
Microsoft OLE DB Persistence Provider 支持使用 <b>Recordset</b> 对象 <b>Save</b> 方法将 <b>Recordset</b> 对象保存在文件中。随后，使用 <b>Recordset</b> 对象的 <b>Open、</b>或 <b>Connection</b> 对象的 <b>Execute</b> 方法可恢复持久文件。</p>
<p>
<b>Recordset</b> 对象被转换为能被保存在文件中的表单。<b>Recordset</b> 对象可以按所拥有的高级数据图表 (<b>ADTG</b>) 格式保存，或者按打开的可扩展标记语言 (<b>XML</b>) 格式保存。</p>
<p>
挂起更改保存在持久文件中。因此，可以发布查询返回 <b>Recordset</b> 对象、编辑记录集、保存该记录集和挂起变化、以后恢复该记录集、然后使用保存的挂起变化更新数据源。</p>
<p class=label>
<b>用法</b></p>
<p class=label>
<b>保存记录集:</b></p>
<pre>Dim rs as New ADODB.Recordset
rs.<span class=cfe><b>Save</b></span> "c:\yourFile.adtg", adPersistADTG
</pre>
<p class=label>
<b>使用 Recordset.Open 打开持久文件:</b></p>
<pre>dim rs as New ADODB.Recordset
rs.<span class=cfe><b>Open</b></span> "c:\yourFile.adtg", "Provider=<span class=cfe><b>MSPersist</b></span>",,,<span class=cfe><b>adCmdFile</b></span>
</pre>
<p class=tl>
可选地，如果 <b>Recordset</b> 没有活动的连接，则都可以接受所有的默认值和简单的代码：</P><pre>dim rs as New ADODB.Recordset
rs.<span class=cfe><b>Open</b></span> "c:\yourFile.adtg"
</pre>
<p class=label>
<b>使用 Connection.Execute 打开持久文件:</b></p>
<pre>dim conn as New ADODB.Connection
dim rs as New ADODB.Recordset
conn.Open "Provider=<span class=cfe><b>MSPersist</b></span>"
set rs = conn.<span class=cfe><b>execute</b></span>("c:\yourFile.adtg")
</pre>
<p class=label>
<b>使用 RDS.DataControl 打开持久文件:</b></p>
<p class=tl>
在这种情况下，没有设置 <b>Server</b> 属性。</P><pre>Dim dc as New RDS.DataControl
dc.<span class=cfe><b>Connection</b></span> = "Provider=<span class=cfe><b>MSPersist</b></span>"
dc.<span class=cfe><b>SQL</b></span> = "c:\yourFile.adtg"
dc.<span class=cfe><b>Refresh</b></span>
</pre>
</BODY>
</HTML>
