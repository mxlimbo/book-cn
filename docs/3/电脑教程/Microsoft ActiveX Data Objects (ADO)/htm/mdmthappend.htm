<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Append 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthappend"></a>Append 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthAppend_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthAppend_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthAppend_A">
</object></p>
<p>
将对象追加到集合中。如果集合是 <a href="mdcolfields.htm">Fields</a>，可以先创建新的 <a href="mdobjfield.htm">Field</a> 对象然后再将其追加到集合中。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>collection</i><b>.Append</b> <b><i>object</i></b></p>
<p>
<i>fields</i><b>.Append</b> <b><i>Name, Type, DefinedSize, Attrib</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<i>collection&nbsp;&nbsp;&nbsp;</i>集合对象。</p>
<p>
<i>fields&nbsp;&nbsp;&nbsp;</i><b>Fields</b> 集合。</p>
<p>
<b><i>object&nbsp;&nbsp;&nbsp;</i></b>对象变量，代表所要追加对象。</p>
<p>
<b><i>Name&nbsp;&nbsp;&nbsp;</i>字符串</b>，新<b> Field</b> 对象的名称，不得与 <i>fields</i><b> </b>中的任何其他对象同名。 </p>
<p>
<b><i>Type&nbsp;&nbsp;&nbsp;</i>DataTypeEnum</b> 类型，其默认值为 <b>adEmpty</b>。新字段的数据类型。 </p>
<p>
<b><i>DefinedSize&nbsp;&nbsp;&nbsp;</i></b>可选，<b>长整型</b>，指示新字段的定义大小（以字符或字节为单位）。该参数的默认值源于<b> <i>Type </i></b>（默认的 <b><i>Type </i></b>为 <b>adEmpty</b>，默认的 <b>DefinedSize</b> 未指定）。</p>
<p>
<b><i>Attrib&nbsp;&nbsp;&nbsp;</i></b>可选，<b>FieldAttributeEnum</b>，其默认值是 <b>adFldDefault</b>。指定新字段的属性。如果该值未指定，字段将包含源于 <b><i>Type</i></b> 的属性。</p>
<p class=label>
<b>参数</b></p>
<p>
在集合上使用 <b>Append</b> 方法可将对象添加到该集合，此方法仅在 <a href="mdobjcommand.htm">Command</a> 对象的 <a href="mdcolparameters.htm">Parameters</a> 集合上有效。在将 <a href="mdobjparameter.htm">Parameter</a> 对象追加到 <b>Parameters </b>集合中之前必须设置其 <a href="mdprotype.htm">Type</a> 属性。如果选定了变长数据类型，则必须将 <a href="mdprosize.htm">Size</a> 属性设置为大于零的值。</p>
<p>
通过对参数作出说明，可以最大程度地减少对提供者的调用，进而在使用存储过程或参数化查询时提高性能，但必须了解与所要调用的存储过程或参数化查询相关联的参数属性。使用 <a href="mdmthcreateparam.htm">CreateParameter</a>  方法可创建具有适当属性设置的 <b>Parameter </b>对象，而使用 <b>Append </b>方法则可将它们添加到 <b>Parameters </b>集合。这样可以不必调用参数信息的提供者而设置和返回参数值。如果写到不提供参数信息的提供者，则必须使用该方法手工填写 <b>Parameters </b>集合以便能够完全使用参数。</p>
<p class=label>
<b>字段</b></p>
<p>
如果在调用 <i>fields</i><b>.Append</b> 方法前您没有设置 <b>CursorLocation</b> 属性，当使用 <b>Open</b> 方法打开 <b>Recordset</b> 时，<b>CursorLocation</b> 将被自动设置为 <b>adUseClient</b>。</p>
<p>
对打开的 <b>Recordset </b>或已设置 <b>ActiveConnection</b> 属性的 <b>Recordset</b>，调用其 <i>fields</i><b>.Append</b> 方法将引发运行时错误。只能将字段追加到没有打开并且尚未连接到数据源的 <b>Recordset</b>。一般地，通过 <b>CreateRecordset</b> 方法或通过将新 <b>Recordset </b>对象显式赋给对象变量所创建的都是新 <b>Recordset</b> 对象。</p>
</BODY>
</HTML>
