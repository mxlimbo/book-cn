<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>CursorType 属性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdprocursortype"></a>CursorType 属性</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproCursorType_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproCursorType_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproCursorType_A">
</object></p>
<p>
指示在 <a href="mdobjodbrec.htm">Recordset</a> 对象中使用的游标类型。</p>
<p class=label>
<b>设置和返回值</b></p>
<p>
设置或返回以下某个 <b>CursorTypeEnum</b> 值。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>常量</b></td>
<td class=label width=67%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenForwardOnly</b></td>
<td width=67%>仅向前游标，默认值。除了只能在记录中向前滚动外，与静态游标相同。当只需要在记录集中单向移动时，使用它可提高性能。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenKeyset</b></td>
<td width=67%>键集游标。尽管从您的记录集不能访问其他用户删除的记录，但除无法查看其他用户添加的记录外，键集游标与动态游标相似。仍然可以看见其他用户更改的数据。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenDynamic</b></td>
<td width=67%>动态游标。可以看见其他用户所作的添加、更改和删除。允许在记录集中进行所有类型的移动，但不包括提供者不支持的书签操作。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenStatic</b></td>
<td width=67%>静态游标。可以用来查找数据或生成报告的记录集合的静态副本。另外，对其他用户所作的添加、更改或删除不可见。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>CursorType</b> 属性可指定打开 <b>Recordset </b>对象时应该使用的游标类型。<b>Recordset</b> 关闭时 <b>CursorType</b> 属性为读/写，而 <b>Recordset</b> 打开时该属性为只读。</p>
<p>
如果将 <a href="mdprocursorlocation.htm">CursorLocation</a> 属性设置为 <b>adUseClient </b>则只支持 <b>adUseStatic </b>的设置。如果设置了不支持的值，不会导致错误，将使用最接近支持的 <b>CursorType</b>。</p>
<p>
如果提供者不支持所请求的游标类型，提供者可能会返回其他游标类型。打开 <b>Recordset</b> 对象时，将更改 <b>CursorType</b> 属性使之与实际使用的游标匹配。要验证返回游标的指定功能，请使用 <a href="mdmthsupports.htm">Supports</a> 方法。关闭 <b>Recordset</b> 后，<b>CursorType</b> 属性将恢复为最初的设置。</p>
<p>
下表说明每个游标类型所需的提供者功能（由 <b>Supports</b> 方法常量标识）。 </p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>对于该 CursorType 的某Recordset </b></td>
<td class=label width=67%><b>对于所有这些常量， Supports 方法必须返回 True</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenForwardOnly</b></td>
<td width=67%>无</td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenKeyset</b></td>
<td width=67%><b>AdBookmark</b>、<b>adHoldRecords</b>、<b>adMovePrevious</b>、<b>adResync</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenDynamic</b></td>
<td width=67%><b>adMovePrevious</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdOpenStatic</b></td>
<td width=67%><b>adBookmark</b>, <b>adHoldRecords</b>, <b>adMovePrevious</b>, <b>adResync</b></td>
</tr>
</table><br>
<p class=indent>
<B><b>注意</b></B>&nbsp;&nbsp;&nbsp;尽管对于动态游标和仅向前游标 <b>Supports</b>(<b>adUpdateBatch</b>) 可能是真，但对于批处理更新应使用键集游标或静态游标。请将 <b>LockType</b> 属性设置为 <b>adLockBatchOptimistic</b>，然后将 <b>CursorLocation</b> 属性设置为 <b>adUseClient</b> 以启用批更新需要的 OLE DB 游标服务。</p>
<p class=indent>
<b>远程数据服务<B>用法&nbsp;&nbsp;&nbsp;</B></b>当用于客户端 (ADOR) <b>Recordset</b> 对象时，只能将 <b>CursorType</b> 属性设置为 <b>adOpenStatic</b>。</p>
</BODY>
</HTML>
