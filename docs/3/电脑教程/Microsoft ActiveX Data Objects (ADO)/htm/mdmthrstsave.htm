<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Save 方法 (ADO Recordset)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthrstsave"></a>Save 方法 (ADO Recordset)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthRstSave_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthRstSave_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthRstSave_A">
</object></p>
<p>
将<b> Recordset</b> 保存（持久）在文件中。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset.</i><b>Save</b> <b><i>FileName, PersistFormat</i></b> </p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>FileName&nbsp;&nbsp;&nbsp;</i></b>可选。文件的完整路径名，用于保存 <b>Recordset</b>。</p>
<p>
<b><i>PersistFormat&nbsp;&nbsp;&nbsp;</i></b>可选。<b>PersistFormatEnum </b>值，指定保存 <b>Recordset </b>所使用的格式。可以是如下的某个常量：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=24%><b>常量</b></td>
<td class=label width=76%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=24%><b>adPersistADTG</b></td>
<td width=76%>（默认）使用专用的“Advanced Data Tablegram”格式保存。</td>
</tr>
<tr valign=top>
<td width=24%><b>adPersistXML</b></td>
<td width=76%>使用<b> </b>XML 格式保存。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
只能对打开的 <b>Recordset </b>调用 <b>Save</b> 方法。随后使用<b> </b><a href="mdmthrstopen.htm">Open</a> 方法可由<b><i> FileName</i></b> 恢复 <b>Recordset</b>。</p>
<p>
如果 <a href="mdprofilter.htm">Filter</a> 属性影响 <b>Recordset</b>，将只保存经过筛选的行。如果 <b>Recordset </b>是分级结构的，那么将保存当前子 <b>Recordset </b>和它的子 <b>Recordset</b>，但不保存上一级 <b>Recordset</b>。</p>
<p>
在第一次保存 <b>Recordset </b>时指定 <b><i>FileName</i></b>。如果随后调用<i> </i><b>Save </b>时，应忽略 <b><i>FileName</i></b>，否则将产生运行时错误。如果随后使用新的<b><i> FileName</i></b> 调用<b> Save</b>，那么<b> Recordset</b> 将保存到新的文件中，但新文件和原始文件都是打开的。</p>
<p>
<b>Save</b> 不关闭 <b>Recordset</b> 或 <b><i>FileName</i></b>，从而可以继续使用 <b>Recordset</b> 并保存最新的更改。在 <b>Recordset</b> 关闭之前 <b><i>FileName</i></b> 将保持打开，在这段时间其它应用程序可以读取但不能写入 <b><i>FileName</i></b>。</p>
<p>
出于安全的原因，对由 Microsoft Internet Explorer 执行的脚本，<b>Save</b> 方法仅允许使用低的和自定义的安全设置。有关安全问题的详细解释，请参阅 在 http://www.microsoft.com/data/techmat.htm 上的白皮书标题“Security Issues in the Microsoft Internet Explorer”。</p>
<p>
如果正在进行异步 <b>Recordset</b> 获取、执行或更新操作时调用<b> Save</b> 方法，则 <b>Save</b> 将进入等待状态，直到异步操作完成。</p>
<p>
在 <b>Save</b> 方法完成后，当前行位置将成为 <b>Recordset </b>的首行。</p>
<p>
要得到最佳结果，应使用 <b>Save</b> 将 <b>CursorLocation</b> 属性设置为 <b>adUseClient</b>。如果您的提供者不支持用于保存 <b>Recordset</b> 对象的所需功能，则客户端游标将提供该功能。</p>
</BODY>
</HTML>
