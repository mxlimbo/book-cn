<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Delete 方法 (ADO Recordset)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthrstdelete"></a><sup></sup>Delete 方法 (ADO Recordset)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthRstDelete_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthRstDelete_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthRstDelete_A">
</object></p>
<p>
删除当前记录或记录组。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset</i>.<b>Delete</b> <b><i>AffectRecords</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>AffectRecords&nbsp;&nbsp;&nbsp;</i>AffectEnum</b> 值，确定 <b>Delete</b> 方法所影响的记录数目，该值可以是下列常量之一。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=50%><b>常量</b></td>
<td width=50%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=50%><b>AdAffectCurrent</b></td>
<td width=50%>默认。仅删除当前记录。</td>
</tr>
<tr valign=top>
<td width=50%><b>AdAffectGroup</b></td>
<td width=50%>删除满足当前 <a href="mdprofilter.htm">Filter</a> 属性设置的记录。要使用该选项，必须将<b> Filter</b> 属性设置为有效的预定义常量之一。</td>
</tr>
<tr valign=top>
<td width=50%><b>adAffectAll</b></td>
<td width=50%>删除所有记录。</td>
</tr>
<tr valign=top>
<td width=50%><b>adAffectAllChapters</b></td>
<td width=50%>删除所有子集记录。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>Delete </b>方法可将 <b>Recordset </b>对象中的当前记录或一组记录标记为删除。如果 <b>Recordset </b>对象不允许删除记录将引发错误。使用立即更新模式将在数据库中进行立即删除，否则记录将标记为从缓存删除，实际的删除将在调用 <a href="mdmthupdatebatch.htm">UpdateBatch</a> 方法时进行。（使用<b> Filter</b> 属性可查看已删除的记录）。</p>
<p>
从已删除的记录中检索字段值将引发错误。删除当前记录后，在移动到其他记录之前已删除的记录将保持为当前记录。一旦离开已删除记录，则无法再次访问它。</p>
<p>
如果在事务中嵌套删除，可用 <a href="mdmthbegintrans.htm">RollbackTrans</a> 方法恢复已删除的记录。如果处于批更新模式，则可用 <a href="mdmthcancelbatch.htm">CancelBatch</a> 方法取消一个或一组挂起删除。</p>
<p>
如果因与基本数据冲突而导致删除记录失败（如记录已被其他用户删除），则提供者向 <a href="mdcolerrors.htm">Errors</a> 集合返回警告但不终止程序执行，只有在所有提出请求的记录上发生冲突时才会产生运行时错误。</p>
<p>
如果 <a href="mdprodynuniquetable.htm">Unique Table</a> 动态属性被设置，并且 <b>Recordset</b> 是对多个表执行 JOIN 操作的结果，那么，<b>Delete</b> 方法将仅删除 <b>Unique Table</b> 属性所命名的表中的行。</p>
</BODY>
</HTML>
