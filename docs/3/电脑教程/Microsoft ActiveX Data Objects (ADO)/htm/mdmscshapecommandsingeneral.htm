<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>常规 Shape 命令</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdmscshapecommandsingeneral"></a>常规 Shape 命令</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscShapeCommandsInGeneral_C">
</object></p>
<p>
“数据构形”定义了成形 <b>Recordset</b> 的列、由列代表的条目之间的关系以及数据充填到 <b>Recordset</b> 的方式。</p>
<p>
成形的 <b>Recordset</b> 可以由如下类型的列组成：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=23%><b>列类型</b></td>
<td class=label width=77%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=23%>数据</td>
<td width=77%>由对数据提供者、表或以前成形 <b>Recordset</b> 使用查询命令所返回的 <b>Recordset</b> 的字段。</td>
</tr>
<tr valign=top>
<td width=23%>子集</td>
<td width=77%>对另一个 <b>Recordset </b>的引用，称为“子集”。子集列使定义“父-子”关系成为可能，在这种关系中“父”是包含子集列的 <b>Recordset</b>，“子”是由子集代表的 <b>Recordset</b>。</td>
</tr>
<tr valign=top>
<td width=23%>合计</td>
<td width=77%>列的值通过对所有行执行“合计函数”获得，或者是子 <b>Recordset</b> 的所有行的列。（请参阅下表中的合计函数。）</td>
</tr>
<tr valign=top>
<td width=23%>计算表达式</td>
<td width=77%>列的值通过对在 <b>Recordset</b> 的相同行中的列进行 Visual Basic for Applications 表达式的计算而获得。表达式是 CALC 函数的参数。（请参阅下表中的计算表达式。）</td>
</tr>
<tr valign=top>
<td width=23%>新建</td>
<td width=77%>空的、虚构的字段，可在随后充填数据。列使用 NEW 关键字定义。（请参阅下表中的 NEW 关键字。）</td>
</tr>
</table><br>
<p>
Shape 命令可以包含子句，指定针对基本数据提供者并将返回 <b>Recordset</b> 对象的查询命令。查询的语法取决于对基本数据提供者的要求。虽然 ADO 并不要求使用任何指定的查询语言，但通常是使用结构化查询语言 (SQL)。</p>
<p>
您可以使用 SQL <b>JOIN</b> 子句关联两个表，但是，分级 <b>Recordset</b> 可以更有效地表达信息。由 <b>JOIN</b> 创建的 <b>Recordset</b> 的每行会多余地重复一个表中的信息。分级 <b>Recordset</b> 的多个子 <b>Recordset </b>对象中，每个对象仅有一个父 <b>Recordset</b>。</p>
<p>
Shape 命令可以仅由 <b>Recordset</b> 对象发出。</p>
<p>
Shape 命令可以嵌套，即父命令或子命令本身可以是另一个 Shape 命令。</p>
<p>
有关定位分级 <b>Recordset </b>的详细信息，请参阅<a href="mdmscaccessingrowsinhierarchicalrecordset.htm">访问分级 Recordset 中的行</a>。</p>
<p>
有关语法正确的 Shape 命令的详细信息，请参阅<a href="mdmscformalshapegrammar.htm">形状语法格式</a>。</p>
<p class=label>
<b>合计函数、CALC 函数和 NEW 关键字</b></p>
<p>
数据构形支持如下函数。<i>chapter-alias </i>是指定给包含了将被操作列的子集名称。</p>
<p>
chapter-alias（子集-别名）可以是完整的，由指向包含 <i>column-name </i>的子集的每个子集列名称组成，全部用句号分隔。例如，如果父子集 chap1 包含拥有数量列 amt 的子子集，则完整名即是 chap1.chap2.amt。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>合计函数</b></td>
<td class=label width=50%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=50%>SUM(<i>chapter-alias</i>.<i>column-name</i>)</td>
<td width=50%>计算指定列中所有值的和。</td>
</tr>
<tr valign=top>
<td width=50%>AVG(<i>chapter-alias</i>.<i>column-name</i>)</td>
<td width=50%>计算指定列中所有值的平均值。</td>
</tr>
<tr valign=top>
<td width=50%>MAX(<i>chapter-alias</i>.<i>column-name</i>)</td>
<td width=50%>计算指定列中的最大值。</td>
</tr>
<tr valign=top>
<td width=50%>MIN(<i>chapter-alias</i>.<i>column-name</i>)</td>
<td width=50%>计算指定列中的最小值。</td>
</tr>
<tr valign=top>
<td width=50%>COUNT(<i>chapter-alias</i>[.<i>column-name</i>])</td>
<td width=50%>计算指定别名或列中行的数量。</td>
</tr>
<tr valign=top>
<td width=50%>STDEV(<i>chapter-alias</i>.<i>column-name</i>)</td>
<td width=50%>计算指定列中的标准偏差。</td>
</tr>
<tr valign=top>
<td width=50%>ANY(<i>chapter-alias</i>.<i>column-name</i>)</td>
<td width=50%>列的值（列的值在所有行均相同）。</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>计算表达式</b></td>
<td class=label width=50%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=50%>CALC(<i>expression</i>)</td>
<td width=50%>计算任意表达式，但仅针对包含 CALC 函数的 <b>Recordset</b> 行。可以是任何 Visual Basic for Applications (VBA) 函数或表达式。</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>NEW 关键字</b></td>
<td class=label width=50%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=50%>NEW (field type [(width | scale [,precision])]</td>
<td width=50%>将指定类型的空列添加到 <b>Recordset</b>。</td>
</tr>
</table><br>
</BODY>
</HTML>
