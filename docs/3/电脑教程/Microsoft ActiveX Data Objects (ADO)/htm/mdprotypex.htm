<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Type 属性范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdprotypex"></a>Type 属性范例</h3>
<p>
该范例通过显示与雇员表所有 <b>Field</b> 对象的 <b>Type</b> 属性值对应的常量名说明 <b>Type</b> 属性。该过程运行时需要 <b>FieldType</b> 函数。</p>
<pre>Public Sub TypeX()

   Dim rstEmployees As ADODB.Recordset
   Dim fldLoop As ADODB.Field
   Dim strCnn As String

   ' 使用雇员表中的数据打开记录集。
   strCnn = "Provider=sqloledb;" &amp; _
      "Data Source=srv;Initial Catalog=pubs;User Id=sa;Password=; "
   Set rstEmployees = New ADODB.Recordset
   rstEmployees.Open "employee", strCnn, , , adCmdTable

   Debug.Print "Fields in Employee Table:" &amp; vbCr

   ' 枚举雇员表的字段集合。
   For Each fldLoop In rstEmployees.Fields
      Debug.Print "&nbsp; Name: " &amp; fldLoop.Name &amp; vbCr &amp; _
         "&nbsp; Type: " &amp; FieldType(fldLoop.<span class=cfe><b>Type</b></span>) &amp; vbCr
   Next fldLoop

End Sub

Public Function FieldType(intType As Integer) As String

   Select Case intType
      Case adChar
         FieldType = "adChar"
      Case adVarChar
         FieldType = "adVarChar"
      Case adSmallInt
         FieldType = "adSmallInt"
      Case adUnsignedTinyInt
         FieldType = "adUnsignedTinyInt"
      Case adDBTimeStamp
         FieldType = "adDBTimeStamp"
   End Select

End Function</pre>
</BODY>
</HTML>
