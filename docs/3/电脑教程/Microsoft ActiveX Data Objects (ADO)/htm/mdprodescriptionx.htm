<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Description、NativeError、Number、Source 和 SQLState 属性范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdprodescriptionx"></a>Description、NativeError、Number、Source 和 SQLState 属性范例</h3>
<p>
该范例触发并捕获错误，同时显示产生的 <b>Error</b> 对象的 <b>Description</b>、<b>HelpContext</b>、<b>HelpFile</b>、<b>NativeError</b>、<b>Number</b>、<b>Source</b> 和 <b>SQLState</b> 属性。</p>
<pre>Public Sub DescriptionX()

   Dim cnn1 As ADODB.Connection
   Dim errLoop As ADODB.Error
   Dim strError As String

   On Error GoTo ErrorHandler
   
   ' 有意触发错误。
   Set cnn1 = New ADODB.Connection
   cnn1.Open "nothing"
   
   Exit Sub

ErrorHandler:

   ' 枚举错误集合并显示每个 Error 对象的属性。
   For Each errLoop In cnn1.Errors
      strError = "Error #" &amp; errLoop.Number &amp; vbCr &amp; _
         "   " &amp; errLoop.Description &amp; vbCr &amp; _
         "   (Source: " &amp; errLoop.Source &amp; ")" &amp; vbCr &amp; _
         "   (SQL State: " &amp; errLoop.SQLState &amp; ")" &amp; vbCr &amp; _
         "   (NativeError: " &amp; errLoop.NativeError &amp; ")" &amp; vbCr
      If errLoop.HelpFile = "" Then
         strError = strError &amp; _
            "   No Help file available" &amp; _
            vbCr &amp; vbCr
      Else
         strError = strError &amp; _
            "   (HelpFile: " &amp; errLoop.HelpFile &amp; ")" &amp; vbCr &amp; _
            "   (HelpContext: " &amp; errLoop.HelpContext &amp; ")" &amp; _
            vbCr &amp; vbCr
      End If
         

   Debug.Print strError
   Next

   Resume Next

End Sub</pre>
</BODY>
</HTML>
