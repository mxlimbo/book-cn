<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>将业务对象标记为“脚本安全”</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdhowsfs"></a>将业务对象标记为“脚本安全”</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowSFS_C">
</object></p>
<p>
为确保 Internet 环境的安全，需要将由 <a href="mdobjdataspace.htm">RDS.DataSpace</a> 对象的 <a href="mdmthcreateobj.htm">CreateObject</a> 方法事例化的<a href="mddefbusinessobject.htm">业务对象</a>标记为“脚本安全”。在 <a href="mddefdcom.htm">DCOM</a> 中使用之前，应确保在系统注册表的“许可”区域中对该业务对象进行了同样的标记。</p>
<p>
要手工标记业务对象为“脚本安全”，需要创建包含以下文本的具有 .reg 扩展名的文本文件。下面的两组编号可以启用“脚本安全”功能：</p>
<p>
[HKEY_CLASSES_ROOT\CLSID\&lt;<i>MyActiveXGUID</i>&gt;\Implemented <br>
Categories\{7DD95801-9882-11CF-9FA9-00AA006C42C4}]</p>
<p>
[HKEY_CLASSES_ROOT\CLSID\&lt;<i>MyActiveXGUID</i>&gt;\Implemented <br>
Categories\{7DD95802-9882-11CF-9FA9-00AA006C42C4}]</p>
<p>
其中 &lt;MyActiveXGUID&gt; 是业务对象的十六进制 GUID 号码，将其保存并通过使用“注册表编辑器”或双击“Windows 资源管理器”中的 .reg 文件将其合并到注册表中。</p>
<p>
在 Microsoft&reg; Visual Basic&reg; 中创建的业务对象可通过“打包和展开向导”被自动标记为“脚本安全”。当向导要求指定安全设置时，请选择“初始化安全”和“脚本安全”。</p>
<p>
在最后的步骤中，“应用程序安装向导”创建了一个 .htm 和一个 .cab 文件，可以将这两个文件复制到目标计算机并双击 .htm 文件以加载页面并正确注册服务器。</p>
<p>
由于在默认情况下业务对象将安装在 Windows\System32\Occache 目录中，因此要将其移动到&nbsp; Windows\System32 目录并改变 <b>HKEY_CLASSES_ROOT\CLSID\</b>&lt;<i>MyActiveXGUID</i>&gt;\<b>InprocServer32 </b>注册表键使之与正确的路径相匹配。</p>
</BODY>
</HTML>
