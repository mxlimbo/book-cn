<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>LockType 属性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdprolocktype"></a>LockType 属性</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproLockType_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproLockType_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproLockType_A">
</object></p>
<p>
指示编辑过程中对记录使用的锁定类型。</p>
<p class=label>
<b>设置和返回值</b></p>
<p>
设置或返回以下某个 <b>LockTypeEnum</b> 的值。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>常量</b></td>
<td class=label width=66%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=34%><b>adLockReadOnly</b></td>
<td width=66%>默认值，只读。无法更改数据。</td>
</tr>
<tr valign=top>
<td width=34%><b>adLockPessimistic</b></td>
<td width=66%>保守式记录锁定（逐条）。提供者执行必要的操作确保成功编辑记录，通常采用编辑时立即锁定数据源的记录的方式。</td>
</tr>
<tr valign=top>
<td width=34%><b>adLockOptimistic</b></td>
<td width=66%>开放式记录锁定（逐条）。提供者使用开放式锁定，只在调用 <a href="mdmthupdate.htm">Update</a> 方法时锁定记录。</td>
</tr>
<tr valign=top>
<td width=34%><b>adLockBatchOptimistic</b></td>
<td width=66%>开放式批更新。用于与立即更新模式相反的批更新模式。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
打开 <b>Recordset</b> 前设置 <b>LockType</b> 属性可指定打开时提供者应该使用的锁定类型。读取该属性可返回在打开的 <b>Recordset</b> 对象上正在使用的锁定类型。<b>Recordset</b> 关闭时 <b>LockType</b> 属性为读/写，打开时该属性为只读。</p>
<p>
提供者可能不支持所有的锁定类型。如果某提供者不支持所需的 <b>LockType</b> 设置，则将替换为其他类型的锁定。要确定 <b>Recordset </b>对象可用的实际锁定功能，请通过 <b>adUpdate</b> 和 <b>adUpdateBatch</b> 使用 <a href="mdmthsupports.htm">Supports</a> 方法。</p>
<p>
如果 <a href="mdprocursorlocation.htm">CursorLocation</a> 属性被设置为 <b>adUseClient</b>，将不支持 <b>adLockPessimistic</b> 设置。设置不支持的值不会产生错误，因为此时将使用支持的最接近的 <b>LockType </b>的值。</p>
<p class=indent>
<b>远程数据服务<B>用法&nbsp;&nbsp;&nbsp;</B></b>当在客户端 (ADOR) 的 <b>Recordset</b> 对象上使用时，<b>LockType</b> 属性只能设置为 <b>adLockOptimisticBatch</b>。</p>
</BODY>
</HTML>
