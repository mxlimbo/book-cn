<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Connection 对象</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdobjconnection"></a>Connection 对象</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjConnection_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjConnection_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:属性">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjConnection_P">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:方法">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjConnection_M">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:集合">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjConnection_CO">
</object></p>
<p>
<b>Connection</b> 对象代表打开的、与数据源的连接。</p>
<p>
<img src="objconn.gif" border=0><br>
<img src="parmult.gif" border=0><a href="mdcolerrors.htm"><img src="colerror.gif" border=0></a><br>
<img src="parmult.gif" border=0><a href="mdobjcommand.htm"><img src="objcomma.gif" border=0></a><br>
<img src="parchild.gif" border=0><a href="mdobjodbrec.htm"><img src="objrecor.gif" border=0></a></p>
<p class=label>
<b>说明</b></p>
<p>
<b>Connection</b> 对象代表与数据源进行的唯一会话。如果是客户端/服务器数据库系统，该对象可以等价于到服务器的实际网络连接。取决于提供者所支持的功能，<b>Connection</b> 对象的某些集合、方法或属性有可能无效。</p>
<p>
使用 <b>Connection</b> 对象的集合、方法、和属性可执行下列操作：
<ul type=disc>
<li>
在打开连接前使用 <b>ConnectionString</b>、<b>ConnectionTimeout</b> 和 <b>Mode</b> 属性对连接进行配置。<br><br></li>
<li>
设置 <b>CursorLocation</b> 属性以便调用支持批更新的“客户端游标提供者”。<br><br></li>
<li>
使用 <b>DefaultDatabase</b> 属性设置连接的默认数据库。<br><br></li>
<li>
使用 <b>IsolationLevel</b> 属性为在连接上打开的事务设置隔离级别。<br><br></li>
<li>
使用 <b>Provider</b> 属性指定 OLE DB 提供者。<br><br></li>
<li>
使用 <b>Open</b> 方法建立到数据源的物理连接。使用 <b>Close</b> 方法将其断开。<br><br></li>
<li>
使用 <b>Execute</b> 方法执行对连接的命令，并使用 <b>CommandTimeout</b> 属性对执行进行配置。<br><br></li>
<li>
可使用 <b>BeginTrans</b>、<b>CommitTrans</b> 和 <b>RollbackTrans</b> 方法以及 <b>Attributes</b> 属性管理打开的连接上的事务（如果提供者支持则包括嵌套的事务）。<br><br></li>
<li>
使用 <b>Errors</b> 集合检查数据源返回的错误。<br><br></li>
<li>
通过 <b>Version</b> 属性读取使用中的 ADO 执行版本。<br><br></li>
<li>
使用 <b>OpenSchema</b> 方法获取数据库模式信息。</li>
</ul>
<p class=indent>
<B><b>注意</b></B>&nbsp;&nbsp;&nbsp;如果不使用 <b>Command</b> 对象执行查询，请向 <b>Connection</b> 对象的 <b>Execute</b> 方法传送查询字符串。但是，当需要使命令文本具有持久性并重新执行，或使用查询参数的时候，则必须使用 <b>Command</b> 对象。</p>
<p>
可以创建独立于先前定义的其他任何对象的 <b>Connection</b> 对象。</p>
<p class=indent>
<b>注意</b>&nbsp;&nbsp;&nbsp;可以象执行 <b>Connection</b> 对象的本地方法一样执行命令或存储过程。</p>
<p class=indent>
如果要执行命令，可以使用 <b>Command</b> 对象的 <b>Name</b> 属性给命令指定一个名称。将 <b>Command</b> 对象的 <b>ActiveConnection</b> 属性设置为该连接。然后，象发出 <b>Connection</b> 对象的方法一样发出使用命令名称的语句，后面可带任何参数（如果有返回行，则后面带 <b>Recordset</b> 对象）。设置 <b>Recordset</b> 属性以便自定义所产生的记录集。例如：</p>
<pre>Dim cnn As New ADODB.Connection
Dim cmd As New ADODB.Command
Dim rst As New ADODB.Recordset
...
cnn.Open "..."
cmd.Name = "yourCommandName"
cmd.ActiveConnection = cnn
...
'命令名称、任意参数、以及可选记录集。
cnn.<span class=cfe><b>yourCommandName</b></span> "parameter", rst</pre>
<p class=indent>
</p>
<p class=indent>
要执行存储过程，可以如同发出 <b>Connection</b> 对象的方法一样发出使用存储过程名称的语句，后面可带任何参数。ADO 将对参数类型进行“最佳判断”。例如：</p>
<pre>Dim cnn As New ADODB.Connection
...
'存储过程名称及任意参数。
cnn.<span class=cfe><b>sp_yourStoredProcedureName</b></span> "parameter"</pre>
</BODY>
</HTML>
