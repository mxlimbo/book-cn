<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>了解自定义文件</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdmscunderstandingcustomizationfile"></a>了解自定义文件</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmscUnderstandingCustomizationFile_C">
</object></p>
<p>
自定义文件中的每个节标头均由方括号 ([ ]) 及方括号内的类型和参数。4 个节类型由文字字符串 connect、sql、userlist 或 logs 表示。参数为文字字符串、默认值、用户指定的标识符或无。</p>
<p>
因此，每节都必须标记有以下节标头之一：</p>
<pre><b>[</b> <b>connect</b>   <b>default</b>      <b>]</b>
<b>[</b> <b>connect</b>   <i>identifier   </i><b>]</b>
<b>[</b> <b>sql         default</b>      <b>]</b>
<b>[</b> <b>sql         </b><i>identifier   </i><b>]</b>
<b>[</b> <b>userlist</b>   <i>identifier   </i><b>]</b>
<b>[ logs</b>                  <b>]</b>
</pre>
<p>
以下是节标头的组成部分：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>组成部分</b></td>
<td class=label width=50%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=50%><b>connect</b></td>
<td width=50%>文字字符串 — 该节修改连接字符串。</td>
</tr>
<tr valign=top>
<td width=50%><b>sql</b></td>
<td width=50%>文字字符串 — 该节修改命令字符串。</td>
</tr>
<tr valign=top>
<td width=50%><b>userlist</b></td>
<td width=50%>文字字符串 — 该节修改特定用户的访问权限。</td>
</tr>
<tr valign=top>
<td width=50%><b>logs</b></td>
<td width=50%>文字字符串 — 该节指定记录操作错误的日志文件。</td>
</tr>
<tr valign=top>
<td width=50%><b>default</b></td>
<td width=50%>文字字符串 — 如果没有指定或找到标识符，则使用该节。</td>
</tr>
<tr valign=top>
<td width=50%><i>identifier</i> </td>
<td width=50%>与连接或命令字符串相匹配的字符串。<ul type=disc>
<li>
如果节标头包含 <b>connect </b>而且连接字符串中有标识符字符串，则使用该节。 <br><br></li>
<li>
如果节标头包含 <b>sql </b>而且命令字符串含有标识符字符串，则使用该节。<br><br></li>
<li>
如果节标头含有 <b>userlist </b>而且标识符字符串与 <b>Connect </b>节标识符相匹配，则使用该节。</li>
</ul>
</td>
</tr>
</table><br>
<ul type=disc>
<li>
</li>
</ul>
<p>
<b>DataFactory </b>调用处理程序，传递客户端参数。处理程序在客户端参数中搜索与相应节标头的标识符匹配的完整字符串。如果找到匹配的字符串，该节的内容将应用于客户端的参数。</p>
<p>
下列情况可以使用特定的节：
<ul type=disc>
<li>
如果客户端连接字符串关键字“<b>Data Source</b>=value”中的值与 <b>Connect</b> 节的标识符相匹配，则使用 <b>Connect</b> 节。<br><br></li>
<li>
如果客户命令字符串含有与 <b>sql</b> 节标识符匹配的字符串，则使用 <b>sql</b> 节。 <br><br></li>
<li>
如果没有匹配的标识符，则使用带有默认参数的 <b>connect </b>或 <b>sql </b>节。<br><br></li>
<li>
如果 <b>userlist</b> 节标识符与 <b>connect</b> 节标识符匹配，则使用 <b>userlist</b> 节。如果有匹配的，<b>userlist</b> 节的内容将被应用于 <b>connect</b> 节决定的连接。 <br><br></li>
<li>
如果连接字符串或命令的字符串与任何 <b>connect</b> 或 <b>sql</b> 节标头的标识符不匹配，并且没有带默认参数的 <b>connect</b> 或 <b>sql</b> 节标头，那么未经修改即可使用客户字符串。<br><br></li>
<li>
无论何时操作 <b>DataFactory</b> 都可以使用 <b>logs</b> 节。 </li>
</ul>
</BODY>
</HTML>
