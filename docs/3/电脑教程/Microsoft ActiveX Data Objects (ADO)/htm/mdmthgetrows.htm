<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>GetRows 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthgetrows"></a>GetRows 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthGetRows_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthGetRows_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthGetRows_A">
</object></p>
<p>
将 Recordset 对象的多个记录恢复到数组中。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>array</i> = <i>recordset</i><b>.GetRows(</b> <b><i>Rows</i></b>, <b><i>Start</i></b>, <b><i>Fields </i>)</b></p>
<p class=label>
<b>返回值</b></p>
<p>
返回二维数组。</p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>Rows&nbsp;&nbsp;&nbsp;</i> </b>可选，<b>长整型</b>表达式，指定要检索记录数。默认值为 <b>adGetRowsRest</b> (-1)。</p>
<p>
<b><i>Start&nbsp;&nbsp;&nbsp;</i> </b>可选，<b>字符串</b>或<b>长整型</b>，计算得到在 <b>GetRows </b>操作开始处的记录的书签。也可使用下列 <b>BookmarkEnum</b> 值。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>常量</b></td>
<td class=label width=67%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdBookmarkCurrent</b></td>
<td width=67%>从当前记录开始。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdBookmarkFirst</b></td>
<td width=67%>从首记录开始。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdBookmarkLast</b></td>
<td width=67%>从尾记录开始。</td>
</tr>
</table><br>
<p>
<b><i>Fields&nbsp;&nbsp;&nbsp;</i></b>可选，<b>变体型</b>，代表单个字段名、顺序位置、字段名数组或顺序位置号。ADO 仅返回这些字段中的数据。</p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>GetRows </b>方法可将记录从 <b>Recordset </b>复制到二维数组中。第一个下标标识字段，第二个则标识记录号。当 <b>GetRows </b>方法返回数据时数组变量将自动调整到正确大小。</p>
<p>
如果不指定 <b>Rows </b>参数的值，<b>GetRows </b>方法将自动检索 <b>Recordset </b>对象中的所有记录。如果请求的记录比可用记录多，则 <b>GetRows </b>仅返回可用记录数。</p>
<p>
如果 <b>Recordset </b>对象支持书签，则可以通过传送该记录的 <a href="mdprobookmark.htm">Bookmark</a> 属性值，来指定 <b>GetRows </b>方法将从哪个记录开始检索数据。</p>
<p>
如要限制<b> GetRows</b> 调用返回的字段，则可以在<b><i> </i>Fields</b> 参数中传送单个字段名/编号或者字段名/编号数组。</p>
<p>
在调用<b> GetRows</b> 后，下一个未读取的记录成为当前记录，或者如果没有更多的记录，则 <a href="mdprobof.htm">EOF</a> 属性设置为 <b>True</b>。</p>
</BODY>
</HTML>
