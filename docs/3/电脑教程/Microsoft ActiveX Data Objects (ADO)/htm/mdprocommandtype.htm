<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>CommandType 属性</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdprocommandtype"></a>CommandType 属性</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproCommandType_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproCommandType_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdproCommandType_A">
</object></p>
<p>
指示 <a href="mdobjcommand.htm">Command</a> 对象的类型。</p>
<p class=label>
<b>设置和返回值</b></p>
<p>
设置或返回以下某个 <b>CommandTypeEnum</b> 值。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>常量</b></td>
<td class=label width=71%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=29%><b>AdCmdText</b></td>
<td width=71%>将 <a href="mdprocommandtext.htm">CommandText</a> 作为命令或存储过程调用的文本化定义进行计算。</td>
</tr>
<tr valign=top>
<td width=29%><b>AdCmdTable</b></td>
<td width=71%>将 <b>CommandText</b> 作为其列全部由内部生成的 SQL 查询返回的表格的名称进行计算。</td>
</tr>
<tr valign=top>
<td width=29%><b>AdCmdTableDirect</b></td>
<td width=71%>将 <b>CommandText</b> 作为其列全部返回的表格的名称进行计算。</td>
</tr>
<tr valign=top>
<td width=29%><b>AdCmdStoredProc</b></td>
<td width=71%>将 <b>CommandText</b> 作为存储过程名进行计算。</td>
</tr>
<tr valign=top>
<td width=29%><b>AdCmdUnknown</b></td>
<td width=71%>默认值。<b>CommandText</b> 属性中的命令类型未知。</td>
</tr>
<tr valign=top>
<td width=29%><b>adCmdFile</b></td>
<td width=71%>将 <b>CommandText</b> 作为持久 <a href="mdobjodbrec.htm">Recordset</a> 文件名进行计算。</td>
</tr>
<tr valign=top>
<td width=29%><b>AdExecuteNoRecords</b></td>
<td width=71%>指示 <b>CommandText</b> 为不返回行的命令或存储过程（例如，插入数据的命令）。如果检索任意行，则将丢弃这些行且并不返回。它总是与 <b>adCmdText</b> 或 <b>adCmdStoredProc</b> 进行组合。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>CommandType</b> 属性可优化 <b>CommandText</b> 属性的计算。</p>
<p>
如果 <b>CommandType</b> 属性的值等于 <b>adCmdUnknown</b>（默认值），系统的性能将会降低，因为 ADO 必须调用提供者以确定 <b>CommandText</b> 属性是 SQL 语句、还是存储过程或表格名称。如果知道正在使用的命令的类型，可通过设置 <b>CommandType</b> 属性指令 ADO 直接转到相关代码。如果 <b>CommandType</b> 属性与 <b>CommandText</b> 属性中的命令类型不匹配，调用 <a href="mdmthcmdexecute.htm">Execute</a> 方法时将产生错误。</p>
<p>
<b>adExecuteNoRecords</b> 常量通过最小化内部处理来提高性能。该常量不独立使用，它总是与 <b>adCmdText</b> 或 <b>adCmdStoredProc</b> 组合（如 adCmdText+adExecuteNoRecords）一起使用。如果与 <b>Recordset</b>.<b>Open</b> 一起使用 <b>adExecuteNoRecords</b>，或者该方法使用 <b>Command</b> 对象都将产生错误。</p>
</BODY>
</HTML>
