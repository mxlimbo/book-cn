<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>_Connection (ADO for VC++ 语法)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="mdidxconnectionvcppsyntax"></a>_Connection (ADO for VC++ 语法)</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdidxConnectionVCppSyntax_C">
</object></p>
<h3>方法</h3>
<p>
<a href="mdmthbegintrans.htm">BeginTrans</a>(long *<i>TransactionLevel</i>)<br>
<a href="mdmthbegintrans.htm">CommitTrans</a>(void)<br>
<a href="mdmthbegintrans.htm">RollbackTrans</a>(void)</p>
<p>
<a href="mdmthadocancel.htm">Cancel</a>(void)</p>
<p>
<a href="mdmthclose.htm">Close</a>(void)</p>
<p>
<a href="mdmthcnnexecute.htm">Execute</a>(BSTR <i>CommandText,</i> VARIANT *<i>RecordsAffected,</i> long <i>Options,</i> <br>
_ADORecordset **<i>ppiRset</i>)</p>
<p>
<a href="mdmthcnnopen.htm">Open</a>(BSTR <i>ConnectionString,</i> BSTR <i>UserID,</i> BSTR <i>Password,</i> long <i>Options</i>)</p>
<p>
<a href="mdmthopenschema.htm">OpenSchema</a>(SchemaEnum <i>Schema,</i> VARIANT <i>Restrictions,</i> VARIANT <i>SchemaID,<br>
</i> _ADORecordset **<i>pprset</i>)</p>
<h3>属性</h3>
<p>
<a href="mdproattributes.htm">get_Attributes</a>(long *<i>plAttr</i>)<br>
<b>put_Attributes</b>(long <i>lAttr</i>)</p>
<p>
<a href="mdprocommandtimeout.htm">get_CommandTimeout</a>(LONG *<i>plTimeout</i>)<br>
<b>put_CommandTimeout</b>(LONG <i>lTimeout</i>)</p>
<p>
<a href="mdproconnectionstring.htm">get_ConnectionString</a>(BSTR *<i>pbstr</i>)<br>
<b>put_ConnectionString</b>(BSTR <i>bstr</i>)</p>
<p>
<a href="mdproconnectiontimeout.htm">get_ConnectionTimeout</a>(LONG *<i>plTimeout</i>)<br>
<b>put_ConnectionTimeout</b>(LONG <i>lTimeout</i>)</p>
<p>
<a href="mdprocursorlocation.htm">get_CursorLocation</a>(CursorLocationEnum *<i>plCursorLoc</i>)<br>
<b>put_CursorLocation</b>(CursorLocationEnum <i>lCursorLoc</i>)</p>
<p>
<a href="mdprodefaultdatabase.htm">get_DefaultDatabase</a>(BSTR *<i>pbstr</i>)<br>
<b>put_DefaultDatabase</b>(BSTR <i>bstr</i>)</p>
<p>
<a href="mdproisolationlevel.htm">get_IsolationLevel</a>(IsolationLevelEnum *<i>Level</i>)<br>
<b>put_IsolationLevel</b>(IsolationLevelEnum <i>Level</i>)</p>
<p>
<a href="mdpromode.htm">get_Mode</a>(ConnectModeEnum *<i>plMode</i>)<br>
<b>put_Mode</b>(ConnectModeEnum <i>lMode</i>)</p>
<p>
<a href="mdproprovider.htm">get_Provider</a>(BSTR *<i>pbstr</i>)<br>
<b>put_Provider</b>(BSTR <i>Provider</i>)</p>
<p>
<a href="mdprostate.htm">get_State</a>(LONG *<i>plObjState</i>)</p>
<p>
<a href="mdproversion.htm">get_Version</a>(BSTR *<i>pbstr</i>)</p>
<p>
<a href="mdcolerrors.htm">get_Errors</a>(ADOErrors **<i>ppvObject</i>)</p>
<h3>事件</h3>
<p>
<a href="mdevtbegintranscomplete.htm">BeginTransComplete</a>(LONG <i>TransactionLevel,</i> ADOError *<i>pError,</i> <br>
EventStatusEnum *<i>adStatus,</i> _ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtbegintranscomplete.htm">CommitTransComplete</a>(ADOError *<i>pError,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtconnectconnectionevents.htm">ConnectComplete</a>(ADOError *<i>pError,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtconnectconnectionevents.htm">Disconnect</a>(EventStatusEnum *<i>adStatus,</i> _ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtexecutecomplete.htm">ExecuteComplete</a>(LONG <i>RecordsAffected,</i> ADOError *<i>pError,</i> <br>
EventStatusEnum *<i>adStatus,</i> _ADOCommand *<i>pCommand,</i> <br>
_ADORecordset *<i>pRecordset,</i> _ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtinfomessage.htm">InfoMessage</a>(ADOError *<i>pError,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtbegintranscomplete.htm">RollbackTransComplete</a>(ADOError *<i>pError,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtwillconnectevent.htm">WillConnect</a>(BSTR *<i>ConnectionString,</i> BSTR *<i>UserID,</i> BSTR *<i>Password,</i> <br>
long *<i>Options,</i> EventStatusEnum *<i>adStatus,</i> <br>
_ADOConnection *<i>pConnection</i>)</p>
<p>
<a href="mdevtwillexecuteevent.htm">WillExecute</a>(BSTR *<i>Source,</i> CursorTypeEnum *<i>CursorType,</i> <br>
LockTypeEnum *<i>LockType,</i> long *<i>Options,</i> <br>
EventStatusEnum *<i>adStatus,</i> _ADOCommand *<i>pCommand,</i> <br>
_ADORecordset *<i>pRecordset,</i> _ADOConnection *<i>pConnection</i>)</p>
</BODY>
</HTML>
