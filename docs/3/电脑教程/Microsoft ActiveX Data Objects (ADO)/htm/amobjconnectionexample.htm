<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Connection 范例</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="amobjconnectionexample"></a>Connection 范例</h2>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="amobjConnectionExample_C">
</object></p>
<p>
如下代码演示如何使用连接字符串设置 <a href="amproactiveconnection.htm">ActiveConnection</a> 属性。该代码假定在名为 Servername 的 OLAP 服务器上有一个名为 Bob Video Store 的数据源，并且使用的是 MSOLAP 数据提供者。</p>
<pre>Dim cat As New ADOMD.Catalog
cat.ActiveConnection = "Data Source=Servername;" + _
   "Initial Catalog=Bobs Video Store;Provider=msolap;"
</pre>
<p>
如下代码也演示如何使用连接字符串设置 <b>ActiveConnection </b>属性。但是，该代码使用 MSOLAP 数据提供者连接到本地立方文件，而不是连接到名为 Servername 的 OLAPT 服务器。</p>
<pre>Dim cat As New ADOMD.Catalog
cat.ActiveConnection = _
"Location=C:\MSDASDK\samples\oledb\olap\data\BobsVid.cub;" + _
"Provider=msolap;"
</pre>
<p>
如下代码演示如何将 <b>ActiveConnection </b>属性设置为标准的ADO <a href="mdobjconnection.htm">Connection</a> 对象。要使用 ADO <b>Connection </b>对象，必须在工程中引用 ADO 类型库。</p>
<pre>Dim cnn&nbsp;&nbsp;As New ADODB.Connection
Dim cat&nbsp;&nbsp;As New ADOMD.Catalog
Cnn.Open "Data Source=Servername;" + _
   "Initial Catalog=Bobs Video Store;Provider=msolap;"
Set cat.ActiveConnection = cnn
</pre>
<p class=indent>
<B><b>注意</b></B>&nbsp;&nbsp;&nbsp;在将 <b>ActiveConnection </b>属性设置为 <b>Connection</b> 对象时，记住要使用 <b>Set</b> 关键字。如果没有使用 <b>Set</b> 关键词，其结果是将 <b>ActiveConnection </b>属性设置成 <b>Connection</b> 的默认属性：<a href="mdproconnectionstring.htm">ConnectionString</a>。代码将会工作，但将创建与数据源的其他连接，最终得到相反的结果。</p>
</BODY>
</HTML>
