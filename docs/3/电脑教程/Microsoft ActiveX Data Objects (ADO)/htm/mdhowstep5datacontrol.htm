<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>步骤 5: 使用 DataControl（RDS 教程）</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdhowstep5datacontrol"></a>步骤 5: 使用 DataControl（RDS 教程）</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowStep5DataControl_C">
</object></p>
<p>
<b>您所在的步骤... </b>
<ul type=disc>
<li>
指定在服务器上调用的程序，并获得代理。<br><br></li>
<li>
调用服务器程序，将参数传递给表明数据源和所发命令的服务器程序。<br><br></li>
<li>
较为典型的是通过使用 ADO，服务器程序从数据源获得<b> Recordset</b> 对象。<br><br></li>
<li>
服务器程序将最终的 <b>Recordset </b>对象返回客户端应用程序。<br><br></li>
<li>
<b>在客户端，可选择将 Recordset 对象设置为可视控件易于使用的形式。</b><br><br></li>
<li>
将对 <b>Recordset</b> 对象的更改返回服务器，并用来更新数据源。</li>
</ul>
<p>
<b>讨论</b></p>
<p>
返回的<b> Recordset</b> 对象已经可以使用。可以对它进行同其他记录集一样的检查、定位或编辑。对记录集进行的操作取决于相应的环境。Microsoft Visual Basic 和 Visual C++ 都具有可直接地、或通过启用数据控件间接地使用 <b>Recordset</b> 的可视控件。</p>
<p>
例如，如果正在使用 Microsoft&reg; Internet Explorer 显示 Web 页，可能希望在可视控件中显示 <b>Recordset</b> 对象。Web 页上的可视控件无法直接访问<b> Recordset</b> 对象。但是，可以通过 <b>RDS.DataControl</b> 访问<b> Recordset</b> 对象（即<a href="mdhowdispbound.htm">绑定</a>)。当 <b>RDS.DataControl</b>的 <a href="mdprorecordset.htm">SourceRecordset</a> 属性设置为<b> Recordset</b> 对象时，<b>RDS.DataControl </b>便可被可视控件使用。</p>
<p>
使用可视控件对象须将其 <b>DATASRC</b> 参数设置为 <b>RDS.DataControl</b>，并将 <b>DATAFLD</b> 属性设置为 <b>Recordset </b>对象字段（列）。</p>
<p>
在本教程中，设置 <b>SourceRecordset</b> 属性。</p>
<pre>Sub RDSTutorial5()
Dim DS as New RDS.DataSpace
Dim RS as New ADODB.Recordset   '可选择 ADOR.Recordset
Dim DC as New RDS.DataControl
Dim DF as Object
Set DF = DS.<span class=cfe><b>CreateObject</b></span>("RDSServer.DataFactory", "http://yourServer")
Set RS = DF.<span class=cfe><b>Query</b></span> ("DSN=pubs", "SELECT * FROM authors")
DC.<span class=cfe><b>SourceRecordset</b></span> = RS         '可视控件现在可绑定到 DC。
...
</pre>
<p>
<B><b>下一页</b></B>&nbsp;&nbsp;&nbsp;<a href="mdhowstep6changessenttoserver.htm">步骤 6</a></p>
</BODY>
</HTML>
