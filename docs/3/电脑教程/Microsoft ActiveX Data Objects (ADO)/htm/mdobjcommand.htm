<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Command 对象</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdobjcommand"></a>Command 对象</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjCommand_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjCommand_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:属性">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjCommand_P">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:方法">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjCommand_M">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:集合">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdobjCommand_CO">
</object></p>
<p>
<b>Command</b> 对象定义了将对数据源执行的指定命令。</p>
<p>
<a href="mdobjconnection.htm"><img src="objconn.gif" border=0></a><br>
<img src="parchild.gif" border=0><img src="objcomma.gif" border=0><br>
<img src="space.gif" border=0><img src="parchild.gif" border=0><a href="mdcolparameters.htm"><img src="colparam.gif" border=0></a></p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>Command</b> 对象查询数据库并返回 <a href="mdobjodbrec.htm">Recordset</a> 对象中的记录，以便执行大量操作或处理数据库结构。取决于提供者的功能，某些 <b>Command</b> 集合、方法或属性被引用时可能会产生错误。</p>
<p>
可以使用 <b>Command</b> 对象的集合、方法、属性进行下列操作：
<ul type=disc>
<li>
使用 <b>CommandText</b> 属性定义命令（例如，SQL 语句）的可执行文本。<br><br></li>
<li>
通过 <a href="mdobjparameter.htm">Parameter</a> 对象和 <b>Parameters</b> 集合定义参数化查询或存储过程参数。<br><br></li>
<li>
可使用 <b>Execute</b> 方法执行命令并在适当的时候返回 <b>Recordset</b> 对象。<br><br></li>
<li>
执行前应使用 <b>CommandType</b> 属性指定命令类型以优化性能。<br><br></li>
<li>
使用 <b>Prepared</b> 属性决定提供者是否在执行前保存准备好（或编译好）的命令版本。<br><br></li>
<li>
使用 <b>CommandTimeout</b> 属性设置提供者等待命令执行的秒数。<br><br></li>
<li>
通过设置 <b>ActiveConnection</b> 属性使打开的连接与 <b>Command</b> 对象关联。<br><br></li>
<li>
设置 <b>Name</b> 属性将 <b>Command</b> 标识为与 <b>Connection</b> 对象关联的方法。<br><br></li>
<li>
将 <b>Command</b> 对象传送给 <b>Recordset</b> 的 <b>Source</b> 属性以便获取数据。</li>
</ul>
<p class=indent>
<B><b>注意</b></B>&nbsp;&nbsp;&nbsp;如果不想使用 <b>Command</b> 对象执行查询，请将查询字符串传送给 <b>Connection</b> 对象的 <b>Execute</b> 方法或 <b>Recordset</b> 对象的 <b>Open</b> 方法。但是，当需要使命令文本具有持久性并重新执行它，或使用查询参数时，则必须使用 <b>Command</b> 对象。</p>
<p>
要独立于先前已定义的 <a href="mdobjconnection.htm">Connection</a> 对象创建 <b>Command </b>对象，请将它的 <b>ActiveConnection</b> 属性设置为有效的连接字符串。ADO 仍将创建 <b>Connection</b> 对象，但它不会将该对象赋给对象变量。但是，如果正在将多个 <b>Command</b> 对象与同一个连接关联，则必须显式创建并打开 <b>Connection</b> 对象，这样即可将 <b>Connection</b> 对象赋给对象变量。如果没有将 <b>Command</b> 对象的 <b>ActiveConnection</b> 属性设置为该对象变量，则即使使用相同的连接字符串，ADO 也将为每个 <b>Command</b> 对象创建新的 <b>Connection</b> 对象。</p>
<p>
要执行 <b>Command</b>，只需通过它所关联的 <b>Connection</b> 对象的 <b>Name</b> 属性，将其简单调用即可。必须将 <b>Command</b> 的 <b>ActiveConnection</b> 属性设置为 <b>Connection</b> 对象。如果 <b>Command</b> 带有参数，则将这些参数的值作为参数传送给方法。</p>
<p>
如果在相同连接上执行两个或多个 <b>Command</b> 对象，并且某个 <b>Command</b> 对象是带输出参数的存储过程，这时会发生错误。要执行各个 <b>Command</b> 对象，请使用独立的连接或将所有其他 <b>Command</b> 对象的连接断开。</p>
</BODY>
</HTML>
