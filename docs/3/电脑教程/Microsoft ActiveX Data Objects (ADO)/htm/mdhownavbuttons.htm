<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>地址簿定位按钮</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h3><a name="mdhownavbuttons"></a>地址簿定位按钮</h3>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdhowNavButtons_C">
</object></p>
<p>
地址簿应用程序在 Web 页的底部显示定位按钮。通过选定数据的第一行或最后一行，或者通过选定与当前所选行相邻的行，可以使用定位按钮在<a href="mdhowabdatagrid.htm">网格显示</a>中给数据定位。</p>
<p>
下列代码定义定位按钮。这些 HTML 语句出现在程序的 VBScript 节之前。请复制并粘贴这些控件到引用它们的注释标记的后面。</p>
<pre>&lt;INPUT TYPE=BUTTON NAME="First"       VALUE="First"&gt;
&lt;INPUT TYPE=BUTTON NAME="Prev"       VALUE="Previous"&gt;
&lt;INPUT TYPE=BUTTON NAME="Next"      VALUE="Next"&gt;
&lt;INPUT TYPE=BUTTON NAME="Last"      VALUE="Last"&gt;
</pre>
<p>
HTML 使用标记 INPUT<b> </b>定义窗体元素，例如按钮、选项按钮、复选框或文本。参数<b> TYPE</b> 指定窗体元素的类型，在这里即是按钮。参数 <b>NAME </b>定义代码中按钮被调用的内容。参数<b> VALUE</b> 指定与页面中显示的按钮(“第一”、“上一个”、“下一个”和“最后”)关联的标签。</p>
<p>
用户单击按钮时，生成事件，VBScript 激活相应的定位子过程。</p>

<h4><a name="mdhownavonclick"></a>定位子过程</h4>
<p>
地址簿应用程序包含若干过程，使用户可以单击“第一”、“下一个”、“上一个”和“最后”按钮以便在数据中移动。要启用移动，可指定 <a href="mdobjdatacontrol.htm">RDS.DataControl</a> 对象 (Scontrol) 的方法为所需的移动类型。定位按钮的方法各不相同。</p>
<p>
例如，单击“第一”按钮激活 VBScript First_OnClick 子过程。该过程调用 <a href="mdmthmovefirstadc.htm">MoveFirst</a> 方法，使数据的第一行成为当前行。单击“最后”按钮激活 Last_OnClick 子过程，该过程调用 <b>MoveLast</b> 方法，使数据的最后行成为当前行。其余的定位按钮类似。请复制并粘贴该代码到标记 SCRIPT 和 /SCRIPT 之间。</p>
<pre>' 在绑定的记录集中移动到第一个记录。
Sub First_OnClick
   SControl.Recordset.MoveFirst
End Sub

' 在绑定的记录集中从当前位置移动到下一个记录。 
Sub Next_OnClick
   If SControl.Recordset.EOF Then   'cannot move beyond bottom record
      SControl.Recordset.MoveFirst 
      SControl.Recordset.MoveNext
      Exit Sub
   End If   

   SControl.Recordset.MoveNext

End Sub

' 在绑定的记录集中从当前位置移动到前一个记录。
Sub Prev_OnClick
   If SControl.Recordset.BOF Then   '移动无法超出顶端记录
      SControl.Recordset.MoveLast   '移出 BOF 缓冲区
      SControl.Recordset.MovePrevious
      Exit Sub
   End If
   SControl.Recordset.MovePrevious

End Sub

' 移动到绑定记录集的最后一个记录。
   SControl.Recordset.MoveLast
End Sub
</pre>
</BODY>
</HTML>
