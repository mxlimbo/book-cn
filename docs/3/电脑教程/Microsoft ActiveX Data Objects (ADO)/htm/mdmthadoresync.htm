<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Resync 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthadoresync"></a>Resync 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthADOResync_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthADOResync_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthADOResync_A">
</object></p>
<p>
从基本数据库刷新当前 <a href="mdobjodbrec.htm">Recordset</a> 对象中的数据。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset</i><b>.Resync</b> <b><i>AffectRecords, ResyncValues</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>AffectRecords&nbsp;&nbsp;&nbsp;</i></b>可选，<b>AffectEnum</b> 值，决定<b> Resync</b> 方法所影响的记录数目，可以为下列常量之一。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=28%><b>常量</b></td>
<td class=label width=72%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=28%><b>AdAffectCurrent</b></td>
<td width=72%>只刷新当前记录。</td>
</tr>
<tr valign=top>
<td width=28%><b>AdAffectGroup</b></td>
<td width=72%>刷新满足当前 <a href="mdprofilter.htm">Filter</a> 属性设置的记录。只有将 <b>Filter</b> 属性设置为有效预定义常量之一才能使用该选项。</td>
</tr>
<tr valign=top>
<td width=28%><b>AdAffectAll</b></td>
<td width=72%>默认值。刷新<b> Recordset</b> 对象中的所有记录，包括由于当前 <b>Filter</b> 属性设置而隐藏的记录。</td>
</tr>
<tr valign=top>
<td width=28%><b>adAffectAllChapters</b></td>
<td width=72%>刷新所有子集记录。</td>
</tr>
</table><br>
<p>
<b><i>ResyncValues&nbsp;&nbsp;&nbsp;</i></b>可选，<b>ResyncEnum </b>值。指定是否覆盖基本值。可为下列常量之一。</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=41%><b>常量</b></td>
<td class=label width=59%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=41%><b>AdResyncAllValues</b></td>
<td width=59%>默认值。覆盖数据，取消挂起的更新。</td>
</tr>
<tr valign=top>
<td width=41%><b>AdResyncUnderlyingValues</b></td>
<td width=59%>不覆盖数据，不取消挂起的更新。</td>
</tr>
</table><br>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>Resync</b> 方法将当前<b> Recordset</b> 中的记录与基本的数据库重新同步。这在使用静态或仅向前的游标但希望看到基本数据库中的改动时十分有用。</p>
<p>
如果将 <a href="mdprocursorlocation.htm">CursorLocation</a> 属性设置为 <b>adUseClient</b>，则 <b>Resync</b> 仅对非只读的 <b>Recordset </b>对象可用。</p>
<p>
与 <a href="mdmthadorequery.htm">Requery</a> 方法不同，<b>Resync</b> 方法不重新执行 <b>Recordset</b> 对象的基本的命令，基本的数据库中的新记录将不可见。</p>
<p>
如果由于与基本的数据冲突（如其他用户已将记录删除）而使重新同步的尝试失败，则提供者将警告返回到 <a href="mdcolerrors.htm">Errors</a> 集合并且产生运行时错误。使用 <b>Filter</b> 属性 (<b>adFilterConflictingRecords</b>) 和 <a href="mdprostatus.htm">Status</a> 属性可以找到发生冲突的记录。</p>
<p class=indent>
<B><b>远程数据服务用法</b></B>&nbsp;&nbsp;&nbsp;<b>Resync</b> 方法在客户端 <b>Recordset </b>上无效。</p>
<p class=indent>
如果设置了 <a href="mdprodynuniquetable.htm">Unique Table</a> 和 <a href="mdprodynresynccommand.htm">Resync Command</a> 动态属性，并且 <b>Recordset</b> 是对多个表执行 JOIN 操作的结果，那么，<b>Resync</b> 方法将仅对 <b>Unique Table</b> 属性中命名的表执行在 <b>Resync Command</b> 属性中所给定的操作。</p>
</BODY>
</HTML>
