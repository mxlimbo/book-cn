<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>Execute 方法 (ADO Connection)</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthcnnexecute"></a>Execute 方法 (ADO Connection)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCnnExecute_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCnnExecute_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthCnnExecute_A">
</object></p>
<p>
执行指定的查询、SQL 语句、存储过程或特定提供者的文本等内容。</p>
<p class=label>
<b>语法</b></p>
<p>
对于非按行返回的命令字符串：</p>
<p>
<i>connection</i><b>.Execute</b> <b><i>CommandText</i></b>, <b><i>RecordsAffected</i></b>, <b><i>Options</i></b> </p>
<p>
对于按行返回的命令字符串：</p>
<p>
<b>Set </b><i>recordset</i> = <i>connection</i><b>.Execute</b> <b>(<i>CommandText</i></b>, <b><i>RecordsAffected</i></b>, <b><i>Options</i>)</b></p>
<p class=label>
<b>返回值</b></p>
<p>
返回 <b>Recordset</b> 对象引用。</p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>CommandText&nbsp;&nbsp;&nbsp;</i></b> <b>字符串</b>，包含要执行的 SQL 语句、表名、存储过程或特定提供者的文本。</p>
<p>
<b><i>RecordsAffected&nbsp;&nbsp;&nbsp;</i> </b>可选，<b>长整型</b>变量，提供者向其返回操作所影响的记录数目。</p>
<p>
<b><i>Options&nbsp;&nbsp;&nbsp;</i> </b>可选，<b>长整型</b>值，指示提供者应如何计算 <b>CommandText</b> 参数，可为下列值：</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b>常量</b></td>
<td class=label width=67%><b>说明</b></td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdText</b></td>
<td width=67%>指示提供者应按命令的文本定义计算 <b>CommandText</b>。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdTable</b></td>
<td width=67%>指示 ADO 应生成 SQL 查询以便从<b><i> </i>CommandText</b> 命名的表中返回所有行。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdTableDirect</b></td>
<td width=67%>指示提供者应从<b><i> </i>CommandText</b> 命名的表中返回所有行。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdTable</b></td>
<td width=67%>指示提供者应按表名计算 <b>CommandText</b>。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdStoredProc</b></td>
<td width=67%>指示提供者应按存储过程计算 <b>CommandText</b>。</td>
</tr>
<tr valign=top>
<td width=33%><b>AdCmdUnknown</b></td>
<td width=67%>指示 <b>CommandText</b> 参数中的命令类型未知。</td>
</tr>
<tr valign=top>
<td width=33%><b>adAsyncExecute</b></td>
<td width=67%>指示命令应该异步执行。</td>
</tr>
<tr valign=top>
<td width=33%><b>adAsyncFetch</b></td>
<td width=67%>指示对在<b> CacheSize</b> 属性指定的初始数量之后的剩余行使用异步提取。</td>
</tr>
</table><br>
<p>
本列表中前 4 个常量的详细说明请参见 <a href="mdprocommandtype.htm">CommandType</a> 属性。</p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>Connection </b>对象的 <b>Execute </b>方法，可执行任何在指定连接的 <b>CommandText </b>参数中传送给方法的查询。如果 <b>CommandText </b>参数指定按行返回的查询，执行产生的任何结果将存储在新的 <b>Recordset </b>对象中。如果命令不是按行返回的查询，则提供者返回关闭的 <b>Recordset </b>对象。</p>
<p>
返回的 <b>Recordset </b>对象始终为只读、仅向前的游标。如需要具有更多功能的 <b>Recordset </b>对象，应首先创建具有所需属性设置的 <b>Recordset </b>对象，然后使用 <b>Recordset </b>对象的 <b>Open </b>方法执行查询并返回所需游标类型。</p>
<p>
<b>CommandText</b> 参数的内容对提供者是特定的，并可以是标准的 SQL 语法或提供者支持的任何特殊命令格式。</p>
<p>
该操作完成后将产生 <a href="mdevtexecutecomplete.htm">ExecuteComplete</a> 事件。</p>
</BODY>
</HTML>
