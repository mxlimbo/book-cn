<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=GB_2312-80">
<title>AddNew 方法</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="mdmthaddnew"></a>AddNew 方法</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:请参阅">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthAddNew_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:范例">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthAddNew_X">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:应用于">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="mdmthAddNew_A">
</object></p>
<p>
创建可更新 <a href="mdobjodbrec.htm">Recordset</a> 对象的新记录。</p>
<p class=label>
<b>语法</b></p>
<p>
<i>recordset</i><b>.AddNew</b> <b><i>FieldList</i>,</b> <b><i>Values</i></b></p>
<p class=label>
<b>参数</b></p>
<p>
<b><i>FieldList&nbsp;&nbsp;&nbsp;</i></b>可选。新记录中字段的单个名称、一组名称或序号位置。</p>
<p>
<b><i>Values&nbsp;&nbsp;&nbsp;</i></b>可选。新记录中字段的单个或一组值。如果 <i><b>Fields</b> </i>是数组，那么 <b><i>Values</i></b> 也必须是有相同成员数的数组，否则将发生错误。字段名称的次序必须与每个数组中的字段值的次序相匹配。</p>
<p class=label>
<b>说明</b></p>
<p>
使用 <b>AddNew</b> 方法创建和初始化新记录。通过 <b>adAddNew</b> 使用 <a href="mdmthsupports.htm">Supports</a> 方法可验证是否能够将记录添加到当前的 <b>Recordset</b> 对象。</p>
<p>
在调用 <b>AddNew</b> 方法后，新记录将成为当前记录，并在调用 <a href="mdmthupdate.htm">Update</a> 方法后继续保持为当前记录。如果 <b>Recordset </b>对象不支持书签，当移动到其他记录时将无法对新记录进行访问。是否需要调用 <a href="mdmthadorequery.htm">Requery</a> 方法访问新记录则取决于所使用的游标类型。</p>
<p>
如果在编辑当前记录或添加新记录时调用 <b>AddNew</b>，ADO 将调用 <b>Update </b>方法保存任何更改并创建新记录。</p>
<p>
<b>AddNew </b>方法的行为取决于 <b>Recordset </b>对象的更新模式以及是否传送 <b><i>Fields </i></b>和 <b><i>Values </i></b>参数。</p>
<p>
在立即更新模式（调用 <b>Update </b>方法时提供者会立即将更改写入基本数据源）下，调用不带参数的 <b>AddNew </b>方法可将 <b>EditMode </b>属性设置为 <b>adEditAdd</b>。提供者将任何字段值的更改缓存在本地。调用 <b>Update </b>方法可将新记录传递到数据库并将 <b>EditMode </b>属性重置为 <b>adEditNone</b>。如果传送了 <b>Fields </b>和 <b>Values </b>参数，ADO 则立即将新记录传递到数据库（无须调用 <b>Update</b>），且 <b>EditMode </b>属性值没有改变 (<b>adEditNone</b>)。</p>
<p>
在批更新模式（提供者缓存多个更改并只在调用 <a href="mdmthupdatebatch.htm">UpdateBatch</a> 时将其写入基本数据源）下，调用不带参数的 <b>AddNew </b>方法可将 <b>EditMode </b>属性设置为 <b>adEditAdd</b>。提供者将任何字段值的更改缓存在本地。调用 <b>Update </b>方法可将新的记录添加到当前记录集并将 <b>EditMode </b>属性重置为 <b>adEditNone</b>，但在调用 <b>UpdateBatch </b>方法之前提供者不将更改传递到基本数据库。如果传送 <b><i>Fields </i></b>和 <b><i>Values</i> </b>参数，ADO 则将新记录发送给提供者以便缓存；需要调用 <b>UpdateBatch </b>方法将新记录传递到基本数据库。</p>
<p>
如果 <a href="mdprodynuniquetable.htm">Unique Table</a> 动态属性被设置，并且 <b>Recordset</b> 是对多个表执行 JOIN 操作的结果，那么，<b>AddNew</b> 方法只能将字段插入到由 <b>Unique Table </b>属性所命名的表中。</p>
</BODY>
</HTML>
