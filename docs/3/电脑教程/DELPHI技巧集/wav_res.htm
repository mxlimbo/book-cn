<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>如何将Wav文件做到EXE文件里</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<p align="center"><big><big><big>如何将Wav文件做到EXE文件里 </big></big></big></p>

<p>使用过C++的朋友们都知道，资源在Windows编程里非常重要，合理地运用资源 
<br>
可以使程序更加灵活。其实在Delphi里，同样也可以制作资源，只不过Delphi本 
<br>
身对可视的编程强调很多，对资源的制作就没有多加解释，也没有象Borland 
<br>
C++ 里提供了资源制作工具Resource WorkShop，这些都没有关系，下面我就通 
<br>
过将WAV文件做成资源，从而编译进EXE文件来介绍一下如何利用Delphi本身 
<br>
提供的工具制作资源。 <br>
<br>
<br>
16位的Delphi 1.0和32位的Delphi2.0、3.0都提供了资源 <br>
编译工具，其中 Delphi 1.0的资源编译器叫BRCC.EXE，Delphi 2.0的资源编译器 
<br>
叫BRCC32.EXE 用来编译32位资源，所有资源编译器都只提供了命令行版本， 
<br>
没有提供Windows 版本。制作一个资源一般要通过以下几个步骤： <br>
<br>
<br>
1)编写.RC文件 <br>
<br>
<br>
..RC文件是资源的源文件，编译器也就编译这个文件，生成.RES的资源文件 
<br>
首先在我们的项目子目录中建立一个纯文本文件，起名叫Sound.rc，文件中 
<br>
有一行，内容为： <br>
<br>
<br>
SOUND1 WAV SOUND.WAV <br>
<br>
<br>
其中SOUND.WAV为一个Windows下普通的声音文件 <br>
<br>
<br>
2)编译它 <br>
<br>
<br>
在DOS的提示符下打 BRCC SOUND.RC 硬盘哗啦啦转一会儿后，就编译完了 <br>
<br>
<br>
3)制作程序 <br>
<br>
<br>
这也是最复杂，最灵活的一步，首先启动Windows, 再启动Delphi， 
并且将项目 <br>
中的文件保存到我们的项目中的子目录中。 在Unit1.pas中找这么一行 <br>
<br>
<br>
{$R *.DFM} <br>
<br>
<br>
把我们的资源文件就声明在后面 <br>
<br>
<br>
{$R SOUND.RES} <br>
<br>
<br>
然后，在Form1中声明两个全局变量 <br>
<br>
<br>
PtrSound : PChar; <br>
hRes : THandle; {handle to the loaded resource <br>
if 0 indicates nothing playing} <br>
<br>
<br>
再在Form1的Create事件中写下如下代码 <br>
<br>
<br>
procedure TForm1.FormCreate(Sender: TObject); <br>
var hResInfo : THandle; <br>
begin <br>
hResInfo := FindResource(HInstance, 'SOUND1', 'WAVE'); <br>
hRes := LoadResource(HInstance, hResInfo); <br>
if hRes &gt; 32 then {its a good load} <br>
begin {lock the resource} <br>
ptrSound:=LockResource(hRes); <br>
end; <br>
end; <br>
<br>
<br>
然后在Form1中放一个按钮Button1，写如下代码： <br>
<br>
<br>
procedure TForm1.Button1Click(Sender: TObject); <br>
begin <br>
sndplaysound(ptrSound,snd_async or snd_Memory); <br>
end; <br>
这时候就可以运行了，当然，这只是一个例子，只是提供了调用资源的 
<br>
一种方法，距离实际应用还有一段距离。愿这个Tip能给大家起个抛砖引 
<br>
玉的作用。 </p>
</body>
</html>
