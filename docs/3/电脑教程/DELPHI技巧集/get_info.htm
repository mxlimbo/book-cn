<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>使用Delphi获取系列信息</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<table>
  <tr>
    <td bgColor="#55002b" vAlign="top" width="672"><p align="center"><font color="#ffffff"
    face="黑体"><strong>使用Delphi获取系列信息</strong></font> </td>
  </tr>
  <tr align="left" vAlign="bottom">
    <td background="file://D:\99141302.htm/images/底纹.gif" width="672">　　Delphi以其优良的可视化编程，灵活的Windows 
    API接口，丰富的底层操作越来越受到编程爱好者的青睐。<br>
    　　在Delphi中，通过调用Windows API，可以很方便地获取系统信息，这有助于我们编写出更好的Windows应用程序。以下程序在Delphi3.0 
    For Windows 9x下编译通过。<br>
    　　<strong>一、 用GetDriveType函数获取磁盘信息</strong> <br>
    　　Lbl_DriveType:Tlabel;<br>
    　　DriveType:WORD; //定义驱动器类型变量<br>
    　　DriveType:=GetDriveType(RootPathName); //获得RootPathName所对应的磁盘驱动器信息<br>
    　　case DriveType of<br>
    　　DRIVE_REMOVABLE:Lbl_DriveType.Caption:= '软盘驱动器';<br>
    　　DRIVE_FIXED : Lbl_DriveType.Caption:= '硬盘驱动器';<br>
    　　DRIVE_REMOTE: Lbl_DriveType.Caption:= '网络驱动器';<br>
    　　DRIVE_CDROM: Lbl_DriveType.Caption:= '光盘驱动器';<br>
    　　DRIVE_RAMDISK: Lbl_DriveType.Caption:= '内存虚拟盘';<br>
    　　end; //将该磁盘信息显示在Lbl_DriveType中<br>
    　　<strong>二、 用GlobalMemoryStatus函数获取内存使用信息</strong><br>
    　　MemStatus: TMEMORYSTATUS; //定义内存结构变量<br>
    　　Lbl_Memory:Tlabel;<br>
    　　MemStatus.dwLength := size of(TMEMORYSTATU<br>
    S);<br>
    　　GlobalMemoryStatus(MemStatus); //返回内存使用信息<br>
    　　 Lbl_Memory.Caption := format('共有内存: %d KB 可用内存: 
    %dKB',[MemStatus.dwAvailPhys div 1024,MemStatus.dwTotalPhys div 1024]);<br>
    　　//将内存信息显示在Lbl_Memory中<br>
    　　<strong>三、 用GetSystemInfo函数获取CPU信息</strong><br>
    　　SysInfo: TSYSTEMINFO;<br>
    　　Lbl_CPUName:Tlabel;<br>
    　　GetSystemInfo(SysInfo);//获得CPU信息<br>
    　　case SysInfo.dwProcessorType of<br>
    　　PROCESSOR_INTEL_386:Lbl_CPUName.Caption:=format('%d%s',[SysInfo.dwNumber Of 
    Processors,'Intel80386']);<br>
    　　PROCESSOR_INTEL_486:Lbl_CPUName.Caption:=format('%d%s',[SysInfo.dwNumber Of 
    Processors, 'Intel 80486']);<br>
    　　PROCESSOR_INTEL_PENTIUM:Lbl_CPUName.Caption:=format('%d%s',[SysInfo.dwNum<br>
    berOfProcessors, 'Intel Pentium']);<br>
    　　PROCESSOR_MIPS_R4000:Lbl_CPUName.Caption:=format('%d%s',[SysInfo.dwNumberOfProcessors, 
    'MIPS R4000']);<br>
    　　PROCESSOR_ALPHA_21064:Lbl_CPUName.Caption:=format('%d%s',[SysInfo.dwNumberOfProcessors, 
    'ALPHA 21064']);<br>
    　　end;//把CPU信息显示在Lbl_CPUName中。(陕西　杨波) </td>
  </tr>
</table>
</body>
</html>
