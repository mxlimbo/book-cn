<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>任何动态改变/添加网络设置中的 TCP/IP 的 DNS 地址</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<p>[ 本文仅供参考 http://leonyxl.yeah.net/ ]<br>
<br>
题目：任何动态改变/添加网络设置中的 TCP/IP 的 DNS 地址<br>
<br>
<br>
例如，把 DNS Server的地址添加为192.0.0.1和192.1.1.0，可调用：<br>
SetTCPIPDNSAddresses('192.0.0.1 192.1.1.0') ;<br>
// 各地址之间用一个空格隔开<br>
<br>
1. SetTCPIPDNSAddresses 定义如下：<br>
<br>
procedure SetTCPIPDNSAddresses( sIPs : string );<br>
begin<br>
//<br>
// if using Windows NT<br>
//<br>
SaveStringToRegistry_LOCAL_MACHINE(<br>
'SYSTEM\CurrentControlSet' +<br>
'\Services\Tcpip\Parameters',<br>
'NameServer',<br>
sIPs );<br>
<br>
//<br>
// if using Windows 95<br>
//<br>
SaveStringToRegistry_LOCAL_MACHINE(<br>
'SYSTEM\CurrentControlSet' +<br>
'\Services\VxD\MSTCP',<br>
'NameServer',<br>
sIPs );<br>
end;<br>
<br>
2. 其中 SaveStringToRegistry_LOCAL_MACHINE 定义：<br>
uses Registry;<br>
<br>
procedure SaveStringToRegistry_LOCAL_MACHINE(<br>
sKey, sItem, sVal : string );<br>
var<br>
reg : TRegIniFile;<br>
begin<br>
reg := TRegIniFile.Create( '' );<br>
reg.RootKey := HKEY_LOCAL_MACHINE;<br>
reg.WriteString( sKey, sItem, sVal + #0 );<br>
reg.Free;<br>
end;<br>
<br>
//====================================</p>
</body>
</html>
