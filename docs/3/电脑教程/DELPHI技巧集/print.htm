<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>用Delphi编写打印程序的窍门</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<table>
  <tr>
    <td vAlign="top" width="672"><p align="center"><font color="#004080" face="黑体"><strong>用Delphi编写打印程序的窍门<br>
    </strong></font></td>
  </tr>
  <tr>
    <td vAlign="top" width="672"><p class="ourfont"><font color="#000000">&nbsp;&nbsp; 
    如果你想自己用Delphi编写一个打印程序，那么，下面这些技巧或许对你有所帮助。<br>
    1.获娶显示当前打印机的分辨率<br>
    Windows下的打印分辨对打印程序有着至关重要的作用，如果你想知道打印机的分辨率，请在程序中加入一行：ShowMessage(′水平分辨率′＋inttostr(GetDeviceCaps(printerHandle,LOGPIXELSX))＋chr(13)＋′垂直分辨率：′＋inttostr(GetDeviceCaps(printerHandle,LOGPIXELSY)));结果就一目了然了。<br>
    2.将结果直接送到打印机<br>
    Delphi提供了两种打印方式：一是将结果输送到Form，再调用Form的print方法将结果输送到打印机，二是将结果直接输送到打印机。如果你采用第一种方式，则无论你怎样调整Form的PrintScal属性，打印出来的东西也不会让你满意。因此建议采用第二种方式。<br>
    3.尽量不要使用AssignPrn<br>
    尽管AssignPrn简化了文本打印操作，使输出到打印机像输出到文件一样简单。但简单带来的是一系列的不方便：你无法知道当前打印的行数，无法准确控制行距，无法灵活改变字体字形等等。还是用打印机的Canvas属性进行打印吧。<br>
    4.用打印机的点数做度量单位<br>
    如果想让打印程序在任何打印机上都能正常地打印，你就必须改变你的度量单位。如果采用固定的度量，不同分辨率的打印效果是不同的。举例来讲：printerCanvasrectangle(0,0,360,720)在360×360的佳能4200SP上能打出一个1英寸宽、2英寸高的矩形，但在600×600的惠普6L上只能打出06英寸宽、12英寸高的矩形。使用打印机的点数做为度量单位是一个明智的选择。具体做法如下：VarPointX,PointY:integer;PointX:=GetDeviceCaps(printerHandle,LOGPIXELSX);PointY:=GetDeviceCaps(printerHandle,LOGPIXELSX);printerCanvasrectangle(0,0,PointX＊1,PointY＊2)这样，无论你使用什么样的打印机，都能得到一个1英寸宽、2英寸高的矩形。<br>
    5.添加打印程序单元<br>
    尽管Delphi在生成窗体时会自动在USES部分加入许多程序单元，但打印程序单元(Printers)却不在之列，要想使打印机正常工作和程序不出错，你还是老老实实手工给它加上吧。(湖北杨德军)<br>
    </font></td>
  </tr>
</table>
</body>
</html>
