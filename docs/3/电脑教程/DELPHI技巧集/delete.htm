<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>如何把文件删除到回收站中</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<p>[本文摘自BBS, 不能保证绝对正确, 仅供参考]<br>
<br>
题目： 如何把文件删除到回收站中<br>
<br>
例子如下：// Delphi<br>
<br>
program del;<br>
<br>
uses ShellApi;<br>
{ 利用ShellApi中: function SHFileOperation(const lpFileOp: TSHFileOpStruct): Integer; 
stdcall; }<br>
<br>
Var T:TSHFileOpStruct;<br>
P:String;<br>
begin<br>
P:='C:\Windows\System\EL_CONTROL.CPL';<br>
With T do<br>
Begin<br>
Wnd:=0;<br>
wFunc:=FO_DELETE;<br>
pFrom:=Pchar(P);<br>
fFlags:=FOF_ALLOWUNDO<br>
End;<br>
SHFileOperation(T);<br>
End.<br>
<br>
注意：<br>
1. 给出文件的绝对路径名，否则可能不能恢复；<br>
2. MS的文档说对于多个文件，每个文件名必须被#)字符分隔，而整个字符串必须用两个#0结束。 
<br>
<br>
<br>
<br>
<br>
</p>
</body>
</html>
