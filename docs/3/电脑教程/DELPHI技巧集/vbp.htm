<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>为VB应用程序定制浮动提示</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">

<table>
  <tr>
    <td vAlign="top" width="672"><p align="center"><font color="#004080" face="黑体"><strong>为VB应用程序定制浮动提示<br>
    </strong></font></td>
  </tr>
  <tr>
    <td vAlign="top" width="672"><p class="ourfont"><font color="#000000">&nbsp;&nbsp;&nbsp; 
    在Win95中，当我们将鼠标移至某个控件上时，便会在鼠标所指之处弹出一个小窗口，告诉我们这个控件的用途，这便是“浮动提示”。这种提示方式可以及时地提供有关信息，那么怎样在VB中实现这种功能呢?<br>
    &nbsp;&nbsp;&nbsp; 首先我们在Form的任意位置放一个Text1作为浮动提示的通用文本显示框，几个重要属性设置为：<br>
    &nbsp;&nbsp;&nbsp; Appearance:0－Flat<br>
    &nbsp;&nbsp;&nbsp; BackColor:窗口背景颜色<br>
    &nbsp;&nbsp;&nbsp; BorderStyle:1－FixedSingle<br>
    &nbsp;&nbsp;&nbsp; ForeColor:窗口文本颜色<br>
    &nbsp;&nbsp;&nbsp; Height:文本框高度，一般取286左右<br>
    &nbsp;&nbsp;&nbsp; Visible:False<br>
    &nbsp;&nbsp;&nbsp; 如果该Text1不是在所有按钮设置以后才放置的，则在显示在它之后放置的按钮的浮动提示时，浮动提示将被该按钮所掩盖，这时需要按Ctrl＋J或者在“Edit”菜单中选择“BringtoFront”将Text1带回前台。<br>
    &nbsp;&nbsp;&nbsp; 然后，在Module1通用模块中定义一个用于存放任意浮动提示文本的公共FloatMessage字符串变量： 
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    PublicFloatMessageAsString<br>
    &nbsp;&nbsp;&nbsp; 再在Form的General中加入一个如下公用函数，其功能是用一个文本框自动匹配和管理所有浮动提示： 
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PublicFunctionShowMessage()IfText1Visible=FalseThenText1Left=CurrentXText1Top=CurrentY′<br>
    &nbsp;&nbsp;&nbsp; 
    以上两句定制文本框显示的左上角坐标，下句计算文本框长度<br>
    &nbsp;&nbsp;&nbsp; Text1Width=TextWidth(FloatMessage)＋72<br>
    &nbsp;&nbsp;&nbsp; Text1Text=FloatMessage′初始化浮动提示信息<br>
    &nbsp;&nbsp;&nbsp; Text1Visible=True′显示浮动提示<br>
    &nbsp;&nbsp;&nbsp; EndIf′删除这个If循环将出现游走效果<br>
    &nbsp;&nbsp;&nbsp; EndFunction最后要做的就是在调用该函数的所有事件中为这个FloatMessage赋值。假如我们要为按钮Command1编制浮动提示，则在Command1的MouseMove事件中写入：<br>
    &nbsp;&nbsp;&nbsp; 
    PrivateSubCommand1_MouseMove(ButtonAsInteger,_ShiftAsInteger,XAsSingle,YAsSingle)<br>
    &nbsp;&nbsp;&nbsp; CurrentX=Command1Left＋X<br>
    &nbsp;&nbsp;&nbsp; CurrentY=Command1Top＋Y′<br>
    &nbsp;&nbsp;&nbsp; 
    以上根据按钮位置自动提取相对坐标并且加一个当前鼠标偏移量<br>
    &nbsp;&nbsp;&nbsp; FloatMessage=″ThisisCommand1Button″′浮动提示内容<br>
    &nbsp;&nbsp;&nbsp; ShowMessage<br>
    &nbsp;&nbsp;&nbsp; EndSub<br>
    &nbsp;&nbsp;&nbsp; 
    为了能在鼠标移开相关按钮后将相关浮动提示隐去，我们还须在Form事件中加入：<br>
    &nbsp;&nbsp;&nbsp; 
    PrivateSubForm_MouseMove(ButtonAsInteger,_ShiftAsInteger,XAsSingle,YAsSingle)<br>
    &nbsp;&nbsp;&nbsp; Text1Visible=False<br>
    &nbsp;&nbsp;&nbsp; EndSub本程序不仅仅适合于按钮提示，在任何支持MouseMove事件的控件中都可以运用，有兴趣不妨一试。<br>
    &nbsp;&nbsp;&nbsp; 以上程序均在486DX2/66、P133的Win95和VB40中调试通过。<strong>(湖南 
    陈川)</strong></font></td>
  </tr>
</table>
</body>
</html>
