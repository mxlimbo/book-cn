<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 1: Distributed File System</title>


</head>
<body>
<div class="prevnext"><p><a href="ch24a.htm">3</a> <a href="ch24c.htm">4</a></p></div>

<h1><a name="1733">Lesson 1: Distributed File System</a></h1>


<p>Dfs for Windows 2000 Server provides users with convenient access to shared folders that are distributed throughout a network. A single Dfs shared folder serves as an access point to other shared folders in the network.</p>

<hr />
<p><b>After this lesson, you will be able to</b></p>

<ul>
<li>Configure a standalone Dfs root</li>

<li>Configure a Dfs link</li>

<li>Configure a fault-tolerant Dfs root</li>
</ul>

<p><b>Estimated lesson time: 35 minutes</b></p>
<hr />

<h2><a name="1734">Dfs Overview</a></h2>


<p>Dfs is a single, logical, hierarchical file system. It organizes shared folders on different computers in a network to provide a logical tree structure for file system resources. Figure 24.1 shows how Dfs can organize resources that reside on different components of a network.</p>

<div class="figure">
<a href="javascript:fullSize('F24cc01x.htm')"><img src="images/F24cc01.JPG" /></a>
<div class="caption"><b>Figure 24.1</b> <i>An example of a Dfs share</i>
</div>
</div>

<p>Because the Dfs tree is a single point of reference, users can easily gain access to network resources regardless of the actual location of the underlying resources,. As Figure 24.1 demonstrates, accounting file system resources from multiple servers are organized in one logical Dfs root named Accounting.</p>

<p>A user who navigates a Dfs-managed shared folder does not need to know the name of the server on which the folder is shared. This simplifies network access because users no longer need to locate the server on which a specific resource resides. After connecting to a Dfs root, users can browse and gain access to all resources below the root, regardless of the location of the server on which the resource resides. In the example above, users needing access to accounting file resources would be able to find them in this one location.</p>

<p>A Dfs share uses a tree structure containing a root and Dfs links. To create a Dfs share, you must first create a Dfs root. Each Dfs root can have multiple Dfs links beneath it, each of which points to a shared folder on the network. The Dfs links of the Dfs root represent shared folders (&lt;<i>computer_name</i>&gt;<i>\</i>&lt;<i>share_name</i>&gt;<i>)</i> that can be physically located on different file servers.</p>

<p>The Table 24.1 describes the advantages of using Dfs.</p>

<p><b>Table 24.1</b> <i>Dfs Advantages</i></p>
<table>
<tr>
<th>Function</th>
<th>Advantages</th>
</tr><tr>
<td>Network administration</td>
<td>Dfs simplifies network administration. If a server fails, you can move a Dfs link from one server to another without users being aware of the change. All that is required to move a Dfs link is to modify the Dfs folder to refer to the new server location of the shared folders. Users continue to use the same Dfs path for the Dfs link.</td>
</tr><tr>
<td>Namespace</td>
<td>Clients access file resources by using a single namespace (the Dfs root), as opposed to mapping logical drive letters throughout the enterprise.</td>
</tr><tr>
<td>Memory overhead</td>
<td>Windows 2000 and Windows NT 4.0 clients use no additional memory because Dfs support is integrated with the Microsoft client redirector for both Windows 2000 and Windows NT 4.0. The Dfs Service for Microsoft Network Client must be installed on top of the Windows 95- and Windows 98-based Microsoft client redirector for this Windows 32-bit client to access a Dfs share. Without this service installed, Windows 95 and Windows 98 clients can access standard shares that are Dfs links of a Dfs root share.</td>
</tr><tr>
<td>Server replacement</td>
<td>Administrators can replace file servers without affecting the namespace used by network clients simply by updating the path for the new server in the Distributed File System snap-in.</td>
</tr><tr>
<td>Load balancing and fault tolerance</td>
<td>Dfs provides a level of load balancing and fault tolerance since clients randomly select a physical server to connect to from the list of alternates returned by the Dfs server.</td>
</tr><tr>
<td>Extensibility</td>
<td>The Dfs namespace can be extended at any time to incorporate additional disk space or new business requirements.</td>
</tr><tr>
<td>Network permissions</td>
<td>Dfs preserves network permissions. No additional permissions or security are required because Dfs volumes use existing Windows 2000 file and directory permissions. Access compatibility lists (ACLs) on Windows 2000 fault-tolerant replicas are replicated.</td>
</tr><tr>
<td>Client caching</td>
<td>Dfs clients cache frequently used network resources without experiencing delays locating servers. The first access to a new area of the Dfs tree incurs a slight performance loss (analogous to performing a Net Use command). Caching this data eliminates any performance penalty for subsequent accesses until the client is rebooted or the cache expires.</td>
</tr><tr>
<td>Internet Services (IIS) integration</td>
<td>Dfs works with IIS. Links made to other pages stored in Dfs Information do not have to be updated if the initial page is physically moved from one server to another, provided an administrator reconfigures Dfs accordingly. If the server hosting an Internet page is removed and the page is republished elsewhere, the links on that page do not have to be reconfigured.</td>
</tr>
</table>

<h3><a name="1735">Limits of Dfs</a></h3>


<p>Table 24.2 details the limitations of Dfs.</p>

<p><b>Table 24.2</b> <i>Dfs limitations</i></p>
<table>
<tr>
<th>Description</th>
<th>Limit</th>
</tr><tr>
<td>Maximum number of characters per file path</td>
<td>260</td>
</tr><tr>
<td>Maximum number of alternates per volume</td>
<td>32</td>
</tr><tr>
<td>Maximum number of Dfs roots per server</td>
<td>1</td>
</tr><tr>
<td>Maximum number of Dfs roots per domain</td>
<td>Unlimited</td>
</tr><tr>
<td>Maximum number of volumes hosted in a domain or enterprise</td>
<td>Limited by system resources. Six thousand have been successfully tested in standalone roots.</td>
</tr>
</table>

<h2><a name="1736">Types of Dfs Roots</a></h2>


<p>The Dfs Service is automatically installed with the installation of Windows 2000 Server. The service can be paused, stopped, and started but not removed from the operating system.</p>

<p>Two types of Dfs roots can be configured on Windows 2000 Servers: standalone Dfs roots and domain Dfs roots (sometimes called fault-tolerant Dfs roots).</p>

<h3><a name="1737">Standalone Dfs Roots</a></h3>


<p>The following characteristics are common to standalone Dfs roots:</p>

<ul>
<li>Standalone Dfs information is stored in the local registry.</li>

<li>A standalone Dfs root permits a single level of Dfs links.</li>

<li>When using the Distributed File System snap-in to connect to existing standalone Dfs roots, all servers known to the browse list are retrieved since there is no unique NetBIOS name registered by Dfs-enabled servers.</li>

<li>Standalone Dfs roots can be located on all supported file systems, although locating resources on NTFS formatted partitions is recommended.</li>

<li>Standalone Dfs roots offer no replication or backup; consequently, the Dfs root represents a single point of failure. You can create a replica from a standalone Dfs root; however, file replication services are not available.</li>
</ul>

<h3><a name="1738">Domain Dfs Roots</a></h3>


<p>The following characteristics are common to Dfs fault-tolerant roots:</p>

<ul>
<li>In a domain Dfs root, multiple servers hand out referrals for the Dfs namespace. Fault-tolerant Dfs roots use Active Directory services to store Dfs tree topology and remove the root as a single point of failure.</li>

<li>A fault-tolerant Dfs root is stored in Active Directory services and replicated to every participating Dfs root server. Changes to a Dfs tree are automatically synchronized with Active Directory services. This ensures that you can always restore a Dfs tree topology if the Dfs root is offline for any reason. You can also implement fault tolerance at the file and content levels by assigning alternate resources to a Dfs volume. Any Branch node on the Dfs tree can be serviced by a set of replicated resources. If a client connection to one alternate resource fails for any reason, the Dfs client attempts to connect to another. The Dfs client cycles through the alternates until an available one is found.</li>

<li>Fault-tolerant roots must be located on NTFS version 5.0 formatted partitions.</li>

<li>The list of domains and servers is populated by querying the global catalog for all fault-tolerant Dfs roots (ObjectClass = ftDfs).</li>

<li>Dfs replication topology uses the existing Active Directory replication topology.</li>
</ul>

<h2><a name="1739">Configuring Dfs</a></h2>


<p>Windows 2000 allows you to configure standalone Dfs roots, Dfs links, and domain Dfs roots.</p>

<h3><a name="1740">Configuring a Standalone Dfs Root</a></h3>


<p>Standalone Dfs stores the Dfs topology on a single computer. This type of Dfs provides no fault tolerance if the computer that stores the Dfs topology or any of the shared folders that Dfs uses fails.</p>

<p>A standalone Dfs root is physically located on the server to which users initially connect. The first step in setting up standalone Dfs is to create the Dfs root.</p>

<p>To create a standalone Dfs root, use the Distributed File System snap-in to start the New Dfs Root wizard. Figure 24.2 shows the Select The Dfs Root Type screen with the Create A Stand-Alone Dfs Root radio button selected.</p>

<div class="figure">
<a href="javascript:fullSize('F24cc02x.htm')"><img src="images/F24cc02.JPG" /></a>
<div class="caption"><b>Figure 24.2</b> <i>Creating a standalone Dfs root from the Distributed File System snap-in</i>
</div>
</div>


<p>Table 24.3 describes the screens within the wizard and what actions you can take to configure the new Dfs root.</p>

<p><b>Table 24.3</b> <i>Dfs Root Wizard Actions</i></p>
<table>
<tr>
<th>Screen</th>
<th>Actions</th>
</tr><tr>
<td>Select The Dfs Root Type</td>
<td>Select the Create A Stand-Alone Dfs Root option (Figure 24.2).</td>
</tr><tr>
<td>Specify The Host Server For The Dfs Root</td>
<td>Enter the initial connection point for all resources in the Dfs tree. You can create a Dfs root on any computer running Windows 2000 Server.</td>
</tr><tr>
<td>Specify The Dfs Share</td>
<td>Enter a shared folder to host the Dfs root. You can choose an existing shared folder or create a new share.</td>
</tr><tr>
<td>Name The Dfs Root</td>
<td>Enter a descriptive name in the Comment text box for the Dfs root.</td>
</tr><tr>
<td>Completing The New Root wizard</td>
<td>Review the settings for the Host Server, Root Share, and Root Name text boxes. Click Back if you need to make changes, or click Finish to complete the setup process.</td>
</tr>
</table>

<h3><a name="1741">Configuring a Domain Dfs Root</a></h3>


<p>Domain Dfs writes the Dfs topology to the Active Directory store. This type of Dfs allows Dfs links to point to multiple identical shared folders (also called replicas) for fault tolerance. In addition, it supports Domain Name System (DNS), multiple levels of child volumes, and file replication.</p>

<p>To create a fault-tolerant Dfs root, use the Distributed File System tool to start the New Dfs Root wizard.</p>

<h3><a name="1742">Configuring New Dfs Links</a></h3>


<p>Users can browse folders under a Dfs root without knowing where the referenced resources are physically located. After you create a Dfs root, you can create Dfs links (also known as Child nodes).</p>

<p>To create a Dfs link, open the Distributed File System snap-in, and click the Dfs root to which you will attach a Dfs link. On the Action menu, click New Dfs Link. The Create A New Dfs Link dialog box appears, as shown in Figure 24.3.</p>

<div class="figure">
<a href="javascript:fullSize('F24cc03x.htm')"><img src="images/F24cc03.JPG" /></a>
<div class="caption"><b>Figure 24.3</b> <i>Creating a New Dfs Link off a public Dfs root for a human resources share</i>
</div>
</div>


<p>Table 24.4 describes the option in the dialog box.</p>

<p><b>Table 24.4</b> <i>Create A New Dfs Link Dialog Box Options</i></p>
<table>
<tr>
<th>Option</th>
<th>Description</th>
</tr><tr>
<td>Link Name</td>
<td>The name below the Dfs root that users will see when they connect to Dfs.</td>
</tr><tr>
<td>Send the user to this shared folder</td>
<td>The UNC name for the actual location of the shared folder the Dfs link refers to. Note that the Dfs host server must be able to access any shared folders referred to in a Dfs link.</td>
</tr><tr>
<td>Comment</td>
<td>Additional information (optional) to help keep track of the shared folder (for example, the actual name of the shared folder).</td>
</tr><tr>
<td>Clients cache this Dfs referral for <i>x</i> seconds</td>
<td>Length of time for which clients cache a referral to a Dfs link. After the referral time expires, a client queries the Dfs server about the location of the Dfs link, even if the client has previously established a connection with the Dfs link.</td>
</tr>
</table>

<p>The Dfs link appears below the Dfs root volume in the Distributed File System tool and appears to a Dfs-enabled client as a folder below the Dfs root. Figure 24.4 shows the appearance of a Dfs root named \\Server02\Public and a Dfs link on another server.</p>

<div class="figure">
<a href="javascript:fullSize('F24cc04x.htm')"><img src="images/F24cc04.JPG"  alt = "Click to view at full size." /></a>
<div class="caption"><b>Figure 24.4</b> <i>A Dfs root and a Dfs link as they appear in the Distributed File System snap-in and how they appear on a Dfs-enabled client</i>
</div>
</div>

<p><img src="images/practice.jpg" /></p>

<h2><a name="1743">Practice: Creating a Dfs Root and Dfs Link</a></h2>


<p>In this practice, you configure shares, create a standalone Dfs root, and then create Dfs links.</p>

<h3><a name="1744">Exercise 1: Creating Directories and Shares</a></h3>


<p>In this exercise, you create or use existing folders and create shares for the folders. You can use any method you prefer to create folders and shares or follow the steps in this exercise.</p>

<ol>
<li>Log on to Server01 as Administrator with a password of <i>password</i>.</li>

<li>Open My Computer on the desktop.
<p>The My Computer window appears.</p></li>

<li>Open Local Disk (H:).</li>

<li>From the File menu, select New, and then select Folder.
<p>A folder named New Folder appears in the Local Disk (H:) window, and the blinking cursor appears inside the New Folder box.</p></li>

<li>Rename the folder &quot;Public.&quot;</li>

<li>Select the Public folder, and from the File menu, choose Sharing.
<p>The Public Properties dialog box appears.</p></li>

<li>Select the Share This Folder radio button, and in the Comment text box, type <b>Dfs root share</b>.</li>

<li>Click OK.
<p>The Public folder appears with a hand underneath the folder.</p></li>

<li>Repeat steps 2 to 8 to create the folders and shares listed in the following table, using default permissions.
<p>Be aware that in some cases, the folders will be created on drive letters other than H:, and in one case a share will be created on Server02 to a folder that already exists.</p></li>
</ol>

<table>
<tr>
<th><i>Computer name</i></th>
<th><i>Drive</i></th>
<th><i>Folder</i></th>
<th><i>Share name</i></th>
<th><i>Purpose/ Comment</i></th>
</tr><tr>
<td>Server02</td>
<td>C:</td>
<td>\Inetpub\wwwroot</td>
<td>internal</td>
<td>Internal Web content</td>
</tr><tr>
<td>Server01</td>
<td>H:</td>
<td>\Press</td>
<td>Press</td>
<td>Current press releases</td>
</tr><tr>
<td>Server01</td>
<td>C:</td>
<td>\Inetpub\ftproot</td>
<td>ftproot</td>
<td>FTP root directory mapped partition</td>
</tr><tr>
<td>Server01</td>
<td>I:</td>
<td>\dev\TechDocs</td>
<td>TechDocs</td>
<td>Technical documents area</td>
</tr><tr>
<td>Server01</td>
<td>C:</td>
<td>\Public\Press</td>
<td>PressRepl</td>
<td>Current press releases replica</td>
</tr>
</table>

<h3><a name="1745">Exercise 2: Creating a Standalone Dfs Root on Server01</a></h3>


<p>In this exercise, you create a standalone Dfs root to host the shares created in exercise 1.</p>

<ol>
<li>Click the Start button, point to Programs, point to Administrative Tools, and then click Distributed File System.
<p>The Distributed File System snap-in appears.</p></li>

<li>Read the message displayed in the right pane.</li>

<li>On the Action menu, click New Dfs Root.
<p>The New Dfs Root wizard appears.</p></li>

<li>Read the information on the Welcome To The New Dfs Root Wizard, and then click Next.</li>

<li>On the Select The Dfs Root Type screen, notice that there are two types of Dfs you can create:

<ul>
<li>A domain Dfs root that writes the Dfs tree topology to the Active Directory store and supports DNS, and file replication</li>

<li>A standalone Dfs root that does not use Active Directory service and does not support automatic file replication</li>
</ul>

<p>Because you have not configured a domain controller at this point in your training, you will create a standalone Dfs root.</p></li>

<li>Select the Create A Stand-Alone Dfs Root radio button, and then click Next.</li>

<li>On the Specify The Host Server For The Dfs Root screen, confirm that SERVER01 is displayed, and then click Next.
<p>On the Specify The Dfs Root Share screen, specify a share you created in Exercise 1.</p>
<p>Notice that you can use an existing share for the Dfs root, or the wizard can create a new shared folder for you.</p></li>

<li>Verify that the Use An Existing Share radio button is selected, and then from the drop-down menu, select Public.</li>

<li>Click Next.</li>

<li>In the Comment text box appearing on the Name The Dfs Root screen, type <b>Public access share</b> and then click Next.</li>

<li>Review the settings appearing on the Completing The New Dfs Root Wizard screen, and then click Finish.</li>

<li>The Distributed File System snap-in appears and the Dfs root is configured on SERVER01 to Public.</li>
</ol>

<h3><a name="1746">Exercise 3: Creating Dfs Links</a></h3>


<p>In the following exercise, you create Dfs links below the \\SERVER01\Public Dfs root.</p>

<ol>
<li>In the left pane of the Distributed File System snap-in, select \\SERVER01\Public.</li>

<li>Click on the Action menu, and notice that New Root Replica and Replication Policy are not available.</li>

<li>Click New Dfs Link.
<p>The Create A New Dfs Link dialog box appears.</p></li>

<li>In the Link Name text box, type <b>intranet</b>.</li>

<li>Click Browse.
<p>The Browse For Folder window appears.</p></li>

<li>Expand the + sign to the left of Computers Near Me.</li>

<li>Expand the + sign to the left of Server02, and then click internal and click OK.
<p>The Send The User To This Shared Folder text box contains \\Server02\internal.</p></li>

<li>In the Comment text box, type <b>Internal Web content</b> and click OK.</li>

<li>Always begin this step by clicking on \\SERVER01\Public in the Distributed File System snap-in, and then repeat steps 3-8 to create new Dfs links using information in the following table:</li>
</ol>

<table>
<tr>
<th>Link name</th>
<th>Send the user to this shared folder</th>
<th>Comment</th>
</tr><tr>
<td>news</td>
<td>\\Server01\Press</td>
<td>Current Press Releases</td>
</tr><tr>
<td>ftp</td>
<td>\\Server01\ftproot</td>
<td>FTP Root Directory</td>
</tr><tr>
<td>tech</td>
<td>\\Server01\TechDocs</td>
<td>Technical Documents Area</td>
</tr>
</table>

<blockquote><div class="note"><b>NOTE</b><hr />
Rather than browsing for a share, you can enter the server and share name using standard UNC syntax.</div></blockquote>

<h3><a name="1747">Exercise 4: Creating a Dfs Replica</a></h3>


<p>In the following exercise, you create a replica of the News Dfs link. This Dfs link points to the H:\Press folder shared as Press, and the replica is stored on C:\Public\Press folder, which is shared as PressRepl.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
Because you created a standalone Dfs link, files must be manually copied or synchronized between the two folders. File replication services are not available for replicas created on a standalone Dfs link.</div></blockquote>

<ol>
<li>Select the News link in the left pane of the Distributed File System snap-in.</li>

<li>On the Action menu, click New Replica.
<p>The Add A New Replica dialog box appears.</p></li>

<li>In the Send The User To This Shared Folder text box, type <b>\\SERVER01\PressRepl</b>. Notice that no replication policy can be configured for this replica.</li>

<li>Click OK.
<p>In the right pane both the \\SERVER01\Press and \\SERVER01\PressRepl shares appear.</p></li>
</ol>

<h3><a name="1748">Exercise 5: Accessing the Dfs on Server01</a></h3>


<p>In this exercise, you use the batch file provided with this training kit to copy files to Dfs links created in Exercises 1 to 3. After the files are copied, you access the files through Windows Explorer.</p>

<p><img src="images/cdrom.jpg" /></p>
<blockquote><div class="caution"><b>IMPORTANT</b><hr />
The batch file included with this training kit will work properly only if both servers are running, the shares are created exactly as specified in this practice, and the Administrator account password is <i>password</i> on both computers.</div></blockquote>

<ol>
<li>Insert the Windows 2000 Server Training Supplemental CD-ROM into the CD-ROM drive in Server01.</li>

<li>Open the CD-ROM drive from My Computer.</li>

<li>Open the \chapt24\ex1 folder</li>

<li>Click on the ex1copy.bat file, and from the File menu click Open.
<p>A command window opens as files are copied to the Dfs links, and then the command window closes.</p>
<p>Complete all of the remaining steps in this exercise from Server02.</p></li>

<li>To access the standalone Dfs root on Server01 from Server02, open My Network Places and then open Computers Near Me.
<p>The Computers Near Me windows appears showing all computers in the workgroup.</p></li>

<li>Click on Server01, and from the File menu click Open.
<p>All shares and the Dfs root (Public) appear along with other objects on Server01. Notice that the Public folder appears like any share on Server01.</p></li>

<li>Click on the Public folder, and from the File menu click Open.
<p>The four Dfs links created in Exercise 3 appear.</p></li>

<li>Open each folder and verify that the following files are present.</li>
</ol>

<table>
<tr>
<th>Folder</th>
<th>File(s)</th>
</tr><tr>
<td>ftp</td>
<td>dirmap.htm, dirmap.txt</td>
</tr><tr>
<td>intranet</td>
<td>Q240126 - Best Practices for Using Sysprep with NTFS Volumes.htm</td>
</tr><tr>
<td>news</td>
<td>press.wri</td>
</tr><tr>
<td>tech</td>
<td>Dfsnew.doc, RFS 1777.txt</td>
</tr>
</table>

<p>Note that the intranet folder will contain additional files, since this folder points to a directory created during the installation of Windows 2000 Server.</p>

<p>Which folder represents a location on a server other than Server01?</p>

<p>Which folder represents a mounted drive to a previously empty folder?</p>

<p>Earlier in this exercise, you created a replica of the Press Dfs link. The name of that replica is \\SERVER01\PressRepl. This Dfs link is a shared folder by the name of PressRepl and is located in C:\Public\Press. If you examine the contents of this directory, you will notice that it is empty. However, when you view the News Dfs link, you will notice that there is a file named Press.wri. Why is the PressRepl Dfs replica empty?</p>

<blockquote><div class="tip"><b>TIP</b><hr />
You can use the Distributed File System snap-in to check the status of the Dfs links and to open a window to the contents of the link.</div></blockquote>

<h2><a name="1749">Lesson Summary</a></h2>


<p>Dfs provides a convenient way for users to access shared folders that are distributed throughout a network. A single Dfs shared folder, called a Dfs root, serves as an access point to other shared folders in the network, called Dfs links. Dfs organizes shared folders on different computers in a network into a single, logical, hierarchical file system. Dfs facilitates network navigation and administration while preserving network permissions. Two types of Dfs roots can be configured on Windows 2000 Servers: standalone Dfs roots and domain Dfs roots. Standalone Dfs stores the Dfs topology on a single computer. This type of Dfs provides no fault tolerance if the computer that stores the Dfs topology or any of the shared folders that Dfs uses fail. Domain Dfs writes the Dfs topology to the Active Directory store. This type of Dfs allows Dfs links to point to multiple identical shared folders and supports file replication for fault tolerance. In addition, it supports DNS and multiple levels of Dfs links. Dfs uses the FRS to replicate data in domain Dfs roots and domain Dfs links. When changes are made to a Dfs link that is part of a domain Dfs root, the changes are automatically replicated to other replica members.</p>

</body>
</html>



