<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 1: Installing Windows 2000 Server</title>


</head>
<body>
<div class="prevnext"><p><a href="ch08a.htm">3</a> <a href="ch08c.htm">4</a></p></div>

<h1><a name="581">Lesson 1: Installing Windows 2000 Server</a></h1>


<p>Before you can begin to install Windows 2000 Server, you must prepare for the installation by gathering information and making decisions about how you want to install the software. Once you have performed all the necessary steps to prepare for a Windows 2000 Server installation, you are ready to begin the Windows 2000 setup process. This lesson focuses on gathering the information and performing a new installation of Windows 2000 Server.</p>

<hr />
<p><b>After this lesson, you will be able to</b></p>
<ul>
<li>Prepare to install Windows 2000 Server by completing preinstallation tasks such as identifying hardware requirements and gathering the necessary installation information</li>
<li>Determine which setup program you should use to install Windows 2000 Server</li>
<li>Describe the three stages of the installation process</li>
<li>Perform a new installation of Windows 2000 Server</li>
</ul>
<p><b>Estimated lesson time: 90 minutes</b></p>
<hr />

<h2><a name="582">Preparing for Installation</a></h2>


<p>During installation, the Windows 2000 Setup program asks you to provide information about how to install and configure Windows 2000. You should gather all the necessary information. Good preparation helps you avoid problems during and after the installation.</p>

<p>Before you begin your Windows 2000 installation, review the list of tasks outlined in Table 8.1. Each task is discussed in greater detail in the sections that follow. For now, you need only complete the first two tasks listed in the table: verifying that your computer meets the minimum hardware requirements and checking hardware compatibility. The remaining tasks are completed during the actual installation of Windows 2000 Server, which you will perform in the exercises later in this chapter. The information in this table is meant only to prepare you so you know what to expect and can install Windows 2000 Server later without any unnecessary delays.</p>

<p><b>Table  8.1 </b><i>Pre-installation Checklist</i></p>

<table>
<tr><th>Task</th><th> </th></tr>

<tr><td>Verify that your computer meets the minimum hardware n 
requirements. For example, your hard disk should meet the 
minimum space requirements and preferably have a minimum 
of 2 gigabytes (GB) of free disk space.</td>
<td><img src="images/UntiHE10.JPG" /></td></tr>

<tr><td>Check all hardware (network adapters, video drivers, sound n 
cards, CD-ROM drives, PC cards, and so on) for compatibility 
by checking them against the Windows 2000 Hardware 
Compatibility List (HCL).</td><td> </td></tr>

<tr><td>Identify how you want to partition the hard disk drive on which n 
you are going to install Windows 2000 Server.</td><td><img src="images/UntiHE10.JPG" /></td></tr>

<tr><td>Choose a file system that meets your requirements and provides n 
the services you need. Choose NTFS unless you need to run more 
than one operating system on your computer.</td><td><img src="images/UntiHE10.JPG" /></td></tr>

<tr><td>Select a licensing mode. You can switch to Per Seat from Per Server n 
mode after installation, but not to Per Server from Per Seat mode.</td><td><img src="images/UntiHE10.JPG" /></td></tr>

<tr><td>Choose the type of network group (workgroup or domain) your com- n 
puter will join. If you will be joining a domain, you need additional 
information such as the domain name and the computer account name 
created for you. With an administrator account and password in the 
domain, you can create a computer account in the domain.</td>
<td><img src="images/UntiHE10.JPG" /></td></tr>

<tr><td>Determine whether to perform a new installation or upgrade an n 
existing version of Windows NT Server. Windows NT 4.0 
Workstation, Windows 95 and Windows 98 cannot be upgraded 
to Windows 2000 Server.</td><td><img src="images/UntiHE10.JPG" /></td></tr>

<tr><td>Select an installation method: using Setup disks, from a CD-ROM, n 
or from over the network.</td><td><img src="images/UntiHE10.JPG" /></td></tr>

<tr><td>Choose which components you need to install, such as Networking n 
Services or Microsoft Indexing Service.</td><td><img src="images/UntiHE10.JPG" /></td></tr>
</table>

<p>In addition to the tasks in the checklist, there is more information you need to know that will help you prepare for installation and eliminate potential problems. This includes:</p>

<ul>
<li>Working with Domain Name System (DNS)</li>

<li>Recording Information</li>

<li>Backing Up Files</li>

<li>Uncompressing the Drive</li>

<li>Disabling Disk Mirroring</li>

<li>Disconnecting UPS Devices</li>

<li>Reviewing Applications</li>

<li>Checking the Boot Sector for Viruses</li>

<li>Gathering Information</li>
</ul>

<h3><a name="583">Working with Domain Name System (DNS)</a></h3>


<p>When you create a Windows 2000 domain, the DNS service must be running and configured. If you are joining a domain, you must know the DNS name of the domain that your computer is joining. If DNS is not running, it is installed automatically when you create a domain controller or when you promote a server to a domain controller.</p>

<h3><a name="584">Recording Information</a></h3>


<p>You should write down the following information: previous operating system (if any), name of the computer (if on a network), name of the workgroup or domain (if on a network), and the IP address (if there is no DHCP server or an existing DHCP server will not be used for dynamic IP addressing).</p>

<h3><a name="585">Backing Up Files</a></h3>


<p>Before you install Windows 2000 Server, you should back up the files that you want to preserve. You can back up files to a disk, a tape drive, or another computer on the network.</p>

<h3><a name="586">Uncompressing the Drive</a></h3>


<p>Uncompress any DriveSpace or DoubleSpace volumes before installing Windows 2000. You should not install Windows 2000 on a compressed drive unless the drive was compressed with the NTFS compression utility. DriveSpace or DoubleSpace volumes are created in Windows 95 and Windows 98. Windows 95 and Windows 98 cannot be upgraded to Windows 2000 Server but can coexist on the same computer running Windows 2000 Server.</p>

<h3><a name="587">Disabling Disk Mirroring</a></h3>


<p>If you are installing a clean copy of Windows 2000 and you have Windows NT disk mirroring installed on your target computer, disable it before running Setup. You can re-enable disk mirroring after completing the installation. If you are upgrading to Windows 2000, you can leave Windows NT mirroring enabled during setup.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
It is not necessary to disable hardware level disk mirroring to complete a new installation of Windows 2000 is not necessary since the operating system is unaware of redundant array of inexpensive disks (RAID) implemented in hardware.
</div></blockquote>

<h3><a name="588">Disconnecting UPS Devices</a></h3>


<p>If you have uninterruptible power supply (UPS) equipment connected to your target computer, disconnect the connecting serial cable before running Setup. Windows 2000 Setup attempts to automatically detect devices connected to serial ports, and UPS equipment can cause problems with detection.</p>

<h3><a name="589">Reviewing Applications</a></h3>


<p>Before starting the Windows 2000 Server Setup program, be sure to read Readme.doc (in the root directory of the Windows 2000 Server installation CD-ROM) for information regarding applications that need to be disabled or removed before running Setup. You may need to remove virus-scanning software, third-party network services, or client software before performing your Windows 2000 Server installation.</p>

<h3><a name="590">Checking the Boot Sector for Viruses</a></h3>


<p>A boot sector virus will cause the installation of Windows 2000 to fail. To verify that the boot sector is not infected with a virus, run the Makedisk.bat file in the \Valueadd\3rdparty\CA_antiv directory on the Windows 2000 Server installation CD-ROM. The Makedisk.bat utility creates a floppy disk that is used to check the boot sector. After creating this floppy disk, boot the computer with the floppy disk inserted. This will run a boot sector virus check. After the utility has run, remove the diskette and proceed to the next preinstallation step.</p>

<h3><a name="591">Gathering Information</a></h3>


<p><b>Follow these steps to prepare for the Windows 2000 installation:</b></p>

<ol>
<li>Read any documentation pertaining to installing Windows 2000 for updated installation information. Review the pertinent .txt and .doc files located on the Windows 2000 Server installation CD-ROM.</li>

<li>Make sure you have all device driver disks and configuration settings for third-party hardware, including any third-party device driver disks and documentation.</li>

<li>Have the Windows 2000 Server installation CD-ROM or a network share with the Windows 2000 Server files available.</li>

<li>Format three 3.5-inch 1.44 MB floppy disks (if creating optional Setup boot disks).</li>
</ol>

<blockquote><div class="caution"><b>IMPORTANT</b><hr />
Windows NT 4.0 Setup disks are not compatible with 
Windows 2000.
</div></blockquote>

<h2><a name="592">Minimum Hardware Requirements</a></h2>


<p>You should be familiar with the minimum hardware requirements necessary to install and operate Windows 2000 Server so that you can determine whether your system meets these requirements. The minimum installation requirements for Windows 2000 are listed in Table 8.2.</p>

<p><b>Table  8.2 </b><i> Minimum Hardware Requirements for Windows 2000 Server</i></p>

<table>
<tr><th>Component</th> <th>Minimum requirement</th></tr>

<tr><td>Processor</td> <td>32-bit Pentium 133 MHz</td></tr>

<tr><td>Free hard disk space</td> 
<td>One or more hard disks where %systemroot% (C:\WINNT by default) is located on a partition with at least 671 MB of free space (2 GB recommended)</td></tr>

<tr><td>Memory</td> 
<td>128 MB for networking with one to five client computers; 256 MB minimum is recommended for most network environments</td></tr>

<tr><td>Display</td> 
<td>VGA monitor capable of 640 x 480 (1024 x 768 recommended)</td></tr>

<tr><td>CD-ROM drive</td> 
<td>12x or faster recommended; not required for network installations</td></tr>

<tr><td>Additional drives</td> 
<td>High-density 3.5-inch disk drive, unless your CD-ROM is bootable and supports starting the Setup program from a CD-ROM</td></tr>

<tr><td>Optional components</td> 
<td>Mouse or other pointing device

<p>For network installation: a network adapter and an 
MS-DOS-based network operating system that permits connection to a server containing the Windows 2000 Setup files</p></td></tr>
</table>

<h2><a name="593">Hardware Compatibility</a></h2>


<p>Windows 2000 Setup automatically checks your hardware and software and reports any potential conflicts. However, to ensure a successful installation, you should make sure that your computer hardware is compatible with Windows 2000 Server before starting the setup process. To do this, verify that your hardware is on the HCL. The HCL is included on your Windows 2000 Server installation CD-ROM in the \Support folder in Hcl.txt. The HCL lists each hardware model that has passed the Hardware Compatibility Tests (HCTs). The list also indicates which devices Windows 2000 Server supports. Testing is conducted by Windows Hardware Quality Labs (WHQL) and by some hardware vendors. Installing Windows 2000 Server on a computer that does not have hardware listed in the HCL might not be successful.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
Microsoft regularly releases an updated HCL. Review the most 
up-to-date list of supported hardware at the Microsoft WHQL Web site, 
<a href="http://www.microsoft.com/hcl/default.asp" target="_window2"><i>http://www.microsoft.com/hcl/default.asp</i></a>. If this URL fails, try <a href="http://www.microsoft.com/isapi/redir.dll?prd=Win2000HCL&amp;pver=1" target="_window2"><i>http://www.microsoft.com/isapi/redir.dll?prd=Win2000HCL&amp;pver=1</i></a> . This URL should direct you to the WHQL Web site. If it doesn't display the WHQL Web site, search <a href="http://www.microsoft.com" target="_window2"><i>http://www.microsoft.com</i></a> using the keyword &quot;HCL.&quot;
</div></blockquote>

<p>A hardware model is &quot;supported&quot; if it is listed on the HCL and you are using a Microsoft-supplied driver to control that hardware. The term &quot;unsupported&quot; does not imply anything about the relative quality of hardware or of third-party drivers. Many unsupported computers and devices work correctly with Windows 2000. However, the Windows 2000 support staff at Microsoft does not offer a full range of support services for problems specific to unsupported hardware or drivers.</p>

<p>Microsoft supports only those devices on the HCL. If one of the computer's devices is not on the HCL, contact the device manufacturer to request a Windows 2000 driver, if it exists.</p>

<h2><a name="594">Disk Partitions</a></h2>


<p>The Windows 2000 Server Setup program allows you to install Windows 2000 Server onto an existing partition or to create a partition and then install Windows 2000 onto the new one. During installation, the Setup program examines the hard disk. Depending on the state of the disk, you will be provided with some or all of the following partitioning choices during the installation:</p>

<ul>
<li>If the entire hard disk is unpartitioned, you must create and size the installation partition.</li>

<li>If the disk has partitions, but there is enough unpartitioned disk space, you can create and size the installation partition by using that unpartitioned space.</li>

<li>If there is an existing partition that is large enough, you can install Windows 2000 Server onto that partition.</li>

<li>If the hard disk has an existing partition, you can delete it to create more unpartitioned disk space and then use that unpartitioned space to create the Windows 2000 partition.</li>

<li>If you specify any action that will cause information to be erased, you will be prompted to confirm your choice. If you delete an existing partition, you will cause any data on that partition to be erased. Performing a new installation of Windows 2000 on a partition that contains another operating system will cause that operating system to be overwritten.</li>
</ul>

<p>Although you can use the Windows 2000 Setup program to create other partitions, you should create and size only the installation partition. After Windows 2000 is installed, use the Disk Management tool to partition any remaining unpartitioned space on the hard disk.</p>

<h3><a name="595">Sizing the Installation Partition</a></h3>


<p>The Windows 2000 Server Setup program requires a boot partition of at least 671 MB of free space to install all Windows 2000 operating system files. However, it is recommended that you create a boot partition of at least 2 GB to allow for future installations of files and programs, such as the Windows 2000 paging file, operating system tools, and operating system updates. The boot partition holds the core operating system files.</p>

<p>The system partition is the partition that holds the files needed to begin the initial installation of Windows 2000. On an <i>x</i>86-based computer, the operating system starts from the system partition. This means that Windows 2000 looks for certain files, such as Ntldr, Ntdetect.com, and Boot.ini in the root directory, usually the C: drive (Disk 0) when the computer is started. The operating system cannot start unless the system partition is marked active.</p>

<p>Windows 2000 Server is installed on the boot partition. It contains the operating system parent directory (Winnt, by default), the \System32 subdirectory, the Windows 2000 kernel, and all other files required to run the operating system. If Windows 2000 Server is installed on the active partition, it is both the boot and system partition.</p>

<p>The disk partition where you store Windows 2000 files must be on a permanent hard disk and must have enough unused disk space to hold all the files. This partition must be formatted either with the NTFS (NTFS 4.0 or NTFS 5.0) or with the FAT16 or FAT32 file systems. However, you cannot install Windows 2000 to a FAT16 or FAT32 partition that has implemented disk compression, such as Microsoft DriveSpace.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
In Windows 2000, if you choose to format NTFS during the installation, the partition will be formatted directly to NTFS. In previous versions, the partition was formatted to FAT and then converted to NTFS. This new process allows you to create partitions larger than 4 GB, although a limit of 7.8 GB still exists on the PC architecture.
</div></blockquote>

<p>Winnt.exe and Winnt32.exe, the Setup executable files, report an error if they are unable to find a drive with enough free disk space available (greater than 671 MB), or if the drive specified with the /t: or /tempdrive: switch has insufficient free disk space. If such an error occurs, you must free some disk space and then run Winnt or Winnt32 again.</p>

<p>Windows 2000 looks for certain files in the root directory of the active partition when you start your computer; however, the Windows 2000 operating system may be installed on another drive, such as drive D, as long as the drive is configured with a supported file system. If you want to dual boot your computer to operating systems that do not support NTFS, such as Windows 98, drive C must be formatted either with FAT16 or FAT32.</p>

<p>If a system's hard disk contains basic input/output system (BIOS) controlled partitions, other file systems such as network file system (NFS), stripe sets, volume sets, or mirrors, those elements appear on the Setup screen as partitions of an unknown type. To avoid deleting elements inadvertently, do not use Setup to delete partitions that are displayed as unknown.</p>

<p>If you are installing a new copy of Windows 2000 on a partition mirrored in software, you must disable mirroring before running Setup and then reestablish mirroring after installation is complete. However, if you are upgrading Windows NT Server versions 3.51 or 4.0 or Windows 2000 Server, you can leave mirroring enabled during setup.</p>

<p>Do not install Windows 2000 or upgrade to Windows 2000 on a compressed drive unless the drive was compressed with the NTFS file system compression utility. Uncompress a Windows 95 or Windows 98 DriveSpace or DoubleSpace volume before running Windows 2000 Setup on it.</p>

<p>If you are setting up a dual-boot configuration of Windows 2000 with another operating system such as MS-DOS, Windows 3.0, Windows 95, Windows 98, or Windows NT, install Windows 2000 onto its own partition. Although it is possible to install Windows 2000 onto the same partition as an existing operating system, it is highly recommended that you install Windows 2000 onto a separate partition, because the Windows 2000 Setup program can overwrite files in the Program Files folder installed by other operating systems.</p>

<h2><a name="596">File Systems</a></h2>


<p>When you install Windows 2000 Setup onto unpartitioned disk space, you are prompted to select the file system that should be used to format the partition. You should decide which file system to use before installing Windows 2000 Server. Windows 2000 supports NTFS and the FAT16 and FAT32 file systems.</p>

<p>Table 8.3 compares the different features of the three file systems supported by Windows 2000.</p>

<p><b>Table  8.3 </b><i> Operating System Feature Comparison</i></p>

<table>
<tr><th>Operating system</th> <th>FAT16</th> <th>FAT32</th> <th>NTFS</th></tr>

<tr><td>Overall compatibility</td> 
<td>Recognized by MS-DOS, Windows 3.<i>x</i>, Windows 95, 98, Windows NT Windows 2000, and OS/2.</td> 
<td>Recognized by Windows 95 OSR2, Windows Windows 98, and Windows Windows NT, 2000.</td>
<td>Recognized by Windows NT and Windows 2000. When the computer is running another operating system (such as MS-DOS, Windows 95, Windows 98, or OS/2), that operating system cannot gain access to files on an NTFS volume on the same computer. </td>
</tr>

<tr><td>Supported by MS-DOS and Windows 3.<i>x</i></td> <td>Yes</td> <td>No</td> <td>No</td></tr> 

<tr><td>Supported by Windows 95 preOSR2 releases</td> <td>Yes</td> <td>No</td> <td>No</td></tr>

<tr><td>Supported by Windows 95 OSR2 and Windows 98</td> <td>Yes</td> <td>Yes</td> <td>No</td></tr>

<tr><td>Supported by Windows NT 3.51</td>
<td>Yes</td> <td>No</td> 
<td>Yes, but Windows NT does not support 3.51 NTFS version 5.0.</td></tr>

<tr><td>Supported by Windows NT 4.0</td> 
<td>Yes</td> <td>No</td> 
<td>Yes. Windows NT supports NTFS 4.0 version 5.0 with Service Pack 4 or later installed.</td></tr>

<tr><td>Supported by Windows 2000</td> <td>Yes</td> <td>Yes</td> <td>Yes</td></tr> 
</table>

<h2><a name="597">Licensing</a></h2>


<p>Windows 2000 Server supports two licensing modes: Per Server and Per Seat. In Per Server mode, Client Access Licenses (CALs) are assigned to a server. In Per Seat mode, each computer that accesses the Windows 2000 Server computer requires a separate CAL.</p>

<h2><a name="598">Workgroups and Domains</a></h2>


<p>During installation, you must choose the type of network you want the computer to join. A computer running Windows 2000 can join one of two types of networks: workgroup or domain.</p>

<h3><a name="599">Joining a Workgroup</a></h3>


<p>When joining a workgroup, assign a workgroup name to the computer. The workgroup name assigned can be the name of an existing workgroup or the name of a workgroup created during installation. In either case, the computer appears as a member of that workgroup when other computer users in the network browse for network resources.</p>

<p>A domain and a workgroup can share a name. However, consider the following:</p>

<ul>
<li>The workgroup computers are not members of the domain and are not included in domain administration.</li>

<li>The workgroup computers appear with the domain computers in Windows 2000 Explorer.</li>
</ul>

<h3><a name="600">Joining a Domain</a></h3>


<p>When joining a domain, the Windows 2000 Setup wizard prompts you to provide the DNS name of an existing domain.</p>

<p>Before a computer running Windows NT or Windows 2000 can join a domain, a computer account must be created in or added to the domain database. Only users who have the Join A Computer To The Domain permission can create a computer account. Members of the Administrators, Domain Administrators, or Account Operators groups have this user right by default.</p>

<p>When joining a domain, create a computer account for that computer in advance, or create it during installation by selecting the Create A Computer Account In The Domain check box. Next, supply a user account and password that have the authority to add computer accounts in the domain. By default, this must be an Administrator account.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
When joining a domain, even if the computer account has been previously created, domain credentials must be supplied.
</div></blockquote>

<p>At least one domain controller and one DNS server must be online when you install a computer in the domain. If you install Windows 2000 Server as a standalone server without joining a domain, you can join a domain later by using the Network Identification tab in the System Properties dialog box, as shown in Figure 8.1.</p>

<div class="figure">
<a href="javascript:fullSize('F08cc01x.htm')"><img src="images/F08cc01.JPG" /></a>
<div class="caption"><b>Figure 8.1</b> <i>The Network Identification tab in the System Properties dialog box</i>
</div>
</div>

<h2><a name="601">Upgrade or New Installation</a></h2>


<p>Before running Windows 2000 Server Setup, you must determine whether to upgrade your existing installation of Windows NT or to perform a new installation. See Table 8.4 for a list of possible upgrades.</p>

<p><i>Upgrading</i> is the process of installing Windows 2000 Server in a directory that currently contains certain versions of Windows NT.</p>

<p><b>Table  8.4 </b><i> Upgrade Choices</i></p>

<table>
<tr><th>If your current Windows operating system is:</th> <th>You can upgrade to:</th></tr>

<tr><td>A version earlier than Windows NT 3.51 Server</td> 
<td>Windows NT 3.51 Server or Windows NT 4.0 Server</td></tr>

<tr><td>Windows NT 3.51 Server</td> <td>Windows 2000 Server</td></tr>

<tr><td>Windows NT 4.0 Server</td> <td>Windows 2000 Server</td></tr>

<tr><td>Windows NT Terminal Server</td> <td>Windows 2000 Server</td></tr>

<tr><td>Windows NT 4.0 Server Enterprise</td> <td>Windows 2000 Advanced Server</td></tr>
</table>

<p>An upgrade automatically installs Windows 2000 Server into the same directory as the currently installed operating system.</p>

<p><i>Installing</i>, in contrast to upgrading, is the process of placing the operating system in a new directory, wiping out the previous operating system at setup, or installing Windows 2000 Server on a disk or disk partition that previously contained no operating system.</p>

<p>If you want to perform a new installation on a disk partition that contains applications you want to retain, you must back them up and reinstall them after installing Windows 2000 Server.</p>

<p>If you want to perform a new installation of Windows 2000 Server on a partition that previously contained Windows 2000 Server, and you have documents under My Documents that you want to save, back up the documents in the Documents and Settings directory and copy the documents back into the folder after completing the installation. My Documents points to subdirectories below the Documents and Settings directory.</p>

<h2><a name="602">Installation Methods</a></h2>


<p>Just as with Windows 2000 Professional, there are three different ways to access the installation files to install Windows 2000 Server on the Intel platform:</p>

<ul>
<li>Using Setup disks</li>

<li>From a CD-ROM</li>

<li>From over the network</li>
</ul>

<h3><a name="603">Setup Disks</a></h3>


<p>Windows 2000 Server is distributed on a CD-ROM and includes four setup floppy disks. These Setup disks are required if you are installing Windows 2000 Server on an <i>x</i>86-based computer that is not running MS-DOS or a Windows operating system and does not support the bootable CD-ROM format. These disks also let you start Windows 2000 at times when it might not be able to start on its own because of a computer error, and to initiate an emergency repair.</p>

<p>You can create a set of Setup disks by running Makeboot.exe or Makebt32.exe from the \Bootdisk directory on the Windows 2000 Server installation CD-ROM. Makeboot.exe is a 16-bit DOS application that runs on MS-DOS, 16-bit operating systems like Windows 3.11, Windows 95, and Windows 98. Makebt32.exe is a 32-bit application that runs on Windows NT and Windows 2000.</p>

<p>After the initial phase of installation, Windows 2000 starts and the remainder of Setup runs under Windows 2000, which is helpful for troubleshooting. For example, the install process displays a standard Windows 2000 error check code if an error occurs during setup.</p>

<p>To start an installation of Windows 2000 Server by using the Setup disks, you should first turn off the computer, insert the disk labeled Windows 2000 Setup Boot Disk into drive A, and then turn on your computer. Setup starts automatically.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
If you are installing Windows 2000 Server on a computer that previously contained no operating system, and you are using an MS-DOS boot floppy disk (performing an over-the-network setup), you have to format the drive first. However, if you are using the Windows 2000 Setup disks to start Setup, you can format the drive during setup.
</div></blockquote>

<p>During installation from the Setup disks, the bar at the bottom of the screen displays the Windows 2000 components being loaded. These components are described in Table 8.5.</p>

<p><b>Table  8.5 </b><i> Components Loaded from Each Setup Boot Disk</i></p>

<table>
<tr><th>Setup disk</th> <th>What gets loaded&#133;</th></tr>

<tr><td>Disk One</td>
<td>The Setupldr.bin file starts the setup. The computer is inspected and machine identification data is collected. If a driver is not found for the fixed disk that contains the boot partition, you might need to load a third-party driver. The text-mode portion of Windows 2000 Setup is installed. The Ntkrnlmp.exe file loads the Windows 2000 Executive.</td></tr>

<tr><td>Disk Two</td> 
<td>This disk loads the HAL, configuration tools, fonts, locale-specific data, drivers, and controllers.</td></tr>

<tr><td>Disk Three</td> 
<td>This disk loads the Compaq drive array and disk controller drivers. During this process, Setup detects the appropriate drivers for the system and loads the dynamic volume support (dmboot1).</td></tr>

<tr><td>Disk Four</td> 
<td>This disk loads the floppy disk drivers; SCSI CD-ROM, floppy, and fixed drive drivers; and file system drivers (FAT, NTFS, and CDFS). Windows 2000 is loaded and takes over the setup process. At this point, the CD-ROM drive is accessed. After the files are copied, the system reboots. Remove any floppy disks before the reboot.</td></tr>
</table>

<h3><a name="603a">After Disk Four</a></h3>

<p>After the system reboots, Windows 2000 Setup starts in graphical user interface (GUI) mode. CD-ROM files continue to be copied to the hard disk. Setup detects and installs devices and then prompts you for user information. You must then choose which components to install. From there, choose the type of network installation (typical or custom) and the type of network (workgroup or domain) to join. Setup builds the file list and installs and configures the components.</p>

<h3><a name="604">Bootable CD-ROM</a></h3>


<p>If your Windows 2000 Server installation files are on compact disc and your computer's BIOS supports the bootable CD-ROM (No-emulation mode) format, insert the Windows 2000 Server CD-ROM into the CD-ROM drive and then turn off your computer. When you turn your computer back on, Setup starts automatically.</p>

<p>When Setup requests that you remove the CD-ROM from the CD-ROM drive, do so on bootable CD-ROM systems. Otherwise, Setup starts all over again on the following boot.</p>

<blockquote><div class="caution"><b>IMPORTANT</b><hr />
Although your system might support bootable CD-ROMs, you might have to modify your system BIOS to boot to the CD-ROM.
</div></blockquote>

<p>If your computer is running an operating system such as Windows 95, Windows 98, or Windows NT and you insert the Windows 2000 installation CD-ROM while the computer is running, the Windows 2000 Setup Wizard dialog box appears (provided you haven't turned off AutoPlay).</p>

<h3><a name="605">Over-the-Network (Server-Based)</a></h3>


<p>The Windows 2000 Server system files must be available over the network. Copy the Windows 2000 installation CD-ROM, or at a minimum, the source directory (\I386), to a directory on the hard disk of a network server and share the directory.</p>

<h3><a name="606">Upgrading Windows 95, Windows 98, or Windows NT 4.0 Workstation</a></h3>


<p>As mentioned earlier, you cannot upgrade to Windows 2000 Server from Windows 95, Windows 98, or Windows NT 4.0 Workstation. You can only install a new copy of Windows 2000 Server over these operating systems. Upgrading to Windows 2000 Server retains most system settings, preferences, and application installations. If you prefer a dual-boot configuration, choose the Install Windows 2000 Server option. Press Enter or click Next to continue.</p>

<h3><a name="607">Performing a New Installation</a></h3>


<p>If you do not have Windows 95, Windows 98, or Windows NT installed, you must run MS-DOS and an MS-DOS network client to establish your connection to the shared network folder containing the Setup files.</p>

<p>Running the MS-DOS network client, connect to the system files over the network and run Winnt.exe, which is located on the network share.</p>

<p>The MS-DOS computer needs 500 KB of free conventional memory to run the setup routine successfully. Make sure you have loaded Emm386.exe and are loading all device drivers high.</p>

<blockquote><div class="tip"><b>TIP</b><hr />
To free some memory, run LoadHigh Winnt.exe to load portions of Winnt.exe high.
</div></blockquote>

<p>You should run Smartdrv.exe or your installation will be slow, taking from 4 to 12 hours.</p>

<h2><a name="608">Choosing Which Components to Install</a></h2>


<p>Windows 2000 Server includes a wide variety of core components from which to choose, including a number of administrative tools that are automatically installed by Setup. In addition, you can choose from a number of components that extend the functionality of Windows 2000 Server. These components can be installed during setup or added afterward (through the Add/Remove Windows Components option within Control Panel's Add/Remove Programs application).</p>

<p>These components provide more capabilities on the server. However, you should choose only the components you need, since each component requires additional disk space. Table 8.6 will help you choose the components you need in your installation.</p>

<p><b>Table  8.6 </b><i> Server function components</i></p>

<table>
<tr><th>Possible server function</th> <th>Optional components to consider installing</th></tr>

<tr><td>DHCP, DNS, or WINS server (in a TCP/IP network)</td> 
<td>Dynamic Host Configuration Protocol (DHCP), DNS, or Windows Internet Name Service (WINS)&#8212;all part of Networking Services</td></tr>

<tr><td>Centralized administration of networks</td> 
<td>Management and Monitoring Tools
<p>Remote Installation Services</p></td></tr>

<tr><td>Authentication and secure communication</td> 
<td>Internet Authentication Services (part of Networking Services
<p>Certificate Services</p>
</td></tr>

<tr><td>File access</td> <td>Microsoft Indexing Service
<p>Remote Storage</p>
<p>Other Network File and Print Services (support for NetWare, Macintosh, and UNIX). NetWare client computers are supported through Gateway Services for NetWare (GSNW). The Directory Service Migration Tool installs GSNW if NetWare Directory Service (NDS) is not installed.</p>
</td></tr>

<tr><td>Print access</td> 
<td>Other Network File and Print Services (support for NetWare, Macintosh, 
and UNIX)</td></tr>

<tr><td>Terminal services</td> <td>Terminal Services
<p>Terminal Services Licensing</p>
</td></tr>

<tr><td>Application support</td> <td>Message Queuing Services
<p>Quality of Service (QoS) Admission Control Service (part of Networking Services)</p>
</td></tr>

<tr><td>Internet (Web) infrastructure</td> <td>Internet Information Services (IIS)
<p>Site Server and Lightweight Directory Access Protocol (LDAP; part of Networking Services)</p></td></tr>

<tr><td>Phone and fax support</td> 
<td>Connection Manager Administration Kit and Connection Point Services (part of Management and Monitoring Tools)</td></tr>

<tr><td>Multimedia communications</td> <td>Windows Media Services</td></tr>

<tr><td>Support for a variety of client operating systems</td>
<td>Other Network File and Print Services (support for NetWare, Macintosh, and UNIX)</td></tr>
</table>

<p>Table 8.7  describes each of the optional components. Use this table in conjunction with Table 8.6 to choose appropriate components to install.</p>

<p><b>Table  8.7 </b><i> Optional Components</i></p>

<table>
<tr><th>Optional component</th> <th>Description</th></tr>

<tr><td>Certificate Services</td> <td>Provides authentication support, including secure e-mail, Web-based authentication, and smart card authentication.</td></tr>

<tr><td>Internet Information Services (IIS)</td>
<td>Provides support for Web site creation, configuration, and management, along with Network News Transfer Protocol (NNTP), FTP, and Simple Mail Transfer Protocol (SMTP).</td></tr>

<tr><td>Management and Monitoring Tools</td> 
<td>Provides tools for network management and monitoring, specifically Network Monitoring Tools Monitor, a packet analyzer. Also includes the Simple Network Management Protocol (SNMP).</td></tr>

<tr><td></td><td>Other management tools include support for client dialing and updating client telephone books, and a utility for migrating from NDS to the Windows 2000 Active Directory service.</td></tr>

<tr><td>Message Queuing Services</td> 
<td>Provides services that support the messaging needed by distributed applications, allowing these applications to function reliably in heterogeneous networks or when a computer is temporarily offline.</td></tr>

<tr><td>Microsoft Indexing Service</td> 
<td>Provides indexing functions for documents stored on disk, allowing users to search for specific document text or properties.</td></tr>

<tr><td>Microsoft Script Debugger</td> 
<td>Provides support for script development.</td></tr>

<tr><td>Networking Services</td> 
<td>Provides important support for networking, including the following:
<p><b>COM Internet Services Proxy</b> Supports distributed applications that use HTTP to communicate through IIS.</p>
<p><b>Domain Name System (DNS)</b> Provides name resolution for clients running Windows 2000. With name resolution, users can access servers by name, instead of having to use IP addresses that are difficult to recognize and remember.</p>
<p><b>Dynamic Host Configuration Protocol (DHCP)</b> Enables a server to provide IP addresses dynamically to other servers on the network. With DHCP, you do not need to set and maintain static IP addresses on any intranet servers except for those providing DHCP, DNS, or WINS.</p>
<p><b>Internet Authentication Service</b> Provides authentication for dial-in users.</p>
<p><b>QoS Admission Control Service</b> Allows you to control how applications are allotted network bandwidth. Important applications can be given more bandwidth and less important applications less bandwidth.</p>

<p><b>Simple TCP/IP Services</b> Supports Character  Generator, Daytime Discard, Echo, and Quote of the Day.</p>
<p><b>Site Server ILS Service</b> Supports telephony applications, which help users access features such as caller ID, conference calls, video conferencing, and faxing. This support depends on IIS.</p>
<p><b>Windows Internet Naming Service</b> Provides NetBIOS over TCP/IP name resolution for clients running Windows NT and earlier versions of Microsoft operating systems. With name resolution, users can access servers by name instead of having to use IP addresses that are difficult to recognize and remember.</p>
<blockquote><div class="note"><b>NOTE</b><hr />
 The Clients directory on the Windows 2000 Server installation CD-ROM contains two sub-directories. The WIN9X directory contains the directory service client for Windows 95 and Windows 98 clients. The WIN9XIPP.CLI directory contains the Internet Printing client for Windows 95 and Windows 98. These services remove the WINS requirement from Windows 95 and 
Windows 98 client computers.
</div></blockquote>
</td></tr>

<tr><td>Other Network File and Print Services</td>
<td>Provides file and print services for Macintosh, as well as print services for UNIX.</td></tr>

<tr><td>Remote Installation Services (RIS)</td>
<td>Provides services that allow you to set up new client computers remotely without having to visit each client. The target clients must support remote booting. On the server, a separate partition will be needed for RIS.</td></tr>

<tr><td>Remote Storage</td> 
<td>Provides an extension to your disk space by making removable media, such as tapes, more accessible. Infrequently used data can automatically be transferred to tape and retrieved when needed.</td></tr>

<tr><td>Terminal Services</td> 
<td>Enables you to run client applications on the server so that client computers can function as terminals rather than independent systems. The server provides a multisession environment and runs the Windows-based programs being used on the clients. If you install Terminal Services, you must also install Terminal Services Licensing (to license Terminal Services' clients). However, temporary licenses can be issued for clients that allow you to use Terminal servers for up to 90 days.</td></tr>

<tr><td>Terminal Services Licensing</td> 
<td>Allows you to register and track licenses for Terminal Services Licensing clients. If you install Terminal Services, you must also install Terminal Services Licensing (to license Terminal Services' clients). However, temporary licenses can be issued for clients that allow you to use Terminal servers for up to 90 days.</td></tr>

<tr><td>Windows Media Services</td> 
<td>Provides multimedia support, allowing you to deliver content using Advanced Streaming Format over an intranet or the Internet.</td></tr>
</table>

<h2><a name="609">Windows 2000 Server Setup Programs</a></h2>


<p>Regardless of which method you use to install Windows 2000 Server, you must execute either Winnt.exe or Winnt32.exe. You can use the Setup.exe program to launch Winnt.exe or Winnt32.exe, or you can execute Winnt32.exe or Winnt.exe directly. For a clean installation on a computer running MS-DOS or Windows 3.<i>x</i>, run Winnt.exe from the MS-DOS command line. For a clean installation from Windows 95, Windows 98, or Windows NT Workstation, run Winnt32.exe. For a clean installation or upgrade from Windows NT Server 3.51 or 4.0, run Winnt32.exe. Several switches can be used with Winnt.exe and Winnt32.exe to customize how Windows 2000 Server is installed on your computer.</p>

<h3><a name="610">Windows 2000 Setup Program</a></h3>


<p>The Windows 2000 Setup program, Setup.exe, is located in the root directory of the Windows 2000 Server installation CD-ROM. When you execute Setup.exe, the Microsoft Windows 2000 CD screen appears. From there, you can choose to install Windows 2000 Server, install add-on components, browse the CD, or exit the Setup program. If you select the Install Windows 2000 option, either the Winnt.exe or the Winnt32.exe program runs, depending on which operating system you are currently using.</p>

<p>If Autorun is enabled on your system, the Windows 2000 CD screen appears when you insert the Windows 2000 Server installation CD-ROM into your CD-ROM drive. Autorun calls Setup.exe, which checks the operating system. If Setup determines that the computer is running Windows NT Server 3.51, Windows NT Server 4.0, or an earlier version of Windows 2000 Server, you are prompted either to upgrade or install Windows 2000. If a newer version of Windows 2000 Server is installed on the computer, Setup.exe will not allow the installation of Windows 2000 Server to continue.</p>

<h3><a name="611">Winnt.exe Setup Program</a></h3>


<p>Winnt.exe is commonly used for over-the-network installations that use an MS-DOS network client. Winnt.exe does the following:</p>

<ol>
<li>Creates a $WIN_NT$.~BT temporary directory on the system partition and copies Setup boot files into this directory.</li>

<li>Creates a $WIN_NT$.~LS temporary directory and copies the Windows 2000 files from the server into this directory.</li>

<li>Prompts users to restart their systems. After the computer restarts, the boot menu appears and installation continues.</li>
</ol>

<p>Winnt.exe installs Windows 2000 Server and can be executed from an MS-DOS or a Windows 16-bit operating system command prompt.</p>

<h3><a name="611a">Winnt.exe Switches</a></h3>

<p>You can use the following switches to modify the behavior of the Winnt.exe Setup program:</p>

<div class="code">
<pre>
WINNT [/s[:sourcepath]] [/t[:tempdrive]] [/u[:answer_file]] 
[/udf:id[,UDF_file]][/r:folder] [/rx:folder] [/e:command] [/a]
</pre>
</div>

<p>These switches are described in detail in Table 8.8.</p>

<p><b>Table  8.8 </b><i> Winnt.exe Switches</i></p>

<table>
<tr><th>Switch</th> <th>Description</th></tr>

<tr><td>/s[:<i>sourcepath</i>]</td> <td>Specifies the source location of the Windows 2000 files. The location must be a full path of the form <i>x</i>:[<i>path</i>] or a valid UNC.</td></tr>

<tr><td>/t[:<i>tempdrive</i>]</td> <td>Directs Setup to place temporary files on the specified drive and to install Windows 2000 on that drive. If you do not specify a location, Setup attempts to locate a drive for you.</td></tr>

<tr><td>/u[:<i>answer_file</i>]</td> <td>Performs an unattended setup using an answer file (requires /s). The answer file automatically provides answers to some or all of the prompts that the end user normally responds to during setup.</td></tr>

<tr><td>/udf:<i>id</i>[,<i>UDF_file</i>]</td> <td>Indicates an identifier (<i>id</i>) that Setup uses to specify how a Uniqueness Database File (UDF) modifies an answer file (see /u [:<i>answer_file</i>]). The /udf parameter overrides values in the answer file, and the identifier determines which values in the UDF file are used. If no UDF_file is specified, Setup prompts you to insert a disk that contains the $Unique$.udb file.</td></tr>

<tr><td>/r[:<i>folder</i>]</td> <td>Specifies an optional folder to be installed. The folder remains on the computer after setup is complete.</td></tr>

<tr><td>/rx[:<i>folder</i>]</td> <td>Specifies an optional folder to be copied. The folder is deleted after setup is complete.</td></tr>

<tr><td>/e[:<i>command</i>]</td> <td>Specifies a command to be executed at the end of GUI-mode Setup.</td></tr>

<tr><td>/a</td> <td>Enables accessibility options.</td></tr>
</table>

<h3><a name="612">Winnt32.exe Setup Program</a></h3>


<p>Winnt32.exe is used to install Windows 2000 Server from computers with Windows 95, Windows 98, or Windows NT 4.0 Workstation already installed. It can be executed by double-clicking Winnt32.exe in the root of the source folder (such as \I386) on the Windows 2000 Server installation CD-ROM or in a network share location for over-the-network installations. You can also execute Winnt32.exe by using the run command from the Start Menu, which allows switches to be specified. In addition, the Winnt32 command can be run from the Windows 95, Windows 98, or Windows NT (all Windows 32-bit operating systems) command prompts.</p>

<p>If the Windows 2000 Server installation is initiated over the network, Winnt32.exe creates a $WIN_NT$.~LS temporary directory and copies the Windows 2000 Server files from the server into this directory. The temporary directory is created on the first partition that is large enough, unless otherwise specified by the /t switch. This is known as the Pre-Copy Phase.</p>

<p><b>WINNT32.EXE Switches</b></p>

<p>You can use the following switches to modify the behavior of the Winnt32.exe Setup program:</p>

<div class="code">
<pre>
winnt32 [/s:<i>sourcepath</i>] [/tempdrive:<i>drive_letter</i>] 
[/unattend[<i>num</i>]:
[<i>answer_file</i>]] [/copydir:<i>folder_name</i>] 
[/copysource:<i>folder_name</i>] 
[/cmd:<i>command_line</i>] [/debug[<i>level</i>]:[<i>filename</i>]] 
[/udf:id[,<i>UDF_file</i>]] 
[/syspart:<i>drive_letter</i>] [/checkupgradeonly] [/cmdcons] 
[/m:<i>folder_name</i>] 
[/makelocalsource] [/noreboot]
</pre>
</div>

<p>These switches are described in detail in Table 8.9.</p>

<p><b>Table  8.9 </b><i> Winnt32.Exe Switches</i></p>

<table>
<tr><th>Switch</th> <th>Description</th></tr>

<tr><td>/s:<i>sourcepath</i></td> 
<td>Specifies the source location of the Windows 2000 files. To simultaneously copy files from multiple servers, specify multiple /s sources. If you use multiple /s switches, the first specified server must be available or setup will fail.</td></tr>

<tr><td>/tempdrive:<i>drive_letter</i></td> <td>Directs Setup to place temporary files on the specified partition and to install Windows 2000 on that partition.</td></tr>

<tr><td>/Unattend or /u</td> 
<td>Upgrades your previous version of Windows 2000 in Unattended Setup mode. All user settings are taken from the previous installation, so no user intervention is required during setup.
<p>Using the /unattend switch to automate setup affirms that you have read and accepted the End-User License Agreement (EULA) for Windows 2000. Before using this switch to install Windows 2000 on behalf of an organization other than your own, you must confirm that the end user has received, read, and accepted the terms of the Windows 2000 EULA. Original equipment manufacturers (OEMs) may not use this switch on computers being sold to end users.</p>
</td></tr>

<tr><td>/unattend[<i>num</i>][:<i>answer_file</i>]</td> <td>Performs a fresh installation in Unattended Setup mode. The answer file provides Setup with your custom specifications. <i>Num</i> is the number of seconds between the time that Setup finishes copying the files and when it restarts your computer. You can use num on any computer running Windows NT or Windows 2000. The <i>answer_file</i> placeholder is the name of the answer file.</td></tr>

<tr><td>/copydir:<i>folder_name</i></td> 
<td>Creates an additional folder within the folder in which the Windows 2000 files are installed. For example, if the source folder contains a folder called Private_drivers that has modifications just for your site, you can type <b>/copydir:Private_drivers</b> to have Setup copy that folder to your installed Windows 2000 folder. The new folder location would then be %systemroot%\Private_drivers. 
You can use /copydir to create as many additional folders as you want.</td></tr>

<tr><td>/copysource:<i>folder_name</i></td> 
<td>Creates a temporary additional folder within the folder in which the Windows 2000 files are installed. For example, if the source folder contains a folder called Private_drivers that has modifications just for your site, you can type 
<b>/copysource:Private_drivers</b> to have Setup copy that folder to your installed Windows 2000 folder and use its files during setup. The temporary folder location would then be %systemroot%\Private_drivers. Unlike the folders /copydir creates, /copysource folders are deleted after setup is complete.</td></tr>

<tr><td>/cmd:<i>command_line</i></td> <td>Instructs Setup to carry out a specific command before the final phase of setup. This occurs after your computer has restarted twice and after Setup has collected the necessary configuration information, but before setup is complete.</td></tr>

<tr><td>/debug[<i>level</i>][:<i>filename</i>]</td> <td>Creates a debug log at the level specified, for example, /debug4:C:\ Win2000.log. The default log file is %systemroot%\Winnt32.log, with the debug level set to 2. The log levels are as follows: 0-severe errors, 1-errors, 2-warnings, 3-information, and 4-detailed information for debugging. Each level includes the levels below it.</td></tr>

<tr><td>/udf:<i>id</i>[,<i>UDF_file</i>]</td> 
<td>Indicates an identifier (<i>id</i>) that Setup uses to specify how a Uniqueness Database File (UDF) modifies 
an answer file (see the /unattend entry). The UDF overrides values in the answer file, and the identifier determines which values in the UDF are used. 
For example, /udf:RAS_user, Our_company.udb overrides settings specified for the identifier RAS_user in the Our_company.udb file. If no UDF is specified, Setup prompts the user to 
insert a disk that contains the $Unique$.udb file.</td></tr>

<tr><td>/syspart:<i>drive_letter</i></td> <td>Specifies that you can copy Setup startup files to a hard disk, mark the disk as active, and then install the disk into another computer. When you start that computer, it automatically starts with the next phase of setup. You must always use the /tempdrive parameter with the /syspart parameter.
<p>The /syspart switch for Winnt32.exe runs only from a computer that already has Windows NT 3.51, Windows NT 4.0, or Windows 2000 installed on it. It cannot be run from Windows 95 or Windows 98.</p>
</td></tr>

<tr><td>/checkupgradeonly</td> <td>Checks your computer for upgrade compatibility with Windows 2000. For Windows 95 or Windows 98 upgrades, Setup creates a report named Upgrade.txt in the Windows installation folder. 
For Windows NT 3.51 or 4.0 upgrades, it saves the report to the Winnt32.log in the installation folder.</td></tr>

<tr><td>/cmdcons</td> <td>Adds a Recovery Console option to the operating system selection screen for repairing a failed installation. It is only used post-setup.</td></tr>

<tr><td>/m:<i>folder_name</i></td> <td>Specifies that Setup copies replacement files from an alternate location. Instructs Setup to look in the alternate location first and if files are present, use them instead of the files from the default location.</td></tr>

<tr><td>/makelocalsource</td> 
<td>Instructs Setup to copy all installation source files to your local hard disk. Use /makelocalsource when installing from a CD-ROM to provide installation files when the CD-ROM is not available later in the installation.</td></tr>

<tr><td>/noreboot</td> 
<td>Instructs Setup not to restart the computer after the file copy phase of winnt32 is completed so that you can execute another command.</td></tr>
</table>

<h2><a name="613">The Installation Process</a></h2>


<p>Windows 2000 Server uses the same four-stage installation process that Windows 2000 Professional uses:</p>

<ul>
<li><b>Running the Setup program.</b> The Setup program prepares the hard disk for later stages of the installation and copies the necessary files to run the Setup wizard. This is the text-mode portion of setup.</li>

<li><b>Running the Setup wizard.</b> The Setup wizard requests setup information about the computer, which includes names, passwords, regional settings, and so on. This is the graphics-mode portion of setup.</li>

<li><b>Installing Windows Networking.</b> After gathering information about the computer, the Setup wizard prompts you for networking information and then installs the networking components so that the computer can communicate with other computers on the network.</li>

<li><b>Completing the Installation.</b> To complete the installation, Setup copies files to the hard disk, registers components, and configures the computer. The system restarts after installation is complete.</li>
</ul>


<h3><a name="614">Running the Setup Program</a></h3>


<p>When you run the Setup program, you specify which components will be installed. Setup will copy all of the files needed for the installation to temporary directories on the local hard drive. When you use the Winnt.exe or Winnt32.exe command to initiate an installation over the network, all the files needed to complete the installation are copied over the network to a temporary directory named $WIN_NT$.~LS. Setup then continues as it would if you were performing the installation from a local drive.</p>

<p>You can choose not to create the boot floppies by selecting the check box Copy All Setup Files From The Setup CD To The Hard Drive check box. The check box is under the Advanced Options button. When you select this option, a $WIN_NT$.~BT directory is created on the disk. This directory contains the files that would have been on the four boot floppies.</p>

<p>While the files are being copied into the $WIN_NT$.~LS directory, Windows 95, Windows 98, or Windows NT is still running. This means there is less down time during the upgrade.</p>

<p>In the next section of setup you are prompted for information needed to complete the installation. After you accept the license agreement, you specify or create an installation partition and choose a file system. All files required for installation are copied from the temporary directory (or the CD-ROM) into the installation directory on the hard disk of the target computer.</p>

<h3><a name="614a">Existing Installations</a></h3>

<p>If Setup detects any existing Windows 2000 installations, it displays them in a list. You can select an installation and press R to repair it, or press Esc to continue.</p>

<h3><a name="614b">Partitions</a></h3>

<p>Setup displays all existing partitions and free space on the system. Using the Up and Down arrow keys you can select where you want to install Windows 2000 Server. You can also create and delete partitions. Press Enter to continue.</p>

<h3><a name="614c">File Systems</a></h3>

<p>Setup gives you the option of keeping the current file system intact or converting it to NTFS. If you do not want to change it, select the Leave Current File System Intact option, which is the default, and press Enter to continue.</p>

<p>Setup examines your hard disks and copies the files it needs for installation from the temporary directory to the installation directory. (Winnt is the 
default directory.)</p>

<p>After the files are copied, the computer restarts and the Setup wizard begins. During this phase, Setup gathers information about your computer and allows you to select which optional components to install and allows you to select the administrator password.</p>

<p>The Setup wizard presents a series of dialog boxes through which Windows 2000 collects configuration information for setting up your system. During this stage, Windows 2000 security features are installed and devices are installed and configured.</p>

<h3><a name="614d">Regional Settings</a></h3>

<p>Windows 2000 displays the current (default) regional settings. You can add support for additional languages, change your location settings for the system, and configure the user account default settings.</p>

<h3><a name="614e">Personalize Your Software</a></h3>

<p>When configuring your system, you must type in the name of the person to whom 2000 Server is registered to. You can also add the name of the organization, although this is optional.</p>

<h3><a name="614f">Licensing Mode</a></h3>

<p>You must select the Per Server or Per Seat licensing method. If you select Per Server, you must type in the number of Per Server licenses.</p>

<h3><a name="614g">Computer Name and Administrator Password</a></h3>

<p>You must type in a computer name (NetBIOS name of up to 15 characters) when you install Windows 2000. Note that the autogenerated name is 15 characters long. The name you type in must be different from other computer, workgroup, or domain names on the network. A default computer name is displayed. You can use the default name or type in a new computer name.</p>

<p>You can also type in an Administrator password for the local Administrator user account. This password can be up to 127 characters long. You may also leave the Password field blank.</p>

<h3><a name="614h">Optional Component Manager</a></h3>

<p>The Optional Component Manager allows you to add or remove components during and after installation.</p>

<h3><a name="614i">Date and Time Settings</a></h3>

<p>During installation, you must select the appropriate time zone and adjust the date and time settings, if necessary. You should also make adjustments for daylight savings time.</p>

<h3><a name="615">Installing Windows 2000 Server Networking</a></h3>


<p>When the Setup wizard has gathered the necessary information, the Setup program examines the computer to detect installed network adapters. This can take several minutes.</p>

<h3><a name="615a">Networking Settings</a></h3>

<p>The Windows 2000 networking setup begins with a dialog box that offers a choice between Typical settings (default) or Custom settings. Typical settings configure the system with all the defaults: Client for Microsoft Networks, File and Print Sharing for Microsoft Networks, and Internet Protocol (TCP/IP) configured as a DHCP client.</p>

<p>Custom settings allows you to configure the following items:</p>

<ul>
<li><b>Clients.</b> The default client is Client For Microsoft Networks. You can add Gateway (and Client) Services for NetWare.</li>

<li><b>Services.</b> The default service is File and Printer Sharing for Microsoft Networks. You can add SAP Agent and QoS Packet Scheduler. You can modify the settings for File and Printer Sharing for Microsoft Networks by highlighting the service and clicking Properties. This allows you to optimize server service settings and provide server service compatibility for LAN Manager 2.<i>x</i> clients.</li>

<li><b>Protocols.</b> The default protocol is Internet Protocol (TCP/IP). You can add other protocols, including NWLink IPX/SPX, NetBEUI, DLC, AppleTalk, and Network Monitor Driver. You can also modify the settings for a protocol (if applicable) by highlighting the protocol and clicking Properties.</li>
</ul>

<h3><a name="616">Completing the Installation</a></h3>


<p>The Completing the Installation stage performs the following actions and requires no user interaction. Table 8.10 describes the tasks performed by Setup during this stage.</p>

<p><b>Table  8.10 </b> <i>Tasks Performed during Installation Completion</i></p>

<table>
<tr><th>Task</th> <th>Description</th></tr>

<tr><td>Copying files</td> 
<td>Setup copies any remaining files that are necessary for installation, such as accessories and bitmaps, to the installation directory.</td></tr>

<tr><td>Configuring the computer</td>
<td>Setup creates your start menu and program groups and sets up the print spooler, printers, services, the administrator account, fonts, the Pagefile, and the registration of many dynamic-link libraries (DLLs).</td></tr>

<tr><td>Saving the configuration</td>
<td>Setup saves your configuration to the registry, creates the repair directory, and resets the Boot.ini.</td></tr>

<tr><td>Removing temporary files</td>
<td>Setup removes the temporary files and directories created and used during installation, such as the $WIN_NT$.~LS directory, and also compacts the system hives in the registry.</td></tr>
</table>

<p><img src="images/practice.jpg" /></p>
<h2><a name="617">Practice: Installing Windows 2000 Server</a></h2>


<p>In this practice, you install Windows 2000 Server on a computer with no formatted partitions. During installation, you use the Windows 2000 Server Setup program to create a partition on your hard disk, on which you install Windows 2000 Server as a standalone server in a workgroup.</p>

<h3><a name="618">Exercise 1: Creating Windows 2000 Server Setup Disks</a></h3>


<p>Complete this exercise on a computer running MS-DOS or any version of Windows with access to the Bootdisk directory on the Windows 2000 Server installation CD-ROM.</p>

<p>If your computer is configured with a bootable CD-ROM drive, you can install Windows 2000 without using the Setup disks. To complete this exercise as outlined, bootable CD-ROM support must be disabled in the BIOS.</p>

<blockquote><div class="caution"><b>IMPORTANT</b> <hr />
This exercise requires four formatted 1.44-MB disks. If you use diskettes that contain data, the data will be overwritten without warning.
</div></blockquote>

<ol>
<li>Label the four blank, formatted 1.44-MB diskettes as follows:
<p>Windows 2000 Server Setup Disk #1</p>

<p>Windows 2000 Server Setup Disk #2</p>

<p>Windows 2000 Server Setup Disk #3</p>

<p>Windows 2000 Server Setup Disk #4</p></li>

<li>Insert the Microsoft Windows 2000 Server CD-ROM into the CD-ROM drive.</li>

<li>If the Windows 2000 CD-ROM dialog box appears prompting you to install or upgrade to Windows 2000, click Exit.</li>

<li>Open a command prompt.</li>

<li>At the command prompt, change to your CD-ROM drive. For example, if your CD-ROM drive name is E, type <b>E:</b>  and press Enter.</li>

<li>At the command prompt, change to the Bootdisk directory by typing <b>cd bootdisk</b>  and pressing Enter.</li>

<li>If you are creating the Setup boot disks from a computer running MS-DOS, a Windows 16-bit operating system, Windows 95, or Windows 98, type <b>makeboot a:</b>  (where a: is the name of your floppy disk drive) and then press Enter. If you are creating Setup boot disks from a computer running Windows NT or Windows 2000, type <b>makebt32 a:</b>  (where a: is the name of your floppy disk drive) and then press Enter.

<p>Windows 2000 displays a message indicating that this program creates the four setup disks for installing Windows 2000. It also indicates that four blank, formatted high-density floppy disks are required.</p></li>

<li>Press any key to continue.
<p>Windows 2000 displays a message prompting you to insert the disk that will become the Windows 2000 Setup disk.</p></li>

<li>Insert the blank, formatted disk labeled Windows 2000 Server Setup Disk #1 into the floppy disk drive, and then press any key to continue.
<p>After Windows 2000 creates the disk image, it displays a message prompting you to insert the disk labeled Windows 2000 Server Setup Disk #2.</p></li>

<li>Remove Disk #1, insert the blank formatted disk labeled Windows 2000 Server Setup Disk #2 into the floppy disk drive, and then press any key to continue.
<p>After Windows 2000 creates the disk image, it displays a message prompting you to insert the disk labeled Windows 2000 Server Setup Disk #3.</p></li>

<li>Remove Disk #2, insert the blank formatted disk labeled Windows 2000 Server Setup Disk #3 into the floppy disk drive, and then press any key to continue.
<p>After Windows 2000 creates the disk image, it displays a message prompting you to insert the disk labeled Disk #4.</p></li>

<li>Remove Disk #3, insert the blank formatted disk labeled Windows 2000 Server Setup Disk #4 into the floppy disk drive, and then press any key to continue.
<p>After Windows 2000 creates the disk image, it displays a message indicating that the imaging process is done.</p></li>

<li>At the command prompt, type <b>exit</b>  and then press Enter.</li>

<li>Remove the disk from the floppy disk drive and the CD-ROM from the CD-ROM drive.</li>
</ol>

<h3><a name="619">Exercise 2: Running the Setup Program</a></h3>


<p>This exercise is completed on Computer 1. It is assumed for this exercise that Computer 1 has no operating system installed, the disk is not partitioned, and bootable CD-ROM support, if available, is disabled. To verify that Computer 1 meets all pre-installation requirements, please review &quot;<a href="abouta.htm#1">About This Book</a>.&quot; Computer 1 should be your second computer, not the computer where you installed Windows 2000 Professional (PRO1) earlier in this book.</p>

<ol>
<li>Insert the disk labeled Windows 2000 Server Setup Disk #1 into the floppy disk drive, insert the Windows 2000 Server CD-ROM into the CD-ROM drive, and restart Computer 1.
<p>After the computer starts, Windows 2000 Setup displays a brief message that your system configuration is being checked, and then the Windows 2000 Setup screen appears.</p>

<p>Notice that the gray bar at the bottom of the screen indicates that the computer is being inspected and that the Windows 2000 Executive, which is a minimal version of the Windows 2000 kernel, is loading.</p></li>


<li>When prompted, insert Setup Disk #2 into the floppy disk drive, and then press Enter.
<p>Notice that Setup indicates that it is loading the HAL, fonts, local specific data, bus drivers, and other software components to support your computer's motherboard, bus, and other hardware. Setup also loads the Windows 2000 Setup program files.</p></li>

<li>When prompted, insert Setup Disk #3 into the floppy disk drive, and then press Enter.
<p>Notice that Setup indicates that it is loading disk drive controller drivers. After the drive controllers load, the Setup program initializes drivers appropriate to support access to your disk drives. Setup might pause several times during this process.</p></li>

<li>When prompted, insert Setup Disk #4 into the floppy disk drive, and then press Enter.
<p>Setup loads peripheral support drivers, like the floppy disk driver and file systems. It then initializes the Windows 2000 Executive and loads the rest of the Windows 2000 Setup program.</p>

<p>If you are installing the evaluation version of Windows 2000, a Setup notification screen appears informing you that you are about to install an evaluation version of Windows 2000.</p></li>

<li>Read the Setup Notification message, and then press Enter to continue.
<p>Setup displays the Welcome To Setup screen.</p>

<p>Notice that, in addition to the initial installation of Windows 2000, you can use Windows 2000 Setup to repair or recover a damaged Windows 2000 installation.</p></li>

<li>Read the Welcome To Setup message, and then press Enter to begin the installation phase of Windows 2000 Setup.
<p>Setup displays the License Agreement screen.</p></li>

<li>Read the license agreement, pressing Page Down to scroll to the bottom of the screen.</li>

<li>Select I Accept The Agreement by pressing F8.
<p>Setup displays the Windows 2000 Server Setup screen, prompting you to select an area of free space or an existing partition on which to install Windows 2000. At this stage of setup you can create and delete partitions on your hard disk.</p>

<p>If Computer 1 does not contain any disk partitions (as required for this exercise), you will notice that the hard disk listed on the screen contains an existing unformatted partition.</p></li>

<li>Make sure that the Unpartitioned space partition is highlighted, and then type <b>C</b> .
<p>Setup displays the Windows 2000 Setup screen, confirming that you've chosen to create a new partition in the unpartitioned space and informing you of the minimum and maximum sizes of the partition you can create.</p></li>

<li>Specify the size of the partition you want to create (2048 MB), and then press Enter to continue.
<blockquote><div class="note"><b>NOTE</b> <hr />
Although you can create additional partitions from the remaining unpartitioned space during setup, it is recommended that you perform additional partitioning tasks after you install Windows 2000. To partition hard disks after installation, use the Disk Management snap-in.
</div></blockquote>
<p>Setup displays the Windows 2000 Setup screen, showing the new partition as C: New (Unformatted).</p></li>

<li>Make sure the new partition is highlighted, and press Enter.
<p>You are prompted to select a file system for the partition.</p></li>

<li>Use the arrow keys to select Format The Partition Using The NTFS File System, and then press Enter.
<p>The Setup program formats the partition with NTFS. After it formats the partition, Setup examines the hard disk for physical errors that might cause Setup to fail and then copies files to the hard disk. This process takes several minutes.</p>
<p>Eventually, Setup displays the Windows 2000 Server Setup screen. A red status bar counts down for 15 seconds before Setup restarts the computer.</p></li>

<li>Remove the Setup disk from the floppy disk drive.
<blockquote><div class="caution"><b>IMPORTANT</b> <hr />
If your computer supports booting from the CD-ROM drive, and this feature was not disabled in the BIOS, the computer will boot from the Windows 2000 Server installation CD-ROM after Windows 2000 Setup restarts. This will cause Setup to run from the beginning. If this happens, remove the CD-ROM and restart the computer.
</div></blockquote></li>

<li>Setup copies additional files and then restarts your computer and loads the Windows 2000 Setup wizard.</li>
</ol>

<h3><a name="620">Exercise 3: Running the Setup Wizard and Information-Gathering Phase of Windows 2000 Server Setup</a></h3>


<ol>
<li>On the Welcome to the Windows 2000 Setup Wizard screen, click Next to begin gathering information about your computer.
<p>Setup configures NTFS folder and file permissions for the operating system files, detects the hardware devices in the computer, and then installs and configures device drivers to support the detected hardware. This process takes several minutes.</p></li>

<li>On the Regional Settings page, make sure that the system locale, user locale, and keyboard layout are correct for your language and location, and then click Next.
<blockquote><div class="note"><b>NOTE</b> <hr />
You can modify regional settings after you install Windows 2000 by using Regional Options in Control Panel.
</div></blockquote>
<p>Setup displays the Personalize Your Software page, prompting you for your name and organization name. Setup uses your organization name to generate the default computer name. Many applications that you install later will use this information for product registration and document identification.</p></li>

<li>In the Name field, type your name. In the Organization field, type the name of an organization. Click Next.
<blockquote><div class="note"><b>NOTE</b> <hr />
If the Your Product Key screen appears, type in the product key provided with Windows 2000 Server and then click Next.
</div></blockquote>

<p>Setup displays the Licensing Modes screen, prompting you to select a licensing mode. By default, the Per Server licensing mode is selected. Setup prompts you to type in the number of licenses you have purchased for this server.</p></li>

<li>Select the Per Server radio button, type <b>5</b>  for the number of concurrent connections, and then click Next.
<blockquote><div class="caution"><b>IMPORTANT</b> <hr />
Using the Per Server Number Of Concurrent Connections option and choosing 5 concurrent connections are only suggested values to be used for this exercise. You should use a legal number of concurrent connections based on the actual licenses you own. You can also choose to use Per Seat instead of Per Server.
</div></blockquote>

<p>Setup displays the Computer Name And Administrator Password screen.</p>

<p>Notice that Setup uses your organization name to generate a suggested name for the computer.</p></li>

<li>In the Computer Name field, type <b>Server01</b>.

<p>Windows 2000 displays the computer name in all capital letters regardless of how it was typed in.</p>

<blockquote><div class="warning"><b>WARNING</b> <hr />
To complete this exercise, your computer cannot be connected to a network.
</div></blockquote></li>

<li>In the Administrator Password field and the Confirm Password field, type <b>password</b>  (all lowercase) and then click Next. Passwords are case sensitive, so make sure you type password in all lowercase letters.

<blockquote><div class="note"><b>NOTE</b> <hr />
For the exercises in this self-paced training kit, you will use the password value of &quot;password&quot; for the Administrator account. In a production environment, you should always use a complex password for the Administrator account (one that others cannot easily guess). Microsoft recommends mixing uppercase and lowercase letters, numbers, and symbols (for example, Lp6*g9).
</div></blockquote>

<p>Setup displays the Windows 2000 Components screen that indicates which Windows 2000 system components Setup will install.</p>

<p>You can install additional components after you install Windows 2000 by using Add/Remove Programs in Control Panel. Make sure you install only the components selected by default during setup. Later in this training guide, you will learn how to install additional components.</p></li>

<li>Click Next.

<p>If a modem is detected in the computer during setup, Setup displays the Modem Dialing Information page.</p></li>

<li>If the Modem Dialing Information screen appears, type in an area code or city code and click Next.
<p>The Date and Time Settings screen appears.</p>
<blockquote><div class="caution"><b>IMPORTANT</b> <hr />
Windows 2000 services perform many tasks whose successful completion depends on the computer's time and date settings. Be sure to select the correct time zone for your location to avoid problems in later exercises.
</div></blockquote></li>

<li>Enter the correct date and time and time zone settings, and then click Next.
<p>The Network Settings screen appears and Setup installs networking components.</p></li>
</ol>

<h3><a name="621">Exercise 4: Completing the Installing Windows Networking Components Phase of Windows 2000 Server Setup</a></h3>


<p>Networking is an integral part of Windows 2000 Server. Networking can be configured in many ways. In this exercise, basic networking is configured. In a later practice, you will install additional network components.</p>

<ol>
<li>On the Networking Settings screen, make sure that Typical Settings is selected, and then click Next to begin installing Windows networking components.
<p>This setting installs networking components that are used to gain access to and share resources on a network. It also configures TCP/IP to automatically obtain an IP address from a DHCP server on the network.</p>

<p>Setup displays the Workgroup Or Computer Domain screen, which prompts you to join either a workgroup or a domain.</p></li>

<li>On the Workgroup Or Computer Domain screen, make sure that the No, This Computer Is Not On A Network Or Is On A Network Without A Domain radio button is selected, and that the workgroup name is WORKGROUP. Then click Next.

<p>Setup displays the Installing Components screen, displaying the status as Setup installs and configures the remaining operating system components according to the options you specified. This will take several minutes.</p>

<p>Setup then displays the Performing Final Tasks screen, which shows the status as Setup finishes copying files, makes and saves configuration changes, and deletes temporary files. Computers that do not exceed the minimum hardware requirements might take 30 minutes or more to complete this phase of installation.</p>

<p>Setup then displays the Completing The Windows 2000 Setup Wizard screen.</p></li>

<li>Remove the Windows 2000 Server CD-ROM from the CD-ROM drive, and click Finish.
<blockquote><div class="caution"><b>IMPORTANT</b> <hr />
If your computer supports booting from the CD-ROM drive and you did not remove the installation CD-ROM, and if you disable this feature in the BIOS, the computer will run Setup again soon after Setup restarts the computer. If this happens, remove the CD-ROM and then restart the computer.
</div></blockquote>
<p>Windows 2000 restarts and runs the newly installed version of Windows 2000 Server.</p></li>
</ol>

<h3><a name="622">Exercise 5: Completing the Hardware Installation Phase of  Windows 2000 Server Setup</a></h3>


<p>During this final phase of installation, any Plug and Play hardware not detected in the previous phases of setup will be detected.</p>

<ol>
<li>At the completion of the startup phase, log on by pressing Ctrl+Alt+Delete.</li>

<li>In the Enter Password dialog box, type <b>Administrator</b>  in the User Name field and type <b>password</b>  in the Password field.</li>

<li>Click OK.
<p>If Windows 2000 detects hardware that was not detected during setup, the Found New Hardware Wizard screen appears, indicating that Windows 2000 is installing the appropriate drivers.</p></li>

<li>If the Found New Hardware Wizard screen appears, verify that the Restart The Computer When I Click Finish check box is cleared and then click Finish to complete the Found New Hardware wizard.
<p>Windows 2000 displays the Microsoft Windows 2000 Configure Your Server dialog box. From this dialog box, you can configure a variety of advanced options and services.</p></li>

<li>Select the I Will Configure This Server Later radio button, and click Next.</li>

<li>From the next screen that appears, clear the Show This Screen At Startup check box.</li>

<li>Close the Configure Your Server screen.</li>
</ol>

<h3><a name="623">Exercise 6: Adjusting the Display Settings</a></h3>


<p>Setup selects a default resolution that is compatible with the video adapter that Setup has detected. You can change the default settings now or at any time after you install Windows 2000.</p>

<blockquote><div class="warning"><b>WARNING</b> <hr />
If you do not know the refresh frequency that your monitor supports with the color palette and screen area you selected, do not change the default setting. Setting the refresh frequency too high might damage your monitor.
</div></blockquote>

<ol>
<li>If you wish to adjust your display settings to show more colors or a higher screen resolution, open Control Panel and select Display.
<p>The Display Properties dialog box appears.</p></li>

<li>From the Settings tab, adjust your screen area and colors, and click OK.
<p>A Display Properties message box appears warning you that your settings will be applied and that if you don't respond to the message box that appears after the display settings are adjusted, the original display settings will be restored.</p></li>

<li>Click OK.
<p>If the display settings are valid, a Monitor Settings message box will appear.</p></li>

<li>Click Yes to make the changes permanent.
<p>You have now completed the Windows 2000 Server installation and are logged on as Administrator.</p></li>

<li>Close Control Panel.</li>
</ol>

<blockquote><div class="note"><b>NOTE</b> <hr />
To properly shut down Windows 2000 Server, click the Start button, choose Shut Down, and then follow the directions that appear.
</div></blockquote>

<h2><a name="624">Lesson Summary</a></h2>


<p>To install Windows 2000 Server, you must run either Winnt.exe or Winnt32.exe. Winnt.exe is used on computers running MS-DOS or Windows 16-bit operating systems. Winnt32.exe is used on computers running Windows 32-bit operating systems (Windows 95, Windows 98, Windows NT, or Windows 2000). You can use a number of parameters with Winnt.exe and Winnt32.exe to customize how Windows 2000 Server is installed on your computer. Once one of the Setup files is launched, the Windows 2000 Server installation begins. This process takes place in four phases:</p>

<ol>
<li>Starting the Setup program is when you specify the components to install.</li>

<li>Running the Setup wizard which prompts you to provide the various information that setup cannot automatically determine.</li>

<li>Installing Windows Networking is when the setup program detects the installed network adapters.</li>

<li>Completing the Installation is when the setup program uses the information gathered in the prior steps to copy files, configure the computer and clean up the files as the installation is completed.</li>
</ol>

</body>
</html>



