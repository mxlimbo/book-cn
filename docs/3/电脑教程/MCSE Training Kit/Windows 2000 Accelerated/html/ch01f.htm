<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 5: Using Disk Duplication to Deploy Windows 2000 Professional</title>


</head>
<body>
<div class="prevnext"><p><a href="ch01e.htm">3</a> <a href="ch01g.htm">4</a></p></div>

<h1><a name="112">Lesson 5: Using Disk Duplication to Deploy Windows 2000 Professional</a></h1>

<p>When you install Windows 2000 Professional on several computers with identical hardware configurations, the most efficient installation method to use is disk duplication. By creating a disk image of a Windows 2000 Professional installation and copying that image to multiple destination computers, you save time in the mass installation of Windows 2000 Professional. This method also creates a convenient reference image that you can easily copy again to a computer that is experiencing significant problems.</p>
<p>Disk imaging and duplication technologies have been improved in Windows 2000 Professional over previous versions of Windows. One of the tools that you will use for disk duplication is the improved System Preparation tool (Sysprep.exe) that now ships with Windows 2000 Professional. Knowing how to use this tool can help support professionals prepare master disk images for efficient mass installations. You can use a number of third-party disk-imaging tools to copy the image to other computers. This lesson explains how to use the System Preparation tool to prepare the master image.</p>
<hr />
<p><b>After this lesson, you will be able to</b></p>
<ul>
<li>Install and use the Windows 2000 System Preparation tool to deploy Windows 2000 Professional</li>
</ul>
<p><b>Estimated lesson time: 25 minutes</b></p>
<hr />
<h2><a name="113">Examining the Disk Duplication Process</a></h2>

<p>To install Windows 2000 Professional by using disk duplication, you first need to install and configure Windows 2000 Professional on a test computer. After you have done this, you need to install and configure any applications and application update packs on the test computer. Then you run Sysprep.exe on the test computer to prepare the computer for duplication.</p>
<h2><a name="114">Extracting the Windows 2000 Professional System Preparation Tool</a></h2>

<p>Before you can use the Windows 2000 Professional System Preparation tool, you must copy the necessary files onto the computer you are using to create the master image. To copy the System Preparation tool, you must extract the files from the Deploy.cab file in the Support\Tools folder on the Windows 2000 Professional CD-ROM. For the steps to do this, see Exercise 1, &quot;<a href="ch01e.htm#109">Extracting the Windows 2000 Professional Installation Deployment Tools</a>,&quot; in Lesson 4 of this chapter.</p>
<h2><a name="115">Using the System Preparation Tool to Prepare the Master Image</a></h2>

<p>The System Preparation tool was developed to eliminate several problems you might encounter when copying disks. First of all, every computer must have a unique security ID (SID). If you copied an existing disk image to other computers, every computer on which the image was copied would have the same SID. To prevent this problem, the System Preparation tool adds a system service to the master image that will create a unique local domain SID the first time the computer to which the master image is copied is started.</p>
<p>The System Preparation tool also adds a Mini-Setup wizard to the master copy. The Mini-Setup wizard runs the first time the computer to which the master image is copied is started. The Mini-Setup wizard guides the user through the process of entering such user-specific information as the following:</p>
<ul>
<li>End-user license agreement</li>
<li>Product ID</li>
<li>Regional settings</li>
<li>User name</li>
<li>Company name</li>
<li>Network configuration</li>
<li>Whether the computer is joining a workgroup or domain</li>
<li>Time zone selection</li>
</ul>

<blockquote><div class="note"><b>NOTE</b><hr />
The Mini-Setup wizard can be scripted using the Setup Manager wizard so that this user-specific information can be entered automatically.
</div></blockquote>

<p>The System Preparation tool causes the master image to force the computer on which the master image is copied to run a full Plug and Play device detection. The hard disk controller device driver and the HAL on the computer on which the disk image was generated and on the computer to which the disk image was copied must be identical. The other peripherals, such as the network adapter, the video adapter, and sound cards on the computer on which the disk image was copied, need not be identical to the ones on the computer on which the image was generated.</p>
<p>The System Preparation tool can also be customized; Table 1.4 describes the switches that you can use to customize Sysprep.exe.</p>

<p><b>Table  1.4 </b> <i>Available Switches for Sysprep.exe</i></p>
<table>
<tr>
<th>Switch</th><th> Description</th>
</tr>
<tr>
<td>/quiet</td><td> Runs with no user interaction</td>
</tr>
<tr>
<td>/pnp </td><td>Forces Setup to detect Plug and Play devices on the 
 destination computers</td>
</tr>
<tr>
<td>/reboot </td><td>Restarts the source computer</td>
</tr>
<tr>
<td>/nosidgen </td><td>Doesn't regenerate SIDs on the destination computers</td>
</tr>
</table>

<p><img src="images/practice.jpg" /></p>
<h2><a name="116">Practice: Using the System Preparation Tool to Create a Master Disk Image</a></h2>

<p>In this practice, you will use the Windows 2000 System Preparation tool to prepare a master image for disk duplication.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
You must complete Exercise 1 of Lesson 4 in this chapter and extract the System Preparation tool from the Windows 2000 Professional CD-ROM before you can complete the following exercise.
</div></blockquote>

<blockquote><div class="caution"><b>CAUTION</b><hr />
If you complete the following exercise, you will have to reinstall Windows 2000 Professional on your computer.
</div></blockquote>

<h3><a name="117">Exercise 1: Using the System Preparation Tool</a></h3>

<ol>
<li>Log on as Administrator.</li>

<li>In Windows Explorer, double-click the Sysprep.exe file in the Deploy folder.

<p>A Windows 2000 Professional System Preparation Tool message box appears, warning you that running Sysprep might modify some of the security parameters of this system.</p>

<blockquote><div class="caution"><b>CAUTION</b><hr />
If you run Sysprep on your computer, you will lose some of the security parameters on your computer.
</div></blockquote></li>

<li>If you are certain that you don't mind having to reinstall Windows 2000 Professional, click OK to continue.</li>

<li>Your computer shuts down and prompts you to turn it off.</li>

<li>Turn off your computer.</li>
</ol>

<blockquote><div class="note"><b>NOTE</b><hr />
You can run the Setup Manager wizard to create a Sysprep.inf file. Sysprep.inf provides answers to the Mini-Setup wizard on the destination computers. You can also use this file to specify customized drivers. The Setup Manager wizard creates a Sysprep folder at the root of the drive image and places Sysprep.inf in this folder. The Mini-Setup wizard checks for Sysprep.inf in the Sysprep folder at the root of the drive in which Windows 2000 Professional is being installed.
</div></blockquote>


<h2><a name="118">Installing Windows 2000 Professional from a Master Disk Image</a></h2>


<p>After running Sysprep on your test computer, you are ready to run a third-party disk image copying tool to create a master disk image. Save the new disk image on a shared folder or CD-ROM. Copy this image to the multiple destination computers.</p>

<p>End users can then start the destination computers. The Mini-Setup wizard will prompt the user for computer-specific variables, such as the administrator password for the computer and the computer name. If a Sysprep.inf file was provided, the Mini-Setup wizard will be bypassed and the system will load Windows 2000 Professional without user intervention. You can also automate the completion of the Mini-Setup wizard further by creating a Sysprep.inf file.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
When you use disk duplication, the mass storage controllers and HALs for the test computer and all destination computers must be identical.
</div></blockquote>

<p><img src="images/practice.jpg" /></p>
<h2><a name="119">Practice: Using the System Preparation Tool to Install Windows 2000 Professional</a></h2>

<p>In this practice, you use a master disk image to install Windows 2000 Professional. You have just created a master disk image. Normally you would use a third-party tool to copy this disk image to another computer. For the purposes of this practice, you reinstall Windows 2000 Professional using the master disk image as if it were a computer that had the disk image copied to it.</p>

<h3><a name="120">Exercise 1: Installing Windows 2000 from a Master Image</a></h3>

<ol>
<li>Turn on your computer.

<p>After a few minutes, the Welcome To The Windows 2000 Setup wizard appears.</p></li>

<li>Click Next.
<p>The License Agreement page appears.</p></li>

<li>Read through the license agreement, click I Accept This Agreement, and then click Next.

<p>The Regional Settings page appears.</p></li>

<li>Ensure that the System Locale, the User Locale, and the Keyboard Layout are correct, and then click Next.

<p>The Personalize Your Software page appears.</p></li>

<li>In the Name box, type your name; in the Organization box, type your organization name, and then click Next.

<p>The Your Product Key page appears.</p></li>

<li>Enter your product key, and then click Next.

<p>The Computer Name And Administrator Password page appears.</p></li>

<li>In the Computer Name box, type <b>PRO1</b> (or type the name of your computer, if you are using another valid name for your network).</li>
<li>In the Password and Confirm Password boxes, type <b>password</b> and then click Next.

<p>The Modem Dialing Information page appears.</p></li>

<li>Select the appropriate setting for the What Country/Region Are You In Now? option.</li>
<li>Type the appropriate code for the What Area Code (Or City Code) Are You In Now? setting.</li>
<li>Type the appropriate number for the If You Dial A Number To Get An Outside Line, What Is It? setting.</li>
<li>Select the appropriate option for The Phone System At This Location Uses, and then click Next.

<p>The Date And Time Settings page appears.</p></li>

<li>Ensure that the Date, Time, and Time Zone settings are correct and that the Automatically Adjust Clock For Daylight Saving Changes check box is selected, if you want Windows 2000 Professional to adjust the clock. Then click Next.

<p>The Networking Settings page appears. This might take a few minutes.</p></li>

<li>Ensure that the default option, Typical Settings, is selected, and then click Next.

<p>The Workgroup Or Computer Domain page appears.</p></li>

<li>Ensure that the No, This Computer Is Not On A Network Or Is On A Network Without A Domain option is selected.</li>
<li>Ensure that WORKGROUP appears in the Workgroup Or Computer Domain box, and then click Next.

<p>The Performing Final Tasks page appears briefly, and then the Completing The Windows 2000 Setup Wizard page appears. This might take a few minutes while Setup completes.</p></li>

<li>Click Finish.

<p>The computer restarts, and the Welcome To The Network Identification wizard appears.</p></li>

<li>Click Next.

<p>The Users Of This Computer page appears.</p></li>

<li>Click Users Must Enter A User Name And Password To Use This Computer, and then click Next.

<p>The Completing The Network Identification wizard appears.</p></li>

<li>Click Finish.</li>
<li>Log on as Administrator with a password of <b>password</b>.</li>
</ol>

<h2><a name="121">Lesson Summary</a></h2>


<p>The System Preparation tool (Sysprep.exe) described in this lesson prepares the master computer to be duplicated. One of the primary functions of the System Preparation tool is to delete SIDs and all other user-specific or computer-specific information. You can use four switches to customize Sysprep.exe.</p>

<p>This lesson also showed you that after you run Sysprep.exe on the master computer, you can use a third-party tool to capture the image and copy it to the destination computers. When the user restarts the destination computer, the Mini-Setup wizard appears. You can also automate the completion of the Mini-Setup wizard further by creating a Sysprep.inf file.</p>

</body>
</html>



