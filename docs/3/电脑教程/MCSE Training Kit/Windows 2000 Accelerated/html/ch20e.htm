<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 4: Troubleshooting Group Policy</title>


</head>
<body>
<div class="prevnext"><p><a href="ch20d.htm">3</a> <a href="ch20f.htm">4</a></p></div>

<h1><a name="1470">Lesson 4: Troubleshooting Group Policy</a></h1>


<p>This lesson describes problems you may encounter that relate to Group Policy. It also describes some best practices you should employ to keep Group Policy troubleshooting activities to a minimum.</p>

<hr />
<p><b>After this lesson, you will be able to</b> </p>

<ul>
<li>Troubleshoot Group Policy</li>

<li>Employ best practices for Group Policy</li>
</ul>

<p><b>Estimated lesson time: 10 minutes</b> </p>
<hr />

<h2><a name="1471">Troubleshooting Group Policy</a></h2>


<p>An important part of troubleshooting Group Policy problems is to consider dependencies between components. For example, Software Installation relies on Group Policy, and Group Policy relies on Active Directory directory services. Active Directory relies on proper configuration of network services. When trying to fix problems that appear in one component, it is generally helpful to check whether components, services, and resources on which it relies are working correctly. Event logs are useful for tracking down problems caused by this type of hierarchical dependency.</p>

<p>Table 20.8 describes scenarios in which there are problems that might occur with Group Policy snap-in.</p>

<p><b>Table 20.8</b>  <i>Group Policy Snap-In Problems and Solutions</i></p>
<table>
<tr>
<th colspan="2">Symptom: The user cannot open a GPO even though he or she has Read access to it</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>An administrator must have both Read permission and Write permission for the GPO to open it in the Group Policy snap-in</td><td>Be a member of a security group with Read and Write permission for the GPO. For example, a domain administrator can manage nonlocal GPOs. An administrator for a computer can edit the local GPO on that computer.</td>
</tr>
</table>
<table>
<tr>
<th colspan="2">Symptom: When the user tries to edit a GPO, the &quot;Failed To Open The Group Policy Object&quot; message appears</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>A networking problem, specifically a problem with the Domain Name System (DNS) configuration</td><td>Make sure DNS is working properly.</td>
</tr>
</table>
<p>Table 20.9 describes scenarios where Group Policy settings are not taking effect.</p>

<p><b>Table 20.9</b>  <i>Group Policy Settings Problems and Solutions</i></p>
<table>
<tr>
<th colspan="2">Symptom: Group Policy is not being applied to users and computers in a security group that contains those users and computers, even though a GPO is linked to an OU containing that security group</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>This is correct behavior. Group Policy affects only users and computers contained in sites, domains, and OUs.GPOs are not applied to security groups.</td><td>Link GPOs to sites, domains, and OUs only. Keep in mind that the location of a security group in Active Directory is unrelated to whether Group Policy applies to the users and computers in that security group.</td>
</tr>
</table>

<table>
<tr>
<th colspan="2">Symptom: Group Policy is not affecting users and computers in a site, domain, or OU</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>Group Policy settings can be prevented,intentionally or inadvertently, from taking effect on users and computers in several ways. A GPO can be disabled from affecting users, computers, or both. It also needs to be linked either directly to an OU containing the users and computers or linked to a parent domain or OU so that the Group Policy settings apply through inheritance. When multiple GPOs apply, they are processed in this order: local, site, domain, OU. By default, settings applied later have precedence. In addition, Group Policy can be blocked at the level of any OU, or enforced through a setting of No Override applied to a particular GPO 
link.Finally, the user or computer must belong to one or more security groups with appropriate permissions set.</td><td> Make sure that the intended policy is not being blocked. Make sure no policy set at a higher level of Active Directory has been set to No Override. If Block Policy Inheritance and No Override are both used, keep in mind that No Override takes precedence. Verify that the user or computer is not a member of any security group for which the Accelerated Graphics Port (AGP) permission is set to Deny.Verify that the user or computer is a mem ber of at least one security group for which the AGP permission is set to Allow.Verify that the user or computer is a member of at least one security group for which the Read permission is set to Allow. </td>
</tr>
</table>

<table>
<tr>
<th colspan="2">Symptom: Group Policy is not affecting users and computers in an Active Directory container</th>
</tr>
<tr>
<th>Cause</th><th>Solution</th>
</tr>
<tr>
<td>GPOs cannot be linked to Active Directory containers other than sites, domains, and OUs.</td><td>Link a GPO to an OU that is a parent to  the Active Directory container. Then, by default, those settings are applied to the users and computers in the container through inheritance.</td>
</tr>
</table>

<table>
<tr>
<th colspan="2">Symptom: Group Policy is not taking effect on the local computer</th>
</tr>
<tr>
<th>Cause</th><th>Solution</th>
</tr>
<tr>
<td>Local policies are the weakest. Any nonlocal GPO can overwrite them.</td><td>Check to see what GPOs are being applied 
 through Active Directory and if those GPOs have settings that are in conflict with the local settings.</td>
</tr>
</table>

<p>Table 20.10 describes scenarios in which there are problems using the Software Installation extension.</p>

<p><b>Table 20.10</b>  <i>Software Installation Extension Problems and Solutions</i></p>
<table>
<tr>
<th colspan="2">Symptom: Published applications do not appear in Add/Remove Programs in Control Panel</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>Several causes are possible: Group Policy was not applied; Active Directory cannot be accessed;user does not have any published 
applications in the GPOs that apply to him or her; Client is running Terminal Server.</td><td>Investigate each possibility. Note that 
Software Installation is not supported for Terminal Server clients.</td>
</tr>
</table>
<table>
<tr>
<th colspan="2">Symptom: Document activation of a published application does not cause the application to install.</th>
</tr>
<tr>
<th>Cause</th><th>Solution</th>
</tr>
<tr>
<td>The administrator did not set auto-install.</td><td> Ensure that Auto-Install This Application 
 By File Extension Activation is checked in the Deployment tab in the application's properties sheet.</td>
</tr>
</table>

<table>
<tr>
<th colspan="2">Symptom: The user receives an error message such as &quot;The feature you are trying to install cannot be found in the source directory&quot;</th>
</tr>
<tr>
<th>Cause</th><th>Solution</th>
</tr>
<tr>
<td>There are Network or permissions problems.</td><td>Make sure the network is working correctly. 
 Ensure that the user has Read and AGP permission for the GPO. Ensure that the user has Read permission for the SDP. Ensure that the user has Read permission for the application.</td>
</tr>
</table>
<table>
<tr>
<th colspan="2">Symptom: After removal of an application, the shortcuts for the application still appear on the user's desktop</th>
</tr>
<tr>
<th>Cause</th><th>Solution</th>
</tr>
<tr>
<td>The user has created shortcuts and Windows Installer has no knowledge of them.</td><td>The user must remove the shortcuts 
 manually. </td>
</tr>
</table>
<table>
<tr>
<th colspan="2">Symptom: The user receives an error message such as &quot;Another Installation Is Already In Progress&quot;</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>An uninstallation might be taking place in the background with no user interface presented, or the user might 
have inadvertently triggered two installations simultaneously (which is not supported).</td><td>The user can try again later.</td>
</tr>
</table>
<table>
<tr>
<th colspan="2">Symptom: The user opens an already installed application, and the Windows Installer starts</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>An application might be undergoing automatic repair, or a user-required feature is being added.</td><td>No action is required.</td>
</tr>
</table>
<table>
<tr>
<th colspan="2">Symptom: The user receives error messages such as &quot;Active Directory Will Not Allow The Package To Be Deployed&quot; or &quot;Cannot Prepare Package For Deployment&quot;</th>
</tr>
<tr>
<th>Cause </th><th>Solution</th>
</tr>
<tr>
<td>The package might be corrupted or there might be a networking problem.</td><td>Investigate and take appropriate action</td>
</tr>
</table>

<h2><a name="1472">Group Policy Best Practices</a></h2>


<p>The following best practices should minimize your need to troubleshoot Group Policy.</p>

<h3><a name="1473">General Group Policy Practices</a></h3>


<ul>
<li><b>Disable unused parts of a GPO.</b> If a GPO only has settings, under the User Configuration or Computer Configuration node of the console, that are Not Configured, you can avoid processing those settings by disabling the node. This expedites startup and logon for those users and computers subject to the GPO.</li>

<li><b>Use the Block Policy Inheritance and No Override features sparingly.</b> Routine use of these features makes it difficult to troubleshoot Group Policy.</li>

<li><b>Minimize the number of GPOs associated with users or computers in domains or OUs.</b>The more GPOs applied to a user, the longer it takes to start up and log on.</li>

<li><b>Filter policy based on security group membership.</b> Users who do not have permissions directing that a particular GPO be applied to them can avoid the associated logon delay, because the GPO will not be processed for those users.</li>

<li><b>Use loopback only when necessary.</b> Use loopback only if you need the desktop configuration to be the same regardless of who logs on.</li>

<li><b>Avoid cross-domain GPO assignments.</b> The processing of GPOs will slow logon and startup if Group Policy is obtained from another domain.</li>
</ul>

<h3><a name="1474">Software Installation Practices</a></h3>


<ul>
<li><b>Specify application categories for your organization.</b> Using categories makes it easier for users to find an application in Add/Remove Programs in Control Panel. For example, you could define categories such as Sales Applications, Accounting Applications, and so on.</li>

<li><b>Make sure Windows Installer packages include modifications before they are published or assigned.</b> Remember that modifications are applied to packages at the time of assignment or publication. In practical terms, this means that you should make sure the Modifications tab of the package Properties dialog box is set up as you intend before you click OK. If you neglect to do this, and assign or publish a modified package before you have completely configured it, you can either remove the software and republish or reassign it or upgrade the software with a completely modified version.</li>

<li><b>Assign or publish just once per GPO.</b> A Windows Installer package should be assigned or published no more than once in the same GPO. For example, if you assign Microsoft Office to the computers affected by a GPO, do not assign or publish it to users affected by the GPO.</li>

<li><b>Take advantage of authoring tools.</b> Developers familiar with the files, registry entries, and other requirements for an application to work properly can author native Windows Installer packages using tools available from various software vendors.</li>

<li><b>Repackage existing software.</b> You can use commercially available tools to create Windows Installer packages for software that does not include natively authored .msi files. These tools work by comparing a computer's state before and after installation. For best results, install the software onto a computer free of other application software (perform a clean installation).</li>

<li><b>Use SMS and Dfs.</b> Microsoft Systems Management Server (SMS) and the Windows 2000 Distributed File System (Dfs) are helpful in managing the SDPs (the network shares from which users install their managed software).</li>

<li><b>Assign or publish close to the root in the Active Directory hierarchy.</b> Because Group Policy settings apply by default to child Active Directory containers, it is efficient to assign or publish by linking a GPO to a parent OU or domain. Use security descriptors (such as Access Control Entries [ACEs]) on the GPO for finer control over who receives the software.</li>

<li><b>Use Software Installation properties for widely scoped control.</b> This spares administrative keystrokes when assigning or publishing a large number of packages with similar properties in a single GPO&#8212;for example, when all the software is published and it all comes from the same SDP.</li>

<li><b>Use Windows Installer package properties for fine control.</b>  Use the package properties for assigning or publishing a single package.</li>
</ul>

<h3><a name="1475">Folder Redirection Practices</a></h3>


<ul>
<li><b>Incorporate %username% into fully qualified UNC paths.</b>  This allows users to have their own folders. For example, the user could specify <i>\\server\share</i>\%username%\My Documents and the username would be included in the path.</li>

<li><b>Have My Pictures follow My Documents.</b> This is advisable unless there is a compelling reason not to, such as file share scalability.</li>

<li><b>Consider effects of policy removal.</b> Keep in mind the behavior your Folder Redirection policies will have upon policy removal, as described in &quot;<a href="ch20d.htm#1468">Policy Removal Considerations</a>.&quot;</li>

<li><b>Accept defaults.</b>  In general, accept the default Folder Redirection settings.</li>
</ul>

<h2><a name="1476">Lesson Summary</a></h2>


<p>In this lesson you examined some Group Policy problems that you may encounter and possible solutions. You also learned some best practices for handling Group Policy.</p>

</body>
</html>



