<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 5: Implementing an Audit Policy</title>


</head>
<body>
<div class="prevnext"><p><a href="ch07e.htm">3</a> <a href="ch07g.htm">4</a></p></div>

<h1><a name="561">Lesson 5: Implementing an Audit Policy</a></h1>


<p>Auditing is a powerful capability used for tracking events on computers. To implement auditing, you need to meet the auditing requirements and set the audit policy. After you set an audit policy on a computer, you can implement auditing on files, folders, and printers.</p>

<hr />
<p><b>After this lesson, you will be able to</b></p>
<ul>
<li>Set up auditing on files and folders</li>
<li>Set up auditing on printers</li>
</ul>
<p><b>Estimated lesson time: 25 minutes</b></p>
<hr />

<h2><a name="562">Configuring Auditing</a></h2>


<p>For computers running Windows 2000 Professional, you set up an audit policy for each individual computer.</p>

<h3><a name="563">Auditing Requirements</a></h3>


<p>The following are the requirements to set up and administer auditing:</p>

<ul>
<li>You must have the Manage Auditing And Security Log user right for the computer on which you want to configure an audit policy or review an audit log. By default, Windows 2000 grants these rights to the Administrators group.</li>
<li>The files and folders to be audited must be on Microsoft Windows 2000 File System (NTFS) volumes.</li>
</ul>



<h3><a name="564">Setting Up Auditing</a></h3>


<p>Setting up auditing is a two-part process:</p>

<ol>
<li>Set the audit policy. The audit policy enables auditing of objects but doesn't activate auditing of specific objects.</li>
<li>Enable auditing of specific resources. You specify the specific events to audit for files, folders, printers, and Active Directory objects. Windows 2000 then tracks and logs the specified events.</li>
</ol>

<h2><a name="565">Setting an Audit Policy</a></h2>


<p>The first step in implementing an audit policy is selecting the types of events that Windows 2000 audits. For each event that you can audit, the configuration settings indicate whether to track successful or failed attempts. You set audit policies in the Local Security Settings window, which you open by selecting Local Security Policy on the Administrative Tools menu.</p>

<p>Table 7.8 describes the types of events that Windows 2000 can audit.</p>

<p><b>Table 7.8</b><i> Types of Events Audited by Windows 2000</i></p>

<table>
<tr><th>Event</th><th>Description</th></tr>
<tr><td>Account Logon Events</td><td>A domain controller received a request to validate a user 
account. (This is applicable only if your computer running Windows 2000 Professional joins a Windows 2000 domain.)</td></tr>

<tr><td>Account Management group.</td><td>An administrator created, changed, or deleted a user account or 
A user account was renamed, disabled, or enabled, or a password was set or changed.</td></tr>

<tr><td>Directory Service Access</td><td>A user gained access to an Active Directory object. You must 
configure specific Active Directory objects for auditing to log this type of event. (Active Directory directory services are available only if your computer running Windows 2000 Professional joins a Windows 2000 domain.)</td></tr>

<tr><td>Logon Events</td><td>A user logged on or logged off, or a user made or canceled a network connection to the computer.</td></tr>

<tr><td>Object Access</td><td>A user gained access to a file, folder, or printer. You must configure specific files, folders, or printers for auditing. Object access is auditing a user's access to files, folders, and printers.</td></tr>

<tr><td>Policy Change</td><td>A change was made to the user security options, user rights, or audit policies.</td></tr>

<tr><td>Privilege Use</td><td>A user exercised a right, such as changing the system time. (This doesn't include rights that are related to logging on and logging off.)</td></tr>

<tr><td>Process Tracking</td><td>A program performed an action. This information is generally useful only for programmers who want to track details of program execution.</td></tr>

<tr><td>System Events</td><td>A user restarted or shut down the computer, or an event occurred that affects Windows 2000 security or the security log. (For example, the audit log is full and Windows 2000 starts discarding entries.)</td></tr>
</table>

<p><b>Follow these steps to set an audit policy on a computer that is running Windows 2000 Professional:</b></p>

<ol>
<li>Click Start, point to Programs, point to Administrative Tools, and then click Local Security Policy.</li>
<li>In the Local Security Settings window's console tree, double-click Local Policies, and then click Audit Policy.
<p>The console displays the current audit policy settings in the details pane, as shown in Figure 7.7.</p>

<div class="figure">
<a href="javascript:fullSize('F07cc07x.htm')"><img src="images/F07cc07.JPG" /></a>
<div class="caption"><b>Figure 7.7</b> <i>Events that Windows 2000 can audit</i>
</div>
</div>
</li>

<li>Select the type of event to audit, and then, on the Action menu, click Security.
<p>The Local Security Policy Setting dialog box appears for the selected event. Figure 7.8 shows the Local Security Policy Setting dialog box for Audit Logon Events, and Table 7.9 defines the fields available in the Local Security Policy Setting dialog box.</p></li>
<li>Select the Success check box, the Failure check box, or both.</li>
<li>Click OK.</li>
<li>Restart your computer.

<div class="figure">
<img src="images/F07cc08.JPG" />
<div class="caption"><b>Figure 7.8</b> <i>The Local Security Policy Setting dialog box for Audit Logon Events</i></div></div>


<p><b>Table 7.9</b><i> Local Security Policy Setting Dialog Box Fields</i></p>

<table>
<tr><th>Field</th><th>Description</th></tr>

<tr><td>Effective Policy Setting</td><td>Indicates whether or not auditing is turned on. 
No auditing indicates it is auditing this event. 
Failure indicates it is auditing failed attempts. 
Success indicates it is auditing successful attempts. 
Success, Failure indicates it is auditing all attempts.</td></tr>

<tr><td>Local Policy Setting</td><td>A check mark in the Success check box indicates that auditing is in effect for successful attempts. A check mark in the Failure check box indicates that auditing is in effect for failed attempts.</td></tr>
</table>

<p>Once you have set the audit policy, remember that the changes that you make to your computer's audit policy don't take effect until you restart your computer.</p>
</li>
</ol>

<h2><a name="566">Auditing Access to Files and Folders</a></h2>


<p>If security breaches are an issue for your organization, you can set up auditing for files and folders on NTFS partitions. To audit user access to files and folders, you must first set your audit policy to audit access to objects, which includes files and folders.</p>

<p>Once you have set your audit policy to audit access to objects, you enable auditing for specific files and folders and specify which types of access, by which users or groups, to audit.</p>

<p><b>Follow these steps to enable auditing for specific files and folders:</b></p>

<ol>
<li>On the Security tab in the Properties dialog box for a file or folder, click Advanced.</li>
<li>On the Auditing tab, click Add, select the users for whom you want to audit file and folder access, and then click OK.</li>
<li>In the Auditing Entry dialog box, select the Successful check box or the Failed check box for the events that you want to audit. For a list of the events, see Figure 7.9.

<div class="figure">
<img src="images/F07cc09.JPG" />
<div class="caption"><b>Figure 7.9</b> <i>Events that can be audited for files and folders</i></div></div>

<p>Table 7.10 describes when to audit these events.</p>
</li>
<li>Click OK to return to the Access Control Settings dialog box.
<p>By default, any auditing changes that you make to a parent folder also apply to all child folders and all files in the parent and child folders.</p></li>
<li>To prevent changes that are made to a parent folder from applying to the currently selected file or folder, clear the Allow Inheritable Auditing Entries From Parent To Propagate To This Object check box.</li>
<li>Click OK.

<p><b>Table 7.10</b><i> User Events and What Triggers Them</i></p>

<table>
<tr><th>Event</th><th>User activity that triggers the event</th></tr>
<tr><td>Traverse Folder/Execute File</td><td>Running a program or gaining access to a folder to change directories</td></tr>
<tr><td>List Folder/Read Data</td><td>Displaying the contents of a file or folder</td></tr>
<tr><td>Read Attributes<br />Read Extended Attributes</td><td>Displaying the attributes of a file or folder</td></tr>
<tr><td>Create Files/Write Data</td><td>Changing the contents of a file or creating new files in a folder</td></tr>
<tr><td>Create Folders/Append Data</td><td>Creating folders in the folder</td></tr>
<tr><td>Write Attributes<br />Write Extended Attributes</td><td>Changing attributes of a file or folder</td></tr>
<tr><td>Delete Subfolders And Files</td><td>Deleting a file or subfolder in a folder</td></tr>
<tr><td>Delete</td><td>Deleting a file or folder</td></tr>
<tr><td>Read Permissions</td><td>Viewing permissions or the file owner for a file or folder</td></tr>
<tr><td>Change Permissions</td><td>Changing permissions for a file or folder</td></tr>
<tr><td>Take Ownership</td><td>Taking ownership of a file or folder</td></tr>
</table>
</li>
</ol>

<h2><a name="567">Auditing Access to Printers</a></h2>


<p>Audit access to printers to track access to sensitive printers. To audit access to printers, set your audit policy to audit access to objects, which include printers. Then enable auditing for specific printers and specify which types of access to audit and which users will have access. After you select the printer, you use the same steps that you use to set up auditing on files and folders.</p>

<p><b>Follow these steps to set up auditing on a printer:</b></p>

<ol>
<li>In the Properties dialog box for the printer, click the Security tab, and then click Advanced.</li>
<li>On the Auditing tab, click Add, select the appropriate users or groups for whom you want to audit printer access, and then click OK.</li>
<li>In the Apply Onto box in the Auditing Entry dialog box, select resource where the auditing setting applies.</li>
<li>Under Access, select the Successful check box or the Failed check box for the events that you want to audit (see Figure 7.10).</li>
<li>Click OK in the appropriate dialog boxes to exit.</li>
</ol>

<div class="figure">
<img src="images/F07cc10.JPG" />
<div class="caption"><b>Figure 7.10</b> <i>Printer events that can be audited</i></div></div>


<p>Table 7.11 describes what user activities trigger events for printers.</p>

<p><b>Table 7.11</b><i> Printer Events and What Triggers Them</i></p>

<table>
<tr><th>Event</th><th>User activity that triggers the event</th></tr>
<tr><td>Print</td><td>Printing a file</td></tr>
<tr><td>Manage Printers</td><td>Changing printer settings, pausing a printer, sharing a printer, or removing a printer</td></tr>
<tr><td>Manage Documents</td><td>Changing job settings; pausing, restarting, moving, or deleting documents; sharing a printer; or changing printer properties</td></tr>
<tr><td>Read Permissions</td><td>Viewing printer permissions</td></tr>
<tr><td>Change Permissions</td><td>Changing printer permissions</td></tr>
<tr><td>Take Ownership</td><td>Taking printer ownership</td></tr>
</table>

<h2><a name="568">Lesson Summary</a></h2>


<p>In this lesson, you learned that the first step in implementing an audit policy is selecting the types of events that Windows 2000 audits. You can select the events to audit for files and folders, and you can select the events you want to audit for printers. For each event that you can audit, the configuration settings indicate whether to track successful attempts, failed attempts, or both. You use the Local Security Settings window to set audit policies, and then you restart your computer to enable auditing.</p>

<p>You also learned that you can set up auditing for access to files, folders, and printers on NTFS partitions. To do so, you must first set your audit policy to audit access to objects, which includes files, folders, and printers. Once you have set your audit policy to audit object access, you enable auditing for specific files, folders, and printers and specify which types of access, by which users or groups, to audit.</p>

</body>
</html>



