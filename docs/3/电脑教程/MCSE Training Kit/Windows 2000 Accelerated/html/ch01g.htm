<!DOCTYPE html SYSTEM "msxhtml1-strict.dtd">
<html lang="en" xml:lang="en">
<head>
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" language="JavaScript" src="expando.js"></script>
<title>Lesson 6: Performing Remote Installations</title>


</head>
<body>
<div class="prevnext"><p><a href="ch01f.htm">3</a> <a href="ch01h.htm">4</a></p></div>

<h1><a name="122">Lesson 6: Performing Remote Installations</a></h1>


<p>When you are deploying Windows 2000 Professional over a very large or geographically disparate set of systems, one of the most efficient methods is to use remote installation. You can perform remote installations of Windows 2000 Professional if you have a Windows 2000 Server infrastructure in place and the computers in your network support remote boot.</p>
<blockquote><div class="note"><b>NOTE</b><hr />

For more information about installing and configuring Windows 2000 Server, see Section II, <a href="ch08a.htm">Chapter 8</a>, &quot;Installing Microsoft Windows 2000 Server&quot; in this book.
</div></blockquote>
<hr />

<p><b>After this lesson, you will be able to</b></p>
<ul>
<li>Describe how to deploy Windows 2000 Professional using Remote Installation Services (RIS)</li>
<li>Install RIS</li>
<li>Create a boot floppy</li>
</ul>
<p><b>Estimated lesson time: 40 minutes</b></p>
<hr />

<blockquote><div class="note"><b>NOTE</b><hr />
To be able to install RIS and to create a boot floppy for network interface cards that are not equipped with a Pre-Boot Execution Environment (PXE) boot ROM, or for systems with BIOSs that don't support starting from the PXE boot ROM, you must have a computer running one of the Windows 2000 Server family of products. You must also have either the CD-ROM or access to a network source of files used to install the Server product. For more information, see the section &quot;<a href="ch01g.htm#125">Examining the Prerequisites</a>&quot; below.
</div></blockquote>

<h2><a name="123">Understanding Remote Installation</a></h2>


<p>Remote installation is the process of connecting to a server running Remote Installation Services, called the RIS server, and then starting an automated installation of Windows 2000 Professional on a local computer. Remote installation enables administrators to install Windows 2000 Professional on client computers throughout a network from a central location. This reduces the time administrators spend visiting all the computers in a network, thereby reducing the cost of deploying Windows 2000 Professional.</p>

<p>RIS provides the following benefits:</p>

<ul>
<li>Enables remote installation of Windows 2000 Professional</li>

<li>Simplifies server image management by eliminating hardware-specific images and by detecting Plug and Play hardware during setup</li>

<li>Supports recovery of the operating system and computer in the event of computer failure</li>

<li>Retains security settings after restarting the destination computer</li>

<li>Reduces the total cost of operations by allowing either users or technical staff to install the operating system on individual computers</li>

</ul>

<h2><a name="124">Installing and Configuring Remote Installation Services</a></h2>


<p>Before beginning a mass installation of Windows 2000 Professional using RIS, become familiar with the prerequisites for the service and install the service using the Remote Installation Services Setup wizard.</p>

<h3><a name="125">Examining the Prerequisites</a></h3>


<p>RIS is available only on computers running one of the Windows 2000 Server family of products. The RIS server can be a domain controller or a member server. Table 1.5 lists the network services required for RIS and their RIS function. These network services don't have to be installed on the same computer as RIS, but they must be available somewhere on the network.</p>

<p><b>Table 1.5 </b><i> Network Services Required for RIS</i></p>
<table>
<tr>
<th>Network service</th><th>RIS function</th>
</tr>
<tr>
<td>DNS Service </td><td>RIS relies on the DNS server for locating both the directory service and client computer accounts.</td>
</tr>
<tr>
<td>DHCP Service </td><td>Client computers that can perform a network boot receive an IP address from the DHCP server.</td>
</tr>
<tr>
<td>Active Directory directory services</td><td>RIS relies on the directory services based on Active Directory 
 technology in Windows 2000 for locating existing client computers as well as existing RIS servers</td>
</tr>
</table>

<p>Remote installation requires that RIS (included on the Windows 2000 Server CD-ROM) be installed on a volume that is shared over the network. This shared volume must meet the following criteria:</p>

<ul>
<li>The shared volume can't be on the same drive that is running Windows 2000 Server;</li>

<li>The shared volume must be large enough to hold the RIS software and the various Windows 2000 Professional images; and</li>

<li>The shared volume must be formatted with the Microsoft Windows 2000 File System (NTFS).</li>
</ul>

<h3><a name="126">Using the Remote Installation Services Setup Wizard</a></h3>


<p>When your network meets the prerequisites for RIS, you can run the Remote Installation Services Setup wizard, which does the following:</p>

<ul>
<li>Installs the RIS software</li>
<li>Creates the remote installation folder and copies the Windows 2000 Professional installation files to the server</li>
<li>Adds .SIF files, which are a variation of an Unattend.txt file</li>
<li>Configures the Client Installation Wizard screens that will appear during a remote installation</li>
<li>Updates the registry</li>
<li>Starts RIS</li>
</ul>

<p>When installation of RIS is complete, you can configure it using the server's computer object in the Active Directory Users And Computers snap-in.</p>

<p>The RIS server stores the RIS images used to automatically install Windows 2000 Professional on client computers that are enabled for remote boot. The RIS server can be a domain controller or a standalone server that is a member of a domain containing Active Directory directory services.</p>

<p><img src="images/practice.jpg" /></p>
<h2><a name="127">Practice: Installing RIS</a></h2>

<p>In this practice, you install Windows 2000 Remote Installation Services from a Windows 2000 Server CD-ROM.</p>
<blockquote><div class="note"><b>NOTE</b><hr />

To complete this exercise, you must have a Windows 2000 Professional CD-ROM or access to a shared folder that contains the Windows 2000 Professional installation files. You must also have a drive on the computer running one of the Windows 2000 Server family of products on which you installed RIS that is formatted with NTFS version 5 or later and that contains enough room to hold the Windows 2000 Professional installation files. You must have available on your network a DHCP server, a DNS server, and a domain.
</div></blockquote>

<h3><a name="128">Exercise 1: Installing Remote Installation Services</a></h3>


<p>In this exercise, you install Remote Installation Services on a computer running Windows 2000 Server.</p>

<ol>
<li>Log on as Administrator, and insert the Windows 2000 Server CD-ROM into your CD-ROM drive.</li>

<li>Open Control Panel, and double-click Add/Remove Programs.

<p>The Add/Remove Programs window appears.</p></li>

<li>Click Add/Remove Windows Components.

<p>The Windows Components page of the Windows Components wizard appears.</p></li>

<li>Select the Remote Installation Services check box in the Components box, and then click Next.

<p>Setup installs and configures RIS.</p>

<p>The Completing The Windows Components Wizard page appears.</p></li>

<li>Click Finish.

<p>The System Settings Change dialog box appears, indicating that you must reboot before the new settings will take effect.</p></li>

<li>Remove the Windows 2000 Server CD-ROM from your CD-ROM drive and click Yes.</li>
</ol>

<h3><a name="129">Exercise 2: Configuring Remote Installation Services</a></h3>

<p>In this exercise, you configure RIS.</p>

<ol>
<li>Log on as Administrator.

<p>The Microsoft Windows 2000 Configure Your Server screen appears, indicating that you have selected components that require additional configuration.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
If the Microsoft Windows 2000 Configure Your Server screen doesn't appear after you restart and log on as Administrator, open Control Panel, double-click Add/Remove Programs, and click Add/Remove Windows Components. Under Set Up Services, you should see the Configure Remote Installation Services item with an associated Configure button. Skip step 2 that follows and proceed with step 3.
</div></blockquote></li>

<li>Click Finish Setup.

<p>The Add/Remove Programs window appears, indicating that you now need to configure Remote Installation Services.</p></li>

<li>Click Configure.

<p>The Remote Installation Services Setup wizard appears.</p></li>
<li>Insert the Windows 2000 Professional CD-ROM in the CD-ROM drive of the server. If the Microsoft Windows 2000 CD dialog box appears, click Exit.</li>

<li>Read the information on the welcome screen and then click Next.

<p>The Remote Installation Folder Location page appears.</p>

<p>Notice that the drive on which you create the Remote Installation folder can't be the system drive and must be formatted with NTFS version 5 or later.</p></li>

<li>Type <b>E:\RemoteInst</b> in the Path box, and click Next.



<blockquote><div class="note"><b>NOTE</b><hr />
Enter a path that is appropriate for your system. The folder should not exist; it will be created as part of the configuration process. Remember that the drive must be on the computer on which you installed RIS, must be formatted with NTFS version 5 or later, and must have about 300 MB of space available to hold the Windows 2000 Professional installation files.</div></blockquote>
<p>The Initial Settings page appears.</p>
<blockquote><div class="note"><b>NOTE</b><hr />
By default, the RIS server doesn't support client computers until you configure it to do so.</div></blockquote></li>

<li>Select the Respond To Client Computers Requesting Service check box and then click Next.

<p>The Installation Source Files Location page appears.</p></li>

<li>Enter the path to the installation source files and then click Next.

<blockquote><div class="note"><b>NOTE</b><hr />
If you were using a Windows 2000 Professional CD-ROM in the CD-ROM drive of the server on which you were configuring RIS, you would enter <b><i>x</i>:\i386</b>, where <i>x</i> is the drive letter for the CD-ROM drive.
</div></blockquote>

<p>The Windows Installation Image Folder Name page appears.</p></li>

<li>Click Next to accept the default name of Win2000.pro.

<p>The Friendly Description And Help Text page appears.</p></li>

<li>Click Next to accept the default friendly description and help text.

<p>The Review Settings page appears.</p>

<blockquote><div class="note"><b>NOTE</b><hr />
The default description is &quot;Microsoft Windows 2000 Professional.&quot; The help text is &quot;Automatically installs Windows Professional without prompting the user for input.&quot;
</div></blockquote></li>

<li>Review the information, and then click Finish.


<p>It will take several minutes for the following tasks to be completed:</p>

<ul>

<li>The remote installation folder is created.</li>

<li>The files needed by the services are copied.</li>

<li>The Windows installation files are copied.</li>

<li>The Client Installation Wizard screen files are updated.</li>

<li>A new unattended Setup answer file is created.</li>

<li>RIS is created.</li>

<li>The registry is updated.</li>

<li>The required remote installation services are started.</li>

</ul>
</li>

<li>When all the tasks are completed, click Done and close any open windows.</li>

</ol>

<h2><a name="130">Understanding Client Requirements for Remote Installation</a></h2>


<p>Client computers that support remote installation must have one of the following configurations:</p>

<ul>

<li>A configuration meeting the Net PC specification</li>

<li>A network interface card with a PXE boot ROM and BIOS support for starting from the PXE boot ROM</li>

<li>A supported network interface card and a remote installation boot disk</li>
</ul>

<h2><a name="131">Net PCs</a></h2>


<p>The Net PC is a highly manageable platform that can perform a network boot and manage upgrades and prevents users from changing the hardware or operating system configuration. Additional requirements for the Net PC are the following:</p>

<ul>

<li>The network adapter must be set as the primary boot device within the system BIOS.</li>

<li>The user account that will be used to perform the installation must be assigned the user right &quot;Log on as a batch job.&quot;

<blockquote><div class="note"><b>NOTE</b><hr />
The Administrator group doesn't have the right to log on to a batch job by default and thus needs to be assigned this right before attempting a remote installation.
</div></blockquote></li>

<li>Users must be assigned permission to create computer accounts in the domain that they are joining. The domain is specified in the advanced settings on the RIS server.</li>
</ul>

<h2><a name="132">Computers Not Meeting the Net PC Specification</a></h2>


<p>Computers that don't directly meet the Net PC specification can still interact with the RIS server. You can enable remote installation on a computer that doesn't meet the Net PC specification by doing the following:</p>

<ol>

<li>Install a network interface card with a PXE boot ROM.</li>

<li>Set the BIOS to start from the PXE boot ROM.</li>

<li>Assign the user right &quot;Log on as a batch job&quot; to the user account that will be used to perform the installation.</li>

<li>Assign users permission to create computer accounts in the domain that they are joining. You specify the domain in the advanced settings on the RIS server.</li>
</ol>

<h2><a name="133">Creating Boot Floppies</a></h2>


<p>If the network interface card in a client isn't equipped with a PXE boot ROM or the BIOS doesn't allow starting from the network interface card, create a remote installation boot disk. The boot disk simulates the PXE boot process. Windows 2000 Professional ships with the Windows 2000 Remote Boot Disk Generator that allows you to easily create a boot disk (see Figure 1.7).</p>

<div class="figure">
<img src="images/F01cc07.JPG" />
<div class="caption"><b>Figure 1.7</b> <i>The Windows 2000 Remote Boot Disk Generator dialog box</i>
</div>
</div>

<p>Start the Windows 2000 Remote Boot Disk Generator by running Rbfg.exe. The Rbfg.exe file is located in the RemoteInstall\admin\i386 folder on the Remote Installation Server. These boot floppies support only the PCI-based network adapters listed in the Adapter List. To see the list of the supported network adapters, click the Adapter List button shown in Figure 1.7. A partial listing of the supported network adapter cards is shown in Figure 1.8.</p>

<div class="figure">
<img src="images/F01cc08.JPG" />
<div class="caption"><b>Figure 1.8</b> <i>Network adapters supported by boot floppies</i>
</div>
</div>

<p><img src="images/practice.jpg" /></p>
<h2><a name="134">Practice: Creating a Remote Boot Disk</a></h2>

<p>In this practice, you create a remote boot disk.</p>

<ol>
<li>Log on as Administrator.</li>

<li>Click Start and then click Run.

<p>The Run dialog box appears.</p></li>

<li>Type <b>E:\RemoteInstall\Admin\i386\rbfg</b> in the Open box (where E: is your CD-ROM drive).

<blockquote><div class="note"><b>NOTE</b><hr />
Your path to Rbfg.exe might vary. See step 6 in Exercise 2, &quot;<a href="ch01g.htm#129">Configuring Remote Installation Services</a>,&quot; in the previous practice.</div></blockquote></li>

<li>Click OK.

<p>The Windows 2000 Remote Boot Disk Generator dialog box appears.</p></li>

<li>Read the information in the Windows 2000 Remote Boot Disk Generator dialog box and then click Adapter List.</li>

<li>Scroll through the list of supported adapters, and then click OK to return to the Windows 2000 Remote Boot Disk Generator dialog box.</li>

<li>Insert a formatted 3.5-inch floppy into your floppy disk drive.

<blockquote><div class="note"><b>NOTE</b><hr />
If your computer has more than one floppy disk drive, make sure you select the appropriate floppy disk drive you will be using when you are choosing the drive in the Windows 2000 Remote Boot Disk Generator dialog box.
</div></blockquote></li>

<li>Click Create Disk.

<p>A Windows 2000 Remote Boot Disk Generator dialog box appears, prompting you to create another boot floppy.</p></li>

<li>Click No.</li>

<li>Click Close to close the Windows 2000 Remote Boot Disk Generator dialog box.</li>
</ol>

<h2><a name="135">Lesson Summary</a></h2>


<p>In this lesson, you learned that if you have a Windows 2000 Server infrastruc-ture in place, and the computers in your network support remote boot, the most efficient method of deploying Windows 2000 Professional is to use remote installation. Remote installation is the process of connecting to an RIS server and then starting an automated installation of Windows 2000 Professional on a local computer. Remote installation enables administrators to install Windows 2000 Professional on client computers throughout a network from a central location. This reduces the time that administrators spend visiting all the computers in a network, thereby reducing the cost of deploying Windows 2000 Professional.</p>

<p>You also learned that client computers that support remote installation must have one of the three following configurations: a configuration meeting the Net PC specification, for which the network interface card must be set as the primary boot device within the system BIOS; a network interface card with a PXE boot ROM and BIOS support for starting from the PXE boot ROM; or a supported network interface card and a remote installation boot disk.</p>

<p>Finally, you saw that the user account that is to be used to perform the installation must be assigned the user right &quot;Log on as a batch job,&quot; and users must be assigned permission to create computer accounts in the domain that they are joining. The domain is specified in the advanced settings on the RIS server.</p>

</body>
</html>



