<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Processing the Print Job</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>

<A NAME="344"><H2>Processing the Print Job</H2></A><P>
The Windows&#160;98 printing process begins when you direct an application to print a file. The process varies depending on the print data type (raw or EMF). The following table describes the printing process steps.
<P>
<TABLE WIDTH="95%" BORDER="0" CELLPADDING="5">

<TR>
<TD VALIGN="TOP" COLSPAN="3"><B>The Printing Process</B></TD>
</TR>
<TR>
<TD VALIGN="TOP"> <B>1</B></TD>
<TD VALIGN="TOP" COLSPAN="2">The application sends a document to be printed.</TD>
</TR>

<TR>
<TD VALIGN="TOP"> <B>2</B></TD>
<TD VALIGN="TOP" COLSPAN="2">The GDI calls the print driver and determines what data type to use, raw or EMF.</TD>
</TR>

<TR>
<TD VALIGN="TOP"></TD>
<TD VALIGN="TOP"><B>Raw files</B></TD>
<TD VALIGN="TOP"><B>EMF files</B></TD>
</TR>

<TR>
<TD VALIGN="TOP"> <B>3</B></TD>
<TD VALIGN="TOP">The GDI renders raw documents into device-specific data using information from the printer driver. This is a long process, as the entire document must be fully rendered.</TD>
<TD VALIGN="TOP">The GDI writes enhanced metafiles to a spool file on the disk.</TD>
</TR>

<TR>
<TD VALIGN="TOP"> <B>4</B></TD>
<TD VALIGN="TOP">The GDI writes the data as a spool file on the disk.</TD>
<TD VALIGN="TOP">Control returns to the application.</TD>
</TR>

<TR>
<TD VALIGN="TOP"> <B>5</B></TD>
<TD VALIGN="TOP">Control returns to the application.</TD>
<TD VALIGN="TOP">The print processor renders the EMF document into device-specific data using information from the printer driver.</TD>
</TR>

<TR>
<TD VALIGN="TOP"> <B>6</B></TD>
<TD VALIGN="TOP">The print processor sends the completely rendered document to print.</TD>
<TD VALIGN="TOP">The print processor continues to send data as it is produced to print.</TD>
</TR>
</TABLE>
<P>
<A NAME="345"><H3>Spool File Types</H3></A><P>
You can configure Windows&#160;98 to send either raw or EMF printer data to the spooler.
<P>
Raw data is formatted in the printer's native language such as ASCII, Hewlett-Packard Printer Control Language (PCL), or PostScript. The raw format is printer-specific and may not be printable on a different printing device. A user may perceive that raw printing is slower than EMF printing, because control does not return to the application until the print job is complete.
<P>
The EMF file format is device-independent. The file format stores a collection of internal commands that Windows&#160;98 uses to create printed documents. The EMF is interpreted in the background on a 32-bit print subsystem spooler thread and sent to the printer driver, where <I>rendering</I> is completed. Rendering means to produce an image from a data file on an output device such as a video display or printer. EMF printing usually is faster than raw printing because control returns to the application as soon as the EMF file is created.
<P>
<HR>
<BLOCKQUOTE>
<B>Note</B>
<P>
PostScript printers do not support EMF printing. PostScript files are very similar in function to enhanced metafiles, so EMF printing is not necessary.
</BLOCKQUOTE>
<HR>
<P>
When print jobs are spooled, they are put in the C:\Windows\spool\printers folder, which is hidden. For each print job, there are two files: a spool (.spl) file and a shadow (.shd) file. For raw printing, the spool file is the actual print job. For EMF printing, the spool file points to a series of EMF files (<B>~</B>emf####.tmp), one file for each page of the document, in the temp folder.
<P>
Shadow files contain information needed by the spooler in order to resubmit the job if printing is interrupted, including the:
<P>
<UL>
<LI>Job owner name
<P>
<LI>Document name
<P>
<LI>Submission time
</UL>
<P>
</BODY>
</HTML>





