<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>The Registry Structure</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>

<A NAME="287"><H2>The Registry Structure</H2></A><P>
The Windows&#160;98 registry follows a hierarchical, tree-like structure (see Figure 6.12), similar to the structure of folders and files on a disk.
<P>
<A HREF="javascript:fullSize('F06XX12x.htm')"> <img src="F06XX12.JPG" width=360 height=238 border=0 ALT = "Click to view at full size."> </A>
<P>
<CAPTION><B>Figure 6.12</B> <I>The HKEY_LOCAL_MACHINE subtree</I></CAPTION>
<P>
The components of the registry are:
<P>
<UL>
<LI><I>Subtree</I>&#151;analogous to the root folder of a disk.
<P>
<LI><I>Key</I> and <I>subkey</I>&#151;analogous to folders. Each subtree contains keys and subkeys, just as root folders of a disk contain folders and subfolders.
<P>
<LI><I>Value</I>&#151;analogous to files. Keys and subkeys can contain one or more values. Value entries have three parts: data type, value name, and value data.
<P>
<UL><LI>Icons indicate the specific data type. The most common are icons with zeroes and ones representing binary data type and icons with an &quot;ab&quot; representing human-readable text.
<P>
<LI>The value name is a label for the value data.
<P>
<LI>The value data contains the path, code, or literal text assigned to that key or subkey. Value data that is type &quot;ab&quot; is contained in quotation marks.
</UL>
</UL>
<P>
<A NAME="288"><H3>Registry Subtrees</H3></A><P>
The registry stores data in subtrees (see Figure 6.13). Each subtree contains different types of information about your computer.
<P>
<IMG SRC="F06XX13.GIF" width=259 height=229 BORDER="0">
<P>
<CAPTION><B>Figure 6.13</B> <I>Registry subtree structure</I></CAPTION>
<P>
The following table describes all subtrees of the registry.
<P>
<TABLE WIDTH="95%" BORDER="0" CELLPADDING="5">

<TR>
<TD VALIGN="TOP"><B>Subtree</B></TD>
<TD VALIGN="TOP"><B>Contains</B></TD>
</TR>

<TR>
<TD VALIGN="TOP">HKEY_CLASSES_ROOT</TD>
<TD VALIGN="TOP">Information stored under this subkey is used by Windows shell applications and by OLE applications.</TD>
</TR>

<TR>
<TD VALIGN="TOP">HKEY_CURRENT_USER</TD>
<TD VALIGN="TOP">User-specific system and program settings and configuration information for the current user. </TD>
</TR>

<TR>
<TD VALIGN="TOP">HKEY_LOCAL_MACHINE</TD>
<TD VALIGN="TOP">Global hardware and software settings for every device and application that has ever been installed in this computer.</TD>
</TR>

<TR>
<TD VALIGN="TOP">HKEY_USERS</TD>
<TD VALIGN="TOP">User-specific system and program settings for each user who has ever logged on to this computer.</TD>
</TR>

<TR>
<TD VALIGN="TOP">HKEY_CURRENT_CONFIG</TD>
<TD VALIGN="TOP">Current configuration information for the computer's attached hardware.</TD>
</TR>

<TR>
<TD VALIGN="TOP">HKEY_DYN_DATA</TD>
<TD VALIGN="TOP">Dynamic status information for various devices including system monitoring information from the System Monitor tool. The information is regenerated when the system starts.</TD>
</TR>
</TABLE>
<P>
<A NAME="289"><H3>Subkeys of HKEY_LOCAL_MACHINE</H3></A><P>
The HKEY_LOCAL_MACHINE subtree provides a good example of the subtrees in the registry because the structure of all the subtrees is similar, and the HKEY_LOCAL_MACHINE subtree contains information specific to the local computer that is always the same, regardless of which user is logged on. Information such as the name and version of the installed software, the capabilities of OLE-enabled applications, and the names and types of device drivers is stored in this subtree.
<P>
The following table describes the subkeys located in HKEY_LOCAL_MACHINE:
<P>
<TABLE WIDTH="95%" BORDER="0" CELLPADDING="5">

<TR>
<TD VALIGN="TOP"><B>Subkey</B></TD>
<TD VALIGN="TOP"><B>Contains information about</B></TD>
</TR>

<TR>
<TD VALIGN="TOP">Config</TD>
<TD VALIGN="TOP">Hardware profiles. </TD>
</TR>

<TR>
<TD VALIGN="TOP">Enum</TD>
<TD VALIGN="TOP">All devices that have ever been installed in the computer, including those that are currently installed. Information remains in this branch even if the corresponding device is removed, so that the necessary information is present if the device is reinstalled.</TD>
</TR>

<TR>
<TD VALIGN="TOP">Hardware</TD>
<TD VALIGN="TOP">The CPU vendor and serial port/modem information.</TD>
</TR>

<TR>
<TD VALIGN="TOP">Network</TD>
<TD VALIGN="TOP">A user logon to a networked computer, including the user name, primary network provider, whether the logon was validated by a server, and information about the system policies processor.</TD>
</TR>

<TR>
<TD VALIGN="TOP">Security</TD>
<TD VALIGN="TOP">The network security provider and remote administration capabilities.</TD>
</TR>

<TR>
<TD VALIGN="TOP">Software</TD>
<TD VALIGN="TOP">Applications and system components. Each application should store information under its own subkey. The subkey should have this general form: SOFTWARE\Vendor_name\Product_name\Version.</TD>
</TR>

<TR>
<TD VALIGN="TOP">System</TD>
<TD VALIGN="TOP">The installed devices and their current configuration. This includes information about each class of device, as well as individual devices.</TD>
</TR>
</TABLE>
<P>
</BODY>
</HTML>





