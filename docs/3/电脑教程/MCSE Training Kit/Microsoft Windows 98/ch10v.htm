<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Resolving Additional Hardware Issues</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>

<A NAME="470"><H2>Resolving Additional Hardware Issues</H2></A><P>
The Windows&#160;98 Troubleshooters and Device Manager can help you resolve most hardware problems. Another feature that deals with hardware devices and drivers is Automatic Skip Driver Agent. There are also specific issues associated with Win32 Driver Model (WDM) drivers and Universal Serial Bus (USB) devices.
<P>
<A NAME="471"><H3>Automatic Skip Driver Agent</H3></A><P>
The Automatic Skip Driver Agent (ASD) identifies drivers that fail to load or certain operations that fail at startup. ASD marks the failed device or operation to be bypassed on subsequent startups.
<P>
<A NAME="472"><H3>How Automatic Skip Driver Works</H3></A><P>
When Windows&#160;98 starts, it attempts to load all device drivers for the installed hardware. If a hardware device is defective, the device driver may fail to load. ASD identifies the specific device(s) that failed to enumerate when Windows&#160;98 started. (<I>Enumeration</I> is the process of identifying what Plug and Play devices are in the computer and then assigning the appropriate hardware resources so that these devices work.) After two failed attempts to load, ASD turns off the device driver or stops the operation that caused system startup to fail.
<P>
<HR>
<BLOCKQUOTE>
<B>Note</B>
<P>
For information about operations that can cause ASD to run, refer to the <I>Microsoft Windows&#160;98 Resource Kit</I>.
</BLOCKQUOTE>
<HR>
<P>
ASD maintains a registry key in HKEY_LOCAL_MACHINE, which indicates when a startup failure occurs. A &quot;00&quot; value indicates the operation was successful. A &quot;01&quot; value indicates the operation failed.
<P>
The following example shows the registry entry when a device driver fails to load:
<P>
<PRE>HKEY_LOCAL_MACHINE\System\CurrentControlSet\control\ASD\Prob\
{9B4E7760-3196-11CF-97EA-00AA0034319D}\ROOT\*PNP0C01\0000=<B>01</B></PRE>
<P>
If you want to run ASD to solve system startup failures, perform the following procedure:
<P>
<OL>
<LI>	Run Asd.exe.
<P>
The <B>Automatic Skip Driver</B> dialog box lists failed operations.
<P>
<LI>	Click the check box to reset the ASD registry value to 00.
<P>
<LI>	Restart the computer.
<P>
<LI>	If the operation fails again, run Asd.exe again. In the <B>Automatic Skip Driver</B> dialog box, click the operation that failed, and then click <B>Details</B>.
<P>
The <B>Details</B> dialog box provides a recommendation for solving the problem.
</OL>
<P>
<HR>
<BLOCKQUOTE>
<B>Note</B>
<P>
If you run Asd.exe when no errors have occurred, you receive a message that no critical errors occurred.
</BLOCKQUOTE>
<HR>
<P>
<A NAME="473"><H3>Win32 Driver Model (WDM)</H3></A><P>
Windows&#160;98 includes WDM drivers for many hardware devices. Because of the evolution of the Win32 Driver Model from Windows&#160;95 OSR 2.1 to Windows&#160;98 to Windows&#160;NT 5.0, there may be some incompatibilities between drivers written for specific <I>versions</I> of the WDM. These incompatibilities can be resolved by installing an updated driver.
<P>
If the device uses a WDM driver, and you want to install a different driver, you can do so through the <B>Driver </B>tab of the device's <B>Properties</B> dialog box.
<P>
<A NAME="474"><H3>USB Devices</H3></A><P>
Due to the nature of USB devices, most troubleshooting is hardware related and there are no resource settings that could interfere and cause a USB device to function improperly or fail. You can, however, check the host controller firmware revision by viewing the host controller's properties in <B>Device</B> <B>Manager</B>. The <B>General</B> tab lists the hardware version of the host controller. A version number of &quot;000&quot; indicates that the controller is using the A-1 stepping chip, which is <I>not</I> supported. Contact the Original Equipment Manufacturer (OEM) for an updated host controller.
<P>
</BODY>
</HTML>





