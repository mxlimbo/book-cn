
<HTML>
<HEAD>
<LINK REL=StyleSheet HREF="basicIE4.css" TYPE="text/css">
<TITLE>Appendix G -- Contents of the Windows Msdos.sys File</TITLE>

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>


<FONT SIZE="+3">Appendix G</FONT>
<P>
<A NAME="926"><H1>Contents of the Windows Msdos.sys File</H1></A><P>
This appendix provides information about the Msdos.sys file. The Windows Setup program creates Msdos.sys in the root folder and sets the file's Read-Only, System, and Hidden attributes. Unlike the Msdos.sys file in MS-DOS, this file is a text file. It contains a [Paths] section that lists the locations for other files (such as the registry) and an [Options] section that you can use to personalize the boot process. 
<P>
<A NAME="927"><H1>Contents</H1></A><P>
<A NAME="928"><H2>The [Paths] Section</H2></A><P>
The following table lists settings in the [Paths] section of Msdos.sys:
<P>
<TABLE WIDTH="95%" BORDER="0" CELLPADDING="5">

<TR>
<TD VALIGN="TOP"><B>Setting</B></TD>
<TD VALIGN="TOP"><B>Purpose</B></TD>
</TR>

<TR>
<TD VALIGN="TOP">HostWinBootDrv=&lt;Root of Boot Drive&gt;  Default: C  </TD>
<TD VALIGN="TOP">Specifies the location for the root of the boot drive.  </TD>
</TR>

<TR>
<TD VALIGN="TOP">UninstallDir=&lt;Root of Boot Drive&gt;  Default: C  </TD>
<TD VALIGN="TOP">Specifies the location of the W98undo.dat and W98undo.ini files. These files are necessary to uninstall Windows&#160;98. This setting is present only if you back up your system files when you are prompted during Windows&#160;98 Setup</TD>
</TR>

<TR>
<TD VALIGN="TOP">WinBootDir=&lt;Windows Directory&gt;  Default: Directory specified during Setup (for example, C:\WINDOWS)  </TD>
<TD VALIGN="TOP">This setting lists the location of the necessary files for booting.   </TD>
</TR>
</TABLE>
<P>
<A NAME="929"><H2>The [Options] Section</H2></A><P>
The settings in the [Options] section, listed in the following table, must be manually inserted.
<P>
<TABLE WIDTH="95%" BORDER="0" CELLPADDING="5">

<TR>
<TD VALIGN="TOP"><B>Setting</B></TD>
<TD VALIGN="TOP"><B>Purpose</B></TD>
</TR>

<TR>
<TD VALIGN="TOP">AutoScan=&lt;Number&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">Defines whether or not ScanDisk is run after a bad shutdown. A setting of 0 does not run ScanDisk; 1 prompts before running ScanDisk; 2 does not prompt before running ScanDisk but prompts you before fixing errors if any errors are found. This setting is used only by OEM Service Release 2.</TD>
</TR>

<TR>
<TD VALIGN="TOP">BootDelay=&lt;Seconds&gt;
<br>
Default: 2  </TD>
<TD VALIGN="TOP">Sets the amount of time the &quot;Starting Windows&quot; message remains on the screen before Windows&#160;98 continues to boot.</TD>
</TR>

<TR>
<TD VALIGN="TOP">BootSafe=&lt;Boolean&gt;
<br>
Default: 0  </TD>
<TD VALIGN="TOP">A setting of 1 forces your computer to boot in safe mode. </TD>
</TR>

<TR>
<TD VALIGN="TOP">BootGUI=&lt;Boolean&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">A setting of 1 forces the loading of the GUI interface. A setting of 0 disables the loading of the GUI interface.</TD>
</TR>

<TR>
<TD VALIGN="TOP">BootKeys=&lt;Boolean&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">A setting of 1 enables the use of the function key boot options (that is, F4, F5, F6, and F8). A setting of 0 disables the use of these function keys during the boot process. A setting of BootKeys=0 overrides the use of BootDelay=n. </TD>
</TR>

<TR>
<TD VALIGN="TOP">BootMenu=&lt;Boolean&gt;
<br>
Default: 0  </TD>
<TD VALIGN="TOP">A setting of 1 enables the Startup menu. If this setting is 0, then you must press the F8 key when &quot;Starting Windows&#160;98&quot; appears to invoke the Startup menu.</TD>
</TR>

<TR>
<TD VALIGN="TOP">BootMenuDefault=&lt;Number&gt;
<br>
Default: 1 </TD>
<TD VALIGN="TOP">Use this setting to set the default menu item for startup. Use a setting of 1 if the system is running correctly, or 3 if the system hung in the previous instance </TD>
</TR>

<TR>
<TD VALIGN="TOP">BootMenuDelay=&lt;Number&gt;
<br>
Default: 30  </TD>
<TD VALIGN="TOP">Will pause on the Startup menu. If the number of seconds counts down to 0 without intervention, the BootMenuDefault is activated. This option is not functional unless BootMenu=1 has been added to the [Options] section of the Msdos.sys file. </TD>
</TR>

<TR>
<TD VALIGN="TOP">BootMulti=&lt;Boolean&gt;
<br>
Default: 0  </TD>
<TD VALIGN="TOP">A setting of 0 disables the multi-boot option. (For example, with a setting of 0 you cannot boot your previous operating system.) A setting of 1 enables the F4 and F8 keys to boot your previous operating system. This setting is set to 0 by default to prevent you from inadvertently starting MS-DOS and damaging data by running a disk utility that does not recognize long file names. </TD>
</TR>

<TR>
<TD VALIGN="TOP">BootWarn=&lt;Boolean&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">A setting of 0 disables the safe mode boot warning message and the Startup menu.</TD>
</TR>

<TR>
<TD VALIGN="TOP">BootWin=&lt;Boolean&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">A setting of 1 forces Windows&#160;98 to load at startup. A setting of 0 disables Windows 98 as your default operating system (this is useful only if you have MS-DOS version 5.x or 6.x on the computer). Pressing F4 inverts the default only if BootMulti=1. (For example, pressing the F4 key with a setting of 0 forces Windows 98 to load.)</TD>
</TR>

<TR>
<TD VALIGN="TOP">DoubleBuffer=&lt;Boolean&gt;
<br>
Default: 0  </TD>
<TD VALIGN="TOP">A setting of 1 is a conditional setting that enables double-buffering for controllers that need it (for example, SCSI controllers). A setting of 2 is an unconditional setting that enables double-buffering regardless of whether the controller needs it or not.</TD>
</TR>

<TR>
<TD VALIGN="TOP">DRVSpace=&lt;Boolean&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">A setting of 1 allows the automatic loading of the DRVSPACE.BIN  file. A setting of 0 prevents the automatic loading of this file. </TD>
</TR>

<TR>
<TD VALIGN="TOP">LoadTop=&lt;Boolean&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">A setting of 0 does not let Windows 98 load COMMAND.COM or DRVSPACE.BIN at the top of 640K. If you are having compatibility problems with software that makes assumptions about the available memory try setting this to 0.</TD>
</TR>

<TR>
<TD VALIGN="TOP">Logo=&lt;Boolean&gt;
<br>
Default: 1  </TD>
<TD VALIGN="TOP">A setting of 1 forces the default Windows 98 logo to appear. A setting of 0 prevents the animated logo from being displayed. A setting of 0 also avoids hooking a variety of interrupts that can create incompatibilities with certain third-party memory managers. </TD>
</TR>

<TR>
<TD VALIGN="TOP">Network=&lt;Boolean&gt;
<br>
Default: 0  </TD>
<TD VALIGN="TOP">A setting of 1 means the network was installed and adds &quot;Safe mode with network support&quot; as an option on the Windows 98 Startup menu. </TD>
</TR>
</TABLE>
<P>
The Msdos.sys file also contains a section that contains seemingly useless information. This information is necessary to support programs that expect the Msdos.sys file to be at least 1024 bytes in length. For example, if an anti-virus program detects that the Msdos.sys file is less than 1024 bytes, it may assume that the Msdos.sys file is infected with a virus. If you delete the Msdos.sys file your computer will not start. 
<P>
The following statement, followed by a series of &quot;X&quot;s, appears in the Msdos.sys file: <I>The following lines are required for compatibility with other programs. Do not remove them (Msdos.sys needs to be &gt;1024 bytes).</I>
<P>
Since each line begins with a semicolon (;), the lines are not read by the system. 
<P>
<A NAME="930"><H1>How to Edit the Msdos.sys File</H1></A><P>
If you want to change any of the values in the Msdos.sys file, perform the following procedure:
<P>
<OL>
<LI>	Click <B>Start</B>, point to <B>Find</B>, then click <B>Files Or Folders</B>. 
<P>
<LI>	In the <B>Named</B> box, type <B>msdos.sys.</B>
<P>
<LI>	In the <B>Look In</B> box, click your boot drive (usually drive C, or drive H if drive C: is compressed).
<P>
<LI>	Click the <B>Find Now</B> button.
<P>
<LI>	Right-click the <B>Msdos.sys</B> file and then click <B>Properties</B>. 
<P>
<LI>	Click the <B>Read-Only</B> and <B>Hidden</B> check boxes to clear them to remove these attributes from the Msdos.sys file, and then click <B>OK</B>. 
<P>
<LI>	Right-click the <B>Msdos.sys</B> file and then click <B>Open With</B>. 
<P>
<LI>	In the <B>Choose the program you want to use box</B>, click <B>WordPad</B> and then click <B>OK</B>. 
<P>
<LI>	Make the changes you want to the Msdos.sys file. When you are done, save the file as a text document, and then quit WordPad. 
<P>
<LI>	Right-click the <B>Msdos.sys</B> file, and then click <B>Properties</B>. 
<P>
<LI>	Click the <B>Read-Only</B> and <B>Hidden</B> check boxes to select them to set these attributes for the file, and then click <B>OK</B>. Close the Find window. 
<P>
<LI>	Quit and then restart Windows. 
</OL>
</BODY>
</HTML>



