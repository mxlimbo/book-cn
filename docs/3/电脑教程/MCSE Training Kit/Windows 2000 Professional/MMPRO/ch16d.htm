<HTML>
<HEAD>
<TITLE>Lesson 3: Implementing an Audit Policy</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch16c.htm", "ch16e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="564"><H1>Lesson 3: Implementing an Audit Policy</H1></A>

<p>Auditing is a powerful tool for tracking events that occur on computers in your organization. To implement auditing, you need to consider auditing requirements and set the audit policy. After you set an audit policy on a computer, you can implement auditing on files, folders, and printers.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Set up auditing on files and folders.</li></p>

<p><li>Set up auditing on printers.</li></p>
</ul>



<p><b>Estimated lesson time: 25 minutes</b></p>
</blockquote></div></p>

<A NAME="565"><H2>Configuring Auditing</H2></A>

<p>For computers running Windows 2000 Professional, you set up an audit policy for each individual computer.</p>

<A NAME="566"><H3>Auditing Requirements</H3></A>

<p>The requirements to set up and administer auditing are as follows:</p>

<ul>
<p><li>You must have the Manage Auditing And Security Log user right for the computer where you want to configure an audit policy or review an audit log. By default, Windows 2000 grants these rights to the Administrators group.</li></p>

<p><li>The files and folders to be audited must be on Microsoft Windows 2000 File System (NTFS) volumes.</li></p>
</ul>



<A NAME="567"><H3>Setting Up Auditing</H3></A>

<p>Setting up auditing is a two-part process:</p>

<ol>
<p><li>Set the audit policy. The audit policy enables auditing of objects but doesn't activate auditing of specific objects.</li></p>

<p><li>Enable auditing of specific resources. You specify the specific events to audit for files, folders, printers, and Active Directory objects. Windows 2000 then tracks and logs the specified events.</li></p>
</ol>

<A NAME="568"><H2>Setting an Audit Policy</H2></A>

<p>The first step in implementing an audit policy is selecting the types of events that Windows 2000 audits. For each event that you can audit, the configuration settings indicate whether to track successful or failed attempts. You set audit policies in the Local Security Settings window, which you open by selecting Local Security Policy on the Administrative Tools menu.</p>

<p>Table 16.1 describes the types of events that Windows 2000 can audit.</p>

<p><b>Table 16.1</b> <i>Types of Events Audited by Windows 2000</i></p>

<p><table cellpadding=5 width="95%"><tr>
<th>Event</th><th>Description</th>
</tr><tr>
<td valign="top">Account Logon Events</td> <td valign="top">A domain controller received a request to validate a user 
 account. (This is applicable only if your computer 
 running Windows 2000 Professional joins a Windows 
 2000 domain.)</td>
</tr><tr>
<td valign="top">Account Management</td> <td valign="top">An administrator created, changed, or deleted a user 
 account or group. A user account was renamed, disabled, 
 or enabled, or a password was set or changed.</td>
</tr><tr>
<td valign="top">Directory Service Access</td> <td valign="top">A user gained access to an Active Directory object. You 
 must configure specific Active Directory objects for 
 auditing to log this type of event. (Active Directory 
 directory services are available only if your computer 
 running Windows 2000 Professional joins a Windows 
 2000 domain.)</td>
</tr><tr>
<td valign="top">Logon Events</td> <td valign="top">A user logged on or logged off, or a user made or 
 canceled a network connection to the computer.</td>
</tr><tr>
<td valign="top">Object Access</td> <td valign="top">A user gained access to a file, folder, or printer. You 
 must configure specific files, folders, or printers for 
 auditing. Object access is auditing a user's access to 
 files, folders, and printers.</td>
</tr><tr>
<td valign="top">Policy Change</td> <td valign="top">A change was made to the user security options, user 
 rights, or audit policies.</td>
</tr><tr>
<td valign="top">Privilege Use</td> <td valign="top">A user exercised a right, such as changing the system 
 time. (This doesn't include rights that are related to 
 logging on and logging off.)</td>
</tr><tr>
<td valign="top">Process Tracking</td> <td valign="top">A program performed an action. This information is 
 generally useful only for programmers who want to 
 track details of program execution.</td>
</tr><tr>
<td valign="top">System Events</td> <td valign="top">A user restarted or shut down the computer, or an event 
 occurred that affects Windows 2000 security or the 
 security log. (For example, the audit log is full and 
 Windows 2000 starts discarding entries.)</td>
</tr></table></p>

<p>To set an audit policy on a computer that is running Windows 2000 Professional, use the Local Security Settings window, as follows:</p>

<ol>
<p><li>Click Start, point to Programs, point to Administrative Tools, and then click Local Security Policy.</li></p>

<p><li>In the Local Security Settings window's console tree, double-click Local Policies, and then click Audit Policy.</li></p>

<p>The console displays the current audit policy settings in the details pane, as shown in Figure 16.1.</p>

<p>
<A HREF="javascript:fullSize('F16tk01x.htm')"> <img src="images/F16tk01.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 16.1</b> <i>Events that Windows 2000 can audit</i><!-- /caption -->
</p>

<p><li>Select the type of event to audit, and then, on the Action menu, click Security.</li></p>


<p>The Local Security Policy Setting dialog box appears for the selected event. Figure 16.2 shows the Local Security Policy Setting dialog box for Audit Logon Events, and Table 16.2 defines the fields available in the Local Security Policy Setting dialog box.</p>

<p><li>Select the Success check box, the Failure check box, or both.</li></p>

<p><li>Click OK.</li></p>

<p><li>Restart your computer.</li></p>

<p>
<img src="images/F16tk02.JPG" width=384 height=352 border="0">
</p><p>
<!-- caption --><b>Figure 16.2</b> <i>The Local Security Policy Setting dialog box for Audit Logon Events</i><!-- /caption -->
</p>

</ol>

<p><b>Table 16.2</b> <i>Local Security Policy Setting Dialog Box Fields</i></p>

<p><table cellpadding=5 width="95%"><tr>
<th>Field</th><th>Description</th>
</tr><tr>
<td valign="top">Effective Policy Setting</td> <td valign="top">Indicates whether or not auditing is turned on.
<p>No auditing indicates it is auditing this event.</p>

<p>Failure indicates it is auditing failed attempts.</p>

<p>Success indicates it is auditing successful attempts.</p>

<p>Success, Failure indicates it is auditing all attempts.</p></td>
</tr><tr>
<td valign="top">Local Policy Setting</td> <td valign="top">A check mark in the Success check box indicates that 
 auditing is in effect for successful attempts.

<p>A check mark in the Failure check box indicates that 
 auditing is in effect for failed attempts.</p></td>
</tr></table></p>

<p>Once you have set the audit policy, remember that the changes that you make to your computer's audit policy don't take effect until you restart your computer.</p>

<A NAME="569"><H2>Auditing Access to Files and Folders</H2></A>

<p>If security breaches are an issue for your organization, you can set up auditing for files and folders on NTFS partitions. To audit user access to files and folders, you must first set your audit policy to audit object access, which includes files and folders.</p>

<p>Once you have set your audit policy to audit object access, you enable auditing for specific files and folders and specify which types of access, by which users or groups, to audit.</p>

<p>You can enable auditing for specific files and folders as follows:</p>

<ol>
<p><li>On the Security tab in the Properties dialog box for a file or folder, click Advanced.</li></p>

<p><li>On the Auditing tab, click Add, select the users for whom you want to audit file and folder access, and then click OK.</li></p>

<p><li>In the Audit Entry dialog box, select the Successful check box or the Failed check box for the events that you want to audit. For a list of the events, see Figure 16.3.</li></p>

<p>Table 16.3 describes when to audit these events.</p>

<p><li>Click OK to return to the Access Control Settings dialog box.</li></p>

<p>By default, any auditing changes that you make to a parent folder also apply to all child folders and all files in the parent and child folders.</p>

<p><li>To prevent changes that are made to a parent folder from applying to the currently selected file or folder, clear the Allow Inheritable Auditing Entries From Parent To Propagate To This Object check box.</li></p>

<p><li>Click OK.</li></p>

<p>
<img src="images/F16tk03.JPG" width=367 height=468 border="0">
</p><p>
<!-- caption --><b>Figure 16.3</b> <i>Events that can be audited for files and folders</i><!-- /caption -->
</p>

</ol>

<p><b>Table 16.3</b> <i>User Events and What Triggers Them</i></p>
<p><table cellpadding=5 width="95%"><tr>
<th>Event</th><th>User activity that triggers the event</th>
</tr><tr>
<td valign="top">Traverse Folder/Execute File</td> <td valign="top">Running a program or gaining access to a folder to change directories</td>
</tr><tr>
<td valign="top">List Folder/Read Data</td> <td valign="top">Displaying the contents of a file or folder</td>
</tr><tr>
<td valign="top">Read Attributes<br>Read Extended Attributes</td> <td valign="top">Displaying the attributes of a file or folder</td>
</tr><tr>
<td valign="top">Create Files/Write Data</td> <td valign="top">Changing the contents of a file or creating new files in a folder</td>
</tr><tr>
<td valign="top">Create Folders/Append Data</td> <td valign="top">Creating folders in the folder</td>
</tr><tr>
<td valign="top">Write Attributes<br>
Write Extended Attributes</td> <td valign="top">Changing attributes of a file or folder</td>
</tr><tr>
<td valign="top">Delete Subfolders And Files</td> <td valign="top">Deleting a file or subfolder in a folder</td>
</tr><tr>
<td valign="top">Delete</td> <td valign="top">Deleting a file or folder</td>
</tr><tr>
<td valign="top">Read Permissions</td> <td valign="top">Viewing permissions or the file owner for a file or folder</td>
</tr><tr>
<td valign="top">Change Permissions</td> <td valign="top">Changing permissions for a file or folder</td>
</tr><tr>
<td valign="top">Take Ownership</td> <td valign="top">Taking ownership of a file or folder</td>
</tr></table></p>

<A NAME="570"><H2>Auditing Access to Printers</H2></A>

<p>Audit access to printers to track access to sensitive printers. To audit access to printers, set your audit policy to audit object access, which includes printers. Then enable auditing for specific printers and specify which types of access to audit and which users will have access. After you select the printer, you use the same steps that you use to set up auditing on files and folders. You set up auditing on a printer, as follows:</p>

<ol>
<p><li>In the Properties dialog box for the printer, click the Security tab, and then click Advanced.</li></p>

<p><li>On the Auditing tab, click Add, select the appropriate users or groups for whom you want to audit printer access, and then click OK.</li></p>

<p><li>In the Apply Onto box in the Auditing Entry dialog box, select where the auditing setting applies.</li></p>

<p><li>Under Access, select the Successful check box or the Failed check box for the events that you want to audit. (See Figure 16.4.)</li></p>

<p><li>Click OK in the appropriate dialog boxes to exit.</li></p>

<p>
<img src="images/F16tk04.JPG" width=367 height=468 border="0">
</p><p>
<!-- caption --><b>Figure 16.4</b> <i>Printer events that can be audited</i><!-- /caption -->
</p>

</ol>

<p>Table 16.4 describes audit events for printers and explains which action triggers the event to occur.</p>

<p><b>Table 16.4</b> <i>Printer Events and What Triggers Them</i></p>

<p><table cellpadding=5 width="95%"><tr>
<th>Event</th><th>User activity that triggers the event</th>
</tr><tr>
<td valign="top">Print</td> <td valign="top">Printing a file</td>
</tr><tr>
<td valign="top">Manage Printers</td> <td valign="top">Changing printer settings, pausing a printer, sharing a printer, 
 or removing a printer</td>
</tr><tr>
<td valign="top">Manage Documents</td> <td valign="top">Changing job settings; pausing, restarting, moving, or 
 deleting documents; sharing a printer; or changing printer 
 properties</td>
</tr><tr>
<td valign="top">Read Permissions</td> <td valign="top">Viewing printer permissions</td>
</tr><tr>
<td valign="top">Change Permissions</td> <td valign="top">Changing printer permissions</td>
</tr><tr>
<td valign="top">Take Ownership</td> <td valign="top">Taking printer ownership</td>
</tr></table></p>

<A NAME="571"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that the first step in implementing an audit policy is selecting the types of events that Windows 2000 audits. You can select the events to audit for files and folders, and you can select the events you want to audit for printers. For each event that you can audit, the configuration settings indicate whether to track successful attempts, failed attempts, or both. You use the Local Security Settings window to set audit policies, and then you restart your computer to enable auditing.</p>

<p>You also learned that you can set up auditing for access to files, folders, and printers on NTFS partitions. To do so, you must first set your audit policy to 
audit object access, which includes files, folders, and printers. Once you have 
set your audit policy to audit object access, you enable auditing for specific 
files, folders, and printers and specify which types of access, by which users or groups, to audit.</p>

</BODY>
</HTML>






