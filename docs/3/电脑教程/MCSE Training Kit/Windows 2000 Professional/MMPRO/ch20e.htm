<HTML>
<HEAD>
<TITLE>Lesson 4: Monitoring Network Users</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch20d.htm", "ch20f.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="701"><H1>Lesson 4: Monitoring Network Users</H1></A>

<p>You can also use the Computer Management snap-in or the Shared Folders snap-in to monitor which users are currently gaining access to shared folder resources on a server from a remote computer, and you can view the resources to which the users have connections. You can disconnect users and send administrative messages to computers and users, including computers and users who aren't currently gaining access to network resources.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Disconnect a specific user from his or her network connection.</li></p>

<p><li>Send administrative messages to users.</li></p>
</ul>

<p><b>Estimated lesson time: 20 minutes</b></p>
</blockquote></div></p>

<A NAME="702"><H2>Monitoring User Sessions</H2></A>

<p>You can use the Computer Management snap-in or the Shared Folders snap-in to view users who have a connection to open files on a server and the files to which they have a connection. This information enables you to determine which users you should contact when you need to stop sharing a folder or shut down the server on which the shared folder resides. You can disconnect one or more users to free idle connections to the shared folder, to prepare for a backup or restore operation, to shut down a server, and to change group membership and permissions for the shared folder.</p>

<p>You use the Sessions folder in the Computer Management snap-in or the Shared Folders snap-in to view a list of the users with a current network connection to the computer that you are monitoring (see Figure 20.4).</p>

<p>
<A HREF="javascript:fullSize('F20tk04x.htm')"> <img src="images/F20tk04.JPG" width=404 height=235 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 20.4</b> <i>The Sessions folder in the Computer Management window</i><!-- /caption -->
</p>

<p>Table 20.5 describes the information that is available in the Sessions folder.</p>

<p><b>Table 20.5</b> <i>Information Available in the Sessions Folder</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>Column name</th>
<th>Description</th>
</tr>
<tr>
<td valign="top">User</td>
<td valign="top">The users with a current network connection to this computer</td>
</tr>
<tr>
<td valign="top">Computer</td>
<td valign="top">The name of the user's computer</td>
</tr>
<tr>
<td valign="top">Type</td>
<td valign="top">The operating system running on the user's computer</td>
</tr>
<tr>
<td valign="top">Open Files</td>
<td valign="top">The number of files that the user has open on this computer</td>
</tr>
<tr>
<td valign="top">Connected Time</td>
<td valign="top">The time that has elapsed since the user established the current session</td>
</tr>
<tr>
<td valign="top">Idle Time</td>
<td valign="top">The time that has elapsed since the user last gained access to a 
 resource on this computer</td>
</tr>
<tr>
<td valign="top">Guest</td>
<td valign="top">Whether this computer authenticated the user as a member of the 
 built-in Guest account</td>
</tr>
</table>
</p>

<A NAME="703"><H2>Disconnecting Users</H2></A>

<p>You can disconnect one or all users with a network connection to a computer. You disconnect users so that you can do any of the following:</p>

<ul>
<p><li>Have changes to shared folder and NTFS permissions take effect immediately. A user retains all permissions for a shared resource that Windows 2000 assigned when the user connected to it. Windows 2000 evaluates the permissions again the next time that a connection is made.</li></p>

<p><li>Free idle connections on a computer so that other users can make a connection when you reach the maximum number of connections. User connections to resources might remain active for several minutes after a user finishes gaining access to a resource.</li></p>

<p><li>Shut down a server.</li></p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
After you disconnect a user, he or she can immediately make a new 
connection. If the user gains access to a shared folder from a Windows-based client computer, the client computer will automatically reestablish the connection with the shared folder. This connection will be established without user intervention unless you change the permissions to prevent the user from gaining access to the shared folder or you stop sharing the folder to prevent all users from gaining access to the shared folder.
</blockquote></div>
</p>

<p>You can disconnect a specific user, as follows:</p>

<ol>
<p><li>  In the console tree, under Shared Folders, click Sessions.</li></p>

<p><li>  In the list of users in the details pane, select the user that you want to disconnect, and then click Close Session on the Action menu.</li></p>
</ol>

<p><div class="note"><blockquote><b>NOTE</b><HR>If you want to disconnect all users, click Sessions in the console tree, and then click Disconnect All Sessions on the Action menu.</blockquote></div></p>

<p>To prevent data loss, always notify users who are accessing shared folders or files that you are ready to stop sharing a folder or shut down the computer.</p>

<A NAME="704"><H2>Sending Administrative Messages to Users</H2></A>

<p>You can send administrative messages to one or more users or computers. Send administrative messages to users who have a current connection to a computer on which network resources are shared when there will be a disruption to the computer or resource availability. Some common reasons for sending administrative messages are to notify users when you intend to do any of the following:</p>

<ul>
<p><li>Perform a backup or restore operation</li></p>

<p><li>Disconnect users from a resource</li></p>

<p><li>Upgrade software or hardware</li></p>

<p><li>Shut down the computer</li></p>
</ul>

<p>Use the Computer Management snap-in or the Shared Folders snap-in to send administrative messages to users. By default, all currently connected computers to which you can send a message appear in the list of recipients. You can add other users or computers to this list even if they don't have a current connection to resources on the computer.</p>

<p>
<img src="images/practic.JPG" width=92 height=74 border=0>
</p>

<A NAME="705"><H2>Practice: Sending Console Messages</H2></A>

<p>In this practice, you will use the Shared Folders snap-in to send a console 
message.</p>

<p><li> <b>To send a console message</b></li></p>

<ol>
<p><li>  In the console tree, under Shared Folders, click Shares.</li></p>

<p><li>  On the Action menu, point to All Tasks, and then click Send Console Message.</li></p>

<p><li>  In the Message box, type <b>Log Off Now. PRO1 is shutting down in 5 minutes.</b></li></p>

<p>If your computer isn't connected to a network, the Send button won't be available and the Recipients box will be empty.</p>

<p><li>  Click Add.</li></p>

<p>The Add Recipients dialog box appears.</p>

<p><li>  Type <b>PRO1</b> in the Recipients box.</li></p>

<p>PRO1 should be the name of your computer. If you didn't name your computer PRO1, type the name of your computer in the Recipients box.</p>

<p><li>  Click OK.</li></p>

<p>Notice that the Send button is now available.</p>

<p><li>  Click Send.</li></p>

<p>A message box briefly appears showing that the message is being sent, and then the Messenger Service dialog box appears, as shown in Figure 20.5. It confirms that a message was sent from PRO1 to PRO1, indicating the date and time the message was sent, and displaying the message that was sent.</p>

<p><li>  Click OK to close the message box.</li></p>

<p><li>  Close all windows and log off.</li></p>

<p>
<img src="images/F20tk05.JPG" width=350 height=126 border="0">
</p><p>
<!-- caption --><b>Figure 20.5</b> <i>The Messenger Service dialog box</i><!-- /caption -->
</p>
</ol>

<A NAME="706"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that you can use the Computer Management snap-in or the Shared Folders snap-in to view users who have a connection to open files on a computer and the files to which they have a connection. The Sessions folder allows you to view connections to open files on a server, and it allows you to disconnect a specific user or all users with a network connection to a computer.</p>

<p>You also learned that the Computer Management snap-in or the Shared Folders snap-in allows you to send administrative messages to one or more users or computers, and that by default, all currently connected computers appear in the list of recipients to which you can send a message. Finally, you learned how to add other users or computers to the list of recipients for administrative messages, even if they don't have a current connection to any resources on the computer.</p>

</BODY>
</HTML>






