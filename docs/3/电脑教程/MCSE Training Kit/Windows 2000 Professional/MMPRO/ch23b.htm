<html>
<head>
<title>Lesson 1: Automating Installations</title>
<link rel="STYLESHEET" type="text/css" href="mmpro.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch23a.htm", "ch23c.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>





<A NAME="778"><H1>Lesson 1: Automating Installations</H1></A>

<p>This lesson presents methods that will help you to automate Windows 2000 
installations. When you must install Windows 2000 on computers with varying configurations, scripting provides automation with increased flexibility. You will learn how the improved Setup Manager makes it easy to create the Unattend.txt files that are necessary for scripted installations.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Automate installations of Windows 2000 by using the Windows 2000 Setup Manager Wizard.</li></p>

<p><li>Apply application update packs while upgrading previous versions of Windows.</li></p>
</ul>

<p><b>Estimated lesson time: 45 minutes</b></p>
</blockquote></div></p>

<A NAME="779"><H2>Automating Installations by Using the Windows 2000 Setup Manager</H2></A>

<p>The computers in most networks are not identical but still have many similarities. You can use installation scripts to specify the variations in the hardware configurations of the computers that are to receive installations.</p>

<p>One of the most significant improvements in Windows 2000 is the ease and flexibility of scripting installations. The new Windows 2000 Setup Manager Wizard allows you to quickly create a script for a customized installation of Windows 2000 without concern for cryptic text file syntax. Knowing how to use Setup Manager enables you to perform customized installations on workstations and servers that meet the specific hardware and network requirements of your 
organization.</p>

<p>You can create or modify an answer file by using Setup Manager (see Figure 23.1). Although you can still use Unattend.txt files created with a simple text editor, such as Notepad, you use Setup Manager to reduce errors in syntax. You can copy Setup Manager to your hard disk by extracting the files in the Deploy.cab file located on your Windows 2000 Professional CD-ROM in the Support\Tools folder. To extract the files, double-click the .CAB file to display the files, select the files you want to extract, right-click the files, and then click Extract on the menu that appears.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>For detailed steps on how to install Setup Manager, see the next Practice, &quot;<A HREF="ch23b.htm#780">Installing the Windows 2000 Installation Deployment Tools</A>,&quot; in this chapter.</blockquote></div></p>

<p>
<A HREF="javascript:fullSize('F23tk01x.htm')"> <img src="images/F23tk01.JPG" width=404 height=278 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 23.1</b> <i>Windows Setup Manager</i><!-- /caption -->
</p>

<p>Setup Manager does the following:</p>

<ul>
<p><li>Provides a new, easy-to-use graphical interface with which you can create and modify answer files and UDFs</li></p>

<p><li>Makes it easy to specify computer-specific or user-specific information</li></p>

<p><li>Simplifies the inclusion of application setup scripts in the answer file</li></p>

<p><li>Creates the distribution folder that you use for the installation files</li></p>
</ul>

<p>When you start Setup Manager, you will be presented with the following 
three options:</p>

<ul>
<p><li>Create A New Answer File</li></p>

<p><li>Create An Answer File That Duplicates This Computer's Configuration</li></p>

<p><li>Modify An Existing Answer File</li></p>
</ul>

<p>If you select the Create A New Answer File option, you will then need to choose the type of answer file you want to create. Setup Manager can create the following types of answer files:</p>

<ul>
<p><li>Windows 2000 unattended installation</li></p>

<p><li>Sysprep Install</li></p>

<p><li>Remote Installation Services (RIS)</li></p>
</ul>

<p><div class="note"><blockquote><b>NOTE</b><HR>Remote Installation Services will be discussed later in this chapter in <A HREF="ch23d.htm#792">Lesson 3</A>, &quot;Performing Remote Installations.&quot;</blockquote></div></p>

<p>The remainder of the Setup Manager Wizard allows you to specify the level of user interaction with the Setup program and to enter all the information required to complete Setup.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>The Sysdiff.exe utility is often used in conjunction with Setup Manager to install Windows using difference files. The use of Sysdiff.exe has not changed from Windows NT 4.</blockquote></div></p>

<p><img src="images/practic.JPG" width=92 height=74 border="0"></p>

<A NAME="780"><H2>Practice: Installing the Windows 2000 Installation Deployment Tools</H2></A>

<p>In this practice, you will extract the Windows 2000 installation deployment tools from the Windows 2000 Professional CD-ROM you used to install Windows 2000 Professional, and then you will use System Manager to create an unattended setup script.</p>

<A NAME="781"><H3>Exercise 1: Extracting the Windows 2000 Installation Deployment Tools</H3></A>

<p>In this exercise, you will extract the Windows 2000 installation deployment tools from the CD-ROM you used to install Windows 2000 Professional and copy them to your hard disk.</p>

<p><li> <b>To install the installation deployment tools</b></li></p>
<ol>

<p><li> Log on as Administrator and insert the Windows 2000 Professional CD-ROM in the CD-ROM drive.</li></p>

<p><li> Start Windows Explorer and create the folder Deploy in the root folder of drive C (or in the root folder of your system drive).</li></p>

<p>The Deploy folder will be used to contain the files extracted from the Deploy.cab file on the Windows 2000 Professional CD-ROM.</p>

<p><li> Double click the Deploy file in the Support\Tools folder on drive D.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If D isn't the correct drive letter for your CD-ROM drive, replace the D with the letter representing your CD-ROM drive. 
</blockquote></div>
</p>

<ol>
<p>Windows 2000 displays the contents of the Deploy.cab file.</p>

<p><li value="4"> Select all of the files listed in the Deploy.cab file.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
To select all the files in the Deploy.cab file, hold down the Ctrl key, and then click each of the files listed. If your file icons are listed in one column, you can also select the files by clicking the first file in the list, holding down the Shift key, and then clicking the last file in the list.
</blockquote></div>
</p>

<ol>
<p><li value="5"> Right-click any of the selected files and click Extract on the menu that appears.</li></p>

<p>The Browse For Folder dialog box appears.</p>

<p><li> Select the Deploy folder on drive C (or your system drive, if it is a drive other than C), and then click OK.</li></p>

<p>The Copying dialog box appears briefly as the files are extracted and copied to the Deploy folder.</p>

<p><li> In Windows Explorer, click the Deploy folder to view its contents.</li></p>

<p>You should see the seven files from the Deploy.cab file listed. These files have been extracted from the .CAB file and are now ready to use.</p>

<p><li> Double-click Readme.txt.</li></p>

<p><li> Take a moment to view the topics covered in the Readme.txt file and then close Notepad.</li></p>
</ol>

<A NAME="782"><H3>Exercise 2: Using Setup Manager to Create an Unattended Setup Script</H3></A>

<p>In this exercise, you will use the Windows 2000 Setup Manager to create an unattended setup script. At the same time, the Setup Manager Wizard creates a distribution folder and a .UDF file.</p>

<p><li> <b>To create an unattended setup script using the Setup Manager Wizard</b></li></p>
<ol>

<p><li> In Windows Explorer, double-click the Setupmgr.exe file.</li></p>

<p>The Windows 2000 Setup Manager Wizard appears.</p>

<p><li> Click Next.</li></p>

<p>The New Or Existing Answer File page appears.</p>

<p><li> Ensure that the Create A New Answer File option is selected, and then click Next.</li></p>

<p>The Product To Install page appears. Notice that you have three choices: 
Windows 2000 Unattended Installation, Sysprep Install, and Remote Installation Services.</p>

<p><li> Ensure that Windows 2000 Unattended Installation is selected, and then Click Next.</li></p>

<p>The Platform page appears. Notice you have two choices: Windows 2000 
Professional or Windows 2000 Server.</p>

<p><li> Ensure that Windows 2000 Professional is selected, and then click Next.</li></p>

<p>The User Interaction Level page appears. Notice that you have five choices:</p>

	<ul>
	<p><li><b>Provide Defaults.</b> The answers you provide in the answer file are the default answers that the user sees. The user can accept the default answers or change any of the answers supplied by the script.</li></p>
	
	<p><li><b>Fully Automated.</b> The installation is fully automated. The user doesn't have the chance to review or change the answers supplied by the script.</li></p>
	
	<p><li><b>Hide Pages.</b> The answers provided by the script are supplied during the installation. Any page for which the script supplies all answers is hidden from the user so that the user can't review or change the answers supplied by the script.</li></p>
	
	<p><li><b>Read Only.</b> The script provides the answers, and the user can view the answers on any page that is not hidden, but the user can't change the answers.</li></p>
	
	<p><li><b>GUI Attended.</b> The text-mode portion of the installation is automated, but the user must supply the answers for the GUI-mode portion of the installation.</li></p>
	</ul>

<p><li> Select Fully Automated, and then click Next.</li></p>

<p>The License Agreement page appears.</p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you had chosen any option other than Fully Automated, this page would not have displayed.
</blockquote></div>
</p>

<ol>
<p><li value="7"> Click I Accept The Terms Of The License Agreement, and then click Next.</li></p>

<p>The Customize The Software page appears.</p>

<p><li> Enter your name in the Names box, your organization in the Organization box, and then Click Next.</li></p>

<p>The Computer Names page appears. Notice that you have three choices:</p>

	<ul>
	<p><li>Enter a series of names to be used during the various iterations of the script.</li></p>
	
	<p><li>Provide the name of a text file to import that has one computer name per line listed. Setup imports and uses these names as the computer names in the various iterations of the script.</li></p>
	
	<p><li>Select Automatically Generate Computer Names Based On Organization Name to allow the system to automatically generate the computer names to be used.</li></p>
	</ul>

<p><li> Type <b>PRO2</b> and then click Add. Repeat this step to add PRO3 and PRO4 to the list of names.</li></p>

<p>Notice that the names PRO2, PRO3, and PRO4 appear in the Computers To Be Installed box.</p>

<p><li> Click Next.</li></p>

<p>The Administrator Password page appears. Notice that you have two choices: Prompt The User For An Administrator Password and Use The Following Administrator Password (127 Characters Maximum).</p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
On the User Interaction Level page, you selected Fully Automated, so the Prompt The User For An Administrator Password option is not available.
</blockquote></div>
</p>

<ol>
<p>Notice that you can also have the administrator log on automatically, and you can set the number of times you want the administrator to log on automatically when the computer is restarted.</p>

<p><li value=11> Ensure that Use The Following Administrator Password (127 Characters Maximum) is selected, and type <b>password</b> in the Password box and the Confirm Password box. Then click Next.</li></p>

<p>The Display Settings page appears. Notice that you can adjust the Colors, Screen Area, and Refresh Frequency settings for the display. You can also choose Custom to create your own settings rather than picking from the selections listed under each of the three fields.</p>

<p><li> Click Next to accept the default settings.</li></p>

<p>The Network Settings page appears. Notice that you can choose Typical 
Settings&#8212;which installs TCP/IP, enables DHCP, and installs the Client for Microsoft Networks protocol for each destination computer&#8212;or you can choose Custom Settings.</p>

<p><li> Select Custom Settings, and then click Next.</li></p>

<p>The Number Of Network Adapters page appears.</p>

<p><li> Ensure that the default option, One Network Adapter, is selected and then click Next.</li></p>


<p>The Networking Components page appears. Notice that the Client For Microsoft Networks, File And Printer Sharing For Microsoft Networks, and Internet Protocol (TCP/IP) components are installed by default.</p>

<p><li> Select Internet Protocol (TCP/IP), and then click Properties.</li></p>

<p>The General tab of the Internet Protocol (TCP/IP) Properties dialog box 
appears. Notice that it is identical to configuring TCP/IP through Network Neighborhood.</p>

<p><li> Click Cancel, and then click Next to accept the default settings for networking components.</li></p>

<p>The Workgroup Or Domain page appears.</p>

<p><li> Click Next to accept the default option, Workgroup, and the workgroup name WORKGROUP.</li></p>

<p>The Time Zone page appears.</p>

<p><li> Select the appropriate time zone, and then click Next.</li></p>

<p>The Additional Settings page appears.</p>

<p><li> Ensure that the default option, Yes, Edit The Additional Settings is selected, and then click Next.</li></p>

<p>The Telephony page appears.</p>

<p><li> Select the appropriate setting for What Country/Region Are You In?</li></p>

<p><li> Type the appropriate numbers for What Area (Or City) Code Are You In?</li></p>

<p><li> Type the appropriate number(s) for If You Dial A Number To Access An Outside Line, What Is It?</li></p>

<p><li> Select the appropriate setting for The Phone System At This Location Uses, and then click Next.</li></p>

<p>The Regional Settings page appears. The default selection is Use The Default Regional Settings For The Windows Version You Are Installing.</p>

<p><li> Click Next to accept the default.</li></p>

<p>The Languages page appears; it allows you to add support for additional 
languages.</p>

<p><li> Click Next to accept the default.</li></p>

<p>The Browser And Shell Settings page appears. Notice that you can choose from the following three settings: Use Default Internet Explorer Settings, Use An Autoconfiguration Script Created By The Internet Explorer Administration Kit To Configure Your Browser, and Individually Specify Proxy And Default Home Page Settings.</p>

<p><li> Click Next to accept the default option, Use Default Internet Explorer Settings.</li></p>

<p>The Installation Folder page appears. Notice that you can select from three choices: A Folder Named Winnt, A Uniquely Named Folder Generated By Setup, and This Folder.</p>

<p><li> Select This Folder, and in the This Folder box, type <b>W2000Pro</b> and then click Next.</li></p>

<p>The Install Printers page appears.</p>

<p><li> Click Next to continue without having the script install any network printers.</li></p>

<p>The Run Once page appears. This page allows you to configure Windows to run one or more commands the first time a user logs on.</p>

<p><li> Click Next to continue without having the script run any additional commands.</li></p>

<p>The Distribution Folder page appears. This page allows you to have the Setup Manager Wizard create a distribution folder on your computer or network with the required installation files. You can add additional files to this distribution folder.</p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you were upgrading systems to Windows 2000 Professional, you could add any application update packs to the distribution folder and enter the commands to apply the update packs to the application as part of the upgrade.
</blockquote></div>
</p>

<ol>
<p><li value="30"> Ensure that the default option, Yes, Create Or Modify A Distribution Folder, is selected, and then click Next.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
The other selection is No, This Answer File Will Be Used To Install From A CD. If you are going to be doing a large number of installs, you don't want to try to simultaneously install multiple computers off of a CD-ROM. Create one or more distribution folders.
</blockquote></div>
</p>

<ol>
<p>The Distribution Folder Name page appears.</p>

<p><li value="31"> Click Next to accept the default option, Create A New Distribution Folder.</li></p>

<p>The Additional Mass Storage Drivers page appears.</p>

<p><li> Click Next to continue without adding any additional drivers.</li></p>

<p>The Hardware Abstraction Layer page appears. This page allows you to 
replace the default HAL.</p>

<p><li> Click Next to use the default Hardware Abstraction Layer.</li></p>

<p>The Additional Commands page appears. This page allows you to specify 
additional commands to be run at the end of the unattended setup.</p>

<p><li> Click Next to continue without running any additional commands.</li></p>

<p>The OEM Branding page appears. This page allows you to customize 
Windows Setup by adding your customer OEM branding. You can specify both a logo bitmap and a background bitmap.</p>

<p><li> Click Next to continue without specifying any OEM branding.</li></p>

<p>The Additional Files Or Folders page appears. This page allows you to specify additional files or folders to be copied to the destination computers.</p>

<p><li> Click Next to continue without specifying any additional files or folders to copy.</li></p>

<p>The Answer File Name page appears.</p>

<p><li> Type the path <b>C:\Deploy\Unattend.txt</b> in the Location And File Name box, and then click Next.</li></p>

<p>The Location Of Setup Files page appears. The files can be copied from the CD-ROM or you can specify a network location.</p>

<p><li> Click Next to accept the default option, Copy The Files From CD.</li></p>


<p>The Copying Files page appears while the Setup Manager Wizard copies the distribution files. This will take a few minutes. An indicator shows you the progress of the copy operation.</p>

<p>The Completing The Windows 2000 Setup Manager Wizard appears.</p>

<p><li> Click Finish.</li></p>

<p>Notice that three new files were created in C:\Deploy: Unattend.bat, Unattend.txt, and Unattend.udf. Notice also that a C:\Win2000dist folder was also created and shared.</p>
</ol>

<p><li> <b>To verify the existence of the distribution files</b></li></p>

<ol>
<p><li> Click C:\Win2000dist to view the distribution files.</li></p>

<p><li> Close Windows Explorer.</li></p>
</ol>

<A NAME="783"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that the Windows 2000 Setup Manager Wizard makes it easy to create the Unattend.txt files that are necessary for scripted installations. Setup Manager provides an easy-to-use graphical interface with which you can create and modify answer files and UDFs.</p>

<p>You also learned that before you can use the Setup Manager Wizard, you must copy the Windows 2000 deployment tools, including Setup Manager, by extracting the files located in the Deploy.cab file on the Windows 2000 Professional CD-ROM. The Setup Manager Wizard makes it easy to specify computer-specific or user-specific information, and to include application setup scripts in the answer file. The Setup Manager Wizard also creates the distribution folder that you use for the installation files.</p>

</BODY>
</HTML>


