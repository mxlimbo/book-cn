<HTML>
<HEAD>
<TITLE>Lesson 3: Sharing Folders</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch15c.htm", "ch15e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="532"><H1>Lesson 3: Sharing Folders</H1></A>

<p>You can share resources with others by sharing folders containing those resources. To share a folder, you must be a member of one of several groups, depending on the role of the computer where the shared folder resides. When you share a folder, you can control access to the folder by limiting the number of users who can simultaneously gain access to it, and you can also control access to the folder and its contents by assigning permissions to selected users and groups. Once you have shared a folder, users must connect to the shared folder and must have the appropriate permissions to gain access to it. After you have shared a folder, you might want to modify it. You can stop sharing it, change its share name, and change user and group permissions to gain access to it.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Create and modify shared folders.</li></p>

<p><li>Make a connection to a shared folder.</li></p>
</ul>

<p><b>Estimated lesson time: 20 minutes</b></p>
</blockquote></div></p>

<A NAME="533"><H2>Requirements for Sharing Folders</H2></A>

<p>In Windows 2000 Professional, members of the built-in Administrators and Power Users groups are able to share folders. Which groups can share folders and on which machines they can share them depends on whether it is a workgroup or a domain and the type of computer on which the shared folders reside:</p>

<ul>
<p><li>In a Windows 2000 domain, the Administrators and Server Operators groups can share folders residing on any machines in the domain. The Power Users group is a local group and can share folders residing only on the stand-alone server or computer running Windows 2000 Professional where the group is located.</li></p>

<p><li>In a Windows 2000 workgroup, the Administrators and Power Users groups can share folders on the Windows 2000 Server stand-alone server or the computer running Windows 2000 Professional on which the group exists.</li></p>
</ul>



<p><div class="note"><blockquote><b>NOTE</b><HR>If the folder to be shared resides on an NTFS volume, users must also have at least the Read permission for that folder to be able to share it.</blockquote></div></p>

<A NAME="534"><H2>Administrative Shared Folders</H2></A>

<p>Windows 2000 automatically shares folders for administrative purposes. These shares are appended with a dollar sign ($), which hides the shared folder from users who browse the computer. The root of each volume, the system root folder, and the location of the printer drivers are all hidden shared folders that you can gain access to across the network.</p>

<p>Table 15.2 describes the purpose of the administrative shared folders that 
Windows 2000 automatically provides.</p>

<p><b>Table 15.2 </b> <i>Windows 2000 Administrative Shared Folders</i></p>

<p>
<table valign="top" cellpadding="5" width="95%">

<tr>
<th>Share </th><th>Purpose</th>
</tr>

<tr>
<td valign="top">C$, D$, E$, and so on </td><td valign="top">The root of each volume on a hard disk is automatically 
 shared, and the share name is the drive letter appended with 
 a dollar sign ($). When you connect to this folder, you have 
 access to the entire volume. You use the administrative shares 
 to remotely connect to the computer to perform administrative 
 tasks. Windows 2000 assigns the Full Control permission to 
 the Administrators group.

<p>Windows 2000 also automatically shares CD-ROM drives and 
 creates the share name by appending the dollar sign to the 
 CD-ROM drive letter.</p>
</td>
</tr>

<tr>
<td valign="top">Admin$ </td><td valign="top">The system root folder, which is C:\Winnt by default, is shared 
 as Admin$. Administrators can gain access to this shared 
 folder to administer Windows 2000 without knowing in which 
 folder it is installed. Only members of the Administrators 
 group have access to this share. Windows 2000 assigns the 
 Full Control permission to the Administrators group.</td>

</tr>

<tr>
<td valign="top">Print$</td> <td valign="top">When you install the first shared printer, the <i>systemroot</i>\ 
 System32\Spool\Drivers folder is shared as Print$. This 
 folder provides access to printer driver files for clients. Only 
 members of the Administrators, Server Operators, and Print 
 Operators groups have the Full Control permission. The 
 Everyone group has the Read permission.</td>

</tr></table>
</p>

<p>Hidden shared folders aren't limited to those that the system automatically 
creates. You can share additional folders and append a dollar sign to the end of the share name. Then only users who know the folder name can gain access to it if they also possess the proper permissions to it.</p>

<A NAME="535"><H2>Sharing a Folder</H2></A>

<p>When you share a folder, you can give it a share name, provide comments to 
describe the folder and its content, limit the number of users who have access to the folder, assign permissions, and share the same folder multiple times.</p>

<p>You can share a folder as follows:</p>

<ol>
<p><li> Log on with a user account that is a member of a group that is able to share folders.</li></p>

<p><li> Right-click the folder that you want to share, and then click Properties.</li></p>

<p><li> On the Sharing tab of the Properties dialog box, configure the options shown in Figure 15.5 and described in Table 15.3.</li></p>

<p>
<img src="images/F15tk05.JPG" width=367 height=443 border="0">
</p><p>
<!-- caption --><b>Figure 15.5</b> <i>The Sharing tab of a folder's Properties dialog box</i><!-- /caption -->
</p>

</ol>

<p><b>Table 15.3</b> <i>Sharing Tab Options</i></p>

<p>
<table valign="top" cellpadding="5" width="95%">

<tr>
<th>Option </th><th>Description</th>
</tr>

<tr>
<td valign="top">Share Name </td><td valign="top">The name that users from remote locations use to make a connection 
 to the shared folder. You must enter a share name.</td>

</tr>

<tr>
<td valign="top">Comment</td> <td valign="top">An optional description for the share name. The comment appears 
 in addition to the share name when users at client computers browse 
 the server for shared folders. This comment can be used to identify 
 contents of the shared folder.</td>
</tr>

<tr>
<td valign="top">User Limit </td><td valign="top">The number of users who can concurrently connect to the shared 
 folder. If you click Maximum Allowed as the user limit, Windows 
 2000 Professional supports up to 10 connections. Windows 2000 
 Server can support an unlimited number of connections, but the 
 number of Client Access Licenses (CALs) that you purchased limits 
 the connections.</td>
</tr>

<tr>
<td valign="top">Permissions </td><td valign="top">The shared folder permissions that apply <i>only</i> when the folder is 
 accessed over the network. By default, the Everyone group is assigned 
 Full Control for all new shared folders.
</td>
</tr>

<tr>
<td valign="top">Caching </td><td valign="top">The settings to configure offline access to this shared folder.</td>
</tr>
</table>
</p>

<A NAME="536"><H2>Caching</H2></A>

<p>To make shared folders available offline, copies of the files are stored in a reserved portion of disk space on your computer called a <i>cache</i>. Since the cache is on 
your hard disk, the computer can access this cache regardless of whether it is connected to the network. By default, the cache size is set to 10 percent of the available disk space. You can change the size of the cache on the Offline Files tab of the Folder Options dialog box. You can also see how much space the cache is using by opening the Offline Files folder and clicking Properties on the File menu.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>Shared network files are stored in the root folder of your hard disk. If 
you want to change the location of the cache, the Offline Files Mover (Cachemov.exe) is available in the Windows 2000 Professional Resource Kit 
to change the cache location.</blockquote></div></p>

<p>When you share a folder, you can allow others to make the shared folder available offline by clicking Caching in the folder's Properties dialog box. In the Caching Settings dialog box (see Figure 15.6), the Allow Caching Of Files In This Shared Folder check box allows you to turn caching on and off.</p>

<p>
<A HREF="javascript:fullSize('F15tk06x.htm')"> <img src="images/F15tk06.JPG" width=404 height=305 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.6</b> <i>The Caching Settings dialog box</i><!-- /caption -->
</p>

<p>The Caching Settings dialog box contains three caching options:</p>

<ul>
<p><li>Manual Caching For Documents. The files that someone using your shared folder specifically (or manually) identifies are the only ones available offline. This caching option is recommended for a shared network folder containing files that are to be accessed and modified by several people. This option is the default.</li></p>

<p><li>Automatic Caching For Documents. Makes every file that someone opens from your shared folder available to him or her offline. Files that aren't opened are not available offline.</li></p>

<p><li>Automatic Caching For Programs. Provides offline access to shared folders containing files that 
are read, referenced, or run, but that are not changed in the process. This setting reduces network 
traffic because offline files are opened directly without accessing the network versions in any way, 
and generally start and run faster than the network versions.</li></p>
</ul>



<p><div class="note"><blockquote><b>NOTE</b><HR>For more information on caching and Offline Folders, see <A HREF="ch24a.htm">Chapter 24</A>, &quot;Configuring Windows 2000 for Mobile Computers.&quot;</blockquote></div></p>

<A NAME="537"><H2>Assigning Shared Folder Permissions</H2></A>

<p>After you share a folder, the next step is to specify which users have access to the shared folder by assigning shared folder permissions to selected user accounts and groups.</p>

<p>You can assign permissions to user accounts and groups for a shared folder, as follows:</p>

<ol>
<p><li> On the Sharing tab of the Properties dialog box of the shared folder, click Permissions.</li></p>

<p><li> In the Permissions dialog box, ensure that the Everyone group is selected and then click Remove.</li></p>

<p><li> In the Permissions dialog box, click Add (see Figure 15.7).</li></p>


<p>
<A HREF="javascript:fullSize('F15tk07x.htm')"> <img src="images/F15tk07.JPG" width=404 height=296 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.7</b> <i>Setting permissions for a shared folder</i><!-- /caption -->
</p>


<p><li> In the Select Users, Computers, Or Groups dialog box, click the user accounts and groups to which you want to assign permissions.</li></p>

<p><li> Click Add to add the user account or group to the shared folder. Repeat this step for all user 
accounts and groups to which you want to assign permissions.</li></p>

<p><li> Click OK.</li></p>

<p><li> In the Permissions dialog box for the shared folder, click the user account or group, and then, under Permissions, select the Allow check box or the Deny check box for the appropriate permissions for the user account or group.</li></p>
</ol>

<A NAME="538"><H2>Modifying Shared Folders</H2></A>

<p>You can modify shared folders, stop sharing a folder, modify the share name, and modify shared folder permissions.</p>

<p>You can modify a shared folder as follows:</p>

<ol>
<p><li> Click the Sharing tab in the Properties dialog box of the shared folder.</li></p>

<p><li> To complete the appropriate task, use the steps in Table 15.4.</li></p>
</ol>

<p><b>Table 15.4</b> <i> Steps to Modify a Shared Folder</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>To </th><th>Do this</th>
</tr>

<tr>
<td valign="top">Stop sharing a folder</td><td valign="top"> Click Do Not Share This Folder.</td>
</tr>

<tr>
<td valign="top">Modify the share name </td><td valign="top">Click Do Not Share This Folder to stop sharing 
 the folder; click Apply to apply the change; 
 click Share This Folder, and then enter the new 
 share name in the Share Name box.</td>
</tr>
<tr>
<td valign="top">Modify shared folder permissions </td><td valign="top">Click Permissions. In the Permissions dialog 
 box, click Add or Remove. In the Select Users, 
 Computers, Or Groups dialog box, click the 
 user account or group whose permissions you 
 want to modify.</td>
</tr>

<tr>
<td valign="top">Share folder multiple times</td> <td valign="top">Click New Share to share a folder with an 
 additional shared folder name. Do so to 
 consolidate multiple shared folders into one 
 while allowing users to continue to use the 
 same shared folder name that they used before 
 you consolidated the folders.</td>
</tr>

<tr>
<td valign="top">Remove a share name </td><td valign="top">Click Remove Share. This option appears only 
 after the folder has been shared more than once.</td>
</tr>
</table>
</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>If you stop sharing a folder while a user has a file open, the user might lose data. If you click Do Not Share This Folder and a user has a connection to the shared folder, Windows 2000 displays a dialog box notifying you that a user has a connection to the shared folder.</blockquote></div></p>

<A NAME="539"><H2>Connecting to a Shared Folder</H2></A>

<p>You can gain access to a shared folder on another computer by using the Map Network Drive wizard, the Run command, or My Network Places. If you want to connect to a shared folder by using the Map Network Drive wizard, you can do the following:</p>

<ol>
<p><li> Right-click the My Network Places icon on your desktop, and then click Map Network Drive.</li></p>

<p><li> In the Map Network Drive wizard, shown in Figure 15.8, click Folder, and then type a UNC path to 
the folder (for example, <i>\\computer_name\sharedfolder_name</i>).</li></p>

<p><li> Enter a drive letter for the shared folder in the Drive list box.</li></p>

<p><li> Select the Reconnect At Logon check box if you want to reconnect to the shared folder each time that you log on.</li></p>

<p><li> Click the link labeled Connect Using A Different User Name to connect to a shared folder with a different user account, and then enter the user name and password in the Connect As dialog box.</li></p>
</ol>

<p>You can connect to a shared folder by using the Run command, as follows:</p>

<ol>
<p><li> Click the Start button, click Run, and then type \\<i>computer_name</i> in the
Open box.</li></p>


<p>Windows 2000 displays shared folders for the computer.</p>


<p><li> Double-click the shared folder to which you want to connect.</li></p>
</ol>

<p>You can connect to a shared folder by using My Network Places, as follows:</p>

<ol>
<p><li> Double-click the My Network Places icon.</li></p>

<p><li> Locate the computer on which the shared folder is located.</li></p>

<p><li> Double-click the shared folder to which you want to connect.</li></p>

<p>
<A HREF="javascript:fullSize('F15tk08x.htm')"> <img src="images/F15tk08.JPG" width=404 height=291 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.8</b> <i>The Map Network Drive wizard</i><!-- /caption -->
</p>

</ol>

<A NAME="540"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that you can share resources with others by sharing folders containing those resources. To share a folder, you must be a member of one of several groups, depending on the role of the computer where the shared folder resides. You can control access to a shared folder by limiting the number of users who can simultaneously gain access to it, and you can also control 
access to the folder and its contents by assigning permissions to selected users and groups. To access a shared folder, users must connect to it and must have the appropriate permissions. You can modify a shared folder, stop sharing it, change its share name, and change user and group permissions to gain access to it.</p>

</BODY>
</HTML>






