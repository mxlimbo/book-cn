<HTML>
<HEAD>
<TITLE>Lesson 2: Configuring, Monitoring, and Troubleshooting Driver Signing</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch25b.htm", "ch25d.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="856"><H1>Lesson 2: Configuring, Monitoring, and Troubleshooting Driver Signing</H1></A>

<p>Windows 2000 drivers and operating system files have been digitally signed by Microsoft to ensure their quality. In Device Manager, you can look at the Driver tab to verify that the digital signer of the installed driver is correct. Some applications overwrite existing operating files as part of their installation process. These files can cause system errors that are difficult to troubleshoot. Microsoft has greatly simplified the tracking and troubleshooting of altered files by signing the original operating system files and allowing you to easily verify these signatures.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Configure driver signing.</li></p>

<p><li>Describe the System File Checker (SFC) utility and how to use it to verify and troubleshoot driver signing.</li></p>

<p><li>Use the Windows Signature Verification utility to monitor and troubleshoot driver signing.</li></p>
</ul>

<p><b>Estimated lesson time: 20 minutes</b></p>
</blockquote></div></p>

<A NAME="857"><H2>Configuring Driver Signing</H2></A>

<p>You can configure how the system responds to unsigned files by opening System in Control Panel and clicking the Hardware tab. On the Hardware tab, in the Device Manager box, click Driver Signing to display the Driver Signing Options dialog box (see Figure 25.3).</p>

<p>
<img src="images/F25tk03.JPG" width=359 height=353 border="0">
</p><p>
<!-- caption --><b>Figure 25.3</b> <i>Configuring Driver Signing</i><!-- /caption -->
</p>

<p>The following three settings are available to configure driver signing:</p>

<ul>
<p><li><b>Ignore</b>. This option allows any files to be installed regardless of their digital signature or the lack thereof.</li></p>

<p><li><b>Warn</b>. This option displays a warning message before allowing the installation of an unsigned file. This is the default option.</li></p>

<p><li><b>Block</b>.  This option prevents the installation of unsigned files.</li></p>
</ul>

<p>If you are logged on as Administrator or as a member of the Administrators group, you can select Apply Setting As System Default to apply the driver signing configuration you set up to all users who log on to this computer.</p>

<A NAME="858"><H2>Monitoring and Troubleshooting Driver Signing</H2></A>

<p>As you saw in <A HREF="ch25b.htm#847">Lesson 1</a>, &quot;Using Device Manager and System Information,&quot; you can use Device Manager to track the digital signature of files. Windows 2000 also provides SFC, a command-line utility that you can use to check the digital signature of files. The syntax of the System File Checker utility is as follows:</p>

<p><table cellpadding=5 width="95%"><tr><td>
<pre>
Sfc [/scannow] [/scanonce] [/scanboot] [/cancel] [/quiet] [/enable] 
[/purgecache] [/cachesize=x]</pre>
</td></tr></table>
</p>

<p>Table 25.3 explains System File Checker's optional parameters.</p>

<p><b>Table 25.3</b> <i>System File Checker's Parameters</i></p>

<p>
<table cellpadding=5 width="95%">
<tr> 
<th>Parameter</th>
<th>Description</th></tr>
<tr>
<td valign="top">/scannow</td>
<td valign="top">Causes the SFC utility to scan all protected system files immediately</td></tr>
<tr>
<td valign="top">/scanonce</td>
<td valign="top">Causes the SFC utility to scan all protected system files at the next system restart</td></tr>
<tr>
<td valign="top">/scanboot</td>
<td valign="top">Causes the SFC utility to scan all protected system files every time the system restarts</td></tr>
<tr>
<td valign="top">/cancel</td>
<td valign="top">Cancels all pending scans of protected system files</td></tr>
<tr>
<td valign="top">/quiet</td>
<td valign="top">Replaces all incorrect system file versions without prompting the user</td></tr>
<tr>
<td valign="top">/enable</td>
<td valign="top">Returns Windows File Protection to default operation, prompting the user to restore protected system files when files with incorrect versions are detected</td></tr>
<tr>
<td valign="top">/purgecache</td>
<td valign="top">Purges the file cache and scans all protected system files immediately</td></tr>
<tr>
<td valign="top">/cachesize=x</td>
<td valign="top">Sets the file cache size</td></tr>
</table></p>

<A NAME="859"><H2>Using the File Signature Verification Utility</H2></A>

<p>Windows 2000 also provides a File Signature Verification utility. To use this utility, click Start, point to Run, type <b>sigverif</b> and press Enter. Once the File Signature Verification utility starts, you can click the Advanced button to configure it. The File Signature Verification utility allows you to view the file's name, its location, its modification date, its type, and its version number.</p>

<p>
<img src="images/practic.JPG" width=92 height=74 border="0">
</p>

<A NAME="860"><H2>Practice: Using the Windows Signature Verification Utility</H2></A>

<p>In this practice, you will use the File Signature Verification utility (sigverif) to monitor and troubleshoot driver signing on your system.</p>

<p><li><b>To use sigverif</b></li></p>

<ol>
<p><li> Click Start, point to Run, type <b>sigverif</b> and then press Enter.</li></p>

<p>The File Signature Verification dialog box appears.</p>

<p><li> Click Advanced.</li></p>

<p>The Advanced File Signature Verification Settings dialog box appears with the Search tab active. Notice that by default, you are notified if any system files are not signed. Notice also that you can select Look For Other Files That Are Not Digitally Signed. This setting has the File Signature Verification utility verify nonsystem files to see whether they are digitally signed. If you select this option, you can specify the search parameters for the files you want checked.</p>

<p><li> Leave the default setting, Notify Me If Any System Files Are Not Signed, selected and then click the Logging tab.</li></p>

<p>Notice that by default, the File Signature Verification utility saves the file signature verification to a log file, named Sigverif.txt.</p>

<p><li> Leave the default settings and click OK to close the Advanced File Signature Verification Settings dialog box.</li></p>

<p><li> Click Start.</li></p>

<p>When the File Signature Verification utility completes its check, a Signature Verification Results window will appear if there are files that are not signed. Otherwise you will see a message box telling you that your files have been scanned and verified as being digitally signed.</p>

<p><li>If you get a Signature Verification Results window, review the results and then click Close to close the Signature Verification Results window. Otherwise, click OK to close the message box.</li></p>

<p><li> Click Close to exit the File Signature Verification utility.</li></p>
</ol>

<A NAME="861"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned about the two utilities that verify the digital signatures of system files. One is a command-line utility: System File Checker. It has a number of optional parameters that let you control how and when it will run. The second utility is a Windows utility, File Signature Verification. You practiced monitoring and troubleshooting digital signatures using the File Signature Verification utility.</p>

</BODY>
</HTML>






