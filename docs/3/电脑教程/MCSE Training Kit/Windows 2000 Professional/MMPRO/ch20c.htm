<HTML>
<HEAD>
<TITLE>Lesson 2: Monitoring Access to Shared Folders</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmpro.css"><SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch20b.htm", "ch20d.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>



<A NAME="689"><H1>Lesson 2: Monitoring Access to Shared Folders</H1></A>

<p>You monitor access to shared folders to determine how many users currently have a connection to each folder. You can also monitor open files to determine which users are gaining access to the files, and you can disconnect users from one open file or from all open files.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Determine the shared folders on a computer.</li></p>

<p><li>Monitor shared folders.</li></p>

<p><li>View and modify the properties of a shared folder.</li></p>

<p><li>Monitor open files.</li></p>

<p><li>Disconnect users from one or all open files.</li></p>
</ul>

<p><b>Estimated lesson time: 15 minutes</b></p>
</blockquote></div></p>

<A NAME="690"><H2>Monitoring Shared Folders</H2></A>

<p>You use the Shares folder in either the Computer Management snap-in or the Shared Folders snap-in to view a list of all shared folders on the computer and to determine how many users have a connection to each folder. In Figure 20.1, the Shares folder has been selected in the Computer Management console tree, and all the shared folders on that computer are shown in the details pane.</p>

<p>
<A HREF="javascript:fullSize('F20tk01x.htm')"> <img src="images/F20tk01.JPG" width=404 height=280 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 20.1</b> <i>The Shares folder in the Computer Management window</i><!-- /caption -->
</p>

<p>Table 20.2 explains the information provided in the details pane shown in 
Figure 20.1.</p>

<p><b>Table 20.2</b> <i>Information Available in the Shares Folder</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>Column name</th>
<th>Description</th>
</tr>
<tr>
<td valign="top">Shared Folder</td>
<td valign="top">The shared folders on the computer. This is the name that was 
 given to the folder when it was shared.</td>
</tr>
<tr>
<td valign="top">Shared Path</td>
<td valign="top">The path to the shared folder.</td>
</tr>
<tr>
<td valign="top">Type</td>
<td valign="top">The operating system that must be running on a computer so 
 that it can be used to gain access to the shared folder.</td>
</tr>
<tr>
<td valign="top"># Client Redirections</td>
<td valign="top">The number of clients who have made a remote connection to 
 the shared folder.</td>
</tr>
<tr>
<td valign="top">Comment</td>
<td valign="top">Descriptive text about the folder. This comment was provided 
 when the folder was shared.</td>
</tr>
</table>
</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>Microsoft Windows 2000 doesn't update the list of shared folders, open files, and user sessions automatically. To update these lists, on the Action menu, click Refresh.</blockquote></div></p>

<A NAME="691"><H3>Determining How Many Users Can Access a Shared Folder Concurrently</H3></A>

<p>You can use the Computer Management snap-in or Shared Folders snap-in to 
determine the maximum number of users that are permitted to gain access to 
a folder. In the Shared Folders details pane, click the shared folder for which 
you want to determine the maximum number of concurrent users that can access the folder. On the Action menu, click Properties, and the Properties dialog box for the shared folder appears. The General tab shows you the user limit. In 
Windows 2000 Professional, the maximum is 10. However, you can set this to 
a lower value.</p>

<p>You can also use the Computer Management snap-in or Shared Folders snap-in to determine whether the maximum number of users that are permitted to gain access to a folder has been reached. This is one quick and easy way to troubleshoot connectivity problems. If a user can't connect to a share, determine the number of connections to the share and the maximum connections allowed. If the maximum number of connections have already been made, the user can't connect to the shared resource.</p>

<A NAME="692"><H3>Modifying Shared Folder Properties</H3></A>

<p>You can modify existing shared folders, including shared folder permissions, from the Shares folder. To change a shared folder's properties, click the shared folder, and then on the Action menu, click Properties. The General tab of the Properties dialog box shows you the share name, the path to the shared folder, and any comment that has been entered. The General tab also allows you to view and set a user limit for accessing the shared folder. The Security tab allows you to view and change the shared folders permissions.</p>

<A NAME="693"><H2>Monitoring Open Files</H2></A>

<p>Use the Open Files folder in either the Computer Management snap-in or Shared Folders snap-in to view a list of open files that are located in shared folders and the users who have a current connection to each file (see Figure 20.2). You can use this information when you need to contact users to notify them that you are shutting down the system. Additionally, you can determine which users have a current connection and should be contacted when another user is trying to gain access to a file that is in use.</p>

<p>
<A HREF="javascript:fullSize('F20tk02x.htm')"> <img src="images/F20tk02.JPG" width=404 height=235 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 20.2</b> <i>The Open Files folder in the Computer Management window</i><!-- /caption -->
</p>

<p>Table 20.3 describes the information that is available in the Open Files folder.</p>

<p><b>Table 20.3</b> <i>Information Available in the Open Files Folder</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>Column name</th>
<th>Description</th>
</tr>
<tr>
<td valign="top">Open File</td>
<td valign="top">The name of the open files on the computer.</td>
</tr>
<tr>
<td valign="top">Accessed By</td>
<td valign="top">The logon name of the user who has the file open.</td>
</tr>
<tr>
<td valign="top">Type</td>
<td valign="top">The operating system running on the computer where the user 
 is logged on.</td>
</tr>
<tr>
<td valign="top"># Locks</td>
<td valign="top">The number of locks on the file. Programs can request the 
 operating system to lock a file to gain exclusive access and 
 prevent other programs from making changes to the file.</td>
</tr>
<tr>
<td valign="top">Open Mode</td>
<td valign="top">The type of access that the user's application requested when it 
 opened the file, such as Read or Write.</td>
</tr>
</table>
</p>

<A NAME="694"><H2>Disconnecting Users from Open Files</H2></A>

<p>You can disconnect users from one open file or from all open files. If you make changes to the Microsoft Windows 2000 File System (NTFS) permissions for a file that is currently opened by a user, the new permissions won't affect the user until he or she closes and then attempts to reopen the file.</p>

<p>You can force these changes to take place immediately by doing either of the 
following:</p>

<ul>
<p><li>Disconnecting all users from all open files. To disconnect all users from all open files, in the Shared Folders snap-in console tree, click Open Files, and then on the Action menu, click Disconnect All Open Files.</li></p>

<p><li>Disconnecting all users from one open file. To disconnect users from one open file, in the Shared Folders snap-in console tree, click Open Files. In the details pane, select the open file, and then on the Action menu, click Close Open File.</li></p>
</ul>

<p>
<div class="caution"><blockquote>
<b>CAUTION</b><hr>Disconnecting users from open files can result in data loss.
</blockquote></div>
</p>

<p><img src="images/practic.JPG" width=92 height=74 border="0"></p>

<A NAME="695"><H2>Practice: Managing Shared Folders</H2></A>

<p>In this practice, you will use the Computer Management window to view the shared folders and open files on your computer. You will disconnect all users from all open files.</p>

<p><li> <b>To view the shared folders on your computer</b></li></p>

<ol>
<p><li>  Click the Start button, point to Programs, point to Administrative Tools, and then click Computer Management.</li></p>

<p><li>  In the console tree of Computer Management, expand System Tools, and then expand Shared Folders.</li></p>

<p><li>  In the console tree, click Shares under Shared Folders.</li></p>

<p>Notice that the details pane shows a list of the existing Shared Folders on your computer.</p>
</ol>

<p><li> <b>To view the open files on your computer</b></li></p>

<ul>
<p><li>In the console tree, click Open Files under Shared Folders.</li></p>

<p>If you are working on a computer that isn't connected to a network, there won't be any open files because the open files show only connections from a remote computer to a share on your computer.</p>
</ul>

<p><li> <b>To disconnect all users from open files on your computer</b></li></p>

<ol>
<p><li>  In the console tree, select Open Files under Shared Folders, and then click Disconnect All Open Files on the Action menu.</li></p>

<p>If you aren't on a network, there won't be any open files to disconnect.</p>

<p><li>  Leave Computer Management open. You'll use it in the next practice.</li></p>
</ol>

<A NAME="696"><H2>Lesson Summary</H2></A>

<p>In this lesson, you learned that you use the Shares folder in either the Computer Management snap-in or the Shared Folders snap-in to view a list of all shared folders on the computer and to determine how many users have a connection to each folder. The General tab of the Properties dialog box for a shared folder shows you the user limit, or maximum number of users that can concurrently connect to that share.</p>

<p>You also learned that you can modify existing shared folders, including shared folder permissions. To change a shared folder's properties, click the shared folder, and then on the Action menu, click Properties. The General tab of the Properties dialog box lets you view and change the user limit for accessing the shared folder. The Security tab allows you to view and change the shared folders permissions.</p>

</BODY>
</HTML>






