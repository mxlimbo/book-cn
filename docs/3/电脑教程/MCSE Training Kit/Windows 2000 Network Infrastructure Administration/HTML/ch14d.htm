<HTML>
<HEAD>
<TITLE>Lesson 3: Monitoring Security Events</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmnet.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch14c.htm">[Previous]</A> <A HREF="ch14e.htm">[Next]</A><P>



<A NAME="626"><H1>Lesson 3: Monitoring Security Events</H1></A>

<p>In <a href="ch14b.htm#608">Lesson 1</a>, you learned about various sections of a network security plan. 
Administrative policies for a security plan include policies for delegation of 
administrative tasks and monitoring of audit logs to detect suspicious activity. In this lesson, you will learn how to monitor security events in Windows 2000 to prevent attacks and intrusion on your network.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Manage and monitor network traffic</li></p>

<p><li>Manage and monitor remote access</li></p>
</ul>
<p><b>Estimated lesson time: 45 minutes</b></p>
</blockquote></div></p>

<A NAME="627"><H2>Monitoring Your Network Security</H2></A>

<p>The network security technologies you implement, such as Microsoft Proxy Server, can meet your security goals only if you plan and configure them 
carefully. With thorough preparation, this work can be done very successfully. 
However, anticipating all possible risks can be very difficult because</p>

<ul>
<p><li>New risks develop.</li></p>

<p><li>Systems can break down and the environment in which your systems are placed changes over time.</li></p>
</ul>



<p>By continually reviewing your network security strategies, you can minimize 
security risks. However, you also need to watch the actual network security 
activity to spot weaknesses before they are exploited, and to stop attempts to break security before they are effective.</p>

<p>To watch your network security activity, you need tools to capture the details about the activities and to analyze the data. For example, Microsoft Proxy Server includes logging at two levels: normal and verbose. Windows 2000 also has event logging, which can be enhanced by enabling security auditing. IAS, discussed later in this chapter, has extensive activity reporting options. Third-party products are also available that can help with monitoring servers and applications, including security servers and applications.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>When using security servers and applications, be sure to review the 
documentation for the systems you use and select the logging options that best meet your requirements.</blockquote></div></p>

<A NAME="628"><H2>Using Event Viewer to Monitor Security</H2></A>

<p>Event Viewer allows you to monitor events in your system. It maintains logs about program, security, and system events on your computer. You can use Event Viewer to view and manage the event logs, gather information about hardware and software problems, and monitor Windows 2000 security events. The Event Log service starts automatically when you start Windows 2000. All users can view application and system logs. You can also set up the Windows operating system to audit accesses on specific resources and to have them recorded in the Security Log. Table 14.4 lists various events that you can audit, as well as the specific security threat that the audit event monitors.</p>

<p><b>Table 14.4</b> <i>Threats Detected with Auditing</i></p>

<p><table cellpadding=5 width="95%"><tr>
<th>Audit Event</th> <th>Threat Detected</th>
</tr><tr>
<td valign="top">Failure audit for logon/logoff.</td><td valign="top"> Random password hack</td>
</tr><tr>
<td valign="top">Success audit for logon/logoff.</td> <td valign="top">Stolen password break-in</td>
</tr><tr>
<td valign="top">Success audit for user rights, user and group management, security change policies, 
restart, shutdown, and system events.</td><td valign="top">Misuse of privileges </td>
</tr><tr>
<td valign="top">Success and failure audit for file-access and object-access events. File Manager success and 
failure audit of read/write access by suspect 
users or groups for the sensitive files.</td><td valign="top">Improper access to sensitive files </td>
</tr><tr>
<td valign="top">Success and failure audit for file-access printers and object-access events. Print Manager 
success and failure audit of print access by 
suspect users or groups for the printers.</td><td valign="top">Improper access to printers</td> 
</tr><tr>
<td valign="top">Success and failure write access auditing for program files (.exe and .dll extensions). 
Success and failure auditing for process tracking. 
Run suspect programs; examine security log for 
unexpected attempts to modify program files or 
create unexpected processes. Run only when 
actively monitoring the system log.</td><td valign="top">Virus outbreak</td> 
</tr></table></p>

<p><img src="images/practic.JPG" width=90 height=72 border="0"></p>

<A NAME="629"><H2>Practice: Recording Failed Logon Attempts</H2></A>

<p>Security auditing is not enabled by default. You have to activate the types of 
auditing you require by using the Group Policy snap-in to Microsoft Management Console (MMC). You also must enable auditing for the general areas or specific items you want to track.</p>

<p><li><b>To activate security auditing for failed logon attempts</b></li></p>

<ol>
<p><li>Click Start, click Run, type <b>mmc</b>, then click OK.</li></p>

<p><li>On the Console menu, click Add/Remove Snap-In, then click Add.</li></p>
<p>The Add/Remove Snap-In dialog box appears.</p>

<p><li>Click Add.</li></p>

<p>The Add Standalone Snap-In dialog box appears.</p>

<p><li>Select Group Policy, then click Add.</li></p>

<p>The Select Group Policy dialog box appears.</p>

<p><li>Click Finish to add the local computer.</li></p>

<p>You can also click Browse and then select another computer on your network.</p>

<p><li>In the Add Standalone Snap-In dialog box, click Close.</li></p>

<p><li>In the Add/Remove Snap-In dialog box, click OK.</li></p>

<p><li>Under Local Computer Policy\Computer Configuration\Windows Settings\Security Settings\Local Policies, click Audit Policy, as illustrated in Figure 14.5.</li></p>

<p><li>In the details pane, right-click the Audit Logon Events attribute, then right-click Security.</li></p>

<p>The Local Security Policy Setting dialog box appears.</p>

<p><li>Under Audit These Attempts, select Failure, then click OK.</li></p>
</ol>

<p>
<A HREF="javascript:fullSize('14ntk05x.htm')"> <img src="images/14ntk05.JPG" width=404 height=228 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 14.5</b> <i>Selecting audit policy for the local computer policy</i><!-- /caption -->
</p>

<A NAME="630"><H3>Viewing the Security Event Log</H3></A>

<p>You can specify that an audit entry be written to the security event log whenever certain actions are performed or files are accessed. The audit entry shows the 
action performed, the user who performed it, and the date and time of the action. You can audit both successful and failed attempts at actions, so the audit trail can show who performed actions on the network and who tried to perform actions that are not permitted. You can view the security log in the Event Viewer.</p>

<p>Recording security events is a form of intrusion detection through auditing. 
Auditing and security logging of network activity are important safeguards. 
Windows 2000 enables you to monitor a wide variety of events that can be used to track the activities of an intruder.</p>

<p>The security log records security events, such as valid and invalid logon attempts, and events related to resource use, such as creating, opening, or deleting files or other objects. The security log helps track changes to the security system and identifies any possible breaches to security. For example, attempts to log on to the system might be recorded in the security log, if logon and logoff auditing are enabled. If the security log is examined regularly, it makes it possible to detect some types of attacks, such as password attacks, before they succeed. After a break-in, the security log can help you determine how the intruder entered and what he or she did. The log file entries can serve as legal evidence after the 
intruder has been identified.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>For the highest level of security, monitor the log files constantly.</blockquote></div></p>

<p><img src="images/practic.JPG" width=90 height=72 border="0"></p>

<A NAME="631"><H2>Practice: Viewing the Security Log</H2></A>

<p>Event logs consist of a header, a description of the event (based on the event type), and, optionally, additional data. Most security log entries consist of the header and a description. Event Viewer displays events from each log separately. Each line shows information about a single event, including date, time, source, event type, category, event ID, user account, and computer name. In this practice, you will view the security event log to detect attempted unauthorized network access. To complete this practice, you must have performed the steps in the 
<a href="ch14d.htm#629">previous practice</a> in this lesson.</p>

<p><li><b>To view the security event log</b></li></p>

<ol>
<p><li>Attempt to log on to the Windows 2000 computer on which you activated security auditing for failed logon attempts using an invalid user name and password.</li></p>

<p><li>After failing to log on, use a valid user name and password to log on to Windows 2000.</li></p>

<p><li>Click Start, point to Programs, point to Administrative Tools, then click Event Viewer.</li></p>
<p>Event Viewer opens.</p>

<p><li>Click Security Log in the left pane.</li></p>

<p>Notice that the failed logon attempt is shown in the right pane of the Event Viewer, as illustrated in Figure 14.6.</p>

<p><li>Double-click the Failure Audit item in the event view to open the Event Properties window.</li></p>

<p>Notice that the description section tells you the reason for the failure and the user name entered, but not the password entered.</p>

<p><li>Click OK to close the Event Properties window.</li></p>
</ol>

<p>
<A HREF="javascript:fullSize('14ntk06x.htm')"> <img src="images/14ntk06.JPG" width=404 height=139 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 14.6</b> <i>Invalid logon entry made in the security event log</i><!-- /caption -->
</p>

<A NAME="632"><H2>System Monitor</H2></A>

<p>System Monitor is a tool that can be used to track system resources usage. 
System Monitor can be used to test an application's usage of system resources. Common objects that a user can log are memory, CPU, network, and disk 
activity. Some additional counters, although not performance related, provide useful information about server security. These include</p>

<ul>
<p><li>Server\Errors Access Permissions</li></p>

<p><li>Server\Errors Granted Access</li></p>

<p><li>Server\Errors Logon</li></p>

<p><li>IIS Security</li></p>
</ul>



<p><li><b>To monitor security events using System Monitor</b></li></p>

<ol>
<p><li>Click Start, point to Programs, point to Administrative Tools, then click Performance.</li></p>

<p>System Monitor opens in the MMC.</p>

<p><li>In the right pane, click Add.</li></p>

<p>The Add Counters dialog box appears, as illustrated in Figure 14.7.</p>

<p><li>In the Performance Object drop-down list box, select Server.</li></p>

<p><li>Click Select Counters From List.</li></p>

<p><li>In the Counters list, select a counter, then click Add.</li></p>

<p><li>Click Close to close the Add Counters dialog box.</li></p>
</ol>

<p>
<img src="images/14ntk07.JPG" width=398 height=313 border="0">
</p><p>
<!-- caption --><b>Figure 14.7</b> <i>Adding the Error Logon counter</i><!-- /caption -->
</p>

<A NAME="633"><H2>The IPSec Monitor Utility</H2></A>

<p>The IPSec Monitor can confirm whether your secured communications are 
successful by displaying the active SAs on local or remote computers. For 
example, you can use IPSec Monitor to determine whether there has been a 
pattern of authentication or SA failures, possibly indicating incompatible security policy settings. IPSec Monitor can be run on the local computer or it can be run remotely if you have a network connection to the remote computer.</p>

<p><li><b>To run IPSec Monitor</b></li></p>

<ol>
<p><li>Click Start, then click Run.</li></p>

<p><li>In the Run dialog box, type <b>ipsecmon &lt;computername&gt;</b>, then click OK.</li></p>

<p>The IP Security Monitor dialog box opens, as illustrated in Figure 14.8. An entry is displayed for each active SA. The information contained in each entry includes the name of the active IPSec policy, the active Filter Action and IP Filter List (including details of the active filter), and the tunnel endpoint 
(if one was specified).</p>

<p><li>Click the Options button to set the refresh rate.</li></p>
</ol>

<p>
<A HREF="javascript:fullSize('14ntk08x.htm')"> <img src="images/14ntk08.JPG" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 14.8</b> <i>The IP Security Monitor interface</i><!-- /caption -->
</p>

<p>IPSec Monitor can also provide statistics to aid in performance tuning and troubleshooting, including the following statistics:</p>

<ul>
<p><li>The number and type of active SAs.</li></p>

<p><li>The total number of master and session keys. Successful IPSec SAs initially cause one master key and one session key. Subsequent key regenerations are shown as additional session keys.</li></p>

<p><li>The total number of confidential (Encapsulated Security Payload) or authenticated (Encapsulated Security Payload or authentication header) bytes sent or received.</li></p>
</ul>



<A NAME="634"><H2>Monitoring Security Overhead</H2></A>

<p>Security is achieved only at some cost in performance. Measuring the performance overhead of a security strategy is not simply a matter of monitoring a separate process or thread. The features of the Windows 2000 security model and other security services are integrated into several different operating system services. You cannot monitor security features separately from other aspects of the services. Instead, the most common way to measure security overhead is to run tests comparing server performance with and without a security feature. The tests should be run with fixed workloads and a fixed server configuration so that the security feature is the only variable. During the tests, you should measure</p>

<ul>
<p><li>Processor activity and the processor queue</li></p>

<p><li>Physical memory used</li></p>

<p><li>Network traffic</li></p>

<p><li>Latency and delays</li></p>
</ul>



<A NAME="635"><H2>Lesson Summary</H2></A>

<p>You should monitor network security activity to identify weaknesses before they are exploited. You can use Event Viewer to view and manage Windows 2000 
security events. The audit entry shows the action performed, the user who performed it, and the date and time of the action. Both System Monitor and Network Monitor can provide useful information about server security. The IPSec Monitor can confirm whether your secured communications are successful. In addition, you can use Routing and Remote Access to monitor remote access traffic in 
Windows 2000, and enable logging to review this data.</p>

</BODY>
</HTML>





