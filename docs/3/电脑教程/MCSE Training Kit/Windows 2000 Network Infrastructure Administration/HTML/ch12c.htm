<HTML>
<HEAD>
<TITLE>Lesson 2: Installing Internet Connection Sharing</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmnet.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch12b.htm">[Previous]</A> <A HREF="ch12d.htm">[Next]</A><P>



<A NAME="546"><H1>Lesson 2: Installing Internet Connection Sharing</H1></A>

<p>Internet Connection Sharing (ICS) is a feature of Network and Dial-Up Connections that allows you to use Windows 2000 to connect your home network or small office network to the Internet. For example, you might have a home network that connects to the Internet by using a dial-up connection. In this lesson, you will learn how to install ICS in Windows 2000.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Enable the ICS feature of Windows 2000</li></p>

<p><li>Configure Internet options for ICS</li></p>
</ul>

<p><b>Estimated lesson time: 35 minutes</b></p>
</blockquote></div></p>

<A NAME="547"><H2>Internet Connection Sharing</H2></A>

<p>Internet Connection Sharing (ICS) is a simple package consisting of DHCP, NAT, and DNS. You can use ICS to easily connect your entire network to the Internet. Because ICS provides a translated connection, all of the computers on the network can access Internet resources such as e-mail, Web sites, and FTP sites. ICS provides the following:</p>

<ul>
<p><li>Ease of configuration</li></p>

<p><li>Single public IP address</li></p>

<p><li>Fixed address range for hosts</li></p>

<p><li>DNS proxy for name resolution</li></p>

<p><li>Automatic IP addressing</li></p>
</ul>

<p>ICS provides many more features than just address translation. Microsoft has added many features to make the configuration of Internet connections as simple as possible. ICS can be fully configured and administered from the Routing and Remote Access Manager. For a simple home network, a Connection Sharing Wizard can also be launched from Control Panel Connections. The wizard does not allow configuration of any options but can get a home network up on the Internet in minutes. What simplifies the configuration is automatic addressing and automatic name resolution through the DHCP allocator, DNS proxy, and WINS proxy components. Each of these components provides a simplified configuration over the full version of DHCP, DNS, and WINS servers.</p>

<p>By enabling ICS on the computer that uses the dial-up connection, you are providing NAT, addressing, and name resolution services for all computers on your home network. After ICS is enabled and users verify their networking and Internet options, home network or small office network users can use applications such as Microsoft Internet Explorer and Microsoft Outlook Express as if they were directly connected to the ISP. The ICS computer then dials the ISP and creates the connection so that the user can reach the specified Web address or resource. To use the ICS feature, users on your home office or small office network must configure TCP/IP on their local area connection to obtain an IP address automatically.</p>

<A NAME="548"><H3>Enabling Internet Connection Sharing</H3></A>

<p>Before you enable ICS, consider the following:</p>

<ul>
<p><li>You should not use the ICS feature in a network with other Windows 2000 Server domain controllers, DNS servers, gateways, DHCP servers, or systems configured for static IP.</li></p>

<p><li>When you enable ICS, the network adapter connected to the home or small office network is given a new IP address configuration. Existing TCP/IP connections on the ICS computer are lost and need to be reestablished.</li></p>

<p><li>To use the ICS feature, users on your home office or small office network must configure TCP/IP on their local area connection to obtain an IP address automatically.</li></p>

<p><li>If the ICS computer is using ISDN or a modem to connect to the Internet, you must select the Enable On-Demand Dialing check box.</li></p>
</ul>

<p><li><b>To enable ICS on a network connection</b></li></p>

<ol>
<p><li>Click Start, point to Settings, then click Network And Dial-Up Connections.</li></p>

<p><li>Right-click the dial-up, virtual private network (VPN), or incoming connection you want to share, then click Properties.</li></p>

<p><li>In the Sharing tab, select the Enable Internet Connection Sharing For This Connection check box.</li></p>

<p><li>If you want this connection to dial automatically when another computer on your home network attempts to access external resources, select the Enable On-Demand Dialing check box.</li></p>
</ol>

<A NAME="549"><H3>Installing Connection Sharing</H3></A>

<p>Connection Sharing is configured from within the Routing and Remote Access Manager.</p>

<p><li><b>To install Connection Sharing</b></li></p>

<ol>
<p><li>In the Routing and Remote Access Manager, open the IP Routing folder and right-click on General.</li></p>

<p><li>Click New Routing Protocol, as illustrated in Figure 12.5.</li></p>

<p>The Select Routing Protocol dialog box appears.</p>

<p><li>In the Select Routing Protocol dialog box, click Connection Sharing.</li></p>
</ol>

<p>
<A HREF="javascript:fullSize('12ntk05x.htm')"> <img src="images/12ntk05.JPG" width=404 height=287 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 12.5</b> <i>Routing and Remote Access Manager IP Routing menu</i><!-- /caption -->
</p>

<A NAME="550"><H3>Configuring Internet Options for Internet Connection Sharing</H3></A>

<p>If you have not previously established an Internet connection, complete the following steps.</p>

<p><li><b>To establish an Internet connection</b></li></p>

<ol>
<p><li>Open Internet Explorer.</li></p>

<p><li>Click I Want To Set Up My Internet Connection Manually or I Want To Connect Through A Local Area Network (LAN), then click Next.</li></p>

<p><li>Click I Connect Through A Local Area Network (LAN), then click Next.</li></p>

<p><li>Clear the Automatic Discovery Of Proxy Server [Recommended] check box, then click Next.</li></p>

<p><li>If you want to set up an Internet mail account now, and know your connection information, click Yes, and provide the e-mail account information for which the wizard prompts you. If you do not want to set up an Internet mail account, click No, click Next, then click Finish.</li></p>
</ol>

<p>If you have previously established an Internet connection, you will be prompted to complete the following steps.</p>

<p><li><b>To configure Internet options for ICS</b></li></p>

<ol>
<p><li>From the Tools menu, click Internet Options.</li></p>

<p><li>In the Connections tab, click Never Dial A Connection, then click LAN Settings.</li></p>

<p><li>In Automatic Configuration, clear the Automatically Detect Settings and Use Automatic Configuration Script check boxes.</li></p>

<p><li>In Proxy Server, clear the Use A Proxy Server check box.</li></p>
</ol>

<A NAME="551"><H2>Internet Connection Sharing and NAT</H2></A>

<p>To connect a small office or home office network to the Internet, you can use either a routed or translated connection. For a routed connection, the computer running Windows 2000 Server acts as an IP router that forwards packets between the internal network and the public Internet. Although conceptually simple, a routed connection requires knowledge of IP addressing and routing. However, routed connections allow for all IP traffic between internal hosts and the public Internet. For more information, see the Small Office/Home Office (SOHO) Network to the Internet online help topic.</p>

<p>For a translated connection, the computer running Windows 2000 Server acts as a network address translator. Translated connections that use computers running Windows 2000 Server require less knowledge of IP addressing and routing, and provide a simplified configuration for hosts and the Windows 2000 router. However, translated connections may not allow all IP traffic between SOHO hosts and Internet hosts.</p>

<p>In Windows 2000 Server, you can configure a translated connection to the Internet by using either the ICS feature of Network and Dial-Up Connections or the NAT routing protocol provided with Routing and Remote Access. Both ICS and NAT provide translation, addressing, and name resolution services to SOHO hosts.</p>

<p>As described in the previous section, ICS is designed to provide a single step of configuration (a single check box) on the computer running Windows 2000 to provide a translated connection to the Internet for all of the hosts on the network. However, once enabled, ICS does not allow further configuration beyond the configuration of applications and services. For example, ICS is designed for a single IP address obtained from an ISP and does not allow you to change the range of IP addresses allocated to hosts.</p>

<p>As you learned in <a href="ch12b.htm">Lesson 1</a>, the NAT routing protocol is designed to provide maximum flexibility in the configuration of the computer running Windows 2000 Server to provide a translated connection to the Internet. NAT requires additional configuration steps; however, each step of the configuration is customizable. The NAT protocol allows for ranges of IP addresses from the ISP and the configuration of the range of IP addresses allocated to hosts.</p>

<p>Table 12.2 summarizes the features and capabilities of ICS and NAT.</p>

<p><b>Table 12.2</b> <i>ICS and NAT Features</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th>ICS</th>
			<th>NAT</th>
		</tr>

		<tr>
			<td valign="top">Single check box configuration</td>
			<td valign="top">Manual configuration</td>
		</tr>

		<tr>
			<td valign="top">Single public IP address</td>
			<td valign="top">Multiple public IP addresses</td>
		</tr>

		<tr>
			<td valign="top">Fixed address range for internal hosts</td>
			<td valign="top">Configurable address range for internal hosts</td>
		</tr>

		<tr>
			<td valign="top">Single internal interface</td>
			<td valign="top">Multiple internal interfaces</td>
		</tr>
		
	</table>
</p>

<p>ICS and NAT are features of Windows 2000 Server that are designed to connect SOHO networks to the Internet. ICS and NAT are not designed to</p>

<ul>
<p><li>Directly connect separate private networks together</li></p>

<p><li>Connect networks within an intranet</li></p>

<p><li>Directly connect branch office networks to a corporate network</li></p>

<p><li>Connect branch office networks to a corporate network over the Internet</li></p>
</ul>

<A NAME="552"><H2>Troubleshooting Connection Sharing (NAT)</H2></A>

<p>You can answer the following questions to troubleshoot configuration problems with Connection Sharing (NAT):</p>

<ul>
<p><li><b> Are all of your interfaces (public and private) added to the Connection Sharing (NAT) routing protocol?</b> You must add both public (Internet) and private (small office or home office) interfaces to the Connection Sharing (NAT) routing protocol.</li></p>

<p><li><b> Is translation enabled on the Internet (external) interface?</b> You need to verify that the interface on the Windows router that connects to the Internet is configured for translation. The Enable Translation Across This Interface option in the General tab of the Properties Of The Internet Interface dialog box should be selected.</li></p>

<p><li><b> Is Connection Sharing enabled on the private (internal) interface?</b> You need to verify that the interface on the Windows router that connects to the internal network is configured for Connection Sharing. The Allow Clients On This Interface To Access Any Shared Networks option in the General tab of the Properties Of The Home Network Interface dialog box should be selected.</li></p>

<p><li><b> Is TCP/UDP port translation enabled?</b> If you only have a single public IP address, you need to verify that the Translate TCP/UDP Headers check box in the General tab of the Properties Of The External Interface dialog box is selected.</li></p>

<p><li><b> Is your range of public addresses set correctly?</b> If you have multiple public IP addresses, you need to verify that they are properly entered in the Address Pool tab of the Properties Of The Internet Interface dialog box. If your address pool includes an IP address that was not allocated to you by your ISP, then inbound Internet traffic that is mapped to that IP address may be routed by the ISP to another location.</li></p>

<p><li><b> Is the protocol being used by a program translatable?</b> If you have some programs that do not seem to work through the NAT, you can try running them from the NAT computer. If they work from the NAT computer and not from a computer on the private network, then the payload of the program may not be translatable. You can check the protocol being used by the program against the list of supported NAT editors.</li></p>

<p><li><b> Is Connection Sharing addressing enabled on the home office network?</b> If static addresses are not configured on the private network, verify that Connection Sharing addressing is enabled on the interfaces corresponding to the private network. To verify, click Interfaces in the Addressing tab of the Properties Of The Connection Sharing Object dialog box.</li></p>
</ul>

<A NAME="553"><H2>Lesson Summary</H2></A>

<p>ICS is a feature of Network and Dial-Up Connections that allows you to use Windows 2000 to connect your home network or small office network to the Internet. ICS can be fully configured and administered from the Routing and Remote Access Manager. By enabling ICS on the computer that uses the dial-up connection, you are providing NAT, addressing, and name resolution services for all computers on your home network.</p>

</BODY>
</HTML>





