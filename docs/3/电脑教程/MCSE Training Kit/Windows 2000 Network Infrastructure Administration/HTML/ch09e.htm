<HTML>
<HEAD>
<TITLE>Lesson 4: Configuring WINS Replication</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmnet.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch09d.htm">[Previous]</A> <A HREF="ch09f.htm">[Next]</A><P>



<A NAME="383"><H1>Lesson 4: Configuring WINS Replication</H1></A>

<p>All WINS servers on an internetwork can be configured to fully replicate database entries with other WINS servers. This ensures that a name registered with one WINS server is eventually replicated to all other WINS servers. This lesson explains how WINS database entries are replicated to other WINS servers.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Add a replication partner</li></p>

<p><li>Perform WINS database replication</li></p>
</ul>



<p><b>Estimated lesson time: 20 minutes</b></p>
</blockquote></div></p>

<A NAME="384"><H2>Replication Overview</H2></A>

<p>Database replication occurs whenever the database changes, including when a name is released. Replicating databases enables a WINS server to resolve NetBIOS names of hosts registered with another WINS server. For example, if a host on Subnet 1 is registered with a WINS server on the same subnet but wants to communicate with a host on Subnet 2 and that host is registered with a different WINS server, the NetBIOS name cannot be resolved unless the two WINS servers have replicated their databases with each other.</p>

<p>To replicate database entries, each WINS server must be configured as either a pull or a push partner with at least one other WINS server. A push partner is a WINS server that sends a message to its pull partners notifying them when its WINS database has changed. When a WINS server's pull partners respond to the message with a replication request, the WINS server sends a copy of its new 
database entries (replicas) to its pull partners.</p>

<p>A pull partner is a WINS server that requests new database entries (replicas) from its push partners. This is done by requesting entries with a higher version number than the last entries it received during the last replication.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>WINS servers replicate only new entries in their database. The entire WINS database is not replicated each time replication occurs.</blockquote></div></p>

<A NAME="385"><H2>Configuring a WINS Server as a Push or Pull Partner</H2></A>

<p>Determining whether to configure a WINS server as a pull partner or push partner depends on your network environment. Remember the following rules (depicted in Figure 9.11) when configuring WINS server replication:</p>

<ul>
<p><li>Configure a push partner when servers are connected by fast links, because push replication occurs when the configured number of updated WINS database entries is reached.</li></p>


<p>
<A HREF="javascript:fullSize('09ntk11x.htm')"> <img src="images/09ntk11.JPG" width=404 height=231 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 9.11</b> <i>Push and pull partner configuration</i><!-- /caption -->
</p>


<p><li>Configure a pull partner between sites, especially across slow links, because pull replication can be configured to occur at specific intervals.</li></p>

<p><li>Configure each server to be both a push and pull partner to replicate database entries between them.</li></p>
</ul>



<p><div class="note"><blockquote><b>NOTE</b><HR>You configure a WINS server as a push or pull partner with the WINS 
administration tool.</blockquote></div></p>

<ul>
<p><li>In both Sydney and Seattle, all WINS servers at each site push their new database entries to a single server at their site.</li></p>

<p><li>The servers that receive the push replication are configured for pull replication between each other because the network link between Sydney and Seattle is relatively slow. Replication should occur when the link is the least used, such as late at night.</li></p>
</ul>



<A NAME="386"><H2>Configuring Database Replication</H2></A>

<p>Database replication requires that you configure at least one push partner and 
one pull partner. There are four methods of starting the replication of the WINS database:</p>

<ol>
<p><li>At system startup. Once a replication partner is configured, by default, WINS automatically pulls database entries each time WINS is started. The WINS server can also be configured to push on system startup.</li></p>

<p><li>At a configured interval, such as every five hours.</li></p>

<p><li>When a WINS server has reached a configured threshold for the number of registrations and changes to the WINS database. When the threshold (the update count setting) is reached, the WINS server notifies all of its pull partners, which will then request the new entries.</li></p>

<p><li>By forcing replication in the WINS administrative console, as illustrated in Figure 9.12.</li></p>
</ol>


<p>
<img src="images/09ntk12.JPG" width=281 height=451 border="0">
</p><p>
<!-- caption --><b>Figure 9.12</b> <i>Forcing WINS database replication</i><!-- /caption -->
</p>

<p><img src="images/practic.JPG" width=90 height=72 border="0"></p>

<A NAME="387"><H2>Practice: Performing WINS Database Replication</H2></A>

<p>In these procedures, you configure your WINS server to perform database 
replication with another WINS server.</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>To complete this procedure you first need to configure your second 
computer (Server2) as a WINS server.</blockquote></div></p>

<p>In this procedure, you configure your second computer (WINS server) as a replication partner.</p>

<p><li><b>To configure WINS replication partners</b></li></p>

<ol>
<p><li>Open the WINS administrative console.</li></p>

<p><li>Right-click the Replication Partners folder under your WINS server, then click New Replication Partner.</li></p>

<p>The New Replication Partners dialog box appears.</p>

<p><li>In the WINS Server box, type an IP address of a partner WINS server, then click OK.</li></p>
<p>The Replication Partners dialog box appears with your IP address added to the list of WINS servers, as illustrated in Figure 9.13.</p>

<p>
<A HREF="javascript:fullSize('09ntk13x.htm')"> <img src="images/09ntk13.JPG" width=404 height=203 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 9.13</b> <i>Replication partners listed in the WINS administrative console</i><!-- /caption -->
</p>

<p><li>Right-click the replication partner that you just added in the right pane, then click Properties.</li></p>

<p>The Server Properties dialog box appears.</p>

<p><li>Click the Advanced tab.</li></p>

<p><li>In the Replication Partner Type drop-down list box, select Pull.</li></p>

<p><li>The replication interval is set for 30 minutes.</li></p>

<p><li>Click OK.</li></p>
</ol>

<p>In this procedure, you force WINS to replicate the WINS database with the WINS server.</p>

<p><li><b>To force replication</b></li></p>

<ol>
<p><li>Right-click on the Replication Partners folder.</li></p>

<p><li>From the Context menu, click Replicate Now.</li></p>

<p>A dialog box appears asking you if you are sure you want to start replication.</p>

<p><li>Click Yes.</li></p>
<p>A message box appears indicating the replication request has been queued.</p>

<p><li>Click OK.</li></p>
</ol>

<A NAME="388"><H3>Planning How Many WINS Servers to Use</H3></A>

<p>On a smaller network, a single WINS server can adequately service up to 10,000 clients for NetBIOS name resolution requests. To provide additional fault tolerance, you can configure a second computer running Windows 2000 Server as a backup WINS server for clients. If you use only two WINS servers, you can easily set them up as replication partners of each other. For simple replication between two servers, one server should be set as a pull partner and the other as a push partner. Replication can be either manual or automatic, which you can configure by 
selecting the Enable Automatic Partner Configuration check box in the Advanced tab of the Replication Partner Properties dialog box.</p>

<p>A larger network sometimes requires more WINS servers for several reasons 
including, most importantly, the number of client connections per server. The number of users that each WINS server can support varies with usage patterns, data storage, and the processing capabilities of the WINS server computer. Some enterprise network environments require more robust hardware to handle WINS activity, so you might benefit from upgrading the server computer. When planning your servers, remember that each WINS server can simultaneously handle hundreds of registrations and queries per second. Any number of WINS servers can be specified for fault tolerance purposes. However, you should avoid deploying large numbers of WINS servers unless they are definitely necessary. By limiting the number of WINS servers on your network, you minimize traffic that results from replication, provide more effective NetBIOS name resolution, and reduce administrative requirements.</p>

<A NAME="389"><H3>WINS Automatic Replication Partners</H3></A>

<p>If your network supports multicasting, the WINS server can be configured to 
automatically find other WINS servers on the network by multicasting to the IP address 224.0.1.24. This multicasting occurs by default every 40 minutes. Any WINS servers found on the network are automatically configured as push and pull replication partners, with pull replication set to occur every two hours. If network routers do not support multicasting, the WINS server will find only other WINS servers on its subnet. Automatic WINS server partnerships are turned off by default. To manually disable this feature, use the Registry Editor 
to set UseSelfFndPnrs to 0 and McastIntvl to a large value.</p>

<A NAME="390"><H2>Backing Up the WINS Database</H2></A>

<p>The WINS console provides backup tools so that you can back up and restore 
the WINS database. When WINS backs up the server database, it creates a \Wins_bak\New folder under the backup folder you have specified as the 
Default backup path in Server Properties. Actual backups of the WINS database (WINS.MDB) are stored in this folder. By default, the backup path is the root folder on your system partition, such as C:\. After you specify a backup folder for the database, WINS performs complete database backups every three hours using the specified folder. WINS can also be configured to back up the database automatically when the service is stopped or the server computer is shut down.</p>

<p><li><b>To back up the WINS database</b></li></p>

<ol>
<p><li>Click Start, point to Programs, point to Administrative Tools, then click WINS.</li></p>

<p><li>In the console tree, click the applicable WINS server.</li></p>

<p><li>On the Action menu, click Backup Database.</li></p>

<p><li>When prompted to confirm, click Yes.</li></p>

<p><li>After backup is completed, click OK.</li></p>
</ol>

<p><div class="caution"><blockquote><b>IMPORTANT</b><HR>Do not specify a network drive as the backup location. In addition, if you change the WINS backup or database path in server properties, perform new backups to ensure successful future restorations of the WINS database. This is the only way for the active WINS database to be backed up, because the database is locked open while the WINS server is running.</blockquote></div></p>

<A NAME="391"><H2>Lesson Summary</H2></A>

<p>All of the WINS servers on a given network can be configured to communicate with each other so that a name registered with one WINS server will eventually be known by all WINS servers. A pull partner requests WINS new database 
entries. A push partner sends a message to its pull partners notifying them that 
its WINS database has changed.</p>

</BODY>
</HTML>





