<HTML>
<HEAD>
<TITLE>Lesson 3: Integrating DHCP with Naming Services</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmnet.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch10c.htm">[Previous]</A> <A HREF="ch10e.htm">[Next]</A><P>



<A NAME="417"><H1>Lesson 3: Integrating DHCP with Naming Services</H1></A>

<p>With Windows 2000, a DHCP server can enable dynamic updates in the DNS name space for any of its clients that support these updates. Scope clients can then use DNS dynamic update protocol to update their host name-to-address mapping information (which is stored in zones on the DNS server) whenever changes occur to their DHCP-assigned address. In this lesson, you will learn how to integrate DHCP with DNS.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Integrate DNS and DHCP</li></p>

<p><li>Describe how Dynamic DNS updates work</li></p>

<p><li>Identify how DHCP client updates are typically handled</li></p>
</ul>



<p><b>Estimated lesson time: 25 minutes</b></p>
</blockquote></div></p>

<A NAME="418"><H2>DNS and DHCP</H2></A>

<p>Although DHCP provides a powerful mechanism for automatically configuring client IP addresses, until recently DHCP did not notify the DNS service to update the DNS records on the client&#8212;specifically, updating the client name to an IP 
address, and IP address-to-name mappings maintained by a DNS server. Without a way for DHCP to interact with DNS, the information maintained by DNS for a DHCP client may be incorrect. For example, a client may acquire its IP address from a DHCP server, but the DNS records would not reflect the IP address 
acquired or provide a mapping from the new IP address to the computer name (fully qualified domain name [FQDN]).</p>

<A NAME="419"><H3>Registering for Dynamic DNS Updates</H3></A>

<p>In Windows 2000, DHCP servers and clients can register with DNS, if the server supports Dynamic DNS updates. The Windows 2000 DNS service supports dynamic updates. A Windows 2000 DHCP server can register with a DNS server and update pointer (PTR) and address (A) resource records (RRs) on behalf of its DHCP- 
enabled clients using the Dynamic DNS update protocol. The ability to register both A and PTR type records lets a DHCP server act as a proxy for clients using Windows 95 and Windows NT 4.0 for the purpose of DNS registration. DHCP servers can differentiate between Windows 2000 and other clients. An additional DHCP option code (Option Code 81) enables the return of a client's FQDN to the DHCP server. If implemented, the DHCP server can dynamically update DNS to modify an individual computer's RRs with a DNS server using the dynamic update protocol. This DHCP option permits the DHCP server the following possible interactions for processing DNS information on behalf of DHCP clients that include Option Code 81 in the DHCP request message they send to the server:</p>

<ul>
<p><li>The DHCP server always registers the DHCP client for both the forward (A-type records) and reverse lookups (PTR-type records) with DNS.</li></p>

<p><li>The DHCP server never registers the name-to-address (A-type records) mapping information for DHCP clients.</li></p>

<p><li>The DHCP server registers the DHCP client for both forward (A-type records) and reverse lookups (PTR-type records) only when requested to by the client.</li></p>
</ul>



<p>DHCP and static DNS service are not compatible for keeping name-to-address mapping information synchronized. This might cause problems with using DHCP and DNS together on a network if you are using older, static DNS servers, which are incapable of interacting dynamically when DHCP client configurations change.</p>

<p><li><b>To avoid failed DNS lookups for 
DHCP-registered clients when static DNS service is in effect</b></li></p>

<ol>
<p><li>If WINS servers are used on the network, enable WINS lookup for DHCP clients that use NetBIOS.</li></p>

<p><li>Assign IP address reservations with an infinite lease duration for DHCP clients that use DNS only and do not support NetBIOS.</li></p>

<p><li>Wherever possible, upgrade or replace older, static-based DNS servers with DNS servers supporting updates. Dynamic updates are supported by the Microsoft DNS, included in Windows 2000.</li></p>
</ol>

<p><b>Additional Recommendations</b></p>

<p>When using DNS and WINS together, consider the following options for interoperation:</p>

<ul>
<p><li>If a large percentage of clients use NetBIOS and you are using DNS, consider using WINS lookup on your DNS servers. If WINS lookup is enabled on the Microsoft DNS service, WINS is used for final resolution of any names that are not found using DNS resolution. The WINS forward lookup and WINS-R reverse lookup records are supported only by DNS. If you use servers on your network that do not support DNS, use DNS Manager to ensure that these WINS records are not propagated to DNS servers that do not support WINS lookup.</li></p>

<p><li>If you have a large percentage of computers running Windows 2000 on your network, consider creating a pure DNS environment. This involves developing a migration plan to upgrade older WINS clients to Windows 2000. Support issues involving network name service are simplified by using a single naming and resource locator service (such as WINS and DNS) on your network.</li></p>
</ul>



<A NAME="420"><H3>Windows DHCP Clients and DNS Dynamic Update Protocol</H3></A>

<p>In Windows 2000 Server, the DHCP Server service provides default support to register and update information for legacy DHCP clients in DNS zones. Legacy clients typically include other Microsoft TCP/IP client computers that were released prior to Windows 2000. The DNS/DHCP integration provided in Windows 2000 Server enables a DHCP client that is unable to dynamically update DNS RRs 
directly to have this information updated in DNS forward and reverse lookup zones by the DHCP server.</p>

<p><li><b>To allow dynamic updates for 
DHCP clients that do not support Dynamic DNS updates</b></li></p>

<ol>
<p><li>Click Start, point to Programs, point to Administrative Tools, then click DNS.</li></p>

<p><li>In the console tree, click the applicable zone.</li></p>

<p><li>On the Action menu, click Properties.</li></p>

<p><li>In the DNS Property tab, select Enable Updates For DNS Clients That Do Not Support Dynamic Update.</li></p>

<p><li>Select Only Secure Updates If Your Zone Type Is Active Directory-Integrated.</li></p>
</ol>

<p>DHCP clients running Windows 2000 and earlier versions of Windows interact differently when performing the DHCP/DNS interactions previously described. The following sections explain how this process varies in different cases.</p>

<p><b>DHCP/DNS Update Interaction for Windows 2000 DHCP Clients</b></p>

<p>Windows 2000 DHCP clients interact with DNS dynamic update protocol as follows:</p>

<ol>
<p><li>The client initiates a DHCP request message (DHCPREQUEST) to the server.</li></p>

<p><li>The server returns a DHCP acknowledgment message (DHCPACK) to the client, granting an IP address lease.</li></p>

<p><li>By default, the client sends a DNS update request to the DNS server for its own forward lookup record, a host (A) RR.</li></p>

<p>Alternately, the server can perform this update to the DNS server on behalf of the client if both the client and its configuration are modified accordingly.</p>

<p><li>The server sends updates for the DHCP client's reverse lookup record&#8212;a PTR RR&#8212;using the process defined by the DNS dynamic update protocol.</li></p>
</ol>

<p>This process is illustrated in Figure 10.8.</p>

<p>
<A HREF="javascript:fullSize('10ntk08x.htm')"> <img src="images/10ntk08.JPG" width=404 height=240 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 10.8</b> <i>A DHCP client interacting with the DNS dynamic update protocol</i><!-- /caption -->
</p>

<p><b>DHCP/DNS Update Interaction for DHCP Clients Prior to Windows 2000</b></p>

<p>Earlier versions of Windows DHCP clients do not support the DNS dynamic 
update process directly and therefore cannot directly interact with the DNS server. For these DHCP clients, updates are typically handled as follows:</p>

<ol>
<p><li>The client initiates a DHCP request message (DHCPREQUEST) to the server.</li></p>

<p><li>The server returns a DHCP acknowledgment message (DHCPACK) to the client, granting an IP address lease.</li></p>

<p><li>The server then sends updates to the DNS server for the client's forward lookup record, which is a host (A) RR.</li></p>

<p><li>The server also sends updates for the client's reverse lookup record, which is a PTR RR.</li></p>
</ol>

<p>This process is illustrated in Figure 10.9.</p>

<p>
<A HREF="javascript:fullSize('10ntk09x.htm')"> <img src="images/10ntk09.JPG" width=404 height=224 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 10.9</b> <i>DHCP/DNS interaction with older Windows clients</i><!-- /caption -->
</p>

<A NAME="421"><H2>Lesson Summary</H2></A>

<p>With Windows 2000, a DHCP server can enable dynamic updates in the DNS name space for any of its clients that support these updates. With dynamic update, the primary server for a zone can also be configured to support updates that are initiated by another computer or device that supports dynamic update. For example, it can receive updates from workstations registering A and PTR RRs, or from DHCP servers.</p>

</BODY>
</HTML>





