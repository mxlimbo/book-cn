<HTML>
<HEAD>
<TITLE>Lesson 4: Supporting Virtual Private Networks</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmnet.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<A HREF="ch11d.htm">[Previous]</A> <A HREF="ch11f.htm">[Next]</A><P>



<A NAME="494"><H1>Lesson 4: Supporting Virtual Private Networks</H1></A>

<p>A VPN is defined as the ability to send data between two computers across an internetwork in a manner that mimics the properties of a dedicated private 
network. In this lesson, you will learn about VPNs in a routed environment and with the Internet.</p>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Explain a VPN</li></p>

<p><li>Describe a VPN in a routed environment</li></p>

<p><li>Describe a VPN server with the Internet</li></p>
</ul>



<p><b>Estimated lesson time: 20 minutes</b></p>
</blockquote></div></p>

<A NAME="495"><H2>Implementing a VPN</H2></A>

<p>A VPN is defined as the ability to send data between two computers across an internetwork in a manner that mimics the properties of a dedicated private 
network (see Figure 11.15). VPNs allow users working at home or on the road 
to connect securely to a remote corporate server using the routing infrastructure provided by a public internetwork such as the Internet. From the user's perspective, the VPN is a point-to-point connection between the user's computer and a corporate server. The nature of the intermediate internetwork (hereafter referred to as the transit internetwork) is irrelevant because it appears as if the data is 
being sent over a dedicated private link.</p>


<p>
<A HREF="javascript:fullSize('11ntk15x.htm')"> <img src="images/11ntk15.JPG" width=404 height=277 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 11.15</b> <i>Virtual private network diagram</i><!-- /caption -->
</p>

<p>VPN technology also allows a corporation to connect with its branch offices or with other companies over a public internetwork (such as the Internet) while maintaining secure communications. The VPN connection across the Internet logically operates as a dedicated wide area network (WAN) link.</p>

<p>In both of these cases, the secure connection across the transit internetwork 
appears to the user as a virtual network interface providing private network 
communication over a public internetwork, hence the term virtual private network.</p>



<p>
<A HREF="javascript:fullSize('11ntk16x.htm')"> <img src="images/11ntk16.JPG" width=404 height=246 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 11.16</b> <i>A VPN tunnel</i><!-- /caption -->
</p>

<A NAME="496"><H3>Tunneling Basics</H3></A>

<p>Tunneling, also known as encapsulation, is a method of using an internetwork infrastructure to transfer a payload (see Figure 11.16). The payload may be the frames (or packets) of another protocol. Instead of sending the frame as produced by the originating node, the frame is encapsulated with an additional header. The additional header provides routing information so that the encapsulated payload can traverse the intermediate internetwork. The encapsulated packets are then routed between tunnel endpoints over the transit internetwork. Once the encapsulated frames reach their destination on the transit internetwork, the frame is 
de-encapsulated and forwarded to its final destination.</p>

<p>This entire process (the encapsulation and transmission of packets) is known as tunneling. The logical path through which the encapsulated packets travel through the transit internetwork is called a tunnel.</p>

<A NAME="497"><H3>Examples of Tunneling</H3></A>

<p>Tunneling can be achieved in one of the following ways:</p>

<ul>
<p><li><b>Point-to-Point Tunneling Protocol (PPTP).</b> PPTP allows IP, Internetwork Packet Exchange (IPX), or NetBIOS Enhanced User Interface (NetBEUI) traffic to be encrypted and then encapsulated in an IP header to be sent across a corporate IP internetwork or public internetworks like the Internet.</li></p>

<p><li><b>Layer Two Tunneling Protocol (L2TP).</b> L2TP allows IP traffic to be encrypted and then sent over any medium that supports point-to-point datagram delivery, such as IP, frame relay, or asynchronous transfer mode (ATM).</li></p>


<p><li><b>IP Security (IPSec) tunnel mode.</b> IPSec tunnel mode allows IP payloads to be encrypted and then encapsulated in an IP header to be sent across a corporate IP internetwork or public internetworks like the Internet.</li></p>

<p><li><b>IP-in-IP tunneling.</b> IP-in-IP tunneling encapsulates an existing IP datagram with an additional IP header. This allows a packet to traverse a network with disjointed capabilities or policies. A popular use of IP-in-IP tunneling is to forward multicast traffic through portions of the Internet that do not support multicast routing.</li></p>

</ul>



<A NAME="498"><H2>Integrating VPN in a Routed Environment</H2></A>

<p>In some corporate internetworks (see Figure 11.17), the data of a department (such as the Human Resources department) is so sensitive that the department's LAN is physically disconnected from the rest of the corporate internetwork. 
Although this protects the department's data, it creates information accessibility problems for those users not physically connected to the separate LAN.</p>


<p>
<A HREF="javascript:fullSize('11ntk17x.htm')"> <img src="images/11ntk17.JPG" width=404 height=95 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 11.17</b> <i>Corporate internetwork</i><!-- /caption -->
</p>

<p>VPNs allow the department's LAN to be physically connected to the corporate internetwork but separated by a VPN server. Note that the VPN server is not 
acting as a router between the corporate internetwork and the department LAN. Users on the corporate internetwork having the appropriate credentials (based on a need-to-know policy within the company) can establish a VPN with the VPN server and gain access to the protected resources of the department. Additionally, all communication across the VPN can be encrypted for data confidentiality. For those users not having proper credentials, the department LAN is essentially 
hidden from view.</p>

<A NAME="499"><H2>Integrating VPN Servers with the Internet</H2></A>

<p>Rather than having a remote user make a long distance call (or toll-free call) to a corporate or outsourced NAS, the user calls his or her local Internet service provider (ISP). Using the connection to the local ISP, a VPN is created between the dial-up user and the corporate VPN server across the Internet (see Figure 11.18).</p>


<p>
<A HREF="javascript:fullSize('11ntk18x.htm')"> <img src="images/11ntk18.JPG" width=404 height=154 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 11.18</b> <i>Remote Access over the Internet</i><!-- /caption -->
</p>

<p>To connect a network over the Internet (see Figure 11.19), you have two options:</p>

<ul>
<p><li><b>Branch office using dedicated lines.</b> Rather than using conventional methods such as frame relay, both the branch office and the corporate hub routers are connected to the Internet using a local dedicated circuit and local ISP. Utilizing the local ISP connections, a VPN is created between the branch office router and corporate hub router across the Internet.</li></p>

<p><li><b>Branch office using a dial-up line.</b> Rather than having a router at the branch office make a long distance call (or toll-free call) to a corporate or outsourced NAS, the router at the branch office calls its local ISP. From the connection to the local ISP, a VPN is created between the branch office router and the corporate hub router across the Internet.</li></p>
</ul>




<p>
<A HREF="javascript:fullSize('11ntk19x.htm')"> <img src="images/11ntk19.JPG" width=404 height=112 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 11.19</b> <i>VPN over the Internet</i><!-- /caption -->
</p>

<p><div class="note"><blockquote><b>NOTE</b><HR>In both cases, the users are not charged based on the distance between the offices because only local physical links are being used.</blockquote></div>
</p>

<p>For VPN connections to be reliably available, the corporate hub router acting as 
a VPN server must be connected to a local ISP using a dedicated line. The VPN server must be listening 24 hours a day for incoming VPN traffic. Although this is possible with a dial-up connection, it is less reliable because dynamically 
assigned IP addresses are commonly used and the connection may not be persistent.</p>

<p>
<img src="images/practic.JPG" width=90 height=72 border="0">
</p>

<A NAME="500"><H2>Practice: Creating VPN Interfaces</H2></A>

<p>In this procedure, you will create VPN interfaces on each router.</p>

<p><li><b>To create a router interface</b></li></p>

<ol>
<p><li>From the Routing and Remote Access Manager, right-click Routing Interfaces and choose New Demand-Dial Interface, then click Next.</li></p>

<p><li>Name the interface the name of the remote router you will be connecting to.</li></p>

<p><li>On the Connection Type page, select Connect Using Virtual Private Network (VPN), then click Next.</li></p>

<p><li>On the VPN Type page, select L2TP, then click Next.</li></p>

<p><li>Enter the IP address of the router you will be connecting to, then click Next.</li></p>

<p><li>On the Protocols And Security page, check Route IP Packet On This Interface, and Add A User Account So A Remote Router Can Dial In, then click Next.</li></p>


<p>The Dial-In Credentials dialog box appears. This is the user name the remote router will be dialing in with. The name is grayed because it is the name of the interface you are creating.</p>


<p><li>Click Next.</li></p>

<p><li>Enter the local router name in the Dial-Out Credentials dialog box. This is the user name this router will use when connecting to the remote router. This user name will match the name of a demand-dial interface on the remote router. Leave Domain and Password blank, then click Next.</li></p>

<p><li>Click Finish.</li></p>

<p><li> Repeat Steps 1 to 9 on the other router.</li></p>
</ol>

<p><div class="note"><blockquote><b>NOTE</b><HR>When creating a router-to-router tunnel over a public network, filters should be set on the external router interfaces to allow only the tunneled traffic.</blockquote></div>
</p>

<p><li><b>To exchange routes using Auto Static update</b></li></p>

<ol>
<p><li>From the Routing and Remote Access Manager, go to IP Routing, General.</li></p>

<p><li>Right-click the demand-dial interface and choose Update Routes.</li></p>

<p><li>Repeat Steps 1 and 2 on the other router.</li></p>
</ol>

<p><li><b>To see the routes received during the Auto Static update</b></li></p>

<ol>
<p><li>From the Routing and Remote Access Manager, go to IP Routing, Static Routes.</li></p>

</ol>

<p><li><b>To test the tunnel</b></li></p>

<ol>
<p><li>From Router 1, ping the IP address of Router 2.</li></p>

<p>The demand-dial tunnel should be initiated and the ping should succeed.</p>
</ol>

<A NAME="501"><H2>Lesson Summary</H2></A>

<p>A VPN is defined as the ability to send data between two computers across an internetwork in a manner that mimics the properties of a dedicated private network. In this lesson, you learned about VPNs in a routed environment and with the Internet.</p>

</BODY>
</HTML>





