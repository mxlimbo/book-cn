<HTML>
<HEAD>
<TITLE>Lesson 1: Preparing for an Unattended Installation of Windows 2000 Server</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmserver.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch03a.htm", "ch03c.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="118"><h1>Lesson 1: Preparing for an Unattended Installation of Windows 2000 Server</h1></A>
<p>When you perform an unattended installation of Windows 2000 Server, you create an answer file that supplies information to the setup routine. In addition, if you are going to install Windows 2000 Server on multiple computers over a network, you must create at least one set of distribution folders. This lesson describes the process of creating an answer file and setting up the distribution files necessary for a network installation.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Create a customized answer file for an unattended installation</li></p>

<p><li>Set up your distribution directory for a network installation of Windows 2000 Server</li></p>
</ul>

<b>Estimated lesson time: 45 minutes</b> 
</blockquote></div>
</p>

<A NAME="119"><h2>Creating the Answer File</h2></A>
<p>The answer file is a customized script (usually saved as a .txt file) that allows you to run an unattended installation of Windows 2000 Server. The file, sometimes called the unattend file or the unattend script file, answers the questions that Setup normally prompts you for during installation. The \i386 directory of the Windows 2000 Server installation CD-ROM contains a sample answer file, Unattend.txt, that you can edit and use in your unattended installation. You can leave the name of the answer file as is, or you can change it according to the needs of your organization. For example, Comp1.txt, Install.txt, and Setup.txt are all valid names for an answer file, as long as those names are correctly specified in the Setup command. Being able to use different names allows you to build and use multiple answer files if you need to maintain different scripted installations for different parts of your organization.</p>

<p>Note that other programs, such as the Sysprep tool, which is used to facilitate the creation of a disk image of your Windows 2000 Server installation, also use answer files. (Sysprep is discussed in detail in Lesson 2.) The following table describes how the answer file can be named and when it is used:</p>

<p><table cellpadding=5 width="95%"><tr>
<th>Filename</th><th>When the file is used</th>
</tr><tr>
<td valign="top"><i>&lt;filename&gt;</i>.txt</td> <td valign="top">When performing an unattended installation. You can use any name for the .txt file. Unattend.txt is the name of the sample answer file included with Windows 2000 Server.</td></tr><tr>
<td valign="top">Winnt.sif</td> <td valign="top">When installing Windows 2000 Server from a bootable CD-ROM drive.</td></tr><tr>
<td valign="top">Sysprep.inf</td> <td valign="top">When using the Sysprep tool to create a disk image of your Windows 2000 Server installation.</td></tr></table></p>


<p>The same format that is used in Unattend.txt is used for the files shown in the preceding table. The answer file contains multiple optional sections that you modify to supply information about your installation requirements. The file supplies Setup with answers to all the questions you are asked when you install Windows 2000 Server manually. In addition, the answer file tells Setup how to interact with the distribution folders and files that you have created. For example, in the [Unattended] section there is an original equipment manufacturer (OEM) Preinstall entry that tells Setup whether to copy the $OEM$ subfolders from the distribution folders to the target computer.</p>

<A NAME="120"><h3>Answer File Format</h3></A>
<p>An answer file consists of section headers, keys, and the values for each key. Most of the section headers are predefined, but some can be user defined. The following information is included in the Unattend.txt file. You can copy this file from the CD-ROM to writeable media, like a fixed disk, and then edit the file as necessary to meet the needs of your unattended installation. You can also rename the file.</p>

<p><table cellpadding=5 width="95%"><tr><td><pre> 
Microsoft Windows 2000 Professional, Server, Advanced Server and Datacenter
 (c) 1994 - 1999 Microsoft Corporation. All rights reserved.

Sample Unattended Setup Answer File

This file contains information about how to automate the 
installation
or upgrade of Windows 2000 Professional and Windows 2000 
Server so the
Setup program runs without requiring user input.


[Unattended]
Unattendmode = FullUnattended
OemPreinstall = NO
TargetPath = WINNT
Filesystem = LeaveAlone

[UserData]
FullName = &quot;Your User Name&quot;
OrgName = &quot;Your Organization Name&quot;
ComputerName = &quot;COMPUTER_NAME&quot;

[GuiUnattended]
Sets the Timezone to the Pacific Northwest
Sets the Admin Password to NULL
Turn AutoLogon ON and login once
TimeZone = &quot;004&quot;
AdminPassword = *
AutoLogon = Yes
AutoLogonCount = 1

For Server installs
[LicenseFilePrintData]
AutoMode = &quot;PerServer&quot;
AutoUsers = &quot;5&quot;

[GuiRunOnce]
List the programs that you want to launch when the machine is logged on to for the first time

[Display]
BitsPerPel = 8
XResolution = 800
YResolution = 600
VRefresh = 70

[Networking]
When set to YES, setup will install default networking components. The components to be set are
TCP/IP, File and Print Sharing, and the Client for Microsoft Networks. 
InstallDefaultComponents = YES

[Identification]
JoinWorkgroup = Workgroup
</pre></td></tr></table></p>

<p>You do not need to specify all the possible keys in an answer file if the installation does not require them. Invalid key values generate errors or can cause incorrect behavior after setup.</p>

<p>The answer file is broken into sections. A section name is enclosed in brackets, as in the following example:</p>

<p><table cellpadding=5 width="95%"><tr><td><pre>
[UserData]
</pre></td></tr></table></p>

<p>Sections contain keys and the corresponding values for those keys. Each key and value are separated by a space, an equal sign, and a space:</p>

<p><table cellpadding=5 width="95%"><tr><td><pre>
BitsPerPel = 8
</pre></td></tr></table></p>

<p>Values that have spaces in them require double quotes around them:</p>

<p><table cellpadding=5 width="95%"><tr><td><pre>
OrgName = &quot;Microsoft Corporation&quot;
</pre></td></tr></table></p>

<p>Some sections have no keys and merely contain a list of values:</p>

<table cellpadding=5 width="95%"><tr><td><pre>
[OEMBootFiles]
Txtsetup.oem
</pre></td></tr></table>

<p>Comment lines start with a semicolon:</p>

<p><table cellpadding=5 width="95%"><tr><td><pre>
;Setup program runs without requiring user input.
</pre></td></tr></table></p>

<p><b>Answer File Keys and Values</b></p>

<p>Every key in an answer file must have a value assigned to it; however, some keys are optional, and some keys have default values that are used if the key is omitted. Key values are strings of text, unless numeric is specified. If numeric is specified, the value is decimal unless otherwise noted.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Keys are not case sensitive; they can be uppercase or lowercase.</blockquote></div>
</p>

<p>The Unattend.doc file has detailed information about the answer file keys and values. You can find Unattend.doc in the Deploy.cab file on the Windows 2000 Server installation CD-ROM, under the \Support\Tools folder. To extract or view the contents of the Deploy.cab file, use Windows Explorer. For more details about opening the Unattend.doc file, see the Sreadme.doc file on the Windows 2000 Server installation CD-ROM.</p>

<p>
<div class="warning"><blockquote><b>IMPORTANT</b><hr>
Running Setup.exe or 2000rkst.msi from the \Support\Tools folder installs the Windows 2000 Support Tools in Support.cab, but it does not extract the Unattend.doc file or any of the other compressed files in Deploy.cab.</blockquote></div>
</p>

<A NAME="121"><h3>Methods for Creating an Answer File</h3></A>
<p>You can create an answer file by using Setup Manager or by creating the file manually.</p>

<p><b>Creating the Answer File by Using Setup Manager</b></p>

<p>To help you create or modify the answer file, an application called Setup Manager is available on the Windows 2000 Server installation CD-ROM in the Support\Tools\Deploy.cab file.</p>

<p>You can use Setup Manager to perform the following tasks:</p>

<ul>
<p><li>To specify the platform for the answer file (Windows 2000 Professional, Windows 2000 Server, Remote Operating System Installation, or Sysprep).</li></p>

<p><li>To specify the level of automation for unattended Setup mode (Provide Defaults, Fully Automated, Hide Pages, Read Only, and GUI mode attended Setup).</li></p>

<p><li>To specify default user name and organization information.</li></p>

<p><li>To define one computer name or many computer names to support multiple unattended installations.</li></p>

<p><li>To configure up to 99 automatic administrator logons to complete the setup process.</li></p>

<p><li>To configure display settings.</li></p>

<p><li>To configure network settings.</li></p>

<p><li>To configure joining a workgroup or domain and automatically add a computer account to the domain.</li></p>

<p><li>To create distribution folders.</li></p>

<p><li>To add a custom logo and background files.</li></p>

<p><li>To add files to the distribution folders.</li></p>

<p><li>To add commands to the <font face="courier new" size="-1">[GuiRunOnce]</font> section of the answer file.</li></p>

<p><li>To create Cmdlines.txt files.</li></p>

<p><li>To specify code pages and other language-specific settings.</li></p>

<p><li>To specify regional settings.</li></p>

<p><li>To specify a time zone.</li></p>

<p><li>To specify Telephony Application Programming Interface (TAPI) information.</li></p>


<p><li>To customize browser and shell settings.</li></p>

<p><li>To define the installation folder name. The boot partition (the partition containing the operating system files) is specified with the /t: or /tempdrive: switch.</li></p>


<p><li>To add printers.</li></p>

<p><li>To add mass storage device drivers and a custom HAL to be used during an unattended installation.</li></p>

<p><li>To create a distribution folder and share for the distribution or specify that the unattended installation will run from the Windows 2000 Server CD-ROM.</li></p>
</ul>

<p>With Setup Manager, you can add consistency to the process of creating or updating the answer file. However, you cannot use Setup Manager to specify all answer file settings, optional components, create Txtsetup.oem files, or create subfolders in the distribution folder.</p>

<p>After you use Setup Manager to create an answer file, add more settings by using a text editor. Refer to Unattend.doc and Readme.txt included in the Deploy.cab for a comprehensive list of available settings.</p>

<p>The following table describes the most commonly used Setup Manager specifications.</p>

<p><table cellpadding=5 width="95%"><tr>
<th>Parameter</th><th>Purpose</th>
</tr><tr>  
<td valign="top">Upgrade option</td> <td valign="top">Specifies whether to install Windows 2000 Professional or Windows 2000 Server.</td></tr><tr>
<td valign="top">Target computer name</td> <td valign="top">Specifies the user name, organization name, and computer names to apply to the target computers.</td></tr><tr>
<td valign="top">Product ID</td> <td valign="top">Specifies the product license number obtained from the product documentation.</td></tr><tr> 
<td valign="top">Workgroup or domain</td> <td valign="top">Specifies the name of the workgroup or domain to which the computer should be added.</td></tr><tr>
<td valign="top">Time zone</td> <td valign="top">Specifies the time zone for the computer.</td></tr><tr>
<td valign="top">Network configuration information</td> <td valign="top">Specifies the network adapter type and configuration information, including network protocols.</td></tr></table></p>

<p><b>Creating the Answer File Manually</b></p>

<p>To create the answer file manually, you can use a text editor such as Notepad. In general, an answer file consists of section headers, parameters, and values for those parameters. Although most of the section headers are predefined, you can also define additional section headers. Note that it is not necessary to specify all the possible parameters in the answer file if the installation does not require them.</p>

<p><A HREF="chaba.htm#890">Appendix B</a>, &quot;Sample Answer Files for Unattended Setup,&quot; includes sample answer files that are appropriate for common installation configurations. You can customize the default answer file (Unattend.txt) that comes with Windows 2000 or write a new one based on the samples provided in this appendix.</p>

<A NAME="122"><h2>Creating the Distribution Folders</h2></A>
<p>To install Windows 2000 Server on multiple computers over a network, you must create at least one set of distribution folders. The distribution folders typically reside on a server to which the destination computers can connect. This allows users to install Windows 2000 Server by running Winnt.exe or Winnt32.exe on those computers. You can use one set of distribution folders and multiple answer files for different system implementations. Even if you intend to use disk imaging as your installation method, starting with distribution folders will help to provide consistent implementations for a variety of system types. In addition, distribution folders allow you to update future images by editing the files in the distribution folders to generate updated images without having to start from the beginning.</p>

<p>To help load balance the servers and to make the file-copy phase of Windows 2000 Setup faster, you can create distribution folders on multiple servers to support the installation process on computers that are running Windows 95, Windows 98, Windows NT, or Windows 2000. You can run Winnt32.exe with up to eight sets of distribution folders. Each set of distribution folders contains the Windows 2000 Server installation files as well as any device drivers and other files needed for installation.</p>

<p>To create a distribution folder manually, connect to the network server on which you want to create the distribution folder, and create a \W2kdist folder on the network share. To help differentiate between multiple distribution shares for the different editions of Windows 2000 (Windows 2000 Professional, Windows 2000 Server, and Windows 2000 Advanced Server), choose different names for each folder. If you need localized language versions of Windows 2000 to meet requirements for international branches of your organization, you can create separate distribution shares for each localized version. For each edition of Windows 2000, copy the contents of the \i386 folder to the distribution share created for it. For instance, if you are preparing a distribution for Windows 2000 Server, create and share a folder named \W2kdists and copy the \i386 directory on the Windows 2000 Server installation CD-ROM to it.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The distribution share to support a default installation of Windows 2000 Server requires approximately 313 megabytes (MB) of disk space.</blockquote></div>
</p>

<p>You can also use Setup Manager to automatically create and share a distribution folder.</p>

<A NAME="123"><h3>Structuring the Distribution Folder</h3></A>
<p>This section provides detailed information about the folders and subfolders that make up the set of distribution folders. Figure 3.1 illustrates how these folders should be structured.</p>

<p>
<img src="images/f03xx01x.jpg" border=0 alt="">
</p><p>
<!--caption--><b>Figure 3.1</b> <i>Example of a structure for the distribution folders</i><!--/caption-->
</p>

<p><b>\i386 (On Windows 2000 Installation CD-ROM Copied to Distribution Share)</b></p>

<p>This is the primary distribution folder. It contains all the files required to install Windows 2000 Server. You copy the contents of this folder from the Windows 2000 Server installation CD-ROM to the root of the distribution share.</p>

<p><b>\$OEM$ (On Distribution Share and Copied to $WIN_NT$.~LS)</b></p>

<p>The \$OEM$ subfolder is located directly beneath the primary distribution folder. During Setup you can automatically copy directories, standard Microsoft format 8.3 files, and any tools needed for your automated installation process to \$OEM$. Note that if you use the OEMFILESPATH key in the answer file, you can create the \$OEM$ subfolder outside of the distribution folder.</p>

<p>\$OEM$ provides the necessary folder structure for supplemental files to be copied to the target computer during Setup. These files include drivers, utilities, applications, and any other files required to deploy Windows 2000  Server within your organization.</p>

<p>\$OEM$ can contain the optional file Cmdlines.txt, which contains a list of commands to be run during the GUI mode phase of Setup. These commands can be used to install optional components, such as tools and utilities. Commands contained in Cmdlines.txt are run before the computer is logged on to the network.</p>

<p>As long as Setup finds \$OEM$ in the root of the distribution point, it will copy all the files found in this directory to the $WIN_NT$.~LS temporary directory created during the Text mode phase of Setup. During Setup, subfolders of \$OEM$ are copied to the corresponding location on the target computer. At Setup completion, $OEM$ and all subfolders are deleted along with $WIN_NT$.~LS.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
All folders described next are located on the distribution share below \$OEM$ and are copied to various locations on the computer running Setup.</blockquote></div>
</p>

<p><b>\$OEM$\textmode (Copied to $WIN_NT$.~BT)</b></p>

<p>The \$OEM$\textmode subfolder contains new or updated files for installing mass storage device drivers and HALs. These files can include oem HALs, drivers for SCSI devices, and the Txtsetup.oem file, which directs the loading and installing of these components.</p>

<p>All files placed in the \$OEM$\textmode subfolder (HALs and drivers) must be listed in the <font face="courier new" size="-1">[OEMBootFiles]</font> section of the answer file.</p>

<p><b>\$OEM$\$$ (Copied to %windir% and Subfolders of %windir%)</b></p>

<p>The \$OEM$\$$ subfolder corresponds to the contents of the %windir% environment variable. The subfolder contains the operating system files (either new files or replacements for retail files) that are copied to the various subfolders when Windows 2000 is installed. The structure of this subfolder must match the structure of a standard Windows 2000 installation, where \$OEM$\$$ matches %windir%, \$OEM$\$$\System32 matches %windir%\System32, and so on. Each subfolder needs to contain the files that will be copied to the corresponding operating system folder on the target computer.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
In Windows 2000, %systemroot% is equivalent to %windir%.</blockquote></div>
</p>

<p><b>\$OEM$\$1 (Copied to $systemdrive$)</b></p>

<p>The \$OEM$\$1 subfolder, which is new for Windows 2000, points to the drive on which Windows 2000 is installed. $1 is equivalent to the %systemdrive% environment variable. For example, if you are installing Windows 2000 on the D: drive, \$OEM$\$1 points to the D: drive. This makes it possible to install Windows 2000 to drives other than the C: drive.</p>

<p><b>\$OEM$\$1\Drivers (Copied to $systemdrive$\Drivers and Subfolders of $systemdrive$\Drivers) </b></p>

<p>The \$OEM$\$1\Drivers subfolder, which is new for Windows 2000, allows you to place new or updated Plug and Play device drivers and their supporting files (catalog files and .INF installation files) in and below the Drivers subfolder. These folders and their contents are copied to the %systemdrive%\Drivers folder on the target computer. Adding the OemPnPDriversPath parameter to your answer file will tell Windows 2000 where to look for the new or updated Plug and Play drivers. When searching for appropriate Plug and Play device drivers to install during Setup or afterward, Windows 2000 looks at the files in the folders you created as well as those originally included with the system. Note that you can replace Drivers with a name of your own choosing that follows the 8.3 MS-DOS naming convention.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The \$OEM$\$1\Drivers subfolder replaces the \Display and \Net subfolders used in Windows NT installation.</blockquote></div>
</p>

<p><b>\$OEM$\$1\Sysprep (Copied to %systemdrive%\Sysprep)</b></p>

<p>The \$OEM$\$1\Sysprep subfolder contains the files needed to run the Sysprep utility. Sysprep.exe and Sysprepcl.exe must be in %systemdrive%\Sysprep folder for Sysprep to function properly.</p>

<p>
<div class="tip"><blockquote><b>TIP</b><hr>
Add Sysprep.inf (created by Setup Manager or written manually) to the \$OEM$\$1\Sysprep directory on the distribution share. Otherwise, a floppy disk containing the Sysprep.inf file is necessary to complete a Sysprep setup.</blockquote></div>
</p>

<p><b>\$OEM$\<i>drive_letter</i></b></p>

<p>During Text mode, the structure of each \$OEM$\<i>drive_letter</i> subfolder is copied to the root of the corresponding drive in the target computer. For example, files that you place in the \$OEM$\D subfolder are copied to the root of the D: drive. You can also create subfolders within these subfolders. For example, \$OEM$\E\Misc causes Setup to create a \Misc subfolder on the E: drive.</p>

<p>Files that have to be renamed must be listed in the $$Rename.txt file. Note that the files in the distribution folders must have short file names (format 8.3).</p>

<p>
<img src="images/practic.JPG" border="0"></p>

<A NAME="124"><h3>Exercise 1: Preparing and Running an Automated Installation</h3></A>
<p>In this exercise, you create and run an automated installation of Windows 2000 Server on Computer 2. To prepare for the automated installation, you use the Windows 2000 Server Setup Manager to create an answer file and a distribution share on Server01.</p>

<p>
<div class="warning"><blockquote><b>WARNING</b> <hr>
Do not customize the desktop or any of the Windows 2000 applications on Server01. If you do, the steps in this exercise may not work. For example, this exercise is designed for the double-click behavior of the default desktop.</blockquote></div>
</p>

<p><li><b>Procedure 1: Running Setup Manager</b></li></p>


<p>Complete this procedure on a Server01 with the Windows 2000 Server installation CD-ROM inserted.</p>

<ol>
<p><li>Create a folder named Deploy underneath C:\Program Files.</li></p>

<p><li>Using Windows Explorer, locate the \Support\Tools folder on the windows 2000 server installation cd-rom.</li></p>


<p><li>Select the TOOLS folder in the Folders pane and then double-click the DEPLOY file in the right pane.</li></p>

<p>The contents of the DEPLOY cab file appears.</p>

<p><li>From the Edit menu, choose Select All.</li></p>

<p><li>From the File menu, choose Extract.</li></p>

<p>A Browse For Folder window appears.</p>

<p><li>Click on the + sign to the left of Local Disk (C:) to expand the C: drive.</li></p>

<p><li>Click on the + sign to the left of Program Files to expand the Program Files folder.</li></p>

<p><li>Click on the Deploy folder.</li></p>

<p>The Deploy folder opens.</p>

<p><li>Click OK.</li></p>

<p>A Copying message box appears momentarily as the files in the DEPLOY cab file are extracted to C:\Program Files\Deploy.</p>

<p><li>From the C:\Program Files\Deploy folder, double-click setupmgr.</li></p>

<p>Setup Manager starts, and the Windows 2000 Setup Manager Wizard appears.</p>

<p><li>Read the descriptive text, and then click Next.</li></p>

<p>The New Or Existing Answer File screen appears, and the Create A New Answer File radio button is selected.</p>

<p><li>Click Next.</li></p>

<p>The Product To Install screen appears, and the Windows 2000 Unattended Installation radio button is selected.</p>

<p><li>Click Next.</li></p>

<p>The Platform screen appears, and the Windows 2000 Professional radio button is selected.</p>

<p><li>Select the Windows 2000 Server radio button, and click Next.</li></p>

<p>The User Interaction Level screen appears, and the Provide Defaults radio button is selected.</p>

<p><li>Select the Fully Automated radio button, read the Description text, and then click Next.</li></p>

<p>The License Agreement screen appears.</p>

<p><li>Read the text on this screen, select the I Accept The Terms Of The License Agreement check box, and then click Next.</li></p>

<p>The Customize The Software screen appears.</p>

<p><li>In the Name text box, type your name and press the Tab key.</li></p>

<p><li>In the Organization text box, type your organization name or <b>MSPress Self-Study</b> and click Next.</li></p>

<p>The Licensing Mode screen appears, and the Per Server radio button is selected.</p>

<p><li>Select the Per Seat radio button, and click Next.</li></p>

<p>The Computer Names screen appears.</p>



<p><li>Insert the Windows 2000 Training Supplemental CD-ROM into Server01, and click Import.</li></p>

<p>The Open window appears.</p>
<p><img src="images/cd.JPG" border="0"></p>
<p><li>In the File Name drop-down list box, type <b><i>&lt;CD-ROM_drive</i>:<i>&gt;</i>\chapt03\ ex1\computer names.txt</b> and then click open.</li></p>


<p>The Computer Names screen appears showing a list of computers to be installed.</p>

<p><li>Click Next.</li></p>

<p>The Administrator Password screen appears.</p>

<p><li>In the password text boxes, type <b>password</b>, and select the check box named When The Computer Starts, Automatically Log On As Administrator.</li></p>

<p>The Number of times to Auto Logon is set to 1.</p>

<p><li>Click Next.</li></p>

<p>The Display Settings screen appears.</p>

<p><li>Leave all text box values set to Use Windows Default, and click Next.</li></p>

<p>The Network Settings screen appears, and the Typical Settings radio button is selected.</p>

<p><li>Click Next.</li></p>

<p>The Workgroup or Domain screen appears and the Workgroup radio button is selected.</p>

<p>Server01 is currently configured as a member of a workgroup named WORKGROUP. Therefore, do not change the values appearing on the Workgroup or Domain screen. When the automated installation is run on Computer 2, it will become a member of the same workgroup. Later in your training, Server01 will become a domain controller and the computer you are preparing an answer file for will join that domain.</p>
</ol>
<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The answer file you are preparing now can be modified later to automatically join a domain and create computer accounts in the domain. These modifications are made by using either Setup Manager or a text editor.</blockquote></div>
</p>

<ol>
<p><li value="27">Click Next.</li></p>

<p>The Time Zone screen appears.</p>

<p><li>From the Time Zone drop-down list box, select your time zone and click next.</li></p>


<p>The Additional Settings screen appears, and the Yes, Edit The Additional Settings radio button is selected.</p>

<p><li>Click Next.</li></p>

<p>The Telephony screen appears.</p>

<p><li>You may enter your country/region, area code or city code, and any other settings you require to dial out. If Computer 2 does not have dial-out access, you can ignore this screen and continue.</li></p>

<p><li>Click Next.</li></p>

<p>The Regional Settings screen appears, and the Use The Default Regional Settings For The Windows Version You Are Installing radio button is selected.</p>

<p><li>Click Next.</li></p>

<p>The Languages screen appears.</p>

<p><li>Select any additional language support you want to have available for the operation of Windows 2000 Server, and then click Next.</li></p>

<p>The Browser and Shell Settings screen appears, and the Use Default Internet Explorer Settings radio button is selected.</p>

<p><li>Click Next.</li></p>

<p>The Installation Folder screen appears, and the A Folder Named Winnt radio button is selected.</p>

<p><li>Click Next.</li></p>

<p>The Install Printers screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Run Once screen appears.</p>

<p><li>In the Command To Run text box, type <b>Notepad.exe</b> and click Add.</li></p>

<p>Typically, the Command To Run text box would contain a script or other executable program to further configure the user's environment. For the purpose of training, running Notepad is sufficient. Notice that if you added a printer on the previous screen, the AddPrinter command runs to add your printer to the list of installed printers.</p>

<p><li>Click Next.</li></p>

<p>The Distribution Folder screen appears.</p>

<p><li>Select the Yes, Create Or Modify A Distribution Folder radio button, and click Next.</li></p>

<p>The Distribution Folder Name screen appears, and the Create A New</p>

<p>Distribution Folder radio button is selected.</p>

<p>The Distribution folder text box contains C:\win2000dist, and the Share As Text box contains win2000dist.</p>

<p><li>Click Next.</li></p>

<p>The Additional Mass Storage Drivers screen appears.</p>

<p><li>Read the screen, and click Next.</li></p>

<p>The Hardware Abstraction Layer screen appears.</p>

<p><li>Read the screen, and click Next.</li></p>

<p>The Additional Commands screen appears.</p>

<p><li>Read the screen, and click Next.</li></p>

<p>Commands entered here are written to Cmdlines.txt. This file is created under the distribution folder in the $OEM$ subfolder.</p>

<p>The OEM Branding screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Additional Files Or Folders screen appears.</p>

<p><li>Browse the folders by clicking on them and reading the information that appears under Description.</li></p>

<p>Click Next.</p>

<p>The Answer File Name screen appears showing a path and file name located on the CD-ROM in the Location And File Name text box.</p>

<p><li>Verify that the path and file name to <b>C:\Win2000dist\Unattend.txt</b>, and click next.</li></p>


<p>The Location Of Setup Files screen appears, and the Copy The Files From CD radio button is selected.</p>

<p><li>Remove the Windows 2000 Server Training Supplemental CD-ROM, and insert the Windows 2000 Server installation CD-ROM.</li></p>

<p>After the Windows 2000 Server installation CD-ROM is read, the Microsoft Windows 2000 CD screen appears.</p>

<p><li>Close the Microsoft Windows 2000 CD screen.</li></p>

<p><li>Click Next on the Location Of Setup Files screen.</li></p>

<p>The Copying Files screen appears as the files are copied from the \i386 directory on the installation CD-ROM to C:\Win2000Dist.</p>

<p><li>Allow the file copy to complete before continuing to the next procedure.</li></p>

<p>At the completion of Setup Manager's tasks, a Completing The Windows 2000 Setup Manager Wizard screen appears.</p>

<p><li>Read the screen, and then click Finish.</li></p>
</ol>

<p><li><b>Procedure 2: Inspecting the distribution folder created by Setup Manager</b></li></p>


<p>In this procedure you will inspect the folder structure created by Setup Manager, answer file (Unattend.txt), UDF file (Unattend.udf), and batch file (Unattend.bat).</p>

<ol>
<p><li>Click Start and then Run.</li></p>

<p>The Run dialog box appears.</p>

<p><li>In the Open text box, type <b>C:\Win2000dist</b> and click OK.</li></p>

<p>The Win2000dist window appears.</p>

<p><li>Open another window to the following directory on the Windows 2000 installation CD-ROM: &lt;<i>cd-rom drive</i>:<i>&gt;</i>\i386.</li></p>

<p>The i386 window appears.</p>

<p><li>Arrange the windows so that you can see both the win2000dist window and the i386 window.</li></p>

<p><li>What folder appears directly under the Win2000dist folder that does not appear in the i386 folder?</li></p>
<p><a href="chaaa.htm#866">Answer</a></p>
<p><li>Examine the directory structure below $oem$, and review Figure 3.1 in the text. You will be asked a question about this structure in the &quot;<A HREF="ch03e.htm#141">Review</A>&quot; section of this chapter.</li></p>

<p><li>Return to the Win2000dist folder, and locate the three Unattend files.</li></p>

<p>Notice that two of the Unattend files do not appear with extensions.</p>

<p><li>To show file extensions for all files, select Tools and choose Folder Options.</li></p>

<p>The Folder Options dialog box appears.</p>

<p><li>Click the View tab.</li></p>

<p><li>From the Advanced Settings box, clear the Hide File Extensions For Known File Types check box, and click OK.</li></p>

<p><li>Locate the Unattend files again.</li></p>

<p>The Unattend files appear with their file extensions showing. </p>

<p>Select Unattend.txt, and from the File menu, choose Open.</p>

<p>Unattend.txt appears in Notepad.</p>

<p><li>Locate the [User Data] section and add an additional line named ProductID+&lt;<i>your_product_key</i>&gt;. For the value of ProductID, type the Product Key provided with your copy of Windows 2000 Server.</li></p>

<p><li>Save and close Unattend.txt.</li></p>

<p><li>For an explanation of any sections in this file, refer to Unattend.doc located in the C:\Program Files\Deploy folder you created at the start of this exercise. Unattend.doc can be opened in Microsoft Wordpad, Microsoft Word, or any word processor capable of reading Microsoft Word files.</li></p>

<p><li>Close Unattend.doc.</li></p>

<p><li>From the Win2000dist window, select Unattend.udf; and from the File menu choose Open With.</li></p>

<p>The Open With dialog box appears.</p>

<p><li>Select Notepad from the Choose The Program You Want To Use box, and click OK.</li></p>

<p>Notice that the 12 computer names imported during the operation of Setup Manager appear here.</p>

<p><li>What is the purpose of the UDF file?</li></p>
<p><a href="chaaa.htm#866">Answer</a></p>
<p><li>Close the UDF file.</li></p>

<p><li>From the Win2000dist window, select Unattend.bat; and from the File menu, choose Edit.</li></p>

<p>The contents of the batch file appear in Notepad.</p>

<p><li>Notice that the batch file sets variables, and then the variables are used to run Winnt32 with switches. Notice also that you must specify the computer name when calling the batch file since a UDF file is involved in the setup routine.</li></p>

<p><li>Close the Unattend.bat window.</li></p>
</ol>


<p><li><b>Procedure 3: Running an unattended setup of Windows 2000 Server from Computer 2</b></li></p>


<p>Computer 2 must already be running a Windows 32-bit operating system, such as Windows 95 or Windows NT. In addition, Server01 must be connected to the same network as Computer 2. All requirements for the exercises are outlined in About This Book.</p>

<p>
<div class="caution"><blockquote><b>CAUTION</b><hr>
If Computer 2 is running Windows NT, the boot partition is C:\ and the operating system directory is Winnt, change the name of the installation directory in Unattend.txt. The directory name listed in Unattend.txt is found under the Unattended section, and the valuename is TargetPath. For example, change the value so that TargetPath=\WIN2000S.</blockquote></div>
</p>

<ol>
<p><li>From Computer 2, connect a drive letter (H: will be used throughout this exercise), to \\Server01\WIN2000dist. You can connect to Server01 by using the Administrator username and the password of &quot;password.&quot;</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
If you are running Windows 9<i>x</i> and are having trouble connecting to Server01, make sure the computer is a member of WORKGROUP and logon as Administrator with a password of &quot;password.&quot;</blockquote></div>
</p>

<ol>
<p><li value="2">Open a command prompt and type <b>cdh:</b> .</li></p>
</ol>

<p>
<div class="caution"><blockquote><b>CAUTION</b><hr>
If you have upgraded from Windows 9<i>x</i>, you might find that Setup can't find the .udf file. If this happens, open Unattend.txt on Server01 and specify the full path to the .udf file.</blockquote></div>
</p>

<ol>
<p><li value="3">From the command prompt, type <b>H:\Unattend</b> <b>Server02</b> .</li></p>

<p><li>The Copying Installation Files screen appears as Windows 2000 Server runs an automated installation over the network.</li></p>

<p>At the conclusion of this phase, a warning screen will inform you that the computer will be restarted.</p>
</ol>
<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
This pre-text mode phase of Setup can be completed using the \syspart switch with Winnt32.exe.</blockquote></div>
</p>

<ol>
<p><li value="5">Allow the computer to restart.</li></p>

<p>Upon reboot, the Windows 2000 boot menu appears and Microsoft Windows 2000 Server setup continues to Text mode.</p>

<p>The computer reboots again, and the boot menu appears showing Windows 2000 Server.</p>

<p>Windows 2000 installation continues the graphical portion of setup. The Installing Devices And Installing Components screens take time to complete. The Performing Final Tasks screen appears where Windows 2000 Server completes the setup routine. When setup is completed, the Windows 2000 Setup screen announces that the computer will restart.</p>

<p><li>After the computer restarts, notice that it automatically logs on as Administrator as specified in Setup Manager. In this stage, the printer is installed and Notepad.exe runs.</li></p>

<p><li>Close Notepad.</li></p>

<p>The Windows 2000 Configure Your Server screen appears.</p>

<p><li>Select the I Will Configure This Server Later radio button, and click Next.</li></p>

<p>The Configure Your Server screen appears.</p>

<p><li>Clear the Show This Screen At Startup check box, and close the screen.</li></p>
</ol>

<p>
<div class="caution"><blockquote><b>CAUTION</b><hr>
If you are upgrading from Windows 9x, check to see if your partition is NTFS. If not, you will need to convert it. You can do this by typing convert c: /fs:ntfs at the command prompt.</blockquote></div>
</p>

<A NAME="125"><h2>Lesson Summary</h2></A>
<p>Before you can perform an unattended installation of Windows 2000 Server, you must create an answer file, which is a customized script file that contains multiple optional sections that you modify to supply information about your installation requirements. The file supplies Setup with answers to all the questions you are asked when you install Windows 2000 Server manually. In addition, the answer file tells Setup how to interact with the distribution folders and files that you have created. You must create at least one set of distribution folders to install Windows 2000 Server over a network. Using Setup Manager can create a distribution folder and an answer file manually or automatically. To further customize the answer file, refer to the Unattend.doc file located on the Windows 2000 Server installation CD-ROM.</p>

</BODY>
</HTML>



