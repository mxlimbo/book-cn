<HTML>
<HEAD>
<TITLE>Lesson 5: Domain Name System</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmserver.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch09e.htm", "ch09g.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="483"><h1>Lesson 5: Domain Name System</h1></A>
<p>DNS is a distributed database used in TCP/IP networks to translate computer names (host names) to IP addresses. This lesson introduces you to DNS and name resolution. It also discusses the skills necessary and provides information to install and configure the DNS service.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Explain the function of DNS and its components, and explain the name resolution process</li></p>

<p><li>Install and configure the DNS service, including Dynamic DNS and the DHCP Service for DNS</li></p>

<p><li>Configure a DNS client</li></p>

<p><li>Troubleshoot the DNS service</li></p>
</ul>

<b>Estimated lesson time: 90 minutes</b> 
</blockquote></div>
</p>

<A NAME="484"><h2>Introduction to DNS</h2></A>
<p>DNS is most commonly associated with the Internet. However, private networks use DNS extensively to resolve computer host names and to locate computers within their local networks and the Internet. DNS name resolution is different than the name resolution provided by WINS. WINS resolves NetBIOS names to IP addresses, while DNS resolves IP host names to IP addresses. IP host names resolved using DNS or other means, provide the following benefits:</p>

<ul>
<p><li>IP host names are user-friendly, which means they are easier to remember than IP addresses.</li></p>

<p><li>IP host names remain more constant than IP addresses. An IP address for a server can change, but the server name remains the same.</li></p>

<p><li>IP host names allow users to connect to local servers by using the same naming convention as the Internet.</li></p>
</ul>

<p><img src="images/cd.JPG" border="0"></p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information on DNS, see RFC 1034 and RFC 1035. Use your Web browser to search for &quot;RFC 1034&quot; and &quot;RFC 1035.&quot; You can also find information about DNS and DNS implementation on the Supplemental Course Materials CD (\chapt09\articles\w2kDNS.doc) that accompanies this book.</blockquote></div>
</p>

<A NAME="485"><h3>Domain Namespace</h3></A>
<p>Domain namespace is the naming scheme that provides the hierarchical structure for the DNS database. Each node represents a partition of the DNS database. These nodes are referred to as domains.</p>

<p>The DNS database is indexed by name; therefore, each domain must have a name. As you add domains to the hierarchy, the name of the parent domain is appended to its child domain (called a subdomain). Consequently, a domain's name identifies its position in the hierarchy. For example, in Figure 9.10 the domain name sales.microsoft.com identifies the sales domain as a subdomain of the microsoft domain and microsoft as a subdomain of the com domain.</p>

<p>
<A HREF="javascript:fullSize('f09xx10gx.htm')"> <img src="images/f09xx10g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 9.10</b> <i>Hierarchical structure of a domain namespace</i><!--/caption-->
</p>

<p>As Figure 9.10 illustrates, the hierarchical structure of the domain namespace consists of a root domain, top-level domains, second-level domains, and host names.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The term domain, in the context of DNS, has a slightly different meaning than it does when used in the Microsoft Windows 2000 directory services. A Windows 2000 domain is a grouping of computers and devices that are administered as a unit. In DNS, a domain is a node that represents a partition in the DNS database.</blockquote></div>
</p>

<p><b>Root Domain</b></p>

<p>The root domain is at the top of the hierarchy and is represented as a period (.). The Internet root domain is managed by several organizations, including Network Solutions, Inc.</p>

<p><b>Top-Level Domains</b></p>

<p>Top-level domains are two-character or three-character name codes. Top-level domains are categorized by organization type or geographic location. Thefollowing table provides some examples of top-level domain names.</p>

<p><table cellpadding=5 width="95%"><tr>
<th>Top-level domain</th><th>Description</th>
</tr><tr>
<td valign="top">gov</td> <td valign="top">Government organizations</td></tr><tr>
<td valign="top">com</td> <td valign="top">Commercial organizations</td></tr><tr>
<td valign="top">edu</td> <td valign="top">Educational institutions</td></tr><tr>
<td valign="top">org</td> <td valign="top">Noncommercial organizations</td></tr><tr>
<td valign="top">au</td> <td valign="top">Country code of Australia</td></tr></table></p>

<p>Top-level domains can contain second-level domains and host names.</p>

<p><b>Second-Level Domains</b></p>

<p>Organizations such as Network Solutions, Inc. assign and register second-level domains to individuals and organizations for the Internet. A second-level domain can contain both hosts and subdomains. For example, microsoft.com can contain computers such as ftp.microsoft.com and subdomains such as dev.microsoft.com. The subdomain dev.microsoft.com can contain hosts such as printerserver1.dev.microsoft.com.</p>

<A NAME="486"><h3>Host Names</h3></A>
<p>Host names refer to specific computers on the Internet or a private network. For example, in Figure 9.10, Computer1 is a host name. A host name is the leftmost portion of a fully qualified domain name (FQDN), which describes the exact position of a host within the domain hierarchy. In Figure 9.10, Computer1.sales.microsoft.com. (including the end period, which represents the root domain) is an FQDN.</p>

<p>DNS uses a host's FQDN to resolve a name to an IP address.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The host name does not have to be the same as the computer name. By default, TCP/IP Setup uses the computer name for the host name, replacing illegal characters, such as the underscore (_), with a hyphen (-). For accepted domain naming conventions, see RFC 1035.</blockquote></div>
</p>

<A NAME="487"><h3>Domain Naming Guidelines</h3></A>
<p>When you create a domain namespace, consider the following domain guidelines and standard naming conventions:</p>

<ul>
<p><li>Limit the number of domain levels. Typically, DNS host entries should be three or four levels down the DNS hierarchy and no more than five levels down the hierarchy. As the number of levels increases, so do the administrative tasks.</li></p>

<p><li>Use unique names. Each subdomain must have a unique name within its parent domain to ensure that the name is unique throughout the DNS namespace.</li></p>

<p><li>Use simple names. Simple and precise domain names are easier for users to remember and enable users to search intuitively and locate Web sites or other computers on the Internet or an intranet.</li></p>

<p><li>Avoid lengthy domain names. Domain names can be up to 63 characters, including the periods. The total length of an FQDN cannot exceed 255 characters. Case-sensitive naming is not supported.</li></p>

<p><li>Use standard DNS characters and Unicode characters:</li></p>
<ul>
<p><li>Windows 2000 supports the following standard DNS characters: A through Z, a through z, 0 through 9, and the hyphen (-), as defined in RFC 1035.</li></p>

<p><li>The DNS Service also supports the Unicode character set. The Unicode character set, which includes additional characters not found in the American Standard Code for Information Exchange (ASCII) character set, is required for languages such as French, German, and Spanish.</li></p>
</ul>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Use Unicode characters only if all servers running the DNS service in your environment support Unicode. For more information on the Unicode character set, read RFC 2044 by searching for &quot;RFC 2044&quot; with your Web browser.</blockquote></div>
</p>

<A NAME="488"><h3>Zones</h3></A>
<p>A zone represents a discrete portion of the domain namespace. Zones provide a way to partition the domain namespace into manageable sections.</p>

<p>Multiple zones in a domain namespace are used to distribute administrative tasks to different groups. For example, Figure 9.11 depicts the microsoft.com domain namespace divided into two zones. The two zones allow one administrator to manage the microsoft and sales domains and another administrator to manage the development domain.</p>

<p>
<A HREF="javascript:fullSize('f09xx11gx.htm')"> <img src="images/f09xx11g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 9.11</b> <i>Domain namespace divided into zones</i><!--/caption-->
</p>

<p>A zone must encompass a contiguous domain namespace. For example, as Figure 9.11 shows, you can create a zone for sales.microsoft.com and the parent domain microsoft.com because these zones are contiguous. However, you cannot create a zone that consists of only the sales.microsoft.com domain and the development.microsoft.com domain because these two domains are not contiguous.</p>

<p>The name-to-IP-address mappings for a zone are stored in the zone database file. Each zone is anchored to a specific domain, referred to as the zone's root domain. The zone database file does not necessarily contain information for all subdomains of the zone's root domain, only those subdomains within the zone.</p>

<p>In Figure 9.11, the root domain for Zone1 is microsoft, and its zone file contains the name-to-IP-address mappings for the microsoft and sales domains. The root domain for Zone2 is development, and its zone file contains the name-to-IP-address mappings for the development domain only. The zone file for Zone1 does not contain the name-to-IP address mappings for the development domain, although development is a subdomain of the microsoft domain.</p>

<A NAME="489"><h3>Name Servers</h3></A>
<p>A DNS name server stores the zone database file. Name servers can store data for one zone or multiple zones. A name server is said to have authority for the domain namespace that the zone encompasses.</p>

<p>There must be at least one name server for a zone. However, a zone can have multiple name servers associated with it. One of these servers contains the master zone database file, which is also referred to as the primary zone database file, for that zone. Changes to a zone, such as adding domains or hosts, are performed on the server that contains the primary zone database file. Any other name servers associated with the zone act as a backup to the name server containing the primary zone database file. These name servers contain a secondary zone database file.</p>

<p>Multiple name servers provide several advantages:</p>

<ul>
<p><li><b>Performing zone transfers</b> The additional name servers obtain a copy of the zone database file from the name server that contains the primary database zone file. This is called a zone transfer. These name servers periodically query the name server containing the primary zone database file for updated zone data.</li></p>

<p><li><b>Providing redundancy</b> If the name server containing the primary zone database file fails, the additional name servers can provide service.</li></p>

<p><li><b>Improving access speed for remote locations</b> If a number of clients are in remote locations, use additional name servers to reduce query traffic across slow WAN links.</li></p>

<p><li><b>Reducing loads</b> The additional name servers reduce the load on the name server containing the primary zone database file. Windows 2000 also supports directory-integrated zone storage by using the Active Directory database. Zones stored this way are located in the Active Directory tree under the domain object container. Each directory-integrated zone is stored in a DNS zone container object identified by the name you choose for the zone when you create it.</li></p>
</ul>

<A NAME="490"><h2>Overview of the Name Resolution Process</h2></A>
<p>Name resolution is the process of resolving names to IP addresses. Name resolution is similar to looking up a name in a telephone book, where the name is associated with a telephone number. For example, when you connect to the Microsoft Web site, you use the name www.microsoft.com. DNS resolves www.microsoft.com to its associated IP address. The mapping of names to IP addresses is stored in the DNS distributed database.</p>

<p>DNS name servers resolve forward and reverse lookup queries. A forward lookup query resolves a name to an IP address. A reverse lookup query resolves an IP address to a name. A name server can resolve a query only for a zone for which it has authority. If a name server cannot resolve the query, it passes the query to other name servers that can resolve the query. The name server caches the query results to reduce the DNS traffic on the network.</p>

<A NAME="491"><h3>Forward Lookup Query</h3></A>
<p>The DNS Service uses a client/server model for name resolution. To resolve a forward lookup query, a client passes a query to a local name server. The local name server either resolves the query or queries another name server for resolution.</p>

<p>Figure 9.12 illustrates the process of a client querying a name server for an IP address of www.microsoft.com. The numbers in the figures are described in the steps that follow the diagram.</p>

<p>
<A HREF="javascript:fullSize('f09xx12gx.htm')"> <img src="images/f09xx12g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 9.12</b> <i>Resolving a forward lookup query</i><!--/caption-->
</p>

<ol>
<p><li>The client passes a forward lookup query for www.microsoft.com to its local name server.</li></p>

<p><li>The local name server checks its zone database file to determine whether it contains the name-to-IP address-mapping for the client query. Because the local name server does not have authority for the microsoft.com domain, it passes the query to one of the DNS root servers, requesting resolution of the host name. The root name server sends back a referral to the com name servers.</li></p>

<p><li>The local name server sends a request to a com name server, which responds with a referral to the Microsoft name servers.</li></p>

<p><li>The local name server sends a request to the Microsoft name server. The Microsoft name server receives the request. Because the Microsoft name server has authority for that portion of the domain namespace, it returns the IP address for www.microsoft.com to the local name server.</li></p>

<p><li>The local name server sends the IP address for www.microsoft.com to the client.</li></p>


<p><li>The name resolution is complete, and the client can now access www.microsoft.com by its IP address.</li></p>
</ol>

<A NAME="492"><h3>Name Server Caching</h3></A>
<p>When a name server is processing a query, it might be required to send out several queries to find the answer. With each query, the name server discovers other name servers that have authority for a portion of the domain namespace. The name server caches these query results to reduce network traffic.</p>

<p>When a name server receives a query result, the following actions take place:</p>

<ol>
<p><li>The name server caches the query result for a specified amount of time, referred to as TTL. The zone that provided the query results specifies the TTL. TTL is configured by using the DNS snap-in. The default value is 60 minutes.</li></p>

<p><li>Once the name server caches the query result, TTL starts counting down from its original value.</li></p>

<p><li>When TTL expires, the name server deletes the query result from its cache.</li></p>
</ol>

<p>Caching query results enable the name server to quickly resolve other queries to the same portion of the domain namespace.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Use shorter TTL values to help ensure that data about the domain namespace is more current across the network. Although shorter TTL values increase the load on name servers and longer TTL values decrease the time required to resolve information, the client will not receive the updated information until the TTL expires and a new query to that portion of the domain namespace is resolved.</blockquote></div>
</p>

<A NAME="493"><h3>Reverse Lookup Query</h3></A>
<p>A reverse lookup query maps an IP address to a name. Troubleshooting tools, such as the nslookup command-line utility, use reverse lookup queries to report back host names. Additionally, certain applications implement security based on the ability to connect to names, not IP addresses.</p>

<p>Because the DNS distributed database is indexed by name and not by IP address, a reverse lookup query would require an exhaustive search of every domain name. To solve this problem, a special second-level domain called 
in-addr.arpa was created.</p>

<p>The in-addr.arpa domain follows the same hierarchical naming scheme as the rest of the domain namespace; however, it is based on IP addresses, not domain names, using the following guidelines:</p>

<ul>
<p><li>Subdomains are named after the numbers in the dotted-decimal representation of IP addresses.</li></p>

<p><li>The order of the IP address octets is reversed.</li></p>

<p><li>Companies administer subdomains of the in-addr.arpa domain based on their assigned IP addresses and subnet mask.</li></p>
</ul>

<p>For example, a company that has an assigned IP address range of 169.254.16.0 to 169.254.16.255 with a subnet mask of 255.255.255.0 has authority over the 16.254.169.in-addr.arpa domain.</p>

<A NAME="494"><h2>Installing the DNS Service</h2></A>
<p>To implement DNS, you must configure the server and then install the DNS service. The DNS server must be configured with a static IP address. In addition, you should configure the TCP/IP properties so that the DNS settings point back to the server. You can install the DNS service anytime after or during the installation of Windows 2000 Server.</p>

<p>The DNS installation process does the following:</p>

<ul>
<p><li>Installs the DNS snap-in, and adds a shortcut to Administrative Tools on the Start menu. The DNS snap-in is used to manage local and remote DNS name servers.</li></p>

<p><li>Adds the following key for the DNS Service to the registry:</li></p>

<p><blockquote>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\DNS</blockquote></p>

<p><li>Creates the %systemroot%\System32\DNS folder, which contains the DNS database files.</li></p>
</ul>

<p>Generally, you will not need to edit the DNS database files. However, you might use them to troubleshoot DNS. The DNS service provides a set of sample files, which are added to the %systemroot%\System32\DNS\Samples folder after you have installed the DNS service.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The %systemroot%\System32\DNS\Samples folder includes the BOOT file. The BOOT file is not defined in an RFC and is not needed for RFC compliance. However, the BOOT file is a part of the Berkeley Internet Name Daemon (BIND)-specific implementation of DNS. If you are migrating from a BIND DNS server, copying the BOOT file allows easy migration of your existing configuration.</blockquote></div>
</p>

<A NAME="495"><h2>Configuring the DNS Service</h2></A>
<p>Once the DNS service is installed, you are ready to configure and manage 
the service.</p>

<A NAME="496"><h3>The DNS Snap-In</h3></A>
<p>You can use the DNS snap-in, shown in Figure 9.13, for all configuration and management tasks of the DNS server. The DNS snap-in allows you to configure forward lookup zones and reverse lookup zones, add resource records to the zone database file, and configure the DNS service for Dynamic DNS (DDNS), which enables automatic updates to your zone files by other servers or services.</p>

<p>
<A HREF="javascript:fullSize('f09xx13x.htm')"> <img src="images/f09xx13.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 9.13</b> <i>The DNS snap-in</i><!--/caption-->
</p>

<p>You can access the DNS snap-in as a stand-alone MMC console or through the Computer Management snap-in, under Services And Applications. The DNS snap-in can be installed by running Adminpak.msi or by installing the DNS service. Before the DNS service is installed, the DNS snap-in is used to manage remote servers running the DNS service.</p>

<A NAME="497"><h3>Creating Forward Lookup Zones</h3></A>
<p>A forward lookup zone enables forward lookup queries. On name servers, you must configure at least one forward lookup zone for the DNS Service to work.</p>

<p>To create a new forward lookup zone, select the Forward Lookup Zone folder and then select New Zone from the Action menu. The New Zone wizard guides you through the process of creating a new forward lookup zone. The wizard presents the following configuration options: Zone Type, Zone Name, and Zone File.</p>

<p><b>Zone Type</b></p>

<p>There are three types of zones that you can configure:</p>

<ul>
<p><li><b>Active Directory-integrated</b> An Active Directory-integrated zone is the master copy of a new zone. The zone uses Active Directory services to store and replicate zone files. This option provides secure updates and integrated storage. Standard zone transfers do not occur with Active Directory-integrated zones. Instead, the zone database file is replicated when Active Directory store replication occurs.</li></p>

<p><li><b>Standard primary</b> A standard primary zone is the master copy of a new zone and is stored in a standard text file. You administer and maintain a primary zone on the computer at which you create the zone. This option facilitates the exchange of DNS data with other DNS servers that use text-based storage methods.</li></p>

<p><li><b>Standard secondary</b> A standard secondary zone is a replica of an existing zone. Secondary zones are read-only and are stored in standard text files. A primary zone must be configured in order to create a secondary zone. When creating a secondary zone, you must specify the DNS server, called the master server, which transfers zone information to the name server containing the standard secondary zone. You create a secondary zone to provide redundancy and to reduce the load on the name server containing the primary zone database file.</li></p>
</ul>

<p><b>Zone Name</b></p>

<p>Typically, a zone is named after the highest domain in the hierarchy that the zone encompasses&#8212;that is, the root domain for the zone. For example, for a zone that encompasses both microsoft.com and sales.microsoft.com, the zone name would be microsoft.com.</p>

<p><b>Zone File</b></p>

<p>The zone file refers to the database file name, which defaults to the zone name with a .dns extension. For example, if your zone name is microsoft.com, the default zone database file name is microsoft.com.dns.</p>

<p>When migrating a zone from another server, you can import the existing zone file. You must place the existing file in the %systemroot%\System32\DNS folder on the target computer before creating the new zone. There are two zone transfer methods for zone transfer: full-zone transfer (AXFR) and incremental-zone transfer (IXFR). AXFR is the standard way of transferring zone information, and it is essentially a zone file copy. Windows 2000 supports AXFR, but it also supports IXFR, which uses less bandwidth since only zone changes are replicated.</p>

<A NAME="498"><h3>Creating Reverse Lookup Zones</h3></A>
<p>A reverse lookup zone enables reverse lookup queries. Reverse lookup zones are not required. However, a reverse lookup zone is required to run troubleshooting tools, such as nslookup, and to record a name instead of an IP address in Microsoft Internet Information Services (IIS) log files.</p>

<p>To create a new reverse lookup zone, select the Reverse Lookup Zones folder and then select New Zone. The New Zone wizard guides you through the process of creating a reverse lookup zone. The wizard presents the following configuration options: Zone Type, Reverse Lookup Zone, and Zone File.</p>

<p><b>Zone Type</b></p>

<p>The zone types are the same as the zone type options available when creating a forward lookup zone: Active Directory-integrated, standard primary, and standard secondary.</p>

<p><b>Reverse Lookup Zone</b></p>

<p>Enter your network ID or the name of the reverse lookup zone. If you use a zero in the network ID, it will appear in the zone name. For example, network ID 169 would create zone 169.in-addr.arpa, and network ID 169.0 would create zone 0.169.in-addr.arpa.</p>

<p><b>Zone File</b></p>

<p>The network ID and subnet mask determine the default zone file name. DNS reverses the IP octets and adds the in-addr.arpa suffix. For example, the reverse lookup zone for the 169.254 network becomes 254.169.in-addr.arpa.dns.</p>

<p>When migrating a zone from another server, you can import the existing zone file. You must place the existing file in the %systemroot%\System32\DNS directory on the target computer before creating the new zone.</p>

<A NAME="499"><h3>Adding Resource Records</h3></A>
<p>Once you create your zones, you can use the DNS snap-in to add resource records. Resource records are entries in the zone database file. Each resource record identifies a particular resource within the database. To add a resource record, select the zone to which you want to add the record and then select Other New Record from the Action menu. When the Resource Record Type dialog box appears, you can create records for any of the record types listed in the Select A Resource Record Type list.</p>

<p>There are many types of resource records. When a zone is created, DNS automatically adds two resource records: the Start of Authority (SOA) and the Name Server (NS) records. An SOA record identifies which name server is the authoritative source of information for data within this domain. The first record in the zone database file must be the SOA record. An NS record lists the name servers that are assigned to a particular domain. Both of these record types can be configured in the Properties dialog box for the specific forward lookup zone.</p>

<p>For a list of the other types of resource records, along with a description of each type, open the Resource Record Type dialog box and view the record types listed in the Select A Resource Record Type list. When you select a record type, a description for that record type appears at the bottom of the dialog box.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information on resource records, see RFC 1034, RFC 2052, and RFC 2065. Use your Web browser to search for &quot;RFC 1034,&quot; &quot;RFC 2052,&quot; and &quot;RFC 2065.&quot; For more information on how DNS works, read <i>DNS and BIND</i> by Paul Albitz and Cricket Liu, published by O'Reilly and Associates, Inc. (1998)</blockquote></div>
</p>

<A NAME="500"><h3>Configuring Dynamic DNS</h3></A>
<p>The DNS Service includes a dynamic update capability called Dynamic DNS (DDNS). With DNS, when there are changes to the domain for which a name server has authority, you must manually update the zone database file on the primary name server. With DDNS, name servers and clients within a network automatically update the zone database files.</p>

<p><b>Dynamic Updates</b></p>

<p>You can configure a list of authorized servers to initiate dynamic updates. This list can include secondary name servers, domain controllers, and other servers that perform network registration for clients, such as servers running the DHCP Service or WINS.</p>

<p>The update sequence consists of the following steps:</p>

<ol>
<p><li>A client, using an SOA query, locates the primary DNS server and zone authoritative for the record to be registered.</li></p>

<p><li>The client sends to the located DNS server an assertion or prerequisite-only update to verify an existing registration. If the registration does not exist, the client sends the appropriate dynamic update package to register the record.</li></p>

<p><li>If the update fails, the client attempts to register the record with the other primary DNS server if the authoritative zone is multimaster. If all primary DNS servers fail to process the dynamic update, it is repeated after 5 minutes, and if it fails again, after another 10 minutes. If registration still fails, the described pattern of the registration attempts are repeated 50 minutes after the last retry.</li></p>
</ol>

<p>Every computer running Windows 2000 attempts the registration of its A and PTR records. An A record, also known as the host record, provides the name-to-address mapping, and the PTR record, also known as the pointer record, provides the address-to-name mapping for the computer sending the registration. The service that actually generates the DNS dynamic updates is the DHCP client. The DHCP client service runs on every Windows 2000 computer, regardless of whether or not it is configured as a DHCP client.</p>

<p><b>DDNS and DHCP</b></p>

<p>DDNS interacts with the DHCP Service to maintain synchronized name-to-IP-address mappings for network hosts. By default, the DHCP Service allows clients to add their own A (host) records to the zone, and the DHCP Service adds the PTR (pointer) record to the zone. The DHCP Service cleans up both the A records and PTR records in the zone when the lease expires.</p>

<p>To configure a zone for DDNS, use the DNS snap-in. Select the appropriate zone, and then select Properties from the Action menu. On the General tab of the Properties dialog box, select Yes from the Allow Dynamic Updates drop-down list.</p>

<p>To configure the server to send dynamic updates, use the DHCP snap-in to configure the DHCP server to point to the appropriate DNS servers.</p>

<p><img src="images/cd.JPG" border="0"></p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information on Dynamic DNS, read RFC 2136 and RFC 2137. Use your Web browser to search for &quot;RFC 2136&quot; and &quot;RFC 2137.&quot; You can also find information about DDNS on the Supplemental Course Materials CD-ROM (\chapt09\articles\w2kDNS.doc) that accompanies this book.</blockquote></div>
</p>

<p><img src="images/practic.JPG" border="0"></p>

<A NAME="501"><h3>Exercise 4: Configuring the DNS Service</h3></A>
<p>In this exercise, you delete and re-create a forward lookup zone, create a reverse lookup zone, configure Dynamic DNS, and test your DNS Server. You will use both Server01 and Server02 to complete this exercise.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
In Chapter 6, &quot;<A HREF="ch06d.htm#265">Exercise 1: Installing Active Directory Services</A>,&quot; DNS was installed automatically because Server01, as a stand-alone server, was not using a DNS for name resolution. Installing DNS is similar to installing DHCP and WINS&#8212;DNS is a component of Networking Services. If you wish, navigate to the details of Networking Services to verify that DNS is installed.</blockquote></div>
</p>


<p><li><b> Procedure 1: Confirming a forward lookup zone and creating a reverse lookup zone</b></li></p>


<p>In this procedure, you delete the Active Directory-integrated forward lookup zone type created as a result of the DNS installation. You then create standard primary forward and reverse lookup zones.</p>

<ol>
<p><li>Log on to Server01 as Administrator with a password of &quot;password.&quot;</li></p>

<p><li>Click Start, point to Programs, point to Administrative Tools, and then click DNS.</li></p>

<p>The DNS snap-in appears.</p>

<p><li>Maximize the DNS snap-in.</li></p>

<p><li>In the console tree, expand SERVER01 and then expand the Forward Lookup Zones folder.</li></p>

<p><li>Select the microsoft.com container.</li></p>

<p><li>Click the Action menu, and then click Delete.</li></p>

<p><li>A message appears asking whether you are sure you want to delete. click ok.</li></p>


<p>A DNS warning message appears.</p>

<p><li>Read the DNS warning message, and then click Yes.</li></p>

<p><li>Click the Action menu, and then click New Zone.</li></p>

<p>The New Zone wizard appears.</p>

<p><li>Click Next.</li></p>

<p>The Zone Type screen appears.</p>

<p><li>Ensure that the Standard Primary radio button is selected, and then click next.</li></p>


<p>The Zone Name screen appears.</p>

<p><li>Type microsoft.com, and then click Next.</li></p>

<p><li>The Zone File screen appears.</li></p>

<p><li>Ensure that the Create A New File With This File Name radio button is selected and that the name of the file to be created is microsoft.com.dns.</li></p>

<p><li>Click Next.</li></p>

<p>The Completing The New Zone Wizard screen appears.</p>

<p><li>Review the information on this screen, and then click Finish.</li></p>

<p>The DNS snap-in appears.</p>

<p><li>Click microsoft.com in the console tree.</li></p>

<p>Notice that Start of Authority (SOA), Name Server (NS), and the Host (A) records are generated.</p>

<p>Server01 is now able to resolve host names to IP addresses using the Standard Primary lookup zone file.</p>

<p><li>In the console tree, click the Reverse Lookup Zones container.</li></p>

<p><li>Click the Action menu, and then click New Zone.</li></p>

<p>The New Zone wizard appears.</p>

<p><li>Click Next.</li></p>

<p>The Zone Type screen appears.</p>

<p><li>Ensure that the Standard Primary radio button is selected, and then click next.</li></p>


<p>The Reverse Lookup Zone screen appears.</p>

<p><li>Ensure that The Network ID radio button is selected and type 192.168.1 in the Network ID box.</li></p>

<p>The Reverse Lookup Zone Name text box at the bottom of the screen now contains 1.168.192.in-addr.arpa.</p>

<p><li>Click Next.</li></p>

<p>The Zone File screen appears.</p>

<p><li>Ensure that the Create A New File With This File Name radio button is selected and that the name of the file to be created is 1.168.192.in-addr.arpa.dns.</li></p>


<p><li>Click Next.</li></p>

<p>The Completing The New Zone Wizard screen appears.</p>

<p><li>Review the information on the screen, and then click Finish.</li></p>

<p>The DNS Service on Server01 is now capable of providing host names when given a host address in its subnet.</p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
After creating a DNS, DNS configuration information is commonly added to the DHCP Service. You completed this procedure in the DHCP exercise earlier in this chapter.</blockquote></div>
</p>

<p><li><b>Procedure 2: Configuring dynamic DNS service</b></li></p>


<p>In this procedure, you configure the DNS Service to allow dynamic updates. Complete this procedure using the DNS snap-in on Server01.</p>

<ol>
<p><li>In the console tree, select the microsoft.com container. This folder is located under the Forward Lookup Zones folder.</li></p>

<p><li>Click the Action menu, and then click Properties.</li></p>

<p>The microsoft.com Properties dialog box appears.</p>

<p><li>In the Allow Dynamic Updates drop-down list box, select Yes, and then click OK.</li></p>

<p>This part of the procedure configured Dynamic DNS for the forward lookup zone.</p>

<p><li>In the console tree, select the 192.168.1.x Subnet container.</li></p>

<p><li>Click the Action menu, and then click Properties.</li></p>

<p>The 192.168.1.x Subnet Properties dialog box appears.</p>

<p><li>In the Allow Dynamic Updates drop-down list box, select Yes, and then click OK.</li></p>

<p>This part of the procedure configured Dynamic DNS for the reverse lookup zone.</p>

<p><li>Minimize the DNS snap-in.</li></p>
</ol>

<p><li><b>Procedure 3: Testing and further configuring DNS</b></li></p>


<p>In this procedure, you confirm that the DNS Service is working properly and you further configure the DNS using the DNS snap-in.</p>

<ol>
<p><li>On Server01, restore the minimized DNS snap-in.</li></p>

<p><li>In the console tree, click SERVER01.</li></p>

<p><li>Click the Action menu, and then click Properties.</li></p>

<p>The SERVER01 Properties dialog box appears.</p>

<p><li>Click the Monitoring tab.</li></p>

<p><li>Under Select A Test Type, select the A Simple Query Against This DNS Server, and the A Recursive Query To Other DNS Servers check boxes.</li></p>

<p><li>Click Test Now.</li></p>

<p>In the Test Results box, you will see PASS in both columns. If you are on a stand-alone server, you will see FAIL in the Recursive Query column.</p>

<p><li>Click OK.</li></p>

<p>The DNS snap-in appears.</p>

<p><li>In the console tree, click Reverse Lookup Zones.</li></p>

<p><li>Click 192.168.1.x Subnet.</li></p>

<p>Notice that this reverse lookup zone contains two records, the SOA and the NS records, as shown in the details pane.</p>

<p><li>In the console tree, click 192.168.1.x Subnet.</li></p>

<p><li>Click the Action menu, and then click New Pointer.</li></p>

<p>The New Resource Record dialog box appears.</p>

<p><li>In the Host IP Number box, type <b>201</b> in the highlighted fourth octet.</li></p>

<p><li>In the Host Name text box, type <b>server01.microsoft.com</b>. (Make sure to include the period after the word com.)</li></p>

<p><li>Click OK.</li></p>

<p>A Pointer record appears in the details pane.</p>

<p><li>Close the DNS snap-in.</li></p>

<p><li>Open a command prompt on Server01 or Server02.</li></p>

<p><li>At the command prompt, type <b>nslookup</b> and then press Enter.</li></p>

<p>From Server01, the default server is listed as localhost and the address is listed as 127.0.0.1.</p>

<p>From Server02, the default server is listed as server01.microsoft.com and the address is listed as 192.168.1.201.</p>

<p>Both listings are pointing to server01.microsoft.com. The listing appearing at the command prompt on Server01 is the server's loop-back address.</p>

<p><li>Type <b>ls microsoft.com</b>.</li></p>

<p>Notice that the NS and A records are displayed as a result of this DNS query.</p>

<p><li>Type <b>exit</b> , and then press Enter.</li></p>
<p>Close the command prompt.</p>

</ol>

<A NAME="502"><h2>Configuring a DNS Client</h2></A>
<p>Once you install and configure the DNS service on computers running Windows 2000 Server, you can configure your Windows 2000 DNS clients. You must ensure that TCP/IP is installed on the client before you can configure the client to use the DNS Service. Once TCP/IP is installed on the client, open the Internet Protocol (TCP/IP) Properties dialog box (Figure 9.4). From there, you can configure automatic DNS address acquisition (provided by a DHCP server) or specify the IP addresses of a preferred and alternate DNS. You can configure more advanced settings for DNS by first clicking the Advanced button. From the Advanced TCP/IP Settings dialog box (Figure 9.14), click the DNS tab to configure DNS settings. You will need to supply the IP address or addresses of the DNS servers. These should be listed in order of use. You can also specify DNS settings that assist in resolving host names not specified by their FQDN, and you can configure DDNS registration settings from this dialog box.</p>

<p>
<img src="images/f09xx14.jpg" border="0">
</p><p>
<!--caption--><b>Figure 9.14</b> <i>The Advanced TCP/IP Settings dialog box showing two DNS addresses in order of use, name resolution properties, and automatic registration settings</i><!--/caption-->
</p>

<A NAME="503"><h2>Troubleshooting the DNS Service</h2></A>
<p>You can troubleshoot name servers by using the monitoring and logging options in the DNS snap-in or by using the nslookup command-line utility.</p>

<A NAME="504"><h3>Monitoring the DNS Server</h3></A>
<p>The DNS snap-in allows you to monitor the DNS Service. Select the name server, and then select Properties from the Action menu. In the Properties dialog box, select the Monitoring tab. You can test the name server by performing two types of queries:</p>

<ul>
<p><li><b>Simple query</b> Select this type of query to perform a simple query test of the DNS server. This is a local test that uses the DNS client on this computer to query the name server.</li></p>

<p><li><b>Recursive query</b> Select this type of query to perform a more complex, recursive query test of the name server. This query tests the name server by forwarding a recursive query to another name server.</li></p>
</ul>

<A NAME="505"><h3>Setting Logging Options</h3></A>
<p>The DNS snap-in allows you to set additional logging options for debugging purposes. Open the Properties dialog box for the name server, and select the Logging tab. You can select from 11 options: Query, Notify, Update, Questions, Answers, Send, Receive, UDP, TCP, Full Packets, and Write Through. Information from any of the selected options is saved to the log file.</p>

<A NAME="506"><h3>Using Nslookup</h3></A>
<p>The nslookup command-line utility is the primary diagnostic tool for the DNS service, and it is installed when the TCP/IP protocol is installed. Use nslookup to view any resource record and to direct queries to any name server, including UNIX DNS implementations.</p>

<p>Nslookup has two modes: interactive and noninteractive.</p>

<ul>
<p><li>When you require more than one piece of data, use interactive mode. To run interactive mode, type <b>nslookup</b> at the command prompt. To exit interactive mode, type <b>exit</b>.</li></p>

<p><li>When you require a single piece of data, use noninteractive mode. Type the nslookup syntax at the command line, and the data is returned. The syntax for nslookup is as follows:</li></p>


<p><table cellpadding=5 width="95%"><tr><td>
<pre>nslookup [-option ...] [computer-to-find | - [server]]
</pre></td></tr></table></p>
</ul>

<p>The following table describes the optional parameters for nslookup.</p>

<p><table cellpadding=5 width="95%"><tr>
<th>Syntax</th><th>Description</th>
</tr><tr>
<td valign="top">-option&#8230;</td> <td valign="top">Specifies one or more nslookup commands. For a list of commands, type a question mark (?) in interactive mode to open Help.</td></tr><tr>
<td valign="top" nowrap>computer-to-find</td> <td valign="top">If the computer to find is an IP address, nslookup returns the host name. If the computer to find is a name, nslookup returns an IP address. If the computer to find is a name and does not have a trailing period, the default DNS domain name is appended to the name. To look up a computer outside the current DNS domain, append a period to the name.</td></tr><tr>
<td valign="top">server</td> <td valign="top">Use this server as the DNS name server. If the server is omitted, the currently configured default name server is used.</td></tr></table></p>

<A NAME="507"><h2>Lesson Summary</h2></A>
<p>DNS is a distributed database used in TCP/IP networks to translate computer names to IP addresses. The domain namespace is the naming scheme that provides the hierarchical structure for the DNS database. The hierarchical structure of the domain namespace consists of a root domain, top-level domains, second-level domains, and host names. Zones provide a way to partition the domain namespace into manageable sections. A zone must encompass a contiguous domain namespace. A DNS name server stores the zone database file and can be authoritative for more than one zone. Name resolution is the process of resolving names to IP addresses. DNS name servers resolve forward and reverse lookup queries. A forward lookup query resolves a name to an IP address. A reverse lookup query resolves an IP address to a name. To implement DNS, you must install the DNS Service and then configure the server by using the DNS snap-in. You can use the DNS snap-in to configure forward lookup zones and reverse lookup zones, add resource
records to the zone database file, and configure the DNS Service for DDNS, which enables automatic updates to your zone files by other servers or services. Along with setting up DNS on a Windows 2000 Server computer, you must configure the Windows 2000 client. To configure a DNS client, TCP/IP must be installed and the appropriate DNS settings must be selected in the Internet Protocol (TCP/IP) Properties dialog box. Once DNS is set up in your network, you can troubleshoot the DNS service by using the monitoring and logging options in the DNS snap-in and by using the nslookup command-line utility.</p>

</BODY>
</HTML>



