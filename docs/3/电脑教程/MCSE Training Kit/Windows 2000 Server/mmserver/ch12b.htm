<HTML>
<HEAD>
<TITLE>Lesson 1: Managing Hardware Devices and Drivers</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmserver.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12a.htm", "ch12c.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="673"><h1>Lesson 1: Managing Hardware Devices and Drivers</h1></A>
<p>Hardware includes any physical device connected to your computer and controlled by its microprocessor. For a device to work properly with Windows 2000, a device driver must be loaded onto the computer. A <i>device driver</i> is a program that allows a specific device to communicate with Windows 2000. Although a device might be installed on your system, Windows 2000 cannot use the device until an appropriate driver is installed and configured. This lesson provides an overview of hardware and describes how to manage devices and their drivers. It also describes the tools necessary to add, remove, and configure these devices and their drivers.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Manage hardware devices and drivers by using the Add/Remove Hardware wizard and the Device Manager snap-in, by configuring driver signing options and hardware profiles, and by using event logs to monitor reliability and availability</li></p>

<p><li>Apply service pack updates</li></p>
</ul>

<b>Estimated lesson time: 40 minutes</b> 
</blockquote></div>
</p>

<A NAME="674"><h2>Hardware Overview</h2></A>
<p>Hardware includes any devices that were connected to your computer when it was manufactured, as well as peripheral equipment added later. For example, your system's hardware can include modems, disk drives, drive controllers, CD-ROM drives, printers, network adapters, keyboards, monitors, and display adapter cards.</p>

<p>These devices, which might or might not be Plug and Play compliant, are connected to the computer in several ways. Some devices, such as network adapters and sound cards, are connected to expansion slots inside the computer. Other devices, such as printers and scanners, are connected to ports on the outside of the computer, while some devices, known as PC cards, connect only to PC Card slots on a portable computer.</p>

<p>Each device has its own unique device driver, which is typically supplied by the device manufacturer. Many of these device drivers are included on the Windows 2000 installation CD-ROM.</p>

<A NAME="675"><h3>Hardware Types</h3></A>
<p>Windows 2000 classifies devices by hardware type. Hardware types include such things as display adapter cards, keyboards, CD-ROM drives, ports, and printers. When you use the Device Manager snap-in (Figure 12.1) or the Add/Remove Hardware wizard, you see a list of the hardware types installed on your computer.</p>

<p>
<img src="images/f12xx01.jpg" border="0">
</p><p>
<!--caption--><b>Figure 12.1</b> <i>Device Manager snap-in for the local computer</i><!--/caption-->
</p>

<p>Hardware types are further categorized according to individual devices. For example, the modem hardware type includes over 200 modems you can install and use with Windows 2000.</p>

<p>Devices can also be classified according to the way they are connected to your computer. Most devices are permanently connected to your computer and are typically installed only once. They are available every time you turn on your computer unless you disable or uninstall them. Permanently connected devices include the following:</p>

<ul>
<p><li>Sound cards</li></p>

<p><li>Video display cards</li></p>

<p><li>Modems</li></p>

<p><li>Hard disks</li></p>
</ul>
<p>Other devices are designed to be connected and disconnected from your computer as you need them. You can plug or insert these types of devices into the appropriate port or expansion slot, and Windows 2000 will recognize the device and configure it without restarting your computer. Likewise, when you disconnect these types of devices, you need to inform Windows 2000 only that you are ejecting, removing, or unplugging it. You do not need to shut down or restart your computer. Devices designed to be connected and disconnected include the following:</p>
<ul>
<p><li>PC Cards that connect to portable computers</li></p>

<p><li>Hardware that connects to a universal serial bus (USB) or an IEEE 1394 bus</li></p>

<p><li>Docking stations that support hot docking and undocking of portable computers</li></p>

<p><li>Hardware that connects to serial or parallel ports</li></p>
</ul>

<p>For a comprehensive list of the devices supported by Windows 2000, 
see the Microsoft Windows Hardware Compatibility List (HCL) by 
performing a search on the keyword HCL at the Microsoft Web site 
(<i><a href="http://www.microsoft.com" target="_window2">http://www.microsoft.com</a></i>).</p>

<A NAME="676"><h3>Plug and Play Overview</h3></A>
<p>A <i>Plug and Play</i> device adheres to a set of specifications developed by the IEEE and computer and software manufacturers such as Intel, Compaq Corporation, Microsoft Corporation, and Phoenix Technologies. These specifications allow a computer to automatically detect and configure a device and install the appropriate device drivers. With Windows 2000, it is simple to install a PnP device. Just connect it to the computer and provide an external power source if necessary, and Windows 2000 does the rest by installing any necessary drivers, updating the system, and allocating system resources.</p>

<p>For example, you can dock a portable computer and connect to a network without changing the configuration. Later, you can undock that same computer and use a modem to connect to the network, again without making any manual changes to the operating system configuration. Windows 2000 automatically adjusts the device driver state to match a changed hardware configuration.</p>

<p>With Plug and Play, you can be confident that any new devices will work together properly and that your computer will restart correctly after you install or uninstall hardware. Windows 2000 also recognizes any new hardware when you start your computer and loads any drivers that the hardware device needs.</p>

<p>When you install or uninstall a hardware device, Plug and Play works with the Windows 2000 Power Options utility to manage the power requirements of your hardware and peripherals, shutting them down or conserving power when you are not using them. And if you are working in another program when you install or uninstall a device, Plug and Play lets you know it is about to change your computer configuration and warns you to save your work.</p>

<p>If something does go wrong, the Event Log service records the information in the System log.</p>

<p><b>Plug and Play Device Driver Support</b></p>

<p>Windows 2000 installs a Plug and Play device and its driver automatically. However, if you choose to install an older driver or legacy hardware device, you might have limited Plug and Play support or none at all.</p>

<p>Using a Plug and Play driver to install a non-Plug and Play device might provide some Plug and Play support. Although the system cannot recognize the hardware and load the appropriate drivers on its own, Plug and Play can oversee the installation by allocating resources, interacting with the Power Options utility in Control Panel, and recording any issues in the System log.</p>

<p>Generally, you cannot install non-Plug and Play hardware without performing some manual setup. Use the Add/Remove Hardware wizard or the Device Manager snap-in to change configuration settings for legacy hardware.</p>

<A NAME="677"><h2>Installing Devices</h2></A>
<p>Installing a new device typically involves three steps:</p>

<ol>
<p><li>Connecting the device to your computer</li></p>

<p><li>Loading the appropriate device drivers for the device</li></p>

<p><li>Configuring device properties and settings</li></p>
</ol>

<p>To ensure the device functions properly, you should follow the device manufacturer's installation instructions. This might require you to shut down and unplug your computer, and then connect the device to the appropriate port or insert it into the appropriate slot.</p>

<p>If the device is Plug and Play or is a necessary startup device like the hard disk, this detection happens automatically. However, for some older devices, you might have to restart your computer after you have connected one of them to your computer. Windows 2000 then attempts to detect your new device.</p>

<p>If the device is not Plug and Play, you might have to use the Add/Remove Hardware wizard in Control Panel to tell Windows 2000 what type of device you are installing. After the device is detected or you have identified the device by using the Add/Remove Hardware wizard, Windows 2000 might ask you to insert the Windows 2000 installation CDROM or the manufacturer's floppy disk or CDROM so that it can load the proper device drivers.</p>

<p>Once the device drivers are loaded onto your system, Windows 2000 configures the properties and settings for the device. Although you can manually configure device properties and settings, you should let Windows 2000 do it. When you manually configure properties and settings, the settings become fixed, which means Windows 2000 cannot modify them in the future if a problem arises or there is a conflict with another device.</p>

<p>To install the device, connect it to the appropriate port or slot on your computer according to the device manufacturer's instructions. You might need to start or restart your computer. You must be logged on as an administrator or a member of the Administrators group to complete this procedure. However, if a user with administrator privileges has already loaded the drivers for a device, you can install the device without administrator privileges. Note also that network policy settings might prevent you from completing this procedure if your computer is connected to a network.</p>

<p>In a situation where you need to restart your computer, Windows 2000 should detect the device and start the Found New Hardware wizard. When installing a device, such as installing a sound card into a motherboard slot, shut down Windows and turn off and unplug the computer. Remove the computer cover and install the device in the appropriate slot. Replace the computer cover, and then plug in and turn on the computer.</p>

<p>If your device does not install properly, you might have an older, non-Plug and Play device. Follow the instructions on the screen (if prompted) to choose a destination path to install drivers for the device.</p>

<p>If the device is a small computer system interface (SCSI) device, connect 
it to the SCSI controller port on your computer according to the device manufacturer's instructions. Restart your computer. You need to be sure the device number for the SCSI device is not used by another SCSI device and that the device is properly terminated. To change the device number, see the device manufacturer's instructions.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Personal Computer Memory Card International Association (PCMCIA) SCSI controller cards and other devices might not require a reboot after installation. As always, refer to the manufacturer's instructions when installing hardware. Use the information provided in this chapter as a general guideline to hardware installation.</blockquote></div>
</p>

<p>If the device is a USB or IEEE 1394 device, plug it into any USB or IEEE port on your computer. Follow the instructions that appear on your screen. You do not need to shut down or turn off your computer when you install or plug in a USB or IEEE 1394 device. Although USB and IEEE 1394 are similar technologies, you cannot interchange USB connections with IEEE 1394 connections.</p>

<A NAME="678"><h2>Uninstalling Devices</h2></A>
<p>You can usually uninstall a Plug and Play device by disconnecting or removing the device. Some devices might require you to turn off the computer first. To ensure that you do this properly, consult the device manufacturer's installation and removal instructions.</p>

<p>You can use either the Add/Remove Hardware wizard or Device Manager snap-in to notify Windows 2000 that you want to uninstall a non-Plug and Play device. After you notify Windows 2000 that you are uninstalling a device, you must physically disconnect or remove the device from your computer. For example, if the device is connected to a port on the outside of your computer, you would shut down your computer, disconnect the device from the port, and then unplug the power cord, if there is one for the device.</p>

<p>Instead of uninstalling a Plug and Play device that you might attach again, like a modem, you can disable a device. When you disable a device, the physical device stays connected to your computer, but Windows 2000 updates the system registry so that the device drivers are no longer loaded when you start your computer. When you enable the device, the drivers are available again. Disabling devices is useful if you want to have more than one hardware configuration (hardware profile) for your computer. Multiple hardware profiles are common for mobile computers that operate both on and off of a docking station.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The Device Manager snap-in does not remove device drivers from your hard disk. If you want to do this, use the Add/Remove Hardware wizard and select the Uninstall A Device Removal Task option. Additionally, consult the hardware manufacturer's documentation to determine the best way to remove device drivers.</blockquote></div>
</p>

<A NAME="679"><h2>Tools for Managing Devices and Drivers</h2></A>
<p>Several tools are available for managing hardware devices and their drivers. Most of these tools can be accessed through the Hardware tab of the System Properties dialog box. To open the System Properties dialog box, open Control Panel and then open the System application or hold down the Windows flag key and press the Break key. When the System Properties dialog box appears, select the Hardware tab (Figure 12.2).</p>

<p>
<A HREF="javascript:fullSize('f12xx02x.htm')"> <img src="images/f12xx02.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 12.2</b> <i>System Properties dialog box showing the Hardware tab</i><!--/caption-->
</p>

<p>From here, you can open the Add/Remove Hardware wizard, the Device Manager snap-in, the Driver Signing Options dialog box, and the Hardware Profiles dialog box. In addition to the tools you can access through the System Properties dialog box, you can use Event Viewer logs to troubleshoot hardware configurations.</p>

<A NAME="680"><h3>Add/Remove Hardware Wizard</h3></A>
<p>The Add/Remove Hardware wizard allows you to add new hardware, unplug or remove hardware from your computer, or troubleshoot hardware-related problems (Figure 12.3).</p>

<p>
<A HREF="javascript:fullSize('f12xx03x.htm')"> <img src="images/f12xx03.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 12.3</b> <i>Opening screen of the Add/Remove Hardware wizard</i><!--/caption-->
</p>

<p>In addition to being able to open the wizard from the Hardware tab of the System Properties dialog box, you can open it from Control Panel by selecting Add/Remove Hardware. Once you have opened the wizard, follow the steps in the wizard to add, remove, unplug, or troubleshoot your hardware.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
To use the Add/Remove Hardware wizard, you must be logged on to or running in the context of an account with administrator privileges. Use the Runas command-line utility to run in the security context of another user account. If your computer is connected to a network, network policy settings might prevent you from using the Add/Remove Hardware wizard.</blockquote></div>
</p>

<A NAME="681"><h3>The Device Manager Snap-In</h3></A>
<p>Device Manager is an MMC snap-in that provides you with a graphical view of the hardware that is installed on your computer (Figure 12.1).</p>

<p>In addition to being able to open the Device Manager snap-in from the Hardware tab of the System Properties dialog box, you can open the tool from the Computer Management MMC or create a custom MMC containing the Device Manager snap-in. Once you open Device Manager, you can use it to change the way your hardware is configured as well as the way your hardware interacts with your computer's microprocessor.</p>

<p>The Device Manager snap-in allows you to perform the following tasks:</p>

<ul>
<p><li>Determine whether the hardware on your computer is working properly</li></p>

<p><li>Change hardware configuration settings</li></p>

<p><li>Identify the device drivers loaded for each device, and obtain information about each device driver</li></p>

<p><li>Change advanced settings and properties for devices</li></p>

<p><li>Install updated device drivers</li></p>

<p><li>Disable, enable, and uninstall devices</li></p>

<p><li>Identify Ldevice conflicts and manually configure resource settings</li></p>

<p><li>Print a System Resource Report of the devices installed on your computer</li></p>
</ul>

<p>Typically Device Manager is used to check hardware status and update device drivers. Advanced users who have a thorough understanding of computer hardware also use Device Manager's diagnostic features to resolve device conflicts and change resource settings.</p>

<p>
<div class="warning"><blockquote><b>IMPORTANT</b><hr>
Changing resource settings improperly can disable your hardware and cause your computer to malfunction or be inoperable. Only users who have expert knowledge of computer hardware and hardware configurations should change resource settings.</blockquote></div>
</p>

<p>Ordinarily, you will not need to use the Device Manager snap-in to change resource settings because resources are allocated automatically by Windows 2000 during hardware setup. In addition, Device Manager can be used to manage devices on a local computer only. Device Manager works in read-only mode on a remote computer.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
To use the Device Manager snap-in, you must be logged on to or running in the security context of a user account with administrator privileges. If your computer is connected to a network, network policy settings might prevent you from using the snap-in.</blockquote></div>
</p>

<A NAME="682"><h3>Driver Signing</h3></A>
<p>The Driver Signing function allows Windows 2000 to notify users whether or not a driver they are installing has passed the Microsoft certification process (Figure 12.4). Driver Signing attaches an encrypted digital signature to a code file that has passed the Windows Hardware Quality Labs (WHQL) tests.</p>

<p>
<A HREF="javascript:fullSize('f12xx04x.htm')"> <img src="images/f12xx04.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 12.4</b> <i>Driver Signing Options dialog box</i><!--/caption-->
</p>

<p>Microsoft digitally signs drivers as part of WHQL testing if the driver runs on Windows 2000 operating systems. The digital signature is associated with individual driver packages and recognized by Windows 2000. This certification process proves to users that the drivers they employ are identical to those Microsoft has tested and notifies them if a driver file has been changed after the driver was put on the HCL.</p>

<p>Driver Signing allows for three responses:</p>

<ul>
<p><li><b>Ignore</b> Allows all files to be installed, whether they've been signed or not.</li></p>

<p><li><b>Warn</b> Notifies the user if a driver that's being installed hasn't been signed, and gives the user a chance to say &quot;no&quot; to the installation. Warn also gives the user the option to install unsigned versions of a protected driver file.</li></p>

<p><li><b>Block</b> Prevents all unsigned drivers from being installed.</li></p>
</ul>

<p>Windows 2000 ships with the Warn mode set as the default.</p>

<p>Driver Signing doesn't affect the code itself. Rather, Microsoft signs the binary driver code that passes the WHQL tests. Microsoft then produces a catalog file that contains the code and a cryptographic digital signature. The resulting binary file is constructed in such a way that the code can't be altered without the catalog file's signature becoming invalid.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information on digital signatures and cryptography, see <a href="ch11a.htm">Chapter 11</a>.</blockquote></div>
</p>

<p>Specifically, a hash (encryption) of the driver binary and relevant information are stored in a catalog (.cat) file, and the .cat file is signed with the Microsoft digital signature. The binary itself is not touched; only a .cat file is created for each driver package. The relationship between the driver package and its .cat file is referenced in the driver's .inf file and maintained by the system after the driver is installed.</p>

<p>Vendors wishing to have drivers tested and signed can find information 
on driver signing at <i><a href="http://www.microsoft.com/hwdev/" target="_window2">http://www.microsoft.com/hwdev/</a></i>. Only signed 
drivers are published on the Windows Update Web site at 
<i><a href="http://windowsupdate.microsoft.com/default.htm" target="_window2">http://windowsupdate.microsoft.com/default.htm</a></i> .</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
If you are logged on to or running in the context of an account with administrator privileges, select the Apply Setting As System Default check box (Figure 12.4) to apply the selected setting as the default for all users who log on to the computer. Driver Signing options can also be specified in Group Policy by specifying the Unsigned Driver Installation Behavior security setting.</blockquote></div>
</p>

<A NAME="683"><h3>Hardware Profiles</h3></A>
<p>A hardware profile is a set of instructions that tells Windows 2000 which devices to start when you start your computer or what settings to use for each device. When you first install Windows 2000, a hardware profile named Profile 1 (Current) is created. The default profile name varies for mobile computers. A common name given to mobile computers, by default, is 
Undocked Profile (Current), as shown in Figure 12.5.</p>

<p>
<A HREF="javascript:fullSize('f12xx05x.htm')"> <img src="images/f12xx05.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 12.5</b> <i>Hardware Profiles dialog box</i><!--/caption-->
</p>

<p>By default, every device installed on your computer at the time you install Windows 2000 is enabled in the default hardware profile.</p>

<p>Hardware profiles are especially useful if you have a portable computer. Most portable computers are used in a variety of locations, and hardware profiles let you change which devices your computer uses when you move it from location to location. For example, you might have one profile named Docking Station Configuration for using your portable computer at a docking station with hardware components such as a CD-ROM drive and a network adapter. And you might have a second profile named Undocked Configuration for using your portable computer in a hotel or on an airplane, when you are not using a network adapter or CD-ROM but you are using a modem and portable printer.</p>

<p>You can manage hardware profiles by opening System in Control Panel, clicking the Hardware tab, and clicking Hardware Profiles. If there is more than one hardware profile, you can designate a default profile that will be used every time you start your computer. You can also have Windows 2000 ask you which profile to use every time you start your computer. Once you create a hardware profile, you can use Device Manager to disable and enable devices in the profile. When you disable a device in a hardware profile, the device drivers for the device are not loaded when you start your computer.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
You must be logged on to or running in the context of an account with administrator privileges on the local computer to create, copy, rename, or delete hardware profiles.</blockquote></div>
</p>

<p>The profile created when Windows 2000 is installed (installation profile) provides a model for you to create new hardware profiles. To make a hardware profile appear after it is created, access the properties of the profile and select the Always Include This Profile As An Option When Windows Starts check box.</p>

<A NAME="684"><h3>Event Logs</h3></A>
<p>Careful monitoring of the System log generated by the Event Log service can help you predict and identify the sources of system problems. For example, if log warnings show that a disk driver can read or write to a sector only after several retries, the sector is likely to go bad eventually.</p>

<p>The Application and System logs can confirm problems with software. If a program crashes, the Application log can provide a record of activity leading up to the event.</p>

<p>The following suggestions might help you use event logs to diagnose problems:</p>

<ul>
<p><li><b>Archive logs in log format</b> The binary data associated with an event is saved if you archive the log in log format (.evt), but it is discarded if you archive data in text (.txt) or comma-delimited (.csv) format. The binary data might help a developer or technical support specialist identify the source of a problem.</li></p>

<p><li><b>Note event IDs</b> These numbers match a text description in a message file. The numbers can be used by product support representatives to understand what occurred in the system.</li></p>

<p><li><b>Address hardware problems</b> If you suspect a hardware component is the source of system problems, filter the System log to show only those events generated by the component.</li></p>

<p><li><b>Address system problems</b> If a particular event seems related to system problems, try searching Event Log to find other instances of the same event or to judge the frequency of an error.</li></p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information about using event logs, see the Supplemental Course Materials CD-ROM (\chapt12\articles\Monitoring Reliability.doc) that accompanies this book.</blockquote></div>
</p>

<A NAME="685"><h2>Installing Service Packs</h2></A>
<p>Windows 2000 makes it easier for administrators to add service packs. In Windows NT, Windows 95 and Windows 98, service packs are installed separately, after the operating system is installed. Windows 2000 supports service pack slipstreaming, which means the service pack is applied directly to the operating system's distribution share during installation.</p>

<p>Windows 2000 also eliminates the need to reinstall components applied before a service pack was installed. This makes it much easier to install service packs on existing systems. In the past, when service packs were installed, many previously installed components had to be reinstalled. For example, when a service pack is applied to Windows燦T 4.0, services installed previously, such as IPX or RAS, have to be reinstalled. To address the problems that existed with Windows燦T 4.0 service packs, Windows 2000 provides service pack slipstreaming and post-setup installation of service packs.</p>

<A NAME="686"><h3>Service Pack Slipstreaming</h3></A>
<p>Service pack slipstreaming refers to a service pack being applied to Windows 2000 distribution files on a CD-ROM or on a network share. When Windows 2000 is installed from either source, the appropriate files from the service pack are installed without you having to manually apply the service pack after the installation.</p>

<p>To apply a new service pack, use update.exe with the /slip switch. This copies the updated service pack files over the existing Windows 2000 files. Some of the key files that are replaced include the following:</p>

<ul>
<p><li>A new layout.inf, dosnet.inf, and txtsetup.sif that contains updated checksums for all the service pack files. These files need additional entries if additional files are added.</li></p>

<p><li>A new driver.cab if the drivers in the cabinet file are changed.</li></p>
</ul>

<A NAME="687"><h3>Post-Setup Installation of a Service Pack</h3></A>
<p>A service pack is applied on an existing Windows 2000 system by running update.exe and updating the system to Windows 2000 plus the service pack. When the system state changes (for example, services are added or removed), the base system is told that a service pack was installed, what files were replaced or updated by the service pack, and where the service pack was installed from. This means that the correct files are copied from the service pack distribution location (the network share, CDROM, or Web site) and from the Windows 2000 installation source (network share or CD-ROM). This eliminates the need to reapply a service pack when the system state changes.</p>

<p>Once the service pack is applied, if the system state changes (for example, an RAS is added after the service pack is applied), Windows 2000 installs the correct files, whether those files originate from the Windows 2000 CDROM or from the service pack. Again, this eliminates the need to reapply the service pack whenever the system state changes.</p>

<A NAME="688"><h2>Lesson Summary</h2></A>
<p>Hardware includes any physical device connected to your computer and controlled by your computer's microprocessor. A device driver allows a specific device to communicate with Windows 2000. Windows 2000 classifies devices by hardware type. A Plug and Play device adheres to a set of specifications that allow a computer to automatically detect and configure a device and install the appropriate device drivers. Installing a new device typically involves three steps: connecting the device to your computer, loading the appropriate device drivers for the device, and configuring device properties and settings. You can usually uninstall a Plug and Play device by disconnecting or removing the device. You can use either the Add/Remove Hardware wizard or Device Manager snap-in to notify Windows 2000 that you want to uninstall a non-Plug and Play device. Several tools are available for managing hardware devices and their drivers. From the Hardware tab of the System Properties dialog box, you can open the
Add/Remove Hardware wizard, the Device Manager snap-in, the Driver Signing Options dialog box, and the Hardware Profiles dialog box. In addition to the tools you can access through the System Properties dialog box, Event Log can be used to troubleshoot hardware configurations. Service pack updates can be seamlessly integrated into the network so that new Windows 2000 installations apply the service pack updates as part of the setup routine. Changes to existing Windows 2000 configurations automatically apply the service pack updates.</p>

</BODY>
</HTML>



