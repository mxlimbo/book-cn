<HTML>
<HEAD>
<TITLE>Lesson 4: Installing and Configuring Terminal Services</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmserver.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch14d.htm", "ch14f.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="828"><h1>Lesson 4: Installing and Configuring Terminal Services</h1></A>
<p>Terminal Services provides access to Windows 2000 and the latest Windows-based applications for client computers. It also provides access to your desktop and installed applications anywhere, from any supported client. Terminal Services is a built-in feature of Windows 2000 that allows IT managers and system administrators who want to increase flexibility in application deployment, control computer management costs, and remotely administer network resources.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Deploy Terminal Services in a Windows 2000 environment</li></p>
</ul>

<b>Estimated lesson time: 40 minutes</b> 
</blockquote></div>
</p>

<A NAME="829"><h2>Overview of Terminal Services</h2></A>
<p>Terminal Services running on a Windows 2000 Server enables all client application execution, data processing, and data storage to occur on the server. It provides remote access to a server desktop through terminal emulation software. The terminal emulation software can run on a number of client hardware devices, such as a personal computer, Windows CE-based Handheld PC (H/PC), or terminal.</p>

<p>With Terminal Services, the terminal emulation software sends keystrokes and mouse movements to the server. Terminal Services does all the data manipulation locally and passes back the display. This approach allows remote control of servers and centralized application management, minimizing network bandwidth requirements between the server and client.</p>

<p>Users can gain access to Terminal Services over any TCP/IP connection including Remote Access, Ethernet, the Internet, wireless, wide area network (WAN), or virtual private network (VPN). The user experience is limited only by the slowest link in the connection, and the security of the link is governed by the TCP/IP deployment in the data center.</p>

<p>Terminal Services provides remote administration of network resources, a uniform experience to users in branch offices in remote locations, or a graphical interface to line of business applications on text-based computers.</p>

<p>Terminal Services is a built-in feature of Windows 2000. You can enable Terminal Services in one of two modes: Remote Administration and Application Server.</p>

<A NAME="830"><h3>Remote Administration</h3></A>
<p>Remote Administration gives system administrators a powerful method for remotely administering each Windows 2000 Server computer over any TCP/IP connection. You can administer file and print sharing, edit the registry from another computer on the network, or perform any task as if you were sitting at the console. You can use Remote Administration mode to manage servers not normally compatible with the Application Server mode of Terminal Services, such as servers running the Cluster service.</p>

<p>Remote Administration mode installs only the remote access components of Terminal Services. It does not install application sharing components. This means that you can use Remote Administration with very little overhead on mission critical servers. Terminal Services allows a maximum of two concurrent Remote Administration connections. No additional licensing is required for those connections, and you do not need a license server.</p>

<p>
<img src="images/cd.JPG" border="0">
</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information about remote administration, see the Supplemental Course Materials CD-ROM (\chapt14\articles\TSRemote.doc) that accompanies this book.
</blockquote></div>
</p>

<A NAME="831"><h3>Application Server</h3></A>
<p>In Application Server mode, you can deploy and manage applications from a central location, saving administrators development and deployment time as well as the time and effort required for maintenance and upgrade. After an application is deployed in Terminal Services, many clients can connect&#8212;through a Remote Access connection, LAN, or WAN, and from many different types of clients.</p>

<p>You can install applications directly at the Terminal server, or you can use remote installation. For example, you can use Group Policy and Active Directory services to publish Windows Installer application packages to a Terminal server or a group of Terminal servers. Applications can be installed only by an Administrator on a per server basis and only if the appropriate Group Policy setting is enabled.</p>

<p>Client licensing is required when deploying a Terminal server as an application server. Each client computer, regardless of the protocol used to connect to Terminal server, must have the Terminal Services Client Access License as well as the Windows 2000 Client Access License.</p>

<p>
<img src="images/cd.JPG" border="0">
</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For information about optimizing applications for Windows 2000 Terminal Services, see the Supplemental Course Materials CD-ROM (\chapt14\articles\TSAppDev.doc) that accompanies this book.
</blockquote></div>
</p>

<A NAME="832"><h2>Tools for Administration</h2></A>
<p>To help you install Terminal Services for Windows 2000, additional administration tools are added to the Administrative Tools folder, including Terminal Services Client Creator, Terminal Services Manager, Terminal Services Configuration, and Terminal Services Licensing.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Terminal Services Licensing is installed only if Application Server mode is selected or if Adminpak.msi is installed.
</blockquote></div>
</p>

<A NAME="833"><h3>Terminal Services Client Creator</h3></A>
<p>Use this tool to create floppy disks for installing the Terminal Services Client software on Windows for Workgroups, Windows 95, Windows 98, and Windows NT platforms.</p>

<A NAME="834"><h3>Terminal Services Manager</h3></A>
<p>With this tool, you can manage all Windows 2000 servers running Terminal Services. Administrators can view current users, servers, and processes. Additionally, administrators can send messages to specific users, use the Remote Control feature, and terminate processes. Figure 14.20 shows the Terminal Services Manager console running inside a terminal services session.</p>

<p>
<A HREF="javascript:fullSize('f14xx20x.htm')"> <img src="images/f14xx20.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 14.20</b> <i>Running Terminal Services Manager to manage Terminal Services running on Server01</i><!--/caption-->
</p>

<A NAME="835"><h3>Terminal Services Configuration</h3></A>
<p>This tool allows you to manage your Remote Desktop Protocol (RDP) configuration. Modifying options in this tool are global, unless you choose to inherit information from the same options located in the user configuration. Available options include setting connection encryption, logon settings, time-outs, initial programs run on successful logon, remote control options, Windows printer mapping, LPT port mapping, clipboard mapping, and applying these options to a specific LAN adapter.</p>

<A NAME="836"><h3>Terminal Services Licensing</h3></A>
<p>With this tool, you store and track Windows 2000 Terminal Services client access licenses. It can be installed either during installation of Terminal Services or later. When clients log on to Terminal Services, Terminal Services validates the client license. If a client does not have a license or requires a replacement license, Terminal Services requests one from the license server. The license server provides a license from its pool of available licenses, and Terminal Services passes the license to the client. If there are no available licenses, the license server grants a temporary license for the client. After it is granted, each client license is associated with a particular computer or terminal.</p>

<p>
<img src="images/cd.JPG" border="0">
</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information about Terminal Services administration tools, see the Supplemental Course Materials CD-ROM (\chapt14\articles\TSsol.doc) that accompanies this book.
</blockquote></div>
</p>

<A NAME="837"><h2>Terminal Services Licensing Components</h2></A>
<p>Terminal Services has its own method for licensing clients that log on to Terminal servers. This method is separate from the licensing method for Windows 2000 Server clients. Terminal Services licensing includes four components: the Microsoft Clearinghouse, a license server, a Terminal server, and client licenses.</p>

<A NAME="838"><h3>Microsoft Clearinghouse</h3></A>
<p>The Microsoft Clearinghouse is the database that Microsoft maintains to activate license servers and to issue client license key packs to the license servers that request them. The Clearinghouse stores information about all activated license servers and client license key packs that have been issued. You can access the Clearinghouse through the Licensing wizard in the Terminal Services Licensing snap-in.</p>

<A NAME="839"><h3>License Server</h3></A>
<p>A license server stores all Terminal Services client licenses that have been installed for a Terminal server and tracks the licenses that have been issued to client computers or terminals. A Terminal server must be able to connect to an activated license server before clients can be issued licenses. One activated license server can serve multiple Terminal servers.</p>

<A NAME="840"><h3>Terminal Server</h3></A>
<p>A Terminal server is the computer on which Terminal Services is enabled and running. It provides clients access to Windows-based applications running entirely on the server and supports multiple client sessions on the server. When clients log on to a Terminal server, the server validates the client license. If a client does not have a license, the Terminal server requests one for the client from the license server.</p>

<A NAME="841"><h3>Client Licenses</h3></A>
<p>Each client computer or terminal that connects to a Terminal server must have a valid client license. The client license is stored locally and presented to the Terminal server each time the client connects to the server. The server validates the license, and then allows the client to connect.</p>

<p>
<img src="images/cd.JPG" border="0">
</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For more information about Terminal Services licensing, see the Supplemental Course Materials CD-ROM (\chapt14\articles\TSLicensing.doc) that accompanies this book.</blockquote></div>
</p>

<A NAME="842"><h2>Administering the License Server</h2></A>
<p>Deploying Terminal Services license server includes setting up the license server, enabling the server, activating the server, and installing the licenses.</p>

<A NAME="843"><h3>Setting Up a License Server</h3></A>
<p>A license server is required by Terminal Services when running in Application Server mode. The Terminal Services Licensing service is a low-impact service that stores the client licenses that have been issued for a Terminal server and tracks the licenses that have been issued to client computers or terminals.</p>

<p>The license server must be activated through the Microsoft Clearinghouse and loaded with Client Access Licenses for distribution from the Clearinghouse. The license server is accessed by the Terminal servers only to issue a new license, and need only be administered to obtain licenses from the Clearinghouse.</p>

<A NAME="844"><h3>Enabling a License Server</h3></A>
<p>You can enable the Terminal Services Licensing service on your computer when you run Windows 2000 Server Setup. In a production environment it is recommended that you enable Terminal Services on a member server or stand-alone server, and that you install the license server on a different computer. Terminal Services is resource intensive.</p>

<p>There are two types of license servers: a domain license server and an enterprise license server. Before installing the license server, consider which of the following two types of license servers you require:</p>

<ul>
<p><li><b>Domain license server</b> Appropriate if you want to maintain a separate license server for each domain. If you have workgroups or Windows NT 4.0 domains, a domain license server is the only type that you can install. Terminal servers can access domain license servers only if they are in the same domain as the license server. By default, a license server is installed as a domain license server.</li></p>

<p><li><b>Enterprise license server</b> Can serve Terminal servers in any domain within a site, but the domain must be a Windows 2000 domain. It can serve only Terminal servers in the same site. This type of license server is appropriate if you have many domains. Enterprise license servers can only be installed by using Add/Remove Programs. They cannot be installed during Windows 2000 Setup.</li></p>
</ul>

<p>When deciding where on your physical network to deploy your license server, consider how a Terminal server discovers and communicates with a license server. Upon enabling Terminal Services, the Terminal server begins polling the domain and Active Directory services looking for a license server. (In a workgroup environment, the Terminal server broadcasts to all the servers in the workgroup on the same subnet.)</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
In Windows 2000 domains, the domain license server must be installed on a domain controller. In workgroups or Windows NT 4.0 domains, the domain license server can be installed on any server. If you are planning to eventually migrate from a Workgroup or Windows NT 4.0 domain to a Windows 2000 domain, you might want to install the license server on a computer that can be promoted to a Windows 2000 domain controller.
</blockquote></div>
</p>

<p>To activate the license server quickly and to access the Microsoft Clearinghouse through the Internet, install the server on a computer that has Internet access.</p>

<p>You must enable a Windows 2000 license server within 90 days of enabling Windows 2000 Terminal Services. If you have not enabled the license service when this period ends, your Windows 2000 Terminal Services will fail to operate.</p>

<A NAME="845"><h3>Activating a License Server</h3></A>
<p>A license server must be activated in order to identify the server and allow it to issue client licenses to your Terminal servers. You can activate a license server by using the Licensing wizard.</p>

<p>There are four methods to activate your license server:</p>

<ul>
<p><li>Internet</li></p>

<p><li>Web-based</li></p>

<p><li>Fax</li></p>

<p><li>Telephone</li></p>
</ul>

<p>If the computer running the Terminal Services Licensing snap-in is connected to the Internet, the Internet activation method is the quickest and easiest method. The Licensing wizard directs you to the secure Microsoft Internet site where license servers are activated. When you activate the license server, Microsoft provides the server with a digital certificate that validates server ownership and identity. Using this certificate, a license server can make subsequent transactions with Microsoft and receive client access licenses for your Terminal servers.</p>

<p>If your license server does not have Internet connectivity but you do have the ability to access the World Wide Web from a browser on another computer, you can activate your license server by means of the Web-based activation method. The Licensing wizard directs you to the secure Microsoft Web site to obtain a certificate for the license server.</p>

<p>Alternate methods for activating a license server include faxing your information to or calling the Customer Support Center (CSC) nearest you. The Licensing wizard also guides you through these steps. You can locate the appropriate telephone or fax number to call by using the Licensing wizard. If you use the fax activation method, your confirmed request is returned by fax from Microsoft. If you use the telephone activation method, your request is completed with a customer service representative over the telephone.</p>

<p>You are required to activate a license server only once. While waiting to complete the activation process, your license server can issue temporary licenses for clients that allow them to use Terminal servers for up to 90 days.</p>

<p>The digital certificate that uniquely identifies your license server is stored in the form of a License Server ID. Place a copy of this number in a safe location. To view this number after your license server has been activated, highlight the license server and select Properties from the View menu. Set your communication method to World Wide Web and click OK. Then select Install Licenses from the Action menu and click Next. The License Server ID is listed in the center of the Licensing Wizard screen.</p>

<A NAME="846"><h3>Installing Licenses</h3></A>
<p>Terminal Services licenses must be installed on your license server in order for the Internet Connector setting to be enabled or for non-Windows 2000 clients to permanently access a Windows 2000 Terminal server. To obtain Windows 2000 Terminal Services Client Access licenses or Internet Connector licenses, purchase them through your standard software procurement method. After you purchase them you can then install the licenses by using the Licensing wizard.</p>

<p>After you have installed your licenses, your license server can begin deploying the licenses. Clients with 90-day temporary licenses will be upgraded to a Terminal Services Client Access license the next time they log on (unless the number of client access licenses installed has exceeded by the number of outstanding temporary licenses).</p>

<A NAME="847"><h2>Deploying to Client Computers</h2></A>
<p>Client computers or terminals connect to a Terminal server by using a small client program installed on disk or in firmware. The choice of which client platform to use depends on the current installed base and individual user need. At a minimum, ensure that every client computer or terminal that you expect to connect to a Terminal server is physically capable of hosting the client software and connecting over the network.</p>

<p>Windows-based client computers connecting to Terminal Services should have at least an 80386 microprocessor running at 33 MHz (though a 486/66 is recommended), a 16-bit VGA video card, and the Microsoft TCP/IP stack. The Terminal Services client runs on Windows for Workgroups 3.11, Windows 95, Windows 98, and Windows NT 3.51 or later, and Windows 2000.</p>

<p>The Terminal Services client takes up only about 500 KB of disk space and typically uses approximately 4 MB of RAM when running. If client bitmap caching is enabled, another 10 MB of disk space might be used. For best performance, a computer running the Terminal Services client should have a total of 8 MB of physical RAM or more under Windows for Workgroups 3.11 or Windows 95, 24 MB or more for Windows 98, and 32 MB or more for Windows 2000.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
A Terminal Services client for Windows CE devices can be found on the Windows 2000 Server installation CD-ROM in the \Valueadd\msft\mgmt\mstsc_hpc folder.</blockquote></div>
</p>

<p>The RDP client software is installed by default as a subcomponent of Terminal Services. The various clients are installed in the directory %systemroot%\system32\clients\tsclient</p>

<p>There are two ways to deploy the client:</p>

<ul>
<p><li>Create a file share to do the installation over the network.</li></p>

<p><li>Select Terminal Services Client Creator from the Administrative Tools menu, and make a client image that can be installed with a floppy disk.</li></p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The Terminal Services client requires TCP/IP to connect to the server, but Terminal Services itself can use IPX to gain access to Novell servers if necessary.
</blockquote></div>
</p>

<A NAME="848"><h3>Client Configurations</h3></A>
<p>You can optimize Terminal Services by following these recommendations:</p>

<ul>
<p><li>Disable the Active Desktop.</li></p>

<p><li>Disable smooth scrolling.</li></p>

<p><li>Minimize the use of graphics and animation, including animated graphics, screen savers, blinking cursors, and the animated Microsoft Office Assistant. Place shortcuts on the desktop and keep the Programs submenu as flat as possible. Avoid using bitmaps in wallpaper; in Display Properties set Wallpaper to None on the Background tab, and select a single color from the Appearance tab.</li></p>

<p><li>Enable file sharing on client computers and share drives with easily identifiable names like &quot;drivec.&quot; Be aware of the security implications involved.</li></p>

<p><li>Avoid the use of MS-DOS or Win16 (16-bit) applications where possible.</li></p>

<p><li>Configure the Terminal server to return the user's logon name rather than the computer name to applications that make use of a NetBIOS function that calls for the computer name.</li></p>

<p><li>Train users to use Terminal Services hot key sequences. There are a few important differences in the hot key sequences used in a Terminal Services client session than in a Windows 2000 session.</li></p>
</ul>

<A NAME="849"><h2>Upgrading to Terminal Services</h2></A>
<p>The approach you take to upgrade to Terminal Services depends upon your existing Terminal Services setup.</p>

<A NAME="850"><h3>WinFrame with or without MetaFrame</h3></A>
<p>There is no direct upgrade path from WinFrame to Terminal Services. In this case you first have to upgrade to Microsoft Terminal Server 4.0 and then upgrade to Windows 2000.</p>

<A NAME="851"><h3>Terminal Server 4.0 without MetaFrame</h3></A>
<p>With Terminal Server 4.0 installed, there is a direct upgrade path to Terminal Services. When you install Windows 2000, the server recognizes the Terminal Server 4.0 edition, automatically performs the upgrade, and automatically enables Terminal Services in Application Server mode. Note that you might need to reinstall existing applications if you enable Terminal Services in Application Server mode.</p>

<A NAME="852"><h3>Terminal Server 4.0 with MetaFrame</h3></A>
<p>Upgrading from Terminal Services 4.0 with MetaFrame is similar to upgrading from Terminal Server 4.0, but first you need to upgrade to the MetaFrame version for Windows 2000. After MetaFrame is upgraded, you can follow the same procedure for upgrading from Terminal Server 4.0 without MetaFrame.</p>

<A NAME="853"><h3>Windows NT without Terminal Services</h3></A>
<p>When you install Windows 2000, select Terminal Services in Remote Administration or Application mode, to enable Terminal Services.</p>

<A NAME="854"><h2>Installing and Configuring Applications</h2></A>
<p>A Windows 2000 server that is configured to run Terminal Services in Application Server mode provides multiple concurrent user connections to any number of applications.</p>

<p>It is recommended that applications be added or removed by using the Add/Remove Programs function under Control Panel. This process automatically manages the Terminal Services installation requirements. It is also possible to install the application directly by putting the server into Install mode.</p>

<p>To put the Terminal Server in Install mode, type <b>change user /install</b> . After the software installation is complete, type <b>change user /execute</b> to return the Terminal Server to execute mode.</p>

<p>The change user commands are not necessary when using Add/Remove Programs because Add/Remove Programs takes care of this process in the background. Add/Remove Programs is preferred because there is always the possibility of error or omission when using the command lines. If an application is installed without using Add/Remove Programs and without using the command line to set the Install mode, the application should be removed and reinstalled.</p>

<p>Only administrators are allowed to install applications on a Terminal Services application server.</p>

<A NAME="855"><h3>Deploying Applications through Group Policy</h3></A>
<p>Deploying applications through Active Directory services and Group Policy by using Windows Installer is a very flexible application deployment method. It allows applications to be installed and managed in a number of different ways. The three main ways you can deploy applications when using Windows Installer:</p>

<ul>
<p><li>Install on a local computer by the user.</li></p>

<p><li>Assign by the system administrator from the domain controller to a user or a computer.</li></p>

<p><li>Publish by the system administrator from the domain controller for a user.</li></p>
</ul>

<p>Before an application can be installed using Windows Installer, an .MSI installation package must be available for the application.</p>

<A NAME="856"><h3>Deploying Applications from a Domain Controller</h3></A>
<p>To deploy an application from a domain controller, a system administrator needs to assign a .MSI-based application to a computer. Application servers cannot assign or publish applications to users.</p>

<p>Transform files are required if the original application installation package did not install all of the necessary components of the application to the local disk. Transform files allow you to select what, if anything, needs to be installed during the installation.</p>

<p>A system administrator can also install an application from a remote session or the console of an application server. A typical installation is initiated by using the following command:</p>

<p>
<table cellpadding=5 width="95%"><tr><td><pre>
Msiexec/I <i>ApplicationName</i>.MSI 
TRANSFORMS=<i>TransformFileName</i>.MST ALLUSERS=1
</pre></td></tr></table>
</p>

<p>The installation of an application in a multi-user environment is quite different from an installation to an individual user. Application server software installation must not jeopardize the system that is running, and the installation must be configured to allow concurrent users. For these reasons, only administrators can install applications, and users are not able to install anything.</p>

<p>It is the responsibility of the system administrator to decide which applications are needed and to ensure that applications are locally installed and available before allowing remote user connections.</p>

<p>
<img src="images/practic.JPG" border="0">
</p>

<A NAME="857"><h3>Exercise 3: Installing and Configuring Terminal Services and Terminal Services Licensing</h3></A>
<p>In this exercise you install Windows 2000 Terminal Services, and then run remote administration from Server02 to Server01. Next, you install Terminal Services Licensing and then establish a terminal session from Server02 to Server01.</p>

<p><li><b>Procedure 1: Installing Terminal Services and running Remote Administration</b></li></p>

<p>In this procedure, you install Terminal Services to run in Remote Administration mode on Server01. You then run a remote administration session from Server02. Make sure that the Windows 2000 Server installation CD-ROM is inserted in the CD-ROM drive on Server01.</p>

<ol>
<p><li>Log on to Server01 as Administrator with a password of &quot;password.&quot;</li></p>

<p><li>Click the Start menu, point to Settings and click Control Panel.</li></p>

<p><li>In Control Panel, double-click Add/Remove Programs.</li></p>

<p>The Add/Remove Programs dialog box appears.</p>

<p><li>In the left frame, click Add/Remove Windows Components.</li></p>

<p>After a few moments, the Windows Components wizard appears.</p>

<p><li>Scroll down and select the Terminal Services check box and click Next.</li></p>

<p>The Terminal Services Setup screen appears.</p>

<p><li>Read the information on this screen, verify that the Remote Administration Mode radio button is selected and then click Next.</li></p>

<p>The Configuring Components screen appears as Windows 2000 configures and installs components. After a few minutes, the Completing the Windows Components Wizard screen appears.</p>

<p><li>Click Finish.</li></p>

<p>The Add/Remove Programs dialog box appears.</p>

<p><li>Click Close and then close Control Panel.</li></p>

<p>A System Setting Change message box appears, informing you that you must restart the computer before the settings will take effect.</p>

<p><li>Click Yes to restart the computer.</li></p>

<p><li>After Server01 restarts, do not log on. You will log on from Server02 using Terminal Services remote administration.</li></p>

<p><li>From Server02, logon to Server01 as Administrator with a password of &quot;password.&quot; Make sure you are logging on to the MICROSOFT domain.</li></p>

<p><li>Click the Start menu and then click Run.</li></p>

<p>The Run dialog box appears.</p>

<p><li>In the Open text box, type <b>\\server01\c$\Program Files\terminal services client</b> and then click OK.</li></p>

<p>The Terminal Services Client window appears.</p>

<p><li>Double-click the Conman icon.</li></p>

<p>Client Connection Manager appears.</p>

<p><li>Click the first toolbar icon.</li></p>

<p>The Client Connection Manager wizard starts.</p>

<p><li>Click Next.</li></p>

<p>The Create A Connection screen appears.</p>

<p><li>In the Connection Name text box, type <b>Server01 Remote Administration</b>.</li></p>

<p><li>In the Server name or IP Address text box, type <b>Server01</b> and click Next.</li></p>

<p>The Automatic Logon screen appears.</p>

<p><li>Click the Logon Automatically With This Information check box.</li></p>

<p><li>In the User Name text box, type <b>administrator</b>.</li></p>

<p><li>In the Password text box, type <b>password</b>.</li></p>

<p><li>In the Domain text box, type <b>microsoft</b> and click Next.</li></p>

<p>The Screen options screen appears.</p>

<p><li>Select a resolution that the monitor on Server02 can support. If you don't know what resolution it supports, choose the 640 x 480 radio button.</li></p>

<p><li>Click Next.</li></p>

<p>The Connection Properties screen appears.</p>

<p><li>Click the Enable Data Compression and Cache Bitmaps check boxes and click Next.</li></p>

<p>The Starting A Program screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Icon And Program Group screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Completing The Client Connection Manager Wizard screen appears.</p>

<p><li>Click Finish.</li></p>

<p>The Client Connection Manager appears with the new connection you created.</p>

<p><li>Double-click the Server01 Remote Administration icon.</li></p>

<p>A Connecting box appears. Then a terminal window opens whose title bar is SERVER01 - Terminal Services Client (Server01 Remote Administration).</p>

<p><li>In the Log On To Windows dialog box, type <b>password</b> and click OK.</li></p>

<p>You are now able to remotely administer Server01 from Server02. Notice that on the Server01 monitor, the computer is not logged on but you are logged on to Server01 from Server02.</p>

<p><li>Close the SERVER01 - Terminal Services Client (Server01 Remote Administration) terminal window appearing on Server02.</li></p>

<p>A Disconnect Windows Session message box appears stating that you are about to disconnect from Server01 but that you can return to this session later and continue to run programs started in this terminal session.</p>

<p><li>Click OK.</li></p>

<p><li>Close the Client Connection Manager and close the Terminal Services Client window.</li></p>
</ol>

<p><li><b>Procedure 2: Installing Terminal Services Licensing</b></li></p>

<p>In this procedure, you install Terminal Services Licensing on Server01 to serve the license requirements of Application Server mode. Make sure that the Windows 2000 Server installation CD-ROM is inserted in the CD-ROM drive on Server01.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
In a production environment, it is advisable to install licensing services on a computer that is not also running Terminal services in Application Server mode.
</blockquote></div>
</p>

<ol>
<p><li>Log on to Server01 as Administrator with a password of <b>password</b> .</li></p>

<p><li>Click the Start menu, point to Settings and then click Control Panel.</li></p>

<p><li>In Control Panel, double-click Add/Remove Programs.</li></p>

<p>The Add/Remove Programs dialog box appears.</p>

<p><li>In the left frame, click Add/Remove Windows Components.</li></p>

<p>After a few moments, the Windows Components wizard appears.</p>

<p><li>Scroll down and select the Terminal Services Licensing check box and then click Next.</li></p>

<p>The Terminal Services Setup screen appears.</p>

<p><li>Select the Application Server Mode radio button and then click Next.</li></p>


<p>The Terminal Services Setup screen appears and informs you that Windows 2000 Administration Tools may not work properly after the installation of Terminal services in Application Server mode.</p>

<p><li>Click Next.</li></p>

<p>The Terminal Services Licensing Setup screen appears.</p>

<p><li>Click the Your Entire Enterprise radio button.</li></p>

<p>Notice that the license server database will be stored in C:\WINNT\System32\LServer.</p>

<p><li>Click Next.</li></p>

<p>The Configuring Components screen appears as Windows 2000 configures and installs components. After a few minutes, the Completing the Windows Components Wizard screen appears.</p>

<p><li>Click Finish.</li></p>

<p>The Add/Remove Programs dialog box appears.</p>

<p><li>Click Close and then close Control Panel.</li></p>

<p>A System Setting Change message box appears, informing you that you must restart the computer before the settings will take effect.</p>

<p><li>Click Yes to restart the computer.</li></p>

<p><li>Log on to Server01 as Administrator with a password of &quot;password.&quot;</li></p>

<p><li>Click the Start menu, point to Programs, point to Administrative Tools, and then click Terminal Services Licensing.</li></p>

<p>The Terminal Services Licensing snap-in appears and the Terminal Services Licensing Manager status box appears as Terminal services are located. Once Server01 is found, it appears in the details pane with a status of Not Activated.</p>

<p><li>In the details pane, click SERVER01.</li></p>

<p><li>Click the Action menu and then click Activate Server.</li></p>

<p>The Licensing wizard appears.</p>

<p><li>Click Next.</li></p>

<p>The Connection Method screen appears.</p>

<p><li>In the Connection Method drop-down list box, select Telephone and then click Next.</li></p>

<p>The Country/Region Selection screen appears.</p>

<p><li>Select a country and then click Next.</li></p>

<p><li>Without entering a license server ID, click Next.</li></p>

<p>A Licensing Wizard message box appears explaining that the license server ID entered is not valid or was not entered.</p>

<p><li>Click OK.</li></p>

<p><li>On the License Server Activation screen, click Cancel.</li></p>

<p><li>Close the Terminal Services Licensing snap-in.</li></p> 

<p>The Terminal Services Licensing component is installed and you will be able to use Terminal Services in Application Server mode for 90 days. Before 90 days have passed, you must activate the server using the Terminal Services Licensing snap-in and information provided to you by Microsoft Corporation.</p>
</ol>

<p><li><b>Procedure 3: Preparing an application for Terminal Services Application mode operation</b></li></p>

<p>In this procedure, you uninstall the Windows 2000 Administration Tools and then reinstall them to ensure that they run properly from a terminal session. Make sure that the Windows 2000 Server installation CD-ROM is inserted in the CD-ROM drive on Server01 and that you are logged on as Administrator on Server01.</p>

<ol>
<p><li>On Server01, click the Start menu, point to Settings and then click Control Panel.</li></p>

<p><li>In Control Panel, double-click Add/Remove Programs.</li></p>

<p>The Add/Remove Programs dialog box appears.</p>

<p><li>In the Currently Installed Programs box, click Windows 2000 Administration Tools and then click the Remove button.</li></p>

<p>The Add/Remove Programs message box appears asking you if you want to remove the Windows 2000 Administration Tools from your computer.</p>

<p><li>Click Yes.</li></p>

<p>A Windows Installer status box appears and then the Windows 2000 Administration Tools status box appears as the tools are removed.</p>

<p>The Add/Remove Programs dialog box no longer contains the Windows 2000 Administration Tools. </p>

<p><li>In the left frame, click Add New Programs.</li></p>

<p><li>From the main window, click CD or Floppy.</li></p>

<p>The Install Program From Floppy Disk or CD-ROM screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Run Installation Program screen appears.</p>

<p><li>In the Open text box, type <b>&lt;<i>cd-rom</i>&gt;:\i386\adminpak.msi</b> where &lt;<i>cd-rom</i>&gt; is the drive letter of your CD-ROM drive.</li></p>

<p><li>Click Next.</li></p>

<p>The Windows Installer status box appears and then the Windows 2000 Administration Tools Installation status box appears. After a few moments, the Windows 2000 Administration Tools Setup wizard appears.</p>

<p><li>Click Next.</li></p>

<p>The Installation Progress screen appears as installation proceeds.</p>

<p>After a few minutes, the Completing the Windows 2000 Administration Tools Setup wizard appears. </p>

<p><li>Click Finish.</li></p>

<p>The After Installation screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Finish Admin Install screen appears.</p>

<p><li>Read the text on this screen and then click Finish.</li></p>

<p>The Add/Remove Programs dialog box appears.</p>

<p><li>Click the Close button.</li></p>

<p><li>Close Control Panel.</li></p>
</ol>

<p><li><b>Procedure 4: Connecting to Terminal Services in Application mode and running Terminal Services tools</b></li></p>

<p>In this procedure you install the terminal services client on Server02 and then run a terminal screen from Server02 to Server01. Inside the terminal session running on Server02 you monitor the session using tools installed on Server01. Server01 and Server02 should be logged on as Administrator to the MICROSOFT domain.</p>

<ol>
<p><li>On Server01 click the Start menu and then click Run.</li></p>

<p>The Run dialog box appears.</p>

<p><li>In the Open text box, type <b>C:\winnt\system32\clients</b> and then click OK.</li></p>

<p>The Clients window appears.</p>

<p><li>Click the Tsclient folder.</li></p>

<p><li>Click the File menu and then click Sharing.</li></p>

<p>The Tsclient Properties dialog box appears with the Sharing tab active.</p>

<p><li>Click the Share This Folder radio button.</li></p>

<p>Tsclient appears in the Share Name text box.</p>

<p><li>Click OK.</li></p>

<p><li>Close the Clients window.</li></p>

<p><li>On Server02 click the Start menu and then click Run.</li></p>

<p>The Run dialog box appears.</p>

<p><li>In the Open text box, type <b>\\server01\tsclient</b> and then click OK.</li></p>

<p>The Tsclient On Server01 window appears.</p>

<p><li>Double-click the win32 folder.</li></p>

<p><li>Double-click the disks folder.</li></p>

<p><li>Double-click the disk1 folder.</li></p>

<p><li>Double-click the setup icon.</li></p>

<p>The Terminal Services Client Setup screen appears.</p>

<p><li>Click Continue.</li></p>

<p>The Name And Organization Information dialog box appears.</p>

<p><li>Enter your name and then click OK.</li></p>

<p>The Confirm Name And Organization Information message box appears.</p>

<p><li>Click OK.</li></p>

<p>A License Agreement message box appears.</p>

<p><li>Click the I Agree button.</li></p>

<p>The Terminal Services Client Setup dialog box appears.</p>

<p>Notice that the client software will be installed below the Program Files folder.</p>

<p><li>Click the large button to install the Terminal Services Client software.</li></p>

<p>The Terminal Services Client Setup message box appears asking if you want this installation routine to apply to all users of this computer.</p>

<p><li>Click Yes.</li></p>

<p>The installation progresses and then the Terminal Service Client Setup message box appears stating that the installation was successful.</p>

<p><li>Click OK.</li></p>

<p><li>Close the Disk1 window.</li></p>

<p><li>On Server02 click the Start menu, point to Programs, point to Terminal Services Client and then click the Terminal Services Client icon.</li></p>

<p>The Terminal Services Client dialog box appears.</p>

<p><li>In the Server drop-down list box, type <b>Server01</b>.</li></p>

<p><li>Leave the Screen area at 640 x 480, verify that the Enable Disk Compression check box is selected and select the Cache Bitmaps To Disk check box.</li></p>

<p><li>Click the Connect button.</li></p>

<p>The Server01 - Terminal Services Client window appears.</p>

<p><li>In the Log On To Windows dialog box, type <b>Jane_Doe</b> with a password of <b>student</b> and then click OK.</li></p>

<p>Notice that the Jane_Doe personal profile appears which is indicated by the custom color scheme.</p>

<p><li>From within the terminal session, click the Start menu, point to Programs, point to Administrative Tools, and then click Terminal Services Manager.</li></p>

<p>The SERVER01 - Terminal Services Manager snap-in starts inside of the terminal session.</p>

<p><li>In the console tree, click SERVER01.</li></p>

<p><li>In the details pane, click Jane_Doe.</li></p>

<p><li>Click the Actions menu and then click Status.</li></p>

<p>Status information about the Jane_Doe session appears.</p>

<p><li>Click the Close button.</li></p>

<p><li>Click the Actions menu and then click Send Message.</li></p>

<p>The Send Message dialog box appears.</p>

<p><li>In the top Message title box, type <b>Message from the Administrator</b> and in the bottom Message box, type <b>Terminal Services will be shutting down for maintenance in a few minutes. Please close your session.</b></li></p>

<p><li>Click OK.</li></p>

<p>A message box from the Administrator appears in the terminal session.</p>

<p><li>Click OK.</li></p>

<p><li>Close the SERVER01 - Terminal Services Manager snap-in and then close the SERVER01 - Terminal Services Client window.</li></p>

<p>The Disconnect Windows Session message box appears.</p>

<p><li>Read the message and then click OK.</li></p>

<p><li>Shut down Server02 and Server01.</li></p>
</ol>

<A NAME="858"><h2>Lesson Summary</h2></A>
<p>Terminal Services running on a Windows 2000 Server enables all client application execution, data processing, and data storage to occur on the server. It provides remote access to a server desktop through terminal emulation software. You can enable Terminal Services in one of two modes: Remote Administration and Application Server. Remote Administration gives system administrators a powerful method for remotely administering each Windows 2000 server over any TCP/IP connection. In Application Server mode, you can deploy and manage applications from a central location, saving administrators development and deployment time as well as the time and effort required for maintenance and upgrade. Terminal Services licensing includes four components: the Microsoft Clearinghouse, a license server, a Terminal server, and client licenses. Deploying Terminal Services license server includes setting up the license server, enabling the server, activating the server, and installing the licenses. Every client computer or terminal that you expect to connect to a Terminal server must be physically capable of hosting the client software and connecting over the network. A Windows 2000 server that is configured to run Terminal Services in Application Server mode provides multiple concurrent user connections to any number of applications. You can deploy applications through Active Directory services and Group Policy, and you can deploy applications from a domain controller. When you install Terminal Services for Windows 2000, additional administration tools are added to the Administrative Tools folder, including Terminal Services Client Creator, Terminal Services Manager, Terminal Services Configuration, and Terminal Services Licensing.</p>

</BODY>
</HTML>



