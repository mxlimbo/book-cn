<HTML>
<HEAD>
<TITLE>Lesson 3: Remote Access</TITLE>
<link rel="STYLESHEET" type="text/css" href="mmserver.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch10c.htm", "ch10e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="533"><h1>Lesson 3: Remote Access</h1></A>
<p>Windows 2000 remote access technology allows remote clients to connect to corporate networks or the Internet. This lesson provides an overview of remote access and discusses dial-up remote access connections, remote access security, and managing remote access. This lesson focuses on the Remote Access Service part of RRAS. Hereafter, the acronym RAS will be used to refer to the Remote Access Service component of RRAS.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Describe how remote access works, including dial-up remote access connections and remote access security</li></p>

<p><li>Manage remote access, including the management of users, addresses, access, and authentication</li></p>
</ul>

<b>Estimated lesson time: 35 minutes</b> 
</blockquote></div>
</p>

<A NAME="534"><h2>Overview of Remote Access</h2></A>
<p>In Windows 2000 RAS, remote access clients are either connected to only the remote access server's resources (point-to-point remote access connectivity), or they are connected to the RAS server's resources and the resources in the network to which the remote access server is attached (point-to-LAN remote access connectivity). The latter type of connection type allows remote access clients to access resources as if they were physically attached to the network.</p>

<p>A Windows 2000 remote access server provides two remote access connection methods:</p>

<ul>
<p><li><b>Dial-up remote access</b> With dial-up remote access, a remote access client uses the telecommunications infrastructure to create a temporary physical circuit or a virtual circuit to a port on a remote access server. Once the physical or virtual circuit is created, the rest of the connection parameters can be negotiated.</li></p>

<p><li><b>VPN remote access</b> With virtual private network remote access, a VPN client uses an IP internetwork to create a virtual point-to-point connection with a RAS server acting as the VPN server. Once the virtual point-to-point connection is created, the rest of the connection parameters can be negotiated.</li></p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
This lesson focuses primarily on dial-up remote access; however, many topics also apply to VPN remote access. For a complete understanding of VPNs, read this lesson and then 
review Lesson 4, &quot;<a href="ch10e.htm#555">Virtual Private Networks</a>.&quot;</blockquote></div>
</p>

<A NAME="535"><h2>Dial-Up Remote Access Connections</h2></A>
<p>A dial-up remote access connection consists of a remote access client, a remote access server, and a WAN infrastructure (Figure 10.3).</p>

<p>
<A HREF="javascript:fullSize('f10xx03gx.htm')"> <img src="images/f10xx03g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.3</b> <i>Elements of a dial-up remote access connection</i><!--/caption-->
</p>

<A NAME="536"><h3>Remote Access Client</h3></A>
<p>Windows 2000, Windows NT 3.5 or later, Windows 98, Windows 95, Windows for Workgroups, MS-DOS, and Microsoft LAN Manager remote access clients can all connect to a Windows 2000 remote access server. Almost any third-party Point-to-Point Protocol (PPP) remote access clients&#8212;including UNIX and Apple Macintosh clients&#8212;can connect to a Windows 2000 remote access server.</p>

<p>The Microsoft remote access client is also capable of dialing into a Serial Line Interface Protocol (SLIP) server. SLIP is a legacy dial-in protocol that does not provide the security, performance, or reliability of PPP. A Windows 2000 RAS server does not support SLIP dial-up (dial-in) connections.</p>

<A NAME="537"><h3>Remote Access Service Server</h3></A>
<p>The Windows 2000 remote access server accepts dial-up connections and forwards packets between remote access clients and the network to which the remote access server is attached.</p>

<A NAME="538"><h3>Dial-Up Equipment and WAN Infrastructure</h3></A>
<p>The physical or logical connection between the remote access server and the remote access client is facilitated by dial-up equipment installed at the remote access client, the remote access server, and the telecommunications infrastructure. The nature of the dial-up equipment and telecommunications infrastructure varies depending on the type of connection being made.</p>

<p><b>Public Switched Telephone Network</b></p>

<p>The Public Switched Telephone Network (PSTN), also known as Plain Old Telephone Service (POTS), is the analog telephone system designed to carry the minimal frequencies to distinguish human voices. Because the PSTN was not designed for data transmissions, there are limits to the maximum bit rate that a PSTN connection can support. Dial-up equipment consists of an analog modem for the remote access client and the remote access server. For large organizations, the remote access server is attached to a modem bank containing up to hundreds of modems. With analog modems at both the remote access server and the remote access client, the maximum bit rate supported by PSTN connections is 33,600 bits per second, or 33.6 kilobits per second (Kbps).</p>

<p>Figure 10.4 illustrates a PSTN connection.</p>

<p>
<A HREF="javascript:fullSize('f10xx04gx.htm')"> <img src="images/f10xx04g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.4</b> <i>Dial-up equipment and WAN infrastructure for PSTN connections</i><!--/caption-->
</p>

<p><b>Digital Links and V.90</b></p>

<p>The maximum bit rate of the PSTN is a function of the range of frequencies passed by PSTN switches and the signal-to-noise ratio of the connection. The modern-day analog telephone system is analog only on the <i>local loop,</i> the set of wires that connects the customer to the central office PSTN switch. Once the analog signal reaches the PSTN switch, it is converted to a digital signal. The analog-to-digital conversion introduces noise on the connection known as <i>quantization</i> noise.</p>

<p>When a RAS server is connected to a central office through a digital switch based on T-Carrier or ISDN rather than an analog PSTN switch, there is no analog-to-digital conversion when the remote access server sends information to the remote access client. As a result, there is no quantization noise in the downstream path to the remote access client, and therefore, there is a higher signal-to-noise ratio and a higher maximum bit rate.</p>

<p>With this new technology, called V.90, remote access clients can send data at 33.6 Kbps and receive data at 56 Kbps. In North America, the maximum receive bit rate is 53 Kbps due to Federal Communications Commission (FCC) rules.</p>

<p>To obtain V.90 speeds, the following conditions must be met:</p>

<ul>
<p><li>The remote access client must be using a V.90 modem.</li></p>

<p><li>The RAS server must be using a V.90 digital switch and must be using a digita link to connect to the PSTN, such as T-Carrier or ISDN.</li></p>

<p><li>There cannot be any analog-to-digital conversions in the path from the RAS server to the remote access client.</li></p>
</ul>

<p>Figure 10.5 illustrates a V.90-based PSTN connection.</p>

<p>
<A HREF="javascript:fullSize('f10xx05gx.htm')"> <img src="images/f10xx05g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.5</b> <i>Dial-up equipment and WAN infrastructure for V.90 connections</i><!--/caption-->
</p>

<p><b>Integrated Services Digital Network</b></p>

<p>ISDN is a set of international specifications for digital replacement of the PSTN. ISDN provides a single digital network to handle voice, data, fax, and other services over existing local loop wiring. ISDN behaves like an analog telephone line except that it is a digital technology at higher data rates with a much lower connection time. ISDN offers multiple channels; each channel operates at 64 Kbps and because the network is digital end-to-end there are no analog-to-digital conversions.</p>

<p>Dial-up equipment consists of an ISDN adapter for the remote access client and the remote access server. Remote access clients typically use Basic Rate ISDN (BRI) with two 64-Kbps channels, and large organizations typically use Primary Rate ISDN (PRI) with 23 64-Kbps channels. Figure 10.6 illustrates an ISDN connection.</p>

<p>
<A HREF="javascript:fullSize('f10xx06gx.htm')"> <img src="images/f10xx06g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.6</b> <i>Dial-up equipment and WAN infrastructure for ISDN connections</i><!--/caption-->
</p>

<p><b>X.25</b></p>

<p>X.25 is an international standard for sending data across public packet switching networks. Windows 2000 remote access supports X.25 in two ways:</p>

<ul>
<p><li>The remote access client supports the use of X.25 smart cards, which can connect directly to the X.25 data network and use the X.25 protocol to establish connections and send and receive data. The remote access client also supports dialing into a packet assembler/disassembler (PAD) of an X.25 carrier by using an analog modem.</li></p>

<p><li>The Windows 2000 remote access server supports only direct connections to X.25 networks by using an X.25 smart card.</li></p>
</ul>

<p>For more information about the configuration of X.25 and PADs, see Windows 2000 Server Help. Figure 10.7 illustrates an X.25 connection.</p>

<p>
<A HREF="javascript:fullSize('f10xx07gx.htm')"> <img src="images/f10xx07g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.7</b> <i>Dial-up equipment and WAN infrastructure for X.25 connections</i><!--/caption-->
</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
X.25 smart cards are adapters that use the X.25 protocol and can directly connect to an X.25 public data network. X.25 smart cards are not related to smart cards used for authentication and secure communications.</blockquote></div>
</p>

<p><b>ATM over ADSL</b></p>

<p>Asymmetric Digital Subscriber Line (ADSL) is a new local loop technology for small business and residential customers. Although ADSL provides higher bit rates than PSTN and ISDN connections, the bit rate is not the same in the upstream and downstream directions. Typical ADSL connections offer 64 Kbps from the customer and 1.544 megabits per second (Mbps) to the customer. The asymmetric nature of the connection fits well with typical Internet use. Most Internet users receive a lot more information than they send.</p>

<p>ADSL equipment can appear to Windows 2000 as either an Ethernet interface or a dial-up interface. When an ADSL adapter appears as an Ethernet interface, the ADSL connection operates in the same way as an Ethernet connection to the Internet.</p>

<p>When an ADSL adapter appears as a dial-up interface, ADSL provides a physical connection, and the individual LAN protocol packets are sent by using Asynchronous Transfer Mode (ATM). An ATM adapter with an ADSL port is installed in both the remote access client and remote access server.</p>

<p>Figure 10.8 illustrates an ATM over ADSL connection.</p>

<p>
<A HREF="javascript:fullSize('f10xx08gx.htm')"> <img src="images/f10xx08g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.8</b> <i>Dial-up equipment and WAN infrastructure for ATM over ADSL connections</i><!--/caption-->
</p>

<A NAME="539"><h3>Remote Access Protocols</h3></A>
<p>Remote access protocols control the establishment of connections and the transmission of data over WAN links. The operating system and LAN protocols used on remote access clients and servers dictate which remote access protocol your clients can use.</p>

<p>There are three types of remote access protocols supported by Windows 2000 remote access:</p>

<ul>
<p><li>Point-to-Point Protocol (PPP) is an industry-standard set of protocols providing the best security, multi-protocol support, and interoperability.</li></p>

<p><li>Serial Line Internet Protocol (SLIP) is used by older remote access servers. A Windows 2000 RAS server does not support SLIP dial-up connections.</li></p>

<p><li>Microsoft remote access protocol, also known as Asynchronous NetBEUI (AsyBEUI), is a remote access protocol used by legacy remote access clients running Microsoft operating systems, such as Windows NT 3.1, Windows for Workgroups, MS-DOS, and LAN Manager.</li></p>
</ul>

<A NAME="540"><h3>LAN Protocols</h3></A>
<p>LAN protocols are the protocols used by the remote access client to access resources on the network connected to the RAS server. Windows 2000 remote access supports TCP/IP, IPX, AppleTalk, and NetBEUI.</p>

<A NAME="541"><h2>Remote Access Security</h2></A>
<p>Windows 2000 remote access offers a wide range of security features, including secure user authentication, mutual authentication, data encryption, callback, caller ID, and remote access account lockout.</p>

<A NAME="542"><h3>Secure User Authentication</h3></A>
<p>Secure user authentication is obtained through the encrypted exchange of user credentials. This is possible through the use of the PPP remote access protocol along with one of the following authentication protocols:</p>

<ul>
<p><li>Extensible Authentication Protocol (EAP)</li></p>

<p><li>Microsoft Challenge Handshake Authentication Protocol (MS-CHAP) version 1 and version 2</li></p>

<p><li>Challenge Handshake Authentication Protocol (CHAP)</li></p>

<p><li>Shiva Password Authentication Protocol (SPAP)</li></p>
</ul>

<p>The RAS server can be configured to require a secure authentication method. If the remote access client cannot perform the required secure authentication, the connection is denied.</p>

<A NAME="543"><h3>Mutual Authentication</h3></A>
<p>Mutual authentication is obtained by authenticating both ends of the connection through the encrypted exchange of user credentials. This is possible through the use of PPP along with EAP-Transport Level Security (EAP-TLS) or MS-CHAP version 2. During mutual authentication, the remote access client authenticates itself to the RAS server, and then the RAS server authenticates itself to the remote access client.</p>

<p>It is possible for a RAS server not to request authentication from the remote access client. However, in the case of a Windows 2000 remote access client configured for only EAP-TLS or MS-CHAP version 2, the remote access client forces the mutual authentication of the client and server. If the RAS server does not respond to the authentication request, the connection is terminated by the client.</p>

<A NAME="544"><h3>Data Encryption</h3></A>
<p>Data encryption encrypts the data sent between the remote access client and the RAS server. Remote access data encryption provides data encryption only on the communications link between the remote access client and the RAS server. If end-to-end encryption is needed, use IPSec to create an encrypted end-to-end connection after the remote access connection has been made.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
IPSec can also be used for encrypting a Layer 2 Tunneling Protocol (L2TP) VPN connection. For more information, see <a href="ch10e.htm">Lesson 4</a>.</blockquote></div>
</p>

<p>Data encryption on a remote access connection is based on a secret encryption key known to the RAS server and remote access client. This shared secret key is generated during the user authentication process.</p>

<p>Data encryption is possible over dial-up remote access links when using PPP along with EAP-TLS or MS-CHAP. The RAS server can be configured to require data encryption. If the remote access client cannot perform the required encryption, the connection attempt is rejected.</p>

<p>Windows 2000, Windows NT 4.0, Windows 98, and Windows 95 remote access clients and remote access servers support the Microsoft Point-to-Point Encryption Protocol (MPPE). MPPE uses the Rivest-Shamir-Adleman (RSA) RC4 stream cipher and 40-bit, 56-bit, or 128-bit secret keys. MPPE keys are generated from the EAP-TLS and MS-CHAP user authentication processes.</p>

<A NAME="545"><h3>Callback</h3></A>
<p>With callback, the RAS server calls the remote access client after the user credentials have been verified. Callback can be configured on the server to call the remote access client back at a number specified by the user of the remote access client during the time of the call. This allows a traveling user to dial in and have the RAS server call back the remote access client at the current location, saving telephone charges. Callback can also be configured to always call back the remote access client at a specific phone number, which is the secure form of callback.</p>

<A NAME="546"><h3>Caller ID</h3></A>
<p>Caller ID can be used to verify that the incoming call is coming from a specified phone number. Caller ID is configured as part of the dial-in properties of the user account. If the caller ID number of the incoming connection for that user does not match the configured caller ID, the connection is denied.</p>

<p>Caller ID requires that the caller's telephone line, the phone system, the RAS server's telephone line, and the Windows 2000 driver for the dial-up equipment all support caller ID. If caller ID is configured for a user account and the caller ID is not being passed from the caller to the RAS server, then the connection is denied.</p>

<p>Caller ID is a feature designed to provide a higher degree of security for networks that support telecommuters. The disadvantage of configuring caller ID is that the user must always dial-in from the same telephone line. This is the same disadvantage of callback configured to a specific telephone number.</p>

<A NAME="547"><h3>Remote Access Account Lockout</h3></A>
<p>The remote access account lockout feature is used to specify how many times a remote access authentication can fail against a valid user account before the user is denied remote access. Remote access account lockout is especially important for VPN connections over the Internet. Malicious users on the Internet can attempt to access an organization's intranet by sending credentials (valid user name and a guessed password) during the VPN connection authentication process. When using a dictionary attack, the user sends hundreds or thousands of credentials by using a list of passwords based on common words or phrases. With remote access account lockout enabled, a dictionary attack is thwarted after a specified number of failed attempts.</p>

<p>The remote access account lockout feature does not distinguish between malicious users who attempt to access your intranet and authentic users who attempt remote access but have forgotten their current passwords. Users
who have forgotten their current password typically try several passwords. Depending on the number of attempts and the MaxDenials setting, they may have their accounts locked out.</p>

<p>If you enable the remote access account lockout feature, a malicious user can deliberately force an account to be locked out by attempting multiple authentications with the user account until the account is locked out, thereby preventing the authentic user from being able to log on.</p>

<p>As the network administrator, you must decide on two remote access account lockout variables:</p>

<ul>
<p><li><b>The number of failed attempts before future attempts are denied</b>  After each failed attempt, a failed attempts counter for the user account is incremented. if the counter reaches the configured maximum, future attempts to connect are denied. a successful authentication resets the failed attempts counter when its value is less than the configured maximum. in other words, the failed attempts counter does not accumulate beyond a successful authentication.</li></p>


<p><li><b>How often the failed attempts counter is reset</b> You must periodically reset the failed attempts counter to prevent inadvertent lockouts due to normal mistakes by users when typing in their passwords.</li></p>
</ul>

<A NAME="548"><h2>Managing Remote Access</h2></A>
<p>When managing remote access, you must take into consideration a variety of factors, such as where user account data is to be stored, how addresses are assigned to remote access clients, and who is allowed to create remote access connections. Remote access management includes managing users, addresses, access, and authentication.</p>

<A NAME="549"><h3>Managing Users</h3></A>
<p>Rather than maintaining separate user accounts for the same user on separate servers and trying to keep the accounts simultaneously current, most administrators set up a master account database in the Active Directory store or on a RADIUS server. This allows the RAS server to send the authentication credentials to a central authenticating device.</p>

<A NAME="550"><h3>Managing Addresses</h3></A>
<p>For PPP connections, IP, IPX, and AppleTalk, addressing information must be allocated to remote access clients during the establishment of the connection. The Windows 2000 RAS server must be configured to allocate IP addresses, IPX network and node addresses, or AppleTalk network and node addresses.</p>

<A NAME="551"><h3>Managing Access</h3></A>
<p>In Windows 2000, remote access connections are accepted based on the dial-in properties of a user account and the remote access policies. A remote access policy is a set of conditions and connection parameters that define the characteristics of the incoming connection and the set of constraints imposed on it. Remote access policies can be used to impose connection parameters such as maximum session time, idle disconnect time, required secure authentication methods, required encryption, and so on.</p>

<p>With multiple remote access policies, different sets of conditions can be applied to different remote access clients, or different requirements can be applied to the same remote access client based on the parameters of the connection attempt. For example, multiple remote access policies can be used to meet the following conditions:</p>

<ul>
<p><li>Allow or deny connections if the user account belongs to a specific group.</li></p>

<p><li>Define different days and times for different user accounts based on group membership.</li></p>

<p><li>Configure different authentication methods for dial-up and VPN remote access clients.</li></p>

<p><li>Configure different authentication or encryption settings for PPTP or L2TP connections.</li></p>

<p><li>Configure different maximum session times for different user accounts based on group membership.</li></p>

<p><li>Send network access server-specific RADIUS attributes to a radius client.</li></p>

</ul>

<p>When you have multiple Windows 2000 remote access servers or VPN servers on which you want to use a centralized set of remote access policies, you can configure a Windows 2000 computer with the Internet Authentication Service (IAS) and then configure each remote access or VPN server as a RADIUS client to the IAS server computer.</p>

<p>Windows 2000 RRAS and Windows 2000 IAS both use remote access policies to determine whether to accept or reject connection attempts. For Windows 2000 RRAS, remote access policies are administered through the Routing And Remote Access snap-in. For Windows 2000 IAS servers, remote access policies are administered through the Internet Authentication Service snap-in.</p>

<p>With remote access policies, you can grant remote access by configuring individual user account or by configuring specific remote access policies.</p>

<p><b>Access by User Account</b></p>

<p>The user account for a stand-alone or Active Directory-based server contains a set of dial-in properties that are used when allowing or denying a connection attempt made by a user. For a stand-alone server, you can set the dial-in properties on the Dial-In tab of the user account properties in the Local Users And Groups snap-in. For an Active Directory-based server, you can set the dial-in properties on the Dial-In tab of the user account properties in the Active Directory Users And Computers snap-in as shown in Figure 10.9.</p>

<p>
<img src="images/f10xx09.jpg" border="0">
</p><p>
<!--caption--><b>Figure 10.9</b> <i>Dial-in settings for Active Directory services user Jane Doe</i><!--/caption-->
</p>

<p>The Dial-In tab includes several options: Remote Access Permission (Dial-In or VPN), Verify Caller ID, Callback Options, Assign A Static IP Address, and Apply Static Routes.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For a user account in a Windows NT 4.0 domain or a Windows 2000 Mixed-mode domain, only the Allow Access option and the Deny Access option in the Remote Access Permission (Dial-In or VPN) section and the options in the Callback Options section are available.</blockquote></div>
</p>

<p><b>Remote Access Permission (Dial-In or VPN)</b></p>

<p>You use this property to set remote access to be explicitly allowed, denied, or determined through remote access policies. If access is explicitly allowed, remote access policy conditions, user account properties, or profile properties can still deny the connection attempt. The Control access through Remote Access Policy option is available only on user accounts in a Windows 2000 Native-mode domain or for local accounts on remote access servers running stand-alone Windows 2000 computers.</p>

<p>By default, the Administrator and Guest accounts on a stand-alone remote access server or in a Windows 2000 Native-mode domain are set to Control access through Remote Access Policy and for a Windows 2000 Mixed-mode domain are set to Deny access. New accounts created on a stand-alone RAS server or in a Windows 2000 Native-mode domain are set to Control access through Remote Access Policy. New accounts created in a Windows 2000 Mixed-mode domain are set to Deny access.</p>

<p><b>Verify Caller ID</b></p>

<p>If this property is enabled, the server verifies the caller's phone number. If
the caller's phone number does not match the configured phone number, the connection attempt is denied.</p>

<p>Caller ID must be supported by the caller, the phone system between the caller, and the remote access server. Caller ID on the remote access server consists of call answering equipment that supports the passing of caller ID information and the appropriate driver inside Windows 2000 that supports the passing of caller ID information to the remote access server.</p>

<p>If you configure a caller ID telephone number for a user and you do not have support for the passing of caller ID information from the caller to the remote access server, the connection attempt is denied.</p>

<p><b>Callback Options</b></p>

<p>If this property is enabled, the server calls the caller back during the connection establishment at a telephone number set by the caller or a specific telephone number set by the network administrator.</p>

<p>If a user account is in a Windows 2000 Native-mode domain, the callback number can be up to 128 characters. If a user account is on a RAS server running Windows 2000 as a stand-alone server, in a Windows NT 4.0 domain, or in a Windows 2000 Mixed-mode domain, the callback number is from 24 through 48 characters, due to the compressed format for storing callback numbers. Callback numbers may be long for international calling, or calling using additional codes such as telephone card numbers.</p>

<p><b>Assign a Static IP Address</b></p>

<p>If this property is enabled, you can assign a specific IP address to a user when a connection is made.</p>

<p><b>Apply Static Routes</b></p>

<p>If this property is enabled, you can define a series of static IP routes that are added to the routing table of the remote access server when a connection is made. This setting is designed for user accounts that Windows 2000 routers use for demand-dial routing.</p>

<p><b>Access by Policy</b></p>

<p>The access by policy administrative model is intended for Windows 2000 RAS servers that are either stand-alone servers or members of a Windows 2000 Native-mode domain. To manage remote access by policy, select the Control Access Through Remote Access Policy radio button (on the Dial-In tab of the user's Properties dialog box) on all user accounts (see Figure 10.9) , and then define the new remote access policies that allow or deny access based on your needs. Remote access policy is configured through RRAS or a RADIUS authentication provider. Figure 10.10 shows the Remote Access Policy node in the Routing And Remote Access snap-in.</p>

<p>
<A HREF="javascript:fullSize('f10xx10x.htm')"> <img src="images/f10xx10.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.10</b> <i>Remote Access Policies node in the Routing And Remote Access snap-in with two policies appearing in the details pane</i><!--/caption-->
</p>

<p>The Remote Access Policies node appears in the Routing And Remote Access snap-in when the authentication provider is set to Windows Authentication. When the authentication provider is set to RADIUS Authentication (see Figure 10.2), the Remote Access Policies node does not appear in the Routing And Remote Access snap-in. Instead, policies are configured from the
RADIUS authentication provider interface.</p>

<p>If the remote access server computer is a member of a Windows NT 4.0 domain or a Windows 2000 Mixed-mode domain and you want to manage access by policy, select the Allow Access radio button (on the Dial-In tab of the user's Properties dialog box) on all user accounts. Then remove the default policy called Allow Access If Dial-In Permission Is Enabled, and create a new policy that allows or denies access. A connection that does not match any configured remote access policy is denied, even if the Allow Access radio button is selected on the user account.</p>

<p>A typical use of policy-based access is to allow access through group membership. For example, create a Windows 2000 group with a name such as DialUpUsers, whose members are those users who are allowed to create dial-up remote access connections.</p>

<p>To create a remote access server that allows only dial-up remote access connections, create a new remote access policy with a descriptive name, such as Dial-Up Remote Access If Member Of DialUpUsers group, assign the DialUpUsers group to the policy, and then delete the default remote access policy called Allow Access If Dial-In Permission Is Enabled.</p>

<p><b>Accepting a connection attempt</b></p>

<p>When a user attempts a connection, the connection attempt is accepted or rejected based on the following logic:</p>

<ol>
<p><li>The first policy in the ordered list of remote access policies is checked. If there are no policies, reject the connection attempt.</li></p>

<p><li>If all the conditions of the policy do not match the connection attempt, go to next policy. If there are no more policies, reject the connection attempt.</li></p>

<p><li>If all the conditions of the policy match the connection attempt, check the remote access permission setting for the user attempting the connection.</li></p>


<ul>
<p><li>If Deny Access is selected, reject the connection attempt.</li></p>

<p><li>If Allow Access is selected, apply the user account properties and profile properties.</li></p>
<ul>
<p><li>If the connection attempt does not match the settings of the user account properties and profile properties, reject the connection attempt.</li></p>

<p><li>If the connection attempt matches the settings of the user account properties and profile properties, accept the connection attempt.</li></p>
</ul>
<p><li>If Control Access Through Remote Access Policy is selected, check the remote access permission setting of the policy.</li></p>
<ul>
<p><li>If Deny Remote Access Permission is selected, reject the connection attempt.</li></p>

<p><li>If Grant Remote Access Permission is selected, apply the user account properties and profile properties.</li></p>
</ul>
<p><li>If the connection attempt does not match the settings of the user account properties and profile properties, reject the connection attempt.</li></p>

<p><li>If the connection attempt matches the settings of the user account properties and profile properties, accept the connection attempt.</li></p>
</ul>
</ol>

<p>Figure 10.11 shows the logic of remote access policies and user account settings.</p>

<p>
<A HREF="javascript:fullSize('f10xx11gx.htm')"> <img src="images/f10xx11g.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.11</b> <i>Using remote access policies and user account settings to accept a connection attempt</i><!--/caption-->
</p>

<p><b>Managing Account Lockout</b></p>

<p>Changing settings in the Windows 2000 registry on the computer that provides authentication services configures the account lockout feature. If the RAS server is configured for Windows authentication, modify the registry on the RAS server computer. If the RAS server is configured for RADIUS authentication and Windows 2000 IAS is being used, modify the registry on the IAS server computer.</p>

<p>To enable account lockout, you must set the MaxDenials entry in the registry (HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\
RemoteAccess\Parameters\AccountLockout) to 1 or greater. MaxDenials is the maximum number of failed attempts before the account is locked out. By default, MaxDenials is set to 0, which means that account lockout is disabled. The AccountLockout key is created when RRAS is enabled.</p>

<p>To modify the amount of time before the failed attempts counter is reset, you must set the ResetTime (Mins) entry in the registry (HKEY_LOCAL_MACHINE\
SYSTEM\CurrentControlSet\Services\RemoteAccess\Parameters\
AccountLockout) to the required number of minutes. By default, ResetTime (Mins) is set to a hex value of b40, or 2,880 minutes (48 hours) in decimal.</p>

<p>To manually reset a user account that has been locked out before the failed attempts counter is automatically reset, delete the following registry subkey that corresponds to the user's account name: HKEY_LOCAL_MACHINE\
SYSTEM\CurrentControlSet\Services\RemoteAccess\Parameters\
AccountLockout\&lt;<i>domain_name:user_name&gt;</i>.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The remote access account lockout feature is not related to the Account is locked out setting on the Account tab of the user account properties or related to the administration of account lockout policies in Windows 2000 group policies.</blockquote></div>
</p>

<A NAME="552"><h3>Managing Authentication</h3></A>
<p>The remote access server can be configured to use either Windows or
RADIUS as an authentication provider. Figure 10.2 shows where this option is selected in the Routing And Remote Access snap-in.</p>

<p><b>Windows Authentication</b></p>

<p>If Windows is selected as the authentication provider, then the user credentials sent by users attempting remote access connections are authenticated through normal Windows authentication mechanisms.</p>

<p>If the remote access server is a member server in a Mixed-mode or Native-mode Windows 2000 domain and is configured for Windows authentication, the computer account of the RAS server computer must be a member of the RAS and IAS Servers security group. Configuring membership can be completed by a domain administrator by using the Active Directory Users And Computers snap-in to add the computer to the RAS And IAS Servers security group in the Users container. The netsh command-line utility can also be used to add the server to this group. For example, to add a server named RAS1 to the microsoft.com domain RAS And IAS Servers security group, open a command prompt and enter the Net Shell Command mode by typing <b>netsh</b>. Once in Net Shell Command mode, type <b>add registeredserver domain=microsoft.com server=ras1</b>. If the user installing RRAS is a domain administrator, the computer account is automatically added to the RAS and IAS Servers security group during the installation of RRAS.</p>

<p><b>RADIUS Authentication</b></p>

<p>If RADIUS is selected and configured as the authentication provider on the remote access server, user credentials and parameters of the connection request are sent as a series of RADIUS request messages to a RADIUS server, such as a computer running Windows 2000 Server and IAS.</p>

<p>The RADIUS server receives a user-connection request from the RAS server and authenticates the client against its authentication database. A RADIUS server can also maintain a central storage database of other relevant user properties. In addition to the simple yes or no response to an authentication request, RADIUS can inform the RAS server of other applicable connection parameters for this user, such as maximum session time, static IP address assignment, and so on.</p>

<p>RADIUS can respond to authentication requests based upon its own database, or it can be a front end to another database server, such as a generic Open Database Connectivity (ODBC) server or a Windows 2000 domain controller. The latter server could be located on the same machine as the RADIUS server, or could be centralized elsewhere. In addition, a RADIUS server can act as a proxy client to a remote RADIUS server.</p>

<p>The RADIUS protocol is described in RFC 2138 and RFC 2139. For more information about RAS server authentication scenarios and the RAS server as a RADIUS client, see Windows 2000 Server Help.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
When configured for Windows authentication, both RRAS and IAS use the same process to provide authentication and authorization of incoming connection requests.</blockquote></div>
</p>

<p><b>Windows and Radius Accounting</b></p>

<p>You can also select Windows Accounting, RADIUS Accounting, or None on the Security tab of the Properties dialog box for the remote access server. A remote access server running Windows 2000 supports the logging of accounting information for remote access server connections in local logging files when Windows Accounting is enabled. This logging is separate from the events recorded in the system event log. Accounting logging is especially useful for troubleshooting remote access policy issues. The accounting information is stored in a configurable log file or files stored in the %systemroot%\System32\LogFiles folder. The log files are saved in IAS 1.0 or Open Database Connectivity (ODBC) format, meaning that any ODBC-compliant database program can read the log file directly for analysis.</p>

<p>A remote access server running Windows 2000 also supports the logging of accounting information for remote access serve connections at a RADIUS server when RADIUS authentication and accounting are enabled. This logging is separate from the events recorded in the system event log. If your RADIUS server is a Windows 2000 computer running IAS, then accounting information is logged in log files stored on the IAS server.</p>

<p>
<img src="images/practic.JPG" border="0">
</p>

<A NAME="553"><h3>Exercise 2: Configuring and Monitoring a RAS Connection</h3></A>
<p>This exercise should be completed on Server01 and Server02.</p>

<p><li><b>Procedure 1: Allowing and denying dial-in access</b></li></p>


<p>In this procedure, you will selectively allow or deny remote access to user accounts. Complete this procedure on Server01.</p>

<ol>
<p><li>Open the Active Directory Users And Computers snap-in.</li></p>

<p>The Active Directory Users And Computers snap-in appears.</p>

<p><li>Click the Sales OU in the console tree.</li></p>

<p>The objects in the Sales OU appear in the details pane.</p>

<p><li>Double-click Jane Doe.</li></p>

<p>The Jane Doe Properties dialog box appears.</p>

<p><li>Click the Dial-in tab.</li></p>

<p>The dial-in settings for Jane Doe appear.</p>

<p><li>Click the Allow Access radio button and then click OK.</li></p>

<p><li>Double-click John Smith in the details pane and then click the Dial-In tab.</li></p>

<p>The dial-in settings for John Smith appear.</p>

<p><li>Verify that the Control Access Through Remote Access Policy radio button is selected and then click OK.</li></p>

<p><li>Click the Users container in the console tree.</li></p>

<p>The objects in the Users container appear in the details pane.</p>

<p><li>Access the dial-in properties for Bob Train.</li></p>

<p><li>Click the Deny Access radio button and then click OK.</li></p>

<p><li>Close Active Directory Users And Computers.</li></p>
</ol>

<p><li> <b>Procedure 2: Enabling accounting and configuring logging on the RRAS server</b></li></p>


<p>In this procedure, you configure the RRAS server for Windows account logging and event logging. Complete this procedure on Server01.</p>

<ol>
<p><li>Restore the Routing And Remote Access snap-in.</li></p>

<p><li>Click Remote Access Logging in the console tree.</li></p>

<p><li>In the details pane, double-click Local File.</li></p>

<p>The Local File Properties dialog box appears.</p>

<p><li>Click the Log Authentication Requests (For Example, Access-Accept Or Access-Reject) &#8211; Recommended check box.</li></p>

<p><li>Click OK.</li></p>

<p><li>Click Server01 (Local) in the console tree.</li></p>

<p><li>Click the Action menu and choose Properties.</li></p>

<p>The Server01 (Local) Properties dialog box appears.</p>

<p><li>Click the Event Logging tab.</li></p>

<p><li>Click the Log The Maximum Amount Of Information radio button and check the Enable Point-To-Point Protocol (PPP) Logging check box.</li></p>

<p><li>Click OK.</li></p>

<p>The Routing And Remote Access message box appears asking to restart the router.</p>

<p><li>Click Yes.</li></p> 

<p>A number of message boxes appear as routing and remote access is stopped and restarted.</p>
</ol>

<p><li> <b>Procedure 3: Configuring a dial-up client and accessing the RRAS server (optional)</b></li></p>



<p>In this procedure, you configure Server02 to act as a dial-up client. There must be a modem in Server02 in order for you to complete this exercise.</p>

<ol>
<p><li>Before starting Server02, disconnect the network cable.</li></p>

<p><li>Start Server02.</li></p>

<p><li>At the logon screen, change the Logon To drop-down list box to SERVER02 (This Computer) then log on as Administrator with a password of &quot;password.&quot;</li></p>

<p><li>Click Start, point to Settings, then click Network And Dial-up Connections.</li></p>

<p>The Network And Dial-up Connections window appears. Notice that Local Area Connection contains a red &quot;X.&quot; You disconnected Local Area Connection before starting this procedure.</p>

<p><li>Double-click Make New Connection.</li></p>

<p>The Network Connection wizard appears.</p>

<p><li>Click Next.</li></p>

<p>The Network Connection Type screen appears.</p>

<p><li>Verify that the Dial-Up To Private Network radio button is selected and then click Next.</li></p>

<p>The Phone Number To Dial screen appears.</p>

<p><li>If you are able to dial up the RRAS server, type in the telephone number that the RRAS server modem is connected to. If you are unable to complete this connection, type any telephone number in this text box.</li></p>

<p><li>Click Next.</li></p>

<p>The Connection Availability screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Internet Connection Sharing screen appears.</p>

<p><li>Click Next.</li></p>

<p>The Completing The Network Connection Wizard screen appears and the connection appears with the default name of Dial-Up Connection.</p>

<p><li>Click Finish.</li></p>

<p>The Connect Dial-up Connection dialog box appears.</p>

<p><li>If you are unable to dial up the RRAS server, click Cancel. Screen shots will be provided in the next optional procedure to allow you to see what appears in RRAS when a connection is established. If you are able to dial up the RRAS server, complete the remaining steps.</li></p>

<p><li>In the User Name text box, type <b>Bob_Train</b> (there is an underscore between the first and last name), and then click the Dial button.</li></p>

<p>The Error Connecting To Dial-Up Connection message box appears stating that this user account does not have permission to dial in. The Bob Train user account was assigned the Deny Access Remote Access permission.</p>

<p><li>In the User Name text box, type <b>Jane_Doe</b> (there is an underscore between the first and last name), and in the password box type <b>student</b> and then click the Dial button.</li></p>


<p>The Connecting Dial-up Connection message box appears on Server02 and the connection is verified, authenticated, and registered.</p>

<p>The Connection Complete message box appears on Server02.</p>


<p><li>Click the Do Not Display The Message Again check box and then click OK.</li></p>

<p>The Jane Doe account successfully connected to the RAS server because Allow Access was configured for the properties of the user account.</p>

<p><li>In the Network And Dial-up Connection window, double-click Dial-up Connection.</li></p>

<p>The Dial-up Connection Status dialog box appears.</p>

<p><li>Click the Disconnect button.</li></p>

<p><li>Double-click Dial-up Connection.</li></p>

<p><li>In the User name text box, type <b>John_Smith</b> (there is an underscore between the first and last name), and then click the Dial button.</li></p>

<p>The Error Connecting To Dial-up Connection message box appears stating that this user account does not have permission to dial in. The John Smith user account was assigned the Control access through Remote Access Policy setting.</p>

<p><li>On Server01, restore the Routing And Remote Access snap-in.</li></p>

<p><li>Click the Remote Access Policies node in the console tree.</li></p>

<p><li>Double-click the Allow Access If Dial-In Permission Is Enabled policy in the details pane.</li></p>

<p>The Allow Access If Dial-In Permission Is Enabled Properties dialog
box appears.</p>


<p><li>In the If A User Matches The Conditions section, select the Grant Remote Access Permission radio button and then click OK.</li></p>

<p><li>Return to Server02.</li></p>

<p><li>In the User Name text box click the Dial button to attempt another logon as John_Smith.</li></p>

<p>The Connecting Dial-Up Connection appears on Server02 and the connection is verified, authenticated, and registered. The default remote access policy now grants access to all user accounts that have the Control Access Through Remote Access Policy radio button (on the Dial-In tab) selected.</p>
</ol>

<p><li><b>Procedure 4: Monitoring the remote access connection (optional)</b></li></p>


<p>If you were able to connect to the remote access server, you can complete this procedure. If you weren't able to connect to the remote access server, important screen shots are provided in this procedure. Complete this procedure from Server01.</p>

<ol>
<p><li>Restore the Routing And Remote Access snap-in.</li></p>

<p><li>Click Remote Access Clients (1) in the console tree.</li></p>


<p>MICROSOFT\John_Smith appears in the User Name column. Notice that the connection duration and the number of ports connected also appears (Figure 10.12).</p>

<p>
<A HREF="javascript:fullSize('f10xx12x.htm')"> <img src="images/f10xx12.jpg" border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!--caption--><b>Figure 10.12</b> <i>User Name column showing connection duration and number of ports connected</i><!--/caption-->
</p>


<p><li>Double-click MICROSOFT\John_Smith appearing in the details pane.</li></p>


<p>The Status dialog box appears (Figure 10.13).</p>

<p>
<img src="images/f10xx13.jpg" border="0">
</p><p>
<!--caption--><b>Figure 10.13</b> <i>User Status dialog box showing TCP/IP</i><!--/caption-->
</p>

<p>Notice that the only protocol registered for this connection is TCP/IP. This is because all values are blank under Network Registration except for IP address. The IP address appearing was allocated by DHCP since the default setting for the RAS server is to use DHCP to supply the network address to remote access clients. You can verify this information from the DHCP snap-in on Server01.</p>

<p>From the details pane you can also send a message to the selected remote access client or all connected clients, and disconnect a remote access client.</p>


<p><li>Close the Status dialog box.</li></p>

<p><li>Click Start, then click Run.</li></p>

<p><li>In the Open text box, type <b>c:\winnt\system32\logfiles\iaslog.log,</b> then click OK.</li></p>

<p>
<img src="images/cd.JPG" border="0">
</p>

<p>The Accounting log is displayed in Notepad. If you were unable to complete this exercise, open the iaslog.log file on the Windows 2000 Supplemental Training CD-ROM. You can find this file in the \Chapt10\ex2 folder. Only two lines from the last two connections made by the John Smith user account are included in this file.</p>

<p>For information on how to interpret this log, open the IAS Help file and search for the title, IAS-Formatted Log Files. For a more readable format with less information, consider setting logging to the database-compatible file format.</p>


<p><li>Close Notepad.</li></p>

<p><li>To view the results of event logging, open the Event Viewer from the Administrative Tools program group.</li></p>

<p>The Event Viewer snap-in appears and the contents of the System Log appear in the details pane.</p>

<p><li>Locate and double-click a system log event with a Source of RemoteAccess and an Event ID of 20015.</li></p>

<p>A remote access connection event appears, showing you who connected and to what port.</p>

<p><li>Click OK.</li></p>

<p><li>Locate and double-click a system log event with a Source of RemoteAccess and an Event ID of 20187.</li></p>

<p>A remote access connection event appears, showing you that a remote access authentication attempt failed and the username of the failed attempt.</p>

<p><li>Click OK, then close the Event Viewer snap-in.</li></p>
</ol>

<A NAME="554"><h2>Lesson Summary</h2></A>
<p>Windows 2000 remote access provides two different types of remote access connectivity: dial-up remote access and VPN remote access. A dial-up remote access connection consists of a remote access client, a remote access server, and a WAN infrastructure. Remote access protocols control the connection establishment and transmission of data over WAN links. There are three types of remote access protocols supported by Windows 2000: PPP, SLIP, and Asynchronous NetBEUI. Windows 2000 remote access supports the following LAN protocols: TCP/IP, IPX, AppleTalk, and NetBEUI. Windows 2000 remote access offers a wide range of security features, including secure user authentication, mutual authentication, data encryption, callback, caller ID, and remote access account lockout. Remote access management includes managing users, addresses, access, and authentication.</p>

</BODY>
</HTML>



