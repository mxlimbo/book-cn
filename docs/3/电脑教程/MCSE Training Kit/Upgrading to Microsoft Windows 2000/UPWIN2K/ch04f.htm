<HTML>
<HEAD>
<TITLE>Lesson 5: Installing Active Directory Directory Services</TITLE>
<link rel="STYLESHEET" type="text/css" href="upwin2k.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch04e.htm", "ch04g.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="204"><H1>Lesson 5: Installing Active Directory Directory Services</H1></A>

<p>This lesson presents information on installing Active Directory
directory services, including using the Active Directory Installation
wizard. In addition, the lesson addresses the database and shared
system volume that Active Directory directory services create during
installation. Finally, the lesson discusses domain modes.</p>

<p>
<div class="sidebar"><blockquote>
<p><b>After this lesson, you will be able to</b></p>

<ul>
<p><li>Install Active Directory directory services.</li></p>
</ul>


<p><b>Estimated lesson time: 30 minutes</b></p>
</blockquote></div>
</p>

<A NAME="205"><H2>The Active Directory Installation Wizard</H2></A>

<p>You use the Active Directory Installation wizard to perform the
following tasks:</p>

<ul>
<p><li>Adding a domain controller to an existing domain</li></p>

<p><li>Creating the first domain controller of a new domain</li></p>

<p><li>Creating a new child domain</li></p>

<p><li>Creating a new domain tree</li></p>
</ul>


<p>To launch the Active Directory Installation wizard, you can use the
Windows 2000 Configure Server wizard to start the Active Directory
wizard or you can run Dcpromo.exe. When you run the Active Directory
Installation wizard on a stand-alone server, it steps you through the
process of installing Active Directory directory services on the
computer and creating a new domain controller.</p>

<p>As you install Active Directory directory services, you can choose
whether to add the new domain controller to an existing domain or
create the first domain controller for a new domain.</p>

<A NAME="206"><H3>Adding a Domain Controller to an Existing Domain</H3></A>

<p>If you choose to add a domain controller to an existing domain, you
create a peer domain controller. You create peer domain controllers for
redundancy and to reduce the load on the existing domain controllers.</p>

<A NAME="207"><H3>Creating the First Domain Controller for a New Domain</H3></A>

<p>If you choose to create the first domain controller for a new
domain, you create a new domain. You create domains on your network to
partition your information, which enables you to scale Active Directory
directory services to meet the needs of very large organizations. When
you create a new domain, you can create a new child domain or a new
tree. If you choose to create a new child domain, the new domain is
created as a child domain in an existing domain. When you create a new
domain tree, the new domain does not become part of an existing domain.
You can create a new tree in an existing forest, or you can create a
tree and start a new forest.</p>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
Running Dcpromo.exe on a domain controller
allows you to remove Active Directory directory services from the
domain controller and demotes the domain controller to a stand-alone
server. If you remove Active Directory directory services from all
domain controllers in a domain, you also delete the directory database
for the domain, and the domain no longer exists.
</blockquote></div>
</p>

<A NAME="208"><H2>The Database and Shared System Volume</H2></A>

<p>Installing Active Directory directory services creates the database
and database log files, as well as the shared system volume. Table 4.3
describes the purpose and location of these files.</p>

<p><b>Table 4.3</b> <i>Types of Files Created by Installing Active Directory Directory Services</i></p>

<P>
<table cellpadding=5 width="95%">
<tr> 
<th>Type of file created </th>
<th>Description  </th></tr>
<tr>
<td valign="top">Database and database log files </td>
<td valign="top"> The database is the directory for the new domain, and
the log file temporarily stores changes made to the Active Directory database. <p>The default location for the database and database log files is  <i>systemroot</i>\Ntds.</p> <p>For best performance, place the database and the log file on  separate hard disks.</p></td></tr>
<tr>
<td valign="top">Shared system volume </td>
<td valign="top">The shared system volume is a folder structure that
exists on all Windows 2000 domain controllers. It stores scripts and some
of  the Group Policy objects for both the current domain as well as  the enterprise. The file replication services use the shared
system  volume to replicate files and Group Policy information among  domain controllers. The default location for the shared system  volume is <i>systemroot</i>\Sysvol. <p>The shared system volume must be located on a partition or  volume formatted with NTFS.</p> </td></tr>
</table></p>

<p>Replication of the shared system volume occurs on the same schedule
as replication of Active Directory directory services. As a result, you
might not notice file replication to or from the newly created system
volume until two replication periods have elapsed (typically, 10 minutes). This is because the first
file replication period updates the configuration of other system
volumes so that they are aware of the newly created system volume.</p>

<A NAME="209"><H2>Domain Modes</H2></A>

<p>There are two domain modes: mixed mode and native mode.</p>

<A NAME="210"><H3>Mixed Mode</H3></A>

<p>When you first install a Windows 2000 Server domain controller or
upgrade an existing domain controller running an earlier version of Windows NT
to Windows 2000 Server, the domain controller runs in mixed mode. Mixed
mode allows the domain controller to interact with any domain
controllers in the domain that are running previous versions of Windows NT Server.
Domain controllers running previous versions of Windows NT Server are called
<i>down-level domain controllers</i>.</p>

<A NAME="211"><H3>Native Mode</H3></A>

<p>When all the domain controllers in the domain run Windows 2000
Server, and you do not plan to add any more down-level domain
controllers to the domain, you can switch the domain from mixed mode to
native mode.</p>

<p>Several things happen during the conversion from mixed mode to
native mode:</p>

<ul>
<p><li>Support for down-level replication and down-level domain
controllers ceases. Therefore all the domain controllers in your domain must be
running Windows 2000.</li></p>

<p><li>You can no longer add new down-level domain controllers to
the domain.</li></p>

<p><li>The server that served as the primary domain controller
during migration is no longer the domain master; all domain controllers
begin acting as peers.</li></p>
</ul>


<p>
<div class="note"><blockquote><b>NOTE</b><hr>
The change from mixed mode to native mode is one
way only; you cannot change from native mode to mixed
mode.
</blockquote></div>
</p>

<p>Use the following procedure to switch the domain mode:</p>

<ol>
<p><li>Start the Active Directory Domains and Trusts snap-in.</li></p>

<p><li>Right-click the domain name, and then click Properties.</li></p>

<p><li>On the General tab, click Change To Native Mode.</li></p>

<p><li>In the Warning dialog box, click Yes, and then click OK.</li></p>
</ol>

<p>
<img src="images/practic.JPG" width=68 height=54 border="0">
</p>

<A NAME="212"><H2>Practice: Installing Active Directory Directory Services and Viewing Your Domain</H2></A>

<p>In this practice, you will promote your stand-alone server to a
domain controller by installing Active Directory directory services on
it. You will use My Network Places to confirm that your domain exists
and then use the Active Directory Users and Computers snap-in to view your domain. The last thing you
will do in this practice is change the mode of your domain from the default
mixed mode to native mode.</p>

<A NAME="213"><H3>Exercise 1: Promoting a Stand-Alone Server to a Domain Controller</H3></A>

<p>In this exercise, you will run Dcpromo.exe to install Active
Directory directory services on your stand-alone server, making it a
domain controller in a new domain.</p>


<p><li><b> To install Active Directory directory services on a
stand-alone server</b></li></p>

<ol>
<p><li>Click Start and then click Run.</li></p>

<p><li>Type <b>dcpromo</b> and then click OK.</li></p>

<p>The Active Directory Installation wizard appears.</p>


<p><li>Click Next to continue.</li></p>


<p>The Domain Controller Type page appears.</p>


<p><li>Ensure that the Domain Controller For A New Domain option is
selected, and then click Next.</li></p>


<p>The Create Tree Or Child Domain page appears.</p>


<p><li>Ensure that the Create A New Domain Tree option is selected, and
then click Next.</li></p>


<p>The Create Or Join Forest page appears.</p>


<p><li>Ensure that the Create A New Forest Of Domain Trees option is
selected, and then click Next.</li></p>

<p>The New Domain Name page appears.</p>


<p><li>Type <b>domain.com</b> in the Full DNS Name For New Domain box,
and then click Next.</li></p>


</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you are not using domain.com as your DNS domain name,
type the name you are using.
</blockquote></div>
</p>

<ol>

<p>The NetBIOS Domain Name page appears.</p>

<p><li value="8">Ensure that DOMAIN appears in the Domain NetBIOS Name box, and
then click Next.</li></p>


<p>The Database And Log Locations page appears.</p>


<p><li>Ensure that C:\Winnt\Ntds is the location of both the database
and the log, and click Next.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you did not install Windows 2000 on the C drive or in
the Winnt directory, both locations should default to the Ntds folder on the
drive and in the folder where you installed Windows 2000.
</blockquote></div>
</p>

<ol>

<p>The Shared System Volume page appears.</p>

<p><li value="10">Ensure that the Sysvol folder location is C:\Winnt\Sysvol.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you did not install Windows 2000 on the C drive or in
the Winnt directory, the Sysvol location should default to a Sysvol folder on the
drive and in the folder where you installed Windows 2000.
</blockquote></div>
</p>

<ol>
<p>What is the one Sysvol location requirement?</p>

<p>What is the function of Sysvol?</p>

<p><a href="chaaa.htm#707">Answers</a></p>

<p><li value="11">Click Next to accept C:\Winnt\Sysvol (or the default path on
your system) as the path for Sysvol.</li></p>

<p>The Permissions page appears.</p>


<p><li>Select Permissions Compatible Only With Windows 2000 Servers,
and then click Next.</li></p>


<p>The Directory Services Restore Mode Administrator Password page
appears.</p>


<p><li>Type <b>password</b> in the Password and Confirm Password
boxes, and then click Next.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
For simplicity you are using <i>password</i> for the
Administrator's password. You should always use a complex password
for the Administrator account and, in this case, a password that is not
the same as your Administrator password.
</blockquote></div>
</p>

<ol>
<p>The Summary page appears with a list of the options you
selected.</p>

<p><li value="14">Review the contents of the Summary page, and then click
Next.</li></p>


<p>The Configuring Active Directory progress indicator appears as
Active Directory directory services are installed on the server. This process
will take several minutes.</p>


<p><li>When the Completing The Active Directory Installation Wizard
page appears, click Finish, and then click Restart Now.</li></p>
</ol>

<A NAME="214"><H3>Exercise 2: Viewing Your Domain</H3></A>

<p>In this exercise, you will view your domain.</p>

<p><li><b> To explore My Network Places</b></li></p>

<ol>
<p><li>Log on as Administrator.</li></p>

<p><li>Double-click My Network Places.</li></p>


<p>The My Network Places window appears.</p>


<p><li>Double-click Entire Network, and then click the Entire Contents
link.</li></p>


<p>The Microsoft Windows Network icon appears.</p>


<p><li>Double-click the Microsoft Windows Network icon.</li></p>


<p>The Microsoft Windows Network window appears, and the Domain icon
should be listed.</p>


<p><li>Close the Microsoft Windows Network window.</li></p>
</ol>

<A NAME="215"><H3>Exercise 3: Using the Active Directory Users and Computers Snap-In</H3></A>

<p>In this exercise, you will use the Active Directory Users and
Computers snap-in to view your domain.</p>

<p><li><b>To use the Active Directory Users and Computers
Snap-In</b></li></p>

<ol>
<p><li>Click Start, point to Programs, point to Administrative Tools,
and then click Active Directory Users And Computers.</li></p>

<p><li>In the console tree, expand domain.com.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you did not use domain for your domain name,
double-click your domain name.
</blockquote></div>
</p>
<ol>
<p>What selections are listed under domain?  </p>

<p><a href="chaaa.htm#708">Answer</a></p>

<p><li value="3">In the console tree, click Domain Controllers.</li></p>

<p>Notice that SERVER1 appears in the details pane.</p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you did not use SERVER1 as your server name, the name
of your server appears in the details pane.
</blockquote></div>
</p>

<ol>
<p><li value="4">Leave the Active Directory Users And Computers window open.</li></p>
</ol>

<A NAME="216"><H3>Exercise 4: Changing Your Domain from Mixed Mode to Native Mode</H3></A>

<p>In this exercise, you will change your domain mode from mixed mode
to native mode.</p>

<p><li><b>To change your domain from mixed mode to native mode</b></li></p>

<ol>
<p><li>In the console tree, click domain.com to select it.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If you did not use domain.com for your domain name, click
your domain name.
</blockquote></div>
</p>

<ol>
<p><li value="2">Click Action and then click Properties on the Action menu.</li></p>


<p>The Domain.com Properties dialog box appears.</p>


<p><li>On the General tab, click the Change Mode button.</li></p>


<p>An Active Directory Service dialog box displays a warning that once
the domain mode is changed to native mode, you cannot change back.</p>


<p><li>Click Yes, and then click OK to close the Properties dialog box
for your domain.</li></p>


<p>An Active Directory message box displays a message indicating that
the operation completed successfully and that it may take 15 minutes or
more for the information to replicate to all domain controllers.</p>


<p><li>Click OK, and close all open windows.</li></p>
</ol>

<A NAME="217"><H2>Lesson Summary</H2></A>

<p>To install Active Directory directory services, you can use the
Windows 2000 Configure Your Server wizard to start the Active Directory
Installation wizard. You can also go to a command prompt and type <b>dcpromo</b> to launch the Active Directory Installation wizard. You use
the Active Directory Installation wizard to add a domain controller to an existing domain, to create the first domain
controller of a new domain, to create a new child domain, and to create
a new domain tree.</p>

<p>When installing Active Directory directory services, a database and
a log file are created. The database is the directory for the new
domain, and the log file temporarily stores changes made to the Active
Directory directory services database. The default location for the
database and database log files is <i>systemroot</i>\Ntds. A shared system volume is also created when you install Active
Directory directory services. The shared system volume is a folder
structure that exists on all Windows 2000 domain controllers. It stores
scripts and some of the Group Policy objects for both the current
domain as well as the enterprise. The file replication services use the
shared system volume to replicate files and Group Policy information
among domain controllers. The default location for the shared system
volume is <i>systemroot</i>\Sysvol.</p>

<p>When you first install or upgrade a domain controller to Windows
2000 Server, the domain controller runs in mixed mode. Mixed mode allows
domain controllers to interact with any domain controllers in the
domain that are running previous versions of Windows NT Server
(down-level domain controllers). When all the domain controllers in the
domain run Windows 2000, and you do not plan to add any more down-level
domain controllers to the domain, you can switch the domain from mixed
mode to native mode. Native mode does not support down-level
replication. When you change from mixed mode to native mode, the server
that was the primary domain controller during migration is no longer
the domain master; all domain controllers in native mode act as
peers.</p>

<p>In the practice section of this lesson, you used Dcpromo.exe to
start the Active Directory Installation wizard so that you could
install Active Directory directory services on your computer, promote
your computer to a domain controller, and create a domain. You then
viewed your domain using My Network Places and the Active Directory
Users and Computers tool. Finally, you changed your domain controller
from mixed mode to native mode.</p>

</BODY>
</HTML>



