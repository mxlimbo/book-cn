<html>
<head>
<title>Lesson 2: Implementing RIS</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch15b.htm", "ch15d.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="849"><h1>Lesson 2: Implementing RIS</h1></A>
<p>This section discusses the tasks necessary to implement RIS, including setting up and configuring RIS, creating an RIPrep image, creating an RIS boot disk, and verifying an RIS configuration.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Set up RIS</li></p>

<p><li>Configure RIS</li></p>

<p><li>Create an RIPrep image</li></p>

<p><li>Create an RIS boot disk</li></p>

<p><li>Verify an RIS configuration</li></p>
</ul>

<b>Estimated lesson time: 30 minutes</b> 
</blockquote></div>
</p>

<A NAME="850"><h2>Implementing RIS</h2></A>
<p>To implement RIS you must complete the following tasks:</p>

<ul>
<p><li>Set up RIS</li></p>
<p><li>Configure RIS</li></p>
<p><li>Create an RIPrep image</li></p>
<p><li>Create an RIS boot disk (optional)</li></p>
<p><li>Verify the RIS configuration</li></p>
</ul>

<A NAME="851"><h2>Setting Up RIS</h2></A>
<p>RIS requires a two-stage setup process: adding the RIS component and installing RIS.</p>

<p>
<div class="warning"><blockquote><b>IMPORTANT</b> <hr>
Refer to the &quot;<A HREF="ch15b.htm#837">RIS Server and Client Requirements</A>&quot; section in Lesson 1 before attempting to set up RIS.</blockquote></div>
</p>

<A NAME="852"><h3>Adding the RIS Component</h3></A>
<p>The first stage of RIS setup occurs when RIS is added as an optional component. This stage copies the files required for installation to the hard disk drive on the server. You can add the RIS component during Windows 2000 Server installation or after the server installation by using Add/Remove Programs.</p>

<p><li><b>To add the RIS component</b> </li></p>

<ol>
<p><li> Access the Windows Components Wizard in one of the following ways:</li></p>

<ul>
<p><li>During Windows 2000 Server installation</li></p>
<p><li>Click Start, point to Settings, point to Control Panel, open Add/Remove Programs, then click Add/Remove Windows Components</li></p>
</ul>

<p><li> In the Windows Components Wizard dialog box, shown in Figure 15.5, select the Remote Installation Services check box, then click Next.</li></p>

<p>
<A HREF="javascript:fullSize('15wtk05x.htm')"> <img src="images/15wtk05.JPG" width=404 height=309 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.5</b> <i>Windows Components Wizard dialog box</i><!-- /caption -->
</p>


<p><li> Insert the Windows 2000 Server CD-ROM when prompted.</li></p>
<p><li> On the Completing The Windows Components Wizard page, click Finish.</li></p>
<p><li> In the System Settings Change message box, click Yes to restart the server before installing RIS.</li></p>
</ol>

<A NAME="853"><h3>Installing RIS</h3></A>
<p>The second stage of RIS setup occurs when RIS is installed. This stage installs RIS on the server.</p>

<p><li><b>To install RIS</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Configure Your Server.</li></p>
<p><li> In the Configure Your Server dialog box, click Finish Setup.</li></p>
<p><li> In the Add/Remove Programs dialog box, in the Configure Remote Installation Services box, click Configure to start the Remote Installation Services Setup Wizard.</li></p>
<p><li> In the Welcome To The Remote Installation Services Setup Wizard dialog box, click Next.</li></p>
<p><li> Continue through the prompts provided by the Remote Installation Services Setup Wizard, including:</li></p>
<ul>
<p><li>A location on the server where the RIS folder will be created</li></p>
<p><li>Whether the RIS server should begin servicing client computers immediately after completing setup</li></p>
<p><li>The location of the Windows 2000 Professional CD-ROM or a location on the network that contains the installation files</li></p>
<p><li>A location on the server where image installation files will be copied</li></p>
<p><li>A friendly description and associated help text that describes the OS image to users of the CIW</li></p>
</ul>

<p>After the Remote Installation Services Setup Wizard completes, depending on the settings chosen, the RIS server either begins servicing client computers or pauses while you set RIS configuration options. The next section describes the configuration options available to an RIS administrator.</p>
</ol>

<A NAME="854"><h2>Configuring RIS</h2></A>
<p>By default, an RIS server is not configured to begin servicing client computers immediately after the installation of RIS is completed. To configure RIS you must complete the following tasks:</p>

<ul>
<p><li>Authorize RIS servers</li></p>
<p><li>Set RIS server properties</li></p>
<p><li>Set RIS client installation options</li></p>
<p><li>Set RIPrep image permissions</li></p>
</ul>

<A NAME="855"><h3>Authorizing RIS Servers</h3></A>
<p>By specifying the RIS servers allowed to run on your network, you can prevent unauthorized (often referred to as <i>rogue</i>) RIS servers, ensuring that only RIS servers authorized by administrators can service clients. If an attempt is made to start an unauthorized RIS server on the network, it will be automatically shut down and thus unable to service client computers. An RIS server must be authorized before it can service client computers.</p>

<p><li><b>To authorize RIS servers</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click DHCP.</li></p>
<p><li> In the DHCP console tree, click the DHCP node.</li></p>
<p><li> On the Action menu, click Manage Authorized Servers.</li></p>
<p><li> In the Manage Authorized Servers dialog box, click Authorize.</li></p>
<p><li> In the Authorize DHCP Server dialog box, type the name or IP address of the RIS server to be authorized, then click OK.</li></p>
<p><li> In the DHCP message box, click Yes.</li></p>
<p><li> In the Manage Authorized Servers dialog box, select the computer, then click OK.</li></p>
<p>The authorized RIS server is now listed under the DHCP node.</p>
</ol>

<A NAME="856"><h3>Setting RIS Server Properties</h3></A>
<p>By setting properties on individual RIS servers, you control how the server supplies RIS to clients requesting service.</p>

<p><li><b>To set RIS server properties</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, click the folder that contains the computer whose configuration you want to verify, such as Computers or Domain Controllers.</li></p>

<p><li> In the details pane, right-click the applicable RIS server, then click Properties.</li></p>

<p><li> In the Properties dialog box for the server, click the Remote Install tab.</li></p>

<p><li> In the Remote Install tab (see Figure 15.6) of the Properties dialog box, set the options described in Table 15.1.</li></p>

<p>
<img src="images/15wtk06.JPG" width=404 height=466 border="0">
</p><p>
<!-- caption --><b>Figure 15.6</b> <i>Remote Install tab</i><!-- /caption -->
</p>


<p><b>Table 15.1</b> <i>Options on the Remote Install Tab of the Properties Dialog Box</i></p>

<table cellpadding="5" border="0" width="95%">
<tr><th>Configuration Option</th><th>Description</th></tr>
<tr><td valign="top">Respond To Client Computers Requesting Service</td><td valign="top">The RIS server responds to all clients requesting service.</td></tr>
<tr><td valign="top">Do Not Respond To Unknown Client Computers</td><td valign="top">The RIS server does not respond to unknown client computers. This option is available only if the Respond To Client Computers Requesting Service check box is checked.</td></tr>
</table>

<p><li> In the Remote Install tab, click Advanced Settings.</li></p>

<p><li> In the Remote Installation Services Properties dialog box for the server, in the New Clients tab (see Figure 15.7), set the options described in Table 15.2.</li></p>

<p>
<img src="images/15wtk07.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 15.7</b> <i>New Clients tab on the Remote Installation Services Properties dialog box</i><!-- /caption -->
</p>


<p><b>Table 15.2</b> <i>Options on the New Clients Tab of the Remote Installation Services Dialog Box</i></p>

<table cellpadding="5" border="0" width="95%">
<tr><th>Configuration Option</th><th>Description</th></tr>
<tr><td valign="top">Generate Client Computer Names Using</td><td valign="top">When the client computer name is automatically generated, this option determines how the name is formatted. Provides flexibility in naming new client computers during OS installation without the need for end user or administrator involvement.</td></tr>
<tr><td valign="top">Customize</td><td valign="top">Accesses the Computer Account Generation dialog box on which you can create a custom naming format for the client computer.</td></tr>
<tr><td valign="top">Client Account Location</td><td valign="top">The directory service location of the client computer account, either: 

<br><i>Default Directory Service Location.</i> Specifies that the computer account object for the client computer be created in the Active Directory location where all computer accounts are created by default during the domain join operation. 

<br><i>Same Location As That Of The User Setting Up The Client Computer.</i> Specifies that the client computer account object be created within the same Active Directory container as the user setting up the machine. 

<br><i>Use The Following Directory Service Location.</i> Allows the administrator to set a specific Active Directory container where all client computer account objects installing from this server are created. It is assumed that most administrators will select this option and specify a specific container for all remote installation client computer account objects to be created in.</td></tr>


</table>

<p><li> In the Remote Installation Services Properties dialog box for the server, in the Images tab (see Figure 15.8), view the images installed on the RIS server. Click Add and follow the directions in the wizard to install additional images on the RIS server. Refer to <A HREF="ch15d.htm">Lesson 3</A>, &quot;Administering RIS,&quot; for details.</li></p>

<p>
<img src="images/15wtk08.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 15.8</b> <i>Images tab on the Remote Installation Services Properties dialog box</i><!-- /caption -->
</p>

<p><li> In the Remote Installation Services Properties dialog box for the server, in the Tools tab (see Figure 15.9), view the maintenance and troubleshooting tools installed on the RIS server.</li></p>
<p><li> In the Remote Installation Services Properties dialog box, click OK.</li></p>
<p><li> In the Properties dialog box for the server, click OK.</li></p>
</ol>

<p>Administrators wishing to remotely manage their servers from Windows 2000 Professional workstations can access the administrative tools by installing the Windows 2000 Administration Tools package located on the Windows 2000 Server CD-ROM.</p>

<p>
<img src="images/15wtk09.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 15.9</b> <i>Tools tab on the Remote Installation Services Properties dialog box</i><!-- /caption -->
</p>


<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
When using Windows 2000 Administration Tools on a system other than the RIS server, the administrator cannot add additional OS images or verify the integrity of the RIS server. All other configuration options are available.</blockquote></div>
</p>

<A NAME="857"><h3>Setting RIS Client Installation Options</h3></A>
<p>By setting the RIS client installation options, you can control the options presented to different groups of users during the CIW. There are four client installation options (see Figure 15.4) that can appear on the CIW:</p>

<ul>
<p><li>Automatic Setup</li></p>

<p><li>Custom Setup</li></p>

<p><li>Restart A Previous Setup Attempt</li></p>

<p><li>Maintenance And Troubleshooting</li></p>
</ul>

<p><b>Automatic Setup</b> </p>

<p>The Automatic Setup option is the client installation option that all users of the Remote OS Installation feature have access to by default. The Automatic Setup option allows you to restrict the OS installation options so that that the user simply logs on and the OS installation starts automatically. The user is not prompted during the OS install, which avoids calls to help desk professionals for assistance and saves the organization additional expenses in support costs.</p>

<p>While restricting installation options, you can still allow users to choose the OS for installation. Remote OS Installation allows you to provide a friendly description and associated help text that describes the OS options so that an end user can choose the most appropriate OS.</p>

<p>By preselecting the Remote OS Installation configuration options, you predefine the automatic machine naming format and the location within Active Directory where client computer accounts will be created.</p>

<p><b>Custom Setup</b> </p>

<p>The Custom Setup option is very similar to the Automatic Setup option, yet it provides you with the ability to set up a computer for another person within the organization. This option can be used to fully preinstall a client computer or to prestage the client computer by creating a corresponding computer account within the Active Directory service.</p>

<p>The Custom Setup option lets you override the automatic computer naming and location where the computer account is created within Active Directory. By default, the RIS server will generate a computer name based on a format defined by the Remote OS Installation administrator. You can also define where client computer account objects (CAO) will be created in the Active Directory service during the installation. By default, the automatic computer naming policy is set to create computer names based on the person who logs on to the CIW.</p>

<p><b>Restart A Previous Setup Attempt</b> </p>

<p>The Restart A Previous Setup Attempt option is provided in the event that the installation of the OS fails for any reason. The CIW can be customized to ask a series of questions about the specific OS being installed. When restarting a failed OS setup attempt, the end user is not asked these questions again. Rather, Setup already has this information and simply restarts the file copy operation and completes the OS installation.</p>

<p><b>Maintenance And Troubleshooting</b> </p>

<p>The Maintenance And Troubleshooting option provides access to third-party hardware and software vendor tools. These tools range from system BIOS flash updates and memory virus scanners to a wide range of computer diagnostic tools that check for hardware-related problems. These tools are available before installing and starting the OS on the client computer.</p>

<p>If the option to display the Maintenance And Troubleshooting menu is enabled, user access to individual tool images is controlled in the same way as OS options, by setting specific end user permissions on the individual answer file (.sif) for that tool. For example, you can allow end users access to only one computer diagnostic tool, yet provide help desk professionals with access to the entire suite of diagnostic tools. When the user calls a help desk professional for assistance, the professional can guide him or her through the diagnostic tool for retrieval of information necessary to diagnose the problem being encountered. If the help desk staff must visit the end user for further investigation, they simply log on to the CIW and, based on their credentials, they can access the tools they need to resolve the problem.</p>

<p><li><b>To set client installation options</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>
<p><li> In the console tree, right-click the applicable OU, such as Computers or Domain Controllers, click Properties, then click the Group Policy tab.</li></p>
<p><li> In the Properties dialog box for the group policy, click the group policy object (GPO), then click Edit to start group policy.</li></p>
<p><li> In the Group Policy console tree, click User Configuration, open Windows Settings, then click Remote Installation Services.</li></p>
<p><li> Double-click the Choice Options object.</li></p>
<p>In the Choice Options Properties dialog box (see Figure 15.10), the following installation options affect how the CIW appears to users:</p>
<ul>
<p><li>Automatic Setup</li></p>
<p><li>Custom Setup</li></p>
<p><li>Restart Setup</li></p>
<p><li>Tools</li></p>
</ul>
<p>
<img src="images/15wtk10.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 15.10</b> <i>Choice Options Properties dialog box</i><!-- /caption -->
</p>


<p><li> Click one of the following group policy options for each installation option:</li></p>

<ul>
<p><li> <b>Allow.</b> Use this policy option to offer the installation option to users to which this policy applies.</li></p>

<p><li> <b>Don't Care.</b> Use this policy option to accept the policy settings of the parent container. For example, if the administrator for the entire domain has set group policy that is specific to RIS, and the administrator of this container has chosen the Don't Care option, the policy that is set on the domain is applied to all users that are affected by that policy. Don't Care is the default setting.</li></p>

<p><li> <b>Deny.</b> Use this policy option to deny the users that are affected by this policy access to the installation option.</li></p>
</ul>

<p><li> In the Choice Options Properties dialog box, click OK.</li></p>

<p><li> Close the Group Policy snap-in, and then, in the Properties dialog box for the group policy, click OK.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Because the changes that you make to RIS policy take effect only when the policy is propagated (applied) to your computer, do one of the following to initiate policy propagation:
<ul>
<p><li>Type <b>secedit /refreshpolicy user_policy</b> at the command prompt, then press Enter.</li></p>
<p><li>Restart your computer.</li></p>
<p><li>Wait for automatic policy propagation, which occurs at regular, configurable intervals. By default, policy propagation occurs every eight hours.</li></p>
</ul>
</blockquote></div></p>


<A NAME="858"><h3>Setting RIPrep Image Permissions</h3></A>
<p>By specifying which users or groups of users should have access to the RIPrep OS images available on the RIS server, you can guide users through the selection of the unattended OS installation appropriate for their role within the company. By default, when an OS image is added to an RIS server, the image will be 
available to all users serviced by that RIS server.</p>

<p><li><b>To set RIPrep image permissions</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Accessories, then click Windows Explorer.</li></p>
<p><li> In the \RemoteInstall\Setup\<i>applicable_language</i>\Images\<i>applicable_image_name</i>\i386\templates folder (or the location on the server where you chose to copy image installation files), right-click the appropriate .sif file, then click Properties.</li></p>
<p><li> In the Properties dialog box for the file, click the Security tab.</li></p>
<p><li> Set the appropriate permissions to allow users access to images and click OK.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
To reduce the work involved in maintaining the security applied to images, where possible, set the security on the Templates folder of the image rather than the individual .sif files. Grant or restrict access to groups rather than individual users.</blockquote></div>
</p>

<A NAME="859"><h2>Create an RIPrep Image</h2></A>
<p>To build and maintain standard desktops, many organizations use disk imaging or cloning software that allows you to configure a client computer exactly how you want it, and then make a copy of that image for installation on client computers on the network. Remote OS Installation supports creation and installation of standard desktop images using RIPrep images.</p>

<p>Before you can create an RIPrep image, you must complete the following tasks:</p>

<ul>
<p><li>Create the source computer</li></p>
<p><li>Configure the workstation</li></p>
</ul>

<A NAME="860"><h3>Creating the Source Computer</h3></A>
<p>To create the source computer, use the Remote OS Installation feature to remotely install the base Windows 2000 Professional OS. Once the OS is installed, you can install applications or application suites including in-house line of business (LOB) applications. Then configure the workstation to adhere to company policies. For example, you may choose to define specific screen colors, set the background bitmap to a company-based logo, remove any games installed by the base OS, and set Internet Explorer proxy settings.</p>

<A NAME="861"><h3>Configuring the Workstation</h3></A>
<p>When creating RIPrep images, it is important to understand the relationship of user profiles, the changes made to an RIPrep source computer, and the desired result for users that log on to computers that are installed using the RIPrep image. Applications that carry the &quot;Certified for Windows&quot; logo properly separate user-specific and computer-specific configuration settings and data, and can therefore be installed computer-wide so that they are available to all users of the system. Such applications would also then be available to all users of systems later installed with the resulting RIPrep image. Non-Windows 2000-compliant applications may perform and/or rely on per-user configurations that are specific to the profile of the user actually installing the application prior to running RIPrep (typically a local administrator), rather than to all users of the system. Such configurations remain specific to that user, which may result in the application or configuration setting not being available or not functioning properly for users of computers installed with the RIPrep image. In addition, some nonapplication configuration changes, such as the wallpaper specified for the user desktop, are by default applied only to the current user's profile and will not be applied to users of systems installed with the RIPrep image.</p>

<p>You must thoroughly test any applications or configuration settings desired for use in an RIPrep image to ensure they will work properly with your organization's implementation of user profiles. To test, make the change as one user (typically a local administrator of the computer), log off, and log on as a user account that is representative of your organization. If the changes you made are applied to the second user, the changes will also apply to users that log on to systems installed with an RIPrep image that contains the same change. To complete the test, create an RIPrep image, restore it to a different computer, and log on as a different representative user. Verify that the changes are applied and fully functional.</p>

<p>Some configuration settings can be copied directly from the profile they were applied to (the local administrator in the preceding example) the All Users profile, such as the desktop wallpaper, some Start menu options, and shortcuts. However, all such changes must be tested carefully to verify that their functionality is not broken by the manual adjustments.</p>

<A NAME="862"><h3>Creating an RIPrep Image</h3></A>
<p>When the workstation is configured exactly to specifications, you are ready to create an RIPrep image.</p>

<p><li><b>To create an RIPrep image</b> </li></p>

<ol>
<p><li> On the client workstation, click Start, click Run, then type the Universal Naming Convention (UNC) path of the RIPrep utility in the Open box and click OK. For example: \\<i>Server</i>\<i>Share</i>\RemoteInstall\Admin\I386\ RIPREP.EXE</li></p>

<p><li> In the Welcome To The Remote Installation Preparation Wizard dialog box, click Next.</li></p>

<p><li> Continue through the prompts provided by the Remote Installation Preparation Wizard, including the following:</li></p>
<ul>
<p><li> <b>Server Name.</b> The name of the server to which this installation image will be copied. By default this is the server on which you are running the Remote Installation Preparation Wizard.</li></p>
<p><li> <b>Folder Name.</b> The name of the folder on the RIS server to which this installation image will be copied.</li></p>
<p><li> <b>Friendly Description And Help Text.</b> A friendly description and associated help text that describes the OS image to users of the CIW.</li></p>
</ul>

<p><li> Stop all programs or services on the source computer before proceeding. Review the list of programs or services that are currently running on the source computer, close any running applications, then click Next.</li></p>

<p><li> Review the settings summary, then click Next.</li></p>

<p><li> Review the information from Completing The Remote Installation Preparation Wizard and click Next to replicate the source computer installation image onto the RIS server.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
If the source computer contains a 1 GB disk drive and the destination computer contains a 2 GB disk drive, by default RIS will format the destination computer's drive as a 2 GB partition in the same file system format as the source computer used to create the image.</blockquote></div>
</p>

<ol start="7">
<p>After the initial image questions have been answered, the wizard configures the workstation to a generic state, removing anything unique to the client installation such as the computer's unique security identifier (SID), computer name, and any registry settings unique to that system. Once the preparation phase is complete, the image is automatically replicated to the RIS server provided. After the image is replicated to the RIS server, it is added to the list of available OS installation choices displayed within the CIW. At this point, any remote boot-enabled or compatible client computers that use the PXE-based remote boot technology can install the image.</p>

<p><li> The source computer shuts down when the image replication process is complete. The abbreviated Setup program automatically runs when you restart the source computer. Complete the setup process to use this client computer to create another installation image.</li></p>
</ol>

<A NAME="863"><h3>RIPrep Requirements</h3></A>
<ul>
<p><li>The destination computer (the computer that installs the image posted to the RIS server) is not required to contain hardware identical to that of the source computer that was used to create the image. RIPrep uses the Plug and Play support in the computer running Windows 2000 Professional to detect differences between the source and the destination computers' hardware during image installation. However, the hardware abstraction layer (HAL) drivers must be the same between the source computer and all destination computers that later install the image (for example, they both must be Advanced Configuration and Power Interface (ACPI)-based or both must be non-ACPI-based). In most cases, workstations do not require the unique HAL drivers that servers require.</li></p>
<p><li>The destination computer's disk capacity must be equal to or larger than that of the source computer.</li></p>
<p><li>All copies of Microsoft software made or installed using RIS must be properly licensed. All copies of other software made or installed using RIS must be properly licensed, and it is the licensee's obligation to ensure that it is licensed to make any such copies.</li></p>
</ul>

<A NAME="864"><h3>RIPrep Limitations</h3></A>
<ul>
<p><li>RIPrep currently supports replicating a single disk-single partition (C partition only) Windows 2000 Professional installation to an available RIS server. This means that the OS and all of the applications that make up the standard installation must reside on the C partition prior to running the Remote Installation Preparation Wizard.</li></p>

<p><li>The Remote Installation Preparation Wizard currently allows source image replication only to available RIS servers. Source replication to alternate drives or media types is not supported.</li></p>

<p><li>Replication of encrypted files is not supported.</li></p>

<p><li>Changes made in the source computer's registry before running the Remote Installation Preparation Wizard are not maintained in the installation image.</li></p>

<p><li>Modifications to replicated installation images are not supported.</li></p>
</ul>

<A NAME="865"><h3>Installation Image Sources</h3></A>
<p>When you use the Remote Installation Preparation Wizard to create an installation image of a client computer that was originally installed using a retail version (rather than a Select or original equipment manufacturer [OEM] version) of Windows 2000 Professional, the RIS unattended setup answer file (RIPREP.SIF) must be modified to include the product identification number (PID). The PID is a unique identification number specific to each copy of Windows 2000 Professional used to identify the OS installation and track the number of copies installed throughout an organization.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
If the PID is not entered in the RIPREP.SIF file, the installation process will stop and prompt the user for the PID information during the installation of that RIPrep image.</blockquote></div>
</p>

<p><li><b>To include the PID in the RIPREP.SIF file</b> </li></p>

<ol>
<p><li> Open the RIPREP.SIF file located at \RemoteInstall\Setup\<i>applicable_ language</i>\Images\<i>applicable_image_name</i>\I386\Templates\RIPREP.SIF.</li></p>

<p><li> Type <b>ProductID = &quot;xxxxx-xxx-xxxxxxx-xxxxx&quot;</b> (including the dashes and quotation marks, where x is the PID of the retail version of Windows 2000 Professional) into the [UserData] section of the RIPREP.SIF file.</li></p>
</ol>

<p>The PID for each client installation is randomly generated using the PID entered in the RIPREP.SIF file.</p>

<p>When the source computer OS is installed from the Select or OEM version of the Windows 2000 Professional CD, the PID does not need to be modified in the RIPREP.SIF file.</p>

<A NAME="866"><h2>Creating an RIS Boot Disk</h2></A>
<p>You must create a boot disk to support existing client computers that do not have a PXE-based remote boot-enabled ROM but do have a supported network adapter. The RIS boot disk works like the PXE boot process: Turn on the computer, boot from the RIS boot disk, press F12 to initiate a network service boot, and the CIW is downloaded and starts. Once the CIW starts, the rest of the RIS process is identical regardless of whether the client was booted using a PXE boot ROM or the RIS remote boot disk.</p>

<p><li><b>To create an RIS boot disk</b> </li></p>

<ol>
<p><li> Click Start, click Run, then type the UNC path of the RBFG utility in the Open box and click OK. For example: 

<br>\\<i>server</i>\<i>share</i>\RemoteInstall\Admin\I386\RBFG.EXE</li></p>

<p><li> Insert a formatted disk into the disk drive.</li></p>

<p><li> In the Windows 2000 Remote Boot Disk Generator dialog box (see Figure 15.11), click the appropriate destination drive option (either Drive A or Drive B), and then click Create Disk.</li></p>

<p>
<img src="images/15wtk11.JPG" width=371 height=293 border="0">
</p><p>
<!-- caption --><b>Figure 15.11</b> <i>Windows 2000 Remote Boot Disk Generator dialog box</i><!-- /caption -->
</p>


<p><li> Click Close when the disk is ready, then remove the disk from the disk drive.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
You can use the boot disk only with computers that contain supported PCI-based network adapters. To view the list of supported network adapters, click Adapter List in the Windows 2000 Remote Boot Disk Generator dialog box.</blockquote></div>
</p>

<A NAME="867"><h2>Verifying an RIS Configuration</h2></A>
<p>RIS provides the ability to check the integrity of the RIS-enabled server. You can verify an RIS configuration if you suspect that the server is failing, if you are currently seeing inconsistent behavior, or if you need to restore an RIS volume from backup. The Check Server Wizard checks whether all of the settings, 
services, and configuration options are correctly set and functioning.</p>

<p><li><b>To verify an RIS configuration</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, click the folder that contains the computer whose configuration you want to verify, such as Computers or Domain Controllers.</li></p>

<p><li> In the details pane, right-click the applicable RIS server, then click Properties.</li></p>

<p><li> In the Properties dialog box for the server, in the Remote Install tab, click Verify Server to start the Check Server Wizard.</li></p>

<p><li> On the Welcome To The Check Server Wizard page, click Next.</li></p>

<p><li> Read the summary on the Remote Installation Services Verification Complete page, then click Finish.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
If you are verifying the server configuration because you need to restore an RIS volume from backup, you must verify the server configuration before you restore the volume.</blockquote></div>
</p>

<A NAME="868"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned about the tasks necessary to implement RIS, including setting up and configuring RIS, creating an RIPrep image, creating an RIS boot disk, and verifying an RIS configuration.</p>

</BODY>
</HTML>







