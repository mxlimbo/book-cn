<html>
<head>
<title>Lesson 4: Managing Software Using Group Policy</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12d.htm", "ch12f.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="648"><h1>Lesson 4: Managing Software Using Group Policy</h1></A>
<p>The Software Installation extension, a software management feature of Windows 2000, is the administrator's primary tool for managing software within an organization. Managing software using Software Installation provides your users with immediate access to the software they need to perform their jobs and ensures that users have an easy and consistent experience when working with software throughout its life cycle. Users no longer need to look for a network share, use a CD-ROM, or install, fix, and upgrade software themselves. This lesson walks you through the steps for implementing Software Installation.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li> Deploy software using group policy</li></p>

<p><li> Configure deployment options</li></p>

<p><li> Maintain software using group policy</li></p>
</ul>

<p><b>Estimated lesson time: 75 minutes</b></p>
</blockquote></div>
</p>

<A NAME="649"><h2>Software Management Tools</h2></A>
<p>Three tools are provided with Windows 2000 Server for software installation and maintenance. Table 12.4 describes these tools.</p>

<p><b>Table 12.4</b> <i>Windows 2000 Software Installation and Maintenance Tools</i></p>

<p><table cellpadding=5 width="95%">
<tr><th>Tool</th>
<th>Role</th></tr>

<tr><td valign="top">The Software Installation extension of the Group Policy snap-in</td>
<td valign="top">Used by administrators to manage software</td></tr>

<tr><td valign="top">Windows Installer</td>
<td valign="top">Installs software packaged in Windows 
 Installer files</td></tr>

<tr><td valign="top">Add/Remove Programs in Control Panel</td>
<td valign="top">Used by users to manage software on  their own computers</td></tr>
</table></p>

<A NAME="650"><h3>The Software Installation Extension</h3></A>
<p>The Software Installation extension is the administrator's primary tool for managing software within an organization. Software Installation works in conjunction with group policy and Active Directory, establishing a group policy-based software management system that allows you to centrally manage</p>

<ul>
<p><li> Initial deployment of software.</li></p>

<p><li> Mandatory and nonmandatory upgrades, patches, and quick fixes for software. You can update a version of the software or replace it. You can even upgrade the operating system using service packs.</li></p>

<p><li> Removal of software.</li></p>
</ul>

<p>Using Software Installation, you can centrally manage the installation of software on a client computer by assigning applications to users or computers or by publishing applications for users. <i>Assign</i> required or mandatory software to users or to computers. <i>Publish</i> software that users might find useful to perform their jobs.</p>

<A NAME="651"><h2>Assigning Applications</h2></A>
<p>When you assign an application to a user, the application is advertised to the user the next time he or she logs on to a workstation. The application advertisement follows the user regardless of which physical computer he or she actually uses. This application is installed the first time the user activates the application on the computer, either by selecting the application on the Start menu or by activating a document associated with the application.</p>

<p>When you assign an application to the computer, the application is advertised and the installation is performed when it is safe to do so. Typically this happens when the computer starts up so that there are no competing processes on the computer.</p>

<A NAME="652"><h2>Publishing Applications</h2></A>
<p>When you publish the application to users, the application does not appear 
installed on the users' computers. No shortcuts are visible on the desktop or Start menu, and no changes are made to the local registry on the users' computers. 
Instead, published applications store their advertisement attributes in Active 
Directory. Then, information such as the application's name and file associations is exposed to the users in the Active Directory container. The application is then available for the user to install using Add/Remove Programs in Control Panel or by clicking a file associated with the application (such as an .xls file for Microsoft Excel).</p>

<A NAME="653"><h2>How Software Installation Works</h2></A>
<p>The Software Installation extension uses Windows Installer technology to 
systematically maintain software. Windows Installer is a service that allows the operating system to manage the installation process. Windows Installer is composed of three key parts:</p>

<ul>
<p><li> An operating system service that performs the installation, modification, and removal of the software in accordance with the information in the Windows Installer package.</li></p>

<p><li> The Windows Installer package, a database containing information that describes the installed state of the application.</li></p>

<p><li> An application programming interface (API) that allows applications to interact with Windows Installer to install or remove additional features of the application after the initial installation is complete.</li></p>
</ul>

<p>Because Software Installation leverages Windows Installer, users can take advantage of self-repairing applications. Windows Installer notes when a program file is missing and immediately reinstalls the damaged or missing files, thereby 
fixing the application.</p>

<p>The Windows Installer package is a file that contains explicit instructions on the installation and removal of specific applications. The developer who produces the application provides the Windows Installer package .msi file and ships it with the application. If a Windows Installer package does not come with an application, you might need to create a Windows Installer package, or repackage the application, using a third-party tool.</p>

<p>You can only deploy software using the Software Installation extension if the file type fits one of the following categories:</p>

<ul>
<p><li> Native Windows Installer package (.msi) files are developed as a part of the application and take full advantage of the Windows Installer.</li></p>

<p><li> Repackaged application (.msi) files allow you to repackage applications that do not have a native Windows Installer package in much the same way that you repackage software today to customize installations.</li></p>

<p><li> An existing setup program&#8212;an application (.zap) file&#8212;installs an application by using its original SETUP.EXE program.</li></p>
</ul>

<p>In addition, you can make modifications to customize the installation of a 
Windows Installer package at the time of assignment or publication. Modifications are saved with the .mst file extension.</p>

<p>Other files you may encounter during Software Installation are</p>

<ul>
<p><li> Patch (.msp) files, which are used for bug fixes, service packs, and similar files</li></p>

<p><li> Application assignment scripts (.aas files), which contain instructions associated with the assignment or publication of a package</li></p>
</ul>

<A NAME="654"><h3>Customizing Windows Installer Packages</h3></A>
<p>You can customize Windows Installer applications by using <i>modifications</i>, also called <i>transforms</i>. The Windows Installer package format provides for customization by allowing you to &quot;transform&quot; the original package using authoring and repackaging tools. Some applications also provide wizards or templates that permit a user to create modifications.</p>

<p>For example, Microsoft Office 2000 supplies a Customization Wizard that builds modifications. Using the Microsoft Office 2000 Customization Wizard, you can create a modification that allows you to manage the configuration of Microsoft Office 2000 that is deployed to users. A modification might be designed to 
accommodate Microsoft Word as a key feature, installing it during the first installation. Less popular features, such as revision support or document translators, could install on first usage, and other features, such as clip art, might not install at all. You might have another modification that provides all of the features of Word and does not install Microsoft PowerPoint. The exact mix of which 
features to install and when to install them varies based on the audience for the application and how they use the software.</p>

<A NAME="655"><h2>Implementing Software Installation</h2></A>
<p>The tasks for implementing software installation are</p>

<ol>
<p><li> Planning and preparing the software installation</li></p>

<p><li> Setting up a software distribution point</li></p>

<p><li> Specifying software installation defaults</li></p>

<p><li> Deploying software applications</li></p>

<p><li> Setting automatic installation options</li></p>

<p><li> Setting up application categories</li></p>

<p><li> Setting software application properties</li></p>

<p><li> Maintaining software applications</li></p>
</ol>

<A NAME="656"><h2>Planning and Preparing a Software Installation</h2></A>
<p>When planning a software installation</p>

<ul>
<p><li> Review your organization's software requirements on the basis of your overall organizational structure within Active Directory and your available GPOs</li></p>

<p><li> Determine how you want to deploy your applications</li></p>

<p><li> Create a pilot to test how you want to assign or publish software to users or computers</li></p>

<p><li> Prepare your software using a format that allows you to manage it based on what your organization requires, and test all of the Windows Installer packages or repackaged software</li></p>
</ul>

<p>Table 12.5 describes strategies and considerations for implementing a software installation. Some of these strategies might seem contradictory, but select the strategies that meet your business goals.</p>

<p><b>Table 12.5</b> <i>Strategies and Considerations for Implementing Software Installation</i></p>

<p><table cellpadding=5 width="95%">
<tr><th>Strategy</th>
<th>Considerations</th></tr>

<tr><td valign="top">Create OUs based on software management needs.</td>
<td valign="top">Allows you to target applications to the appropriate set of users. Group policy security settings are not required to target the appropriate set of users.</td></tr>

<tr><td valign="top">Deploy software close to the root in the Active Directory tree.</td>
<td valign="top">Makes it easy to provide all users in an organization with access to an application. This reduces administration because you can deploy a single GPO rather than having to  re-create that object in multiple containers deep in the Active Directory tree.</td></tr>

<tr><td valign="top">Deploy multiple applications with a single GPO.</td>
<td valign="top">Reduces administration overhead by allowing you to create and manage a single GPO rather than multiple GPOs. The logon process is faster because a single GPO deploying 10 applications processes faster than 10 GPOs each deploying one application. This is appropriate in organizations where users share the same core set of applications.</td></tr>

<tr><td valign="top">Publish or assign one application only once in the same GPO or a series of GPOs that might apply to a single user or computer.</td>
<td valign="top">Makes it easier to determine which instance of in the application applies to the user or computer.</td></tr></table></p>

<p>Software licenses are required for software written by independent software vendors and distributed using software distribution points (SDPs). It is your responsibility to match the number of users who can access software to the number of licenses you have on hand. It is also your responsibility to verify that you are working within the guidelines provided by each independent software vendor with the software.</p>

<p>Gather the package formats for the software and perform any necessary modifications to the packages.</p>

<A NAME="657"><h2>Setting Up an SDP</h2></A>
<p>After you have planned and prepared for software management, the next step is to copy the software to one or more SDPs, network locations from which people are able to get the software that they need.</p>

<p><li><b>To set up a software distribution point</b></li></p>

<ol>
<p><li> Create the folders for the software on the file server that will be the SDP and make the folders network shares. For example: \\<i>server</i>\<i>share</i></li></p>

<p><li> Replicate the software to the SDPs by placing or copying the software, packages, modifications, all necessary files, and components to a distribution share(s). Place all software (the package and all related installation files) in a separate folder on the SDP.</li></p>

<p><li> Set the appropriate permissions on the folders so that only administrators can change the files (Read and Write), and users can only read the files from the SDP folders and shares. Use group policy to manage the software within the appropriate GPO.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
Some software supports special commands to facilitate the creation of an SDP. For example, Microsoft Office 2000 should be prepared by running SETUP /A from a command prompt. This allows you to enter the software key once for all users, and the network share (SDP) location to copy the files to. Other software might have other ways to expand any compressed files from the distribution media and transfer the files to the appropriate location.</blockquote></div>
</p>

<A NAME="658"><h2>Specifying Software Installation Defaults</h2></A>
<p>A GPO can contain several settings that affect how an application is installed, managed, and removed. You can globally define the default settings for the new packages within the GPO in the General tab of the Software Installation Properties dialog box. Some of these settings can be changed later by editing the package properties in the Software Installation extension.</p>

<p><li><b>To specify software installation defaults</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then in Computer or User Configuration open Software Settings.</li></p>

<p><li> Right-click the Software Installation node, then click Properties.</li></p>

<p><li> In the General tab of the Software Installation Properties dialog box (see Figure 12.17), type the path to the default SDP for packages (.msi files) in the Default Package Location box.</li></p>

<p>
<img src="images/12wtk16.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 12.17</b> <i>General tab of the Software Installation Properties dialog box</i><!-- /caption -->
</p>


<p><li> In the New Packages section, select one of the following:</li></p>

<ul>
<p><li> <b>Display The Deploy Software Dialog Box</b> to specify that when you add a new package, the Deploy Software dialog box will display, allowing you to assign, publish, or configure package properties.</li></p>

<p><li> <b>Publish</b> to specify that when you add a new package, by default you want it published with standard package properties. Packages can only be published to users, not computers. If this is an installation under the Computer Configuration node of the Group Policy snap-in, the Publish choice appears dimmed.</li></p>

<p><li> <b>Assign</b> to specify that when you add a new package by default, you want it assigned with standard package properties. Packages can be assigned to users and computers.</li></p>

<p><li> <b>Advanced Published Or Assigned</b> to specify that when you add a new package, the Configure Package Properties form should appear.</li></p>
</ul>

<p><li> In the Installation User Interface Options section, select one of the following:</li></p>

<ul>
<p><li> <b>Basic</b> to provide only a basic display of the install process.</li></p>

<p><li> <b>Maximum</b> to provide all installation messages and screens during the package installation.</li></p>
</ul>

<p><li> Check the Uninstall The Applications When They Fall Out Of The Scope Of Management check box to specify that the package should be removed when the GPO no longer applies to users or computers.</li></p>

<p><li> Click OK.</li></p>
</ol>

<A NAME="659"><h2>Deploying Software Applications</h2></A>
<p>Given that software can be either assigned or published, and targeted to users or computers, you can establish a workable combination to meet your software management goals. Table 12.6 details the different approaches.</p>

<p><b>Table 12.6</b> <i>Software Deployment Approaches</i></p>

<p><table cellpadding=5 width="95%">
<tr><th></th>
<th>Publish (User Only)</th>
<th>Assign (User)</th>
<th>Assign (Computer)</th></tr>

<tr><td valign="top">After deployment the software is available for installation after:</td>
<td valign="top">The next logon</td>
<td valign="top">The next logon</td>
<td valign="top">The next time the computer starts</td></tr>

<tr><td valign="top">Typically the user installs the software from:</td>
<td valign="top">Add/Remove Programs in Control Panel</td>
<td valign="top">Start menu or Desktop shortcut</td>
<td valign="top">The software is already installed (the software automatically installs when the computer reboots)</td></tr>

<tr><td valign="top">If the software is not installed, and the user opens a file associated with the software, does the software install?</td>
<td valign="top">Yes (if auto-install is turned on)</td>
<td valign="top">Yes</td>
<td valign="top">Does not apply; the software is already installed</td></tr>

<tr><td valign="top">Can the user remove the software using Add/Remove Programs in Control Panel?</td>
<td valign="top">Yes, and the user can choose to install it again from Add/Remove Programs in Control Panel</td>
<td valign="top">Yes, and the software is available for installation again from the typical install points</td>
<td valign="top">No. Only the local administrator can remove the software; a user can run a repair on the software</td></tr>

<tr><td valign="top">Supported installation files:</td>
<td valign="top">Windows Installer packages, .zap files</td>
<td valign="top">Windows Installer packages</td>
<td valign="top">Windows Installer packages</td></tr>
</table></p>

<p>Modifications, or .mst files, are customizations applied to Windows Installer packages. A modification must be applied at the time of assignment or publication, not at the time of installation.</p>

<A NAME="660"><h3>Assigning Applications</h3></A>
<p>Assign an application when you want everyone to have the application on his or her computer. An application can be published to both computers and users.</p>

<p><li><b>To assign applications</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Right-click the Software Installation node, click New, and click Package.</li></p>

<p>The File Name list in the Open dialog box shows those Windows Installer packages located at the SDP you specified as the default. If the Windows 
Installer package is located on a different network share, you can browse to find the SDP for the package.</p>

<p><li> In the File Name list in the Open dialog box, select the Windows Installer package to be assigned, then click Open.</li></p>

<p><li> In the Deploy Software dialog box (see Figure 12.18), click Assigned, then click OK. If this is an application under the Computer Configuration node of the Group Policy snap-in, the Published choice appears dimmed, because packages can only be assigned to computers, not published.</li></p>

<p>
<img src="images/12wtk17.JPG" width=347 height=233 border="0">
</p><p>
<!-- caption --><b>Figure 12.18</b> <i>Deploy Software dialog box</i><!-- /caption -->
</p>

</ol>

<A NAME="661"><h3>Publishing Applications</h3></A>
<p>Publish an application when you want the application to be available to people managed by the GPO, should they want the application. With published applications it is up to each person to decide whether or not to install the published application. An application can only be published to users.</p>

<p><li><b>To publish applications</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in User Configuration, open Software Settings.</li></p>

<p><li> Right-click the Software Installation node, click New, then click Package.</li></p>

<p>The File Name list in the Open dialog box shows those packages located at the SDP you specified as the default. If the Windows Installer package is 
located on a different network share, you can browse to find the SDP for 
the package.</p>

<p><li> In the File Name list in the Open dialog box, select the Windows Installer package to be published, then click Open.</li></p>

<p><li> In the Deploy Software dialog box (see Figure 12.18), click Published, then click OK.</li></p>

<p>The application is available for users to install either by using Add/Remove Programs in Control Panel or by opening a file with a file name extension that you have associated with the application.</p>
</ol>

<A NAME="662"><h3>Deploying Applications with Modifications</h3></A>
<p>Modifications are associated with the Windows Installer package at deployment time rather than when the Windows Installer is actually using the package to 
install or modify the application. Modifications (.mst files) are applied to 
Windows Installer packages (which have the .msi extension) in an order specified by the administrator. This order must be determined before the application is 
assigned or published.</p>

<p><li><b>To add or remove modifications for applications</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Right-click the Software Installation node, click New, then click Package.</li></p>

<p><li> In the File Name list in the Open dialog box, select the Windows Installer package to be published, then click Open.</li></p>

<p><li> In the Deploy Software dialog box, click Advanced Published Or Assigned, then click OK.</li></p>

<p><li> In the Properties dialog box for the package, click the Modifications tab (see Figure 12.19).</li></p>

<p>
<img src="images/12wtk18.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 12.19</b> <i>Modifications tab of the Properties dialog box</i><!-- /caption -->
</p>


<ul>
<p><li> To add modifications, click Add. In the Open dialog box, browse to find the modification file (.mst), then click Open. You can add multiple modifications.</li></p>

<p><li> To remove modifications, click the modification you want to remove, then click Remove. Repeat until each unwanted modification has been removed.</li></p>

<p><li> To set the order of modifications, select a modification and then click Move Up or Move Down. Modifications are applied according to the order specified in the list.</li></p>
</ul>

<p><li> Make sure that the modifications are configured exactly the way you want them, then click OK.</li></p>
</ol>

<p>
<div class="warning"><blockquote><b>IMPORTANT</b><hr>
Do not click OK until you have finished configuring the modifications. When you click OK, the package is assigned or published immediately. If the modifications are not properly configured you will have to uninstall the package or upgrade the package with a correctly configured version.</blockquote></div>
</p>

<A NAME="663"><h2>Setting Automatic Installation Options</h2></A>
<p>To determine which application users install when they select a file, you can 
select a file extension and configure a priority for installing applications 
associated with the file extension using the File Extensions tab in the Software Installation Properties dialog box. The first application listed is the application installed in association with the file extension.</p>

<p>For example, if you use a GPO to deploy both Microsoft Word 2000 and Microsoft FrontPage 2000, both of these applications can edit HyperText Markup Language (HTML) documents, files with the .htm extension. To configure the file extension priority so that users who are managed by this GPO always install Microsoft FrontPage, set FrontPage as the application with the highest priority for the .htm extension. When users managed by this GPO who have installed neither Microsoft Word 2000 nor Microsoft FrontPage 2000 receive an .htm file (by e-mail or other means) and they double-click on the .htm file, Software Installation installs FrontPage 2000 and opens the .htm file for editing. Without Software Installation, the user would see the Open With dialog box and be asked to select the best alternative from the software already present on his or her computer.</p>

<p>File extension associations are managed on a per-GPO basis. Changing the priority order in a GPO affects only those users who have that GPO applied to them.</p>

<p><li><b>To set automatic installation options based on file name extension</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Right-click the Software Installation node, then click Properties.</li></p>

<p><li> In the File Extensions tab of the Software Installation Properties dialog box (see Figure 12.20), select the file extension for which you want to specify an automatic software installation from the Select File Extension list.</li></p>

<p><li> In the Application Precedence list box, move the application with the highest precedence by default to the top of the list using the Up or Down buttons. The application at the top of the list is automatically installed if a document with the selected file name extension is invoked before the application has been installed.</li></p>

<p><li> Click OK.</li></p>

<p>
<img src="images/new12-20.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 12.20</b> <i>File Extensions tab of the Software Installation Properties dialog box</i><!-- /caption -->
</p>

</ol>

<A NAME="664"><h2>Setting Up Application Categories</h2></A>
<p>You can organize assigned and published applications into logical categories to make it easier for users to locate the appropriate application from within Add/Remove Programs in Control Panel. Windows 2000 does not ship with any 
predefined categories.</p>

<p>The categories that you establish are per domain, not per GPO. You only need to define them once for the whole domain.</p>

<p><li><b>To set up categories for applications to be managed</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Right-click the Software Installation node, then click Properties.</li></p>

<p><li> In the Categories tab of the Software Installation Properties dialog box (see Figure 12.21), click Add.</li></p>

<p><li> In the Enter New Category dialog box, type the name of the application category in the Category box and click OK.</li></p>

<p><li> On the Software Installation Properties dialog box, click OK.</li></p>

<p>
<img src="images/12wtk20.JPG" width=404 height=448 border="0">
</p><p>
<b>Figure 12.21</b> <i>Categories tab of the Software Installation Properties dialog box</i></caption>
</p>
</ol>

<A NAME="665"><h2>Setting Software Application Properties</h2></A>
<p>You can fine-tune each application by editing installation options, specifying 
application categories to be used, and setting permissions for the software 
installation.</p>

<A NAME="666"><h3>Editing Installation Options for Applications</h3></A>
<p>Although you may have globally defined the default settings for new packages within the GPO in the General tab of the Software Installation Properties dialog box, some of these same settings can be changed later by editing the package properties. Installation options affect how an application is installed, managed, and removed.</p>

<p><li><b>To edit installation options for applications</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Click the Software Installation node.</li></p>

<p><li> In the details pane, right-click the application for which you want to edit installation options, then click Properties.</li></p>

<p><li> In the Deployment tab of the Properties dialog box for the application (see Figure 12.22), select one of the following in the Deployment Type area:</li></p>

<ul>
<p><li> <b>Published</b> to allow users in the selected site, domain, or OU to install the application using either Add/Remove Programs in Control Panel or the application installation by file activation.</li></p>

<p><li> <b>Assigned</b> to allow users in the selected site, domain, or OU to receive this application the next time they log on (for assignment to users) or when the computer restarts (for assignment to computers).</li></p>
</ul>

<p>
<img src="images/12wtk21.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 12.22</b> <i>Deployment tab of the Properties dialog box</i><!-- /caption -->
</p>


<p><li> In the Deployment Options area, select one of the following:</li></p>

<ul>
<p><li> <b>Auto-Install This Application By File Extension Activation</b> to use the application precedence for the file name extension as determined in the File Extensions tab of the Software Installation Properties dialog box. If this is an application under the Computer Configuration node of the Group Policy snap-in, the check box appears dimmed and selected, because by default the application is installed automatically.</li></p>

<p><li> <b>Uninstall This Application When It Falls Out Of The Scope Of Management</b> to remove the application at logon (for users) or startup (for computers) if they move to a site, domain, or OU for which the application is not deployed.</li></p>

<p><li> <b>Do Not Display This Package In The Add/Remove Programs Control Panel</b> to specify that this package should not be displayed in Add/Remove Programs in Control Panel.</li></p>
</ul>

<p><li> In the Installation User Interface Options area, select one of the following:</li></p>

<ul>
<p><li> <b>Basic</b> to provide only a basic display to users during the install process.</li></p>

<p><li> <b>Maximum</b> to provide all installation messages and screens to users during the package installation.</li></p>
</ul>

<p><li> Click Advanced to display the Advanced Deployment Options dialog box. In the Advanced Deployment Options area, select either of the following check boxes:</li></p>

<ul>
<p><li> <b>Ignore Language When Deploying This Package</b> to specify whether to deploy the package even if it is in a different language.</li></p>

<p><li> <b>Remove Previous Installs Of This Product From</b> (Users/Computers) <b>If Product Was Not Installed By Group Policy-Based Software Installation</b> to specify whether to remove previous installs of this product from users or computers if product was not installed by group policy-based Software Installation.</li></p>
</ul>

<p><li> Click OK.</li></p>

<p><li> On the Properties dialog box, click OK.</li></p>
</ol>

<A NAME="667"><h3>Specifying Application Categories</h3></A>
<p>You must associate applications with existing categories. Categories you set 
generally pertain to published applications only, as assigned applications do not appear in Add/Remove Programs in Control Panel. The application appears in the selected categories in Add/Remove Programs, which the user can use to install the application.</p>

<p><li><b>To specify application categories for Add/Remove Programs in Control Panel</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Click the Software Installation node.</li></p>

<p><li> In the details pane, right-click the application for which you want to specify application categories, then click Properties.</li></p>

<p><li> In the Categories tab of the Properties dialog box for the application (see Figure 12.23), click the category you want to specify from the Available Categories list, then click Select.</li></p>

<p><li> Repeat Step 4 to specify additional categories. Click OK when you finish selecting categories.</li></p>

<p>
<img src="images/12wtk22.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 12.23</b> <i>Categories tab of the Properties dialog box</i><!-- /caption -->
</p>


</ol>

<A NAME="668"><h3>Setting Permissions for Software Installation</h3></A>
<p>Permissions set for software installation pertain only to the application installation.</p>

<p><li><b>To set permissions for software installation</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Click the Software Installation node.</li></p>

<p><li> In the details pane, right-click the application for which you want to specify software installation permissions, then click Properties.</li></p>

<p><li> In the Security tab of the application's Properties dialog box, click the security group on which to set permissions.</li></p>

<p>Administrators who manage the application installation should have the Full Control permission set to Allow. Users who use the software assigned or 
published by the application should have the Read permission set to Allow.</p>

<p><li> Click OK.</li></p>
</ol>

<A NAME="669"><h2>Maintaining Software Applications</h2></A>
<p>After the deployment of software applications it may be necessary to upgrade or remove them at some point in the software life cycle.</p>

<A NAME="670"><h3>Upgrading Applications</h3></A>
<p>Several events in the life cycle of the software can trigger an upgrade, including the following:</p>

<ul>
<p><li> The original developer of the software might release a new version with new and improved features</li></p>

<p><li> The organization might choose to use a different vendor's application</li></p>
</ul>

<p>Upgrades typically involve major changes to the software and normally have new version numbers. Usually a substantial number of files change for an upgrade. You can use the Software Installation extension to establish the procedure to 
upgrade an existing application to the current release.</p>

<p><li><b>To upgrade applications</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then, in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Click the Software Installation node.</li></p>

<p><li> In the details pane, right-click the Windows Installer package that will function as the upgrade (not the package to be upgraded), then click Properties. You will have previously assigned or published this package.</li></p>

<p><li> In the Upgrades tab of the application's Properties dialog box, click Add to create or add to the list of packages that are to be upgraded by the current package.</li></p>

<p><li> In the Add Upgrade Package dialog box (see Figure 12.24), specify either Current Group Policy Object or A Specific GPO as the source of the package to be upgraded. In the latter case, click Browse, click the GPO you want, and then in the Browse For A Group Policy Object dialog box, click OK.</li></p>

<p>A list of all the other packages assigned to be published within the selected GPO appears under the heading Package To Upgrade. Depending on the GPO, this list may have zero or more entries.</p>

<p><li> Click the package to upgrade.</li></p>

<p><li> Click either Uninstall The Existing Package, Then Install The Upgrade Package, or Package Can Upgrade Over The Existing Package, then click OK. Typically, the uninstall option is for replacing an application with a completely different one (perhaps from a different vendor). The upgrade option is for installing a newer version of the same product while retaining the user's application preferences, document type associations, and so on.</li></p>

<p><li> On the Upgrades tab in the Properties dialog box, enable the Required Upgrade For Existing Packages check box if you want the upgrade to be mandatory, then click OK.</li></p>

<p>If this is an upgrade under the Computer Configuration node of the Group Policy snap-in, the check box appears dimmed and selected, because 
packages can only be assigned to computers, not published.</p>

<p>
<img src="images/12wtk23.JPG" width=384 height=386 border="0">
</p><p>
<!-- caption --><b>Figure 12.24</b> <i>Add Upgrade Package dialog box</i><!-- /caption -->
</p>


</ol>

<A NAME="671"><h3>Removing Applications</h3></A>
<p>At some point, users may no longer require an application, so you may need to remove it. The following two scenarios are addressed through the removal choices set within the Software Installation extension:</p>

<ul>
<p><li> <b>A version of a software application is no longer supported.</b> Administrators can remove the software version from Software Installation without forcing the (physical) removal of the software from the computers of users who are still using the software. Users can continue to use the software until they remove it themselves. No user is able to install the software version (from the Start menu, from Add/Remove Programs in Control Panel, or by document invocation).</li></p>

<p><li> <b>A software application is no longer used.</b> Administrators can force the removal of the software. The software is automatically deleted from a computer, either the next time the computer is turned on (when the software is assigned to the computer), or the next time the user logs on (when the software is assigned to the user). Users cannot install or run the software.</li></p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
When you originally deploy the software, if you want the application to 
be removed when a GPO no longer applies, select the Uninstall This Application When It Falls Out Of The Scope of Management option.</blockquote></div>
</p>

<p><li><b>To remove applications</b></li></p>

<ol>
<p><li> Open the Group Policy snap-in, then in Computer or User Configuration, open Software Settings.</li></p>

<p><li> Click the Software Installation node.</li></p>

<p><li> In the details pane, right-click the application you want to remove, click All Tasks, then click Remove.</li></p>

<p><li> In the Remove Software Dialog box, select one of the following removal options:</li></p>

<ul>
<p><li> <b>Immediately Uninstall The Software From Users And Computers.</b> Select this option to specify that the application be removed the next time a user logs on or restarts the computer.</li></p>

<p><li> <b>Allow Users To Continue To Use The Software, But Prevent New Installations.</b> Select this option to specify that users can continue to use the application if they have already installed it. If they remove the application or have never installed it, they will not be able to install it.</li></p>
</ul>

<p><li> Click OK.</li></p>
</ol>

<A NAME="672"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned how the Software Installation extension helps you specify how applications are installed and maintained in your organization. You can centrally manage the installation of software on a client computer by assigning applications to users or computers or by publishing applications for users. <i>Assign</i> required or mandatory software to users or to computers. <i>Publish</i> software that users might find useful to perform their jobs.</p>

<p>The Software Installation extension uses Windows Installer technology to 
systematically maintain software. The Windows Installer package is a file that contains explicit instructions on installing and removing specific applications.</p>

<p>You also walked through the tasks for implementing software installation, which are: planning and preparing, setting up an SDP, specifying software installation defaults, deploying software applications, setting automatic installation options, setting up application categories, setting software application properties, and maintaining software applications.</p>

</BODY>
</HTML>







