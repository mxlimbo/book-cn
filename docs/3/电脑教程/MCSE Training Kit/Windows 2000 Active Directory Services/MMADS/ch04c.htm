<html>
<head>
<title>Lesson 2: Installing Active Directory</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch04b.htm", "ch04d.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="161"><h1>Lesson 2: Installing Active Directory</h1></A>
<p>This lesson presents information on installing and removing Active Directory 
including using the Active Directory Installation Wizard. In addition, the lesson addresses the 
database and shared system volume that Active Directory creates during installation and setting up 
DNS for Active Directory. Finally, the lesson discusses domain modes.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li> Install Active Directory</li></p>

<p><li> Remove Active Directory from a domain controller</li></p>
</ul>

<p><b>Estimated lesson time: 25 minutes</b> </p>
</blockquote></div>
</p>

<A NAME="162"><h2>The Active Directory Installation Wizard</h2></A>
<p>The Active Directory Installation Wizard can perform the following tasks:</p>

<ul>
<p><li> Add a domain controller to an existing domain</li></p>

<p><li> Create the first domain controller of a new domain</li></p>

<p><li> Create a new child domain</li></p>

<p><li> Create a new domain tree</li></p>

<p><li> Install a DNS server</li></p>

<p><li> Create the database and database log files</li></p>

<p><li> Create the shared system volume</li></p>

<p><li> Remove Active Directory services from a domain controller</li></p>
</ul>

<p>To launch the Active Directory Installation Wizard, run Configure Your Server on the Administrative 
Tools menu of the Start menu, or run DCPROMO from the command prompt. These two methods will run the 
Active Directory Installation Wizard on a stand-alone server and help you through the process of installing 
Active Directory on the computer and creating a new domain controller.</p>

<p>As you install Active Directory, you can choose whether to add the new domain controller to an existing 
domain or create the first domain controller for a new domain.</p>

<A NAME="163"><h3>Adding a Domain Controller to an Existing Domain</h3></A>
<p>If you choose to add a domain controller to an existing domain, you create a peer domain controller. 
You create peer domain controllers for redundancy and to 
reduce the load on the existing domain controllers.</p>

<A NAME="164"><h3>Creating the First Domain Controller for a New Domain</h3></A>
<p>If you choose to create the first domain controller for a new domain, you create a new domain. You 
create domains on your network to partition your information, which enables you to scale Active Directory 
to meet the needs of your organization. When you create a new domain, you can create a new child domain or 
a new tree. Table 4.1 describes creating a new child domain and creating a new 
domain tree.</p>

<p><b>Table 4.1</b> <i>Creating New Domains</i></p>

<p>
<table valign="top" cellpadding="5" width="95%">

<tr>
<th>Creating a New Domain</th><th> Description</th>
</tr>

<tr>
<td valign="top">New child domain </td>
<td valign="top">When you create a child domain, the new domain is a child domain in an existing domain.</td>
</tr>

<tr>
<td valign="top">New domain tree </td>
<td valign="top">When you create a new tree, the new domain is not part of an existing domain. You can create a new 
tree in an existing forest, or you can create a new forest.</td>
</tr>
</table>
</p>

<A NAME="165"><h2>Configuring DNS for Active Directory</h2></A>

<p>Active Directory uses DNS as its location service, enabling computers to find the location of domain 
controllers. To find a domain controller in a particular 
domain, a client queries DNS for resource records that provide the names and IP addresses of the 
Lightweight Directory Access Protocol (LDAP) servers for the domain. LDAP is the protocol used to query 
and update Active Directory, and all domain controllers run the LDAP service. You cannot install Active 
Directory without having DNS on your network, because Active Directory uses DNS as its 
location service. However, you can install DNS separately without Active Directory.</p>

<p>You can configure your Windows 2000 DNS server automatically using the 
Active Directory Installation Wizard. Unless you are using a DNS server other than 
Windows 2000 or you want to perform a special configuration, you do not need to manually configure 
DNS to support Active Directory. However, if you want to set up a configuration other than the default 
configuration that the Active Directory Installation Wizard sets up, you can manually configure DNS using 
the DNS console. Manually configuring DNS is beyond the scope of this course; refer to the <i>MCSE Training 
Kit</i>&#8212;<i>Microsoft Windows 2000 Network Infrastructure Administration</i>, for more information 
on this topic.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
For detailed information on configuring DNS for Active Directory, see <A HREF="ch05a.htm">Chapter 5</A>, 
&quot;DNS and Active Directory Integration.&quot;</blockquote></div>
</p>

<A NAME="166"><h2>The Database and Shared System Volume</h2></A>
<p>Installing Active Directory creates the database and database log files, as well as the shared 
system volume. Table 4.2 describes these files.</p>

<p><b>Table 4.2</b> <i>Types of Files Created by Installing Active Directory</i></p>

<p>
<table valign="top" cellpadding="5" width="95%">

<tr>
<th>Type of File Created</th> <th>Description</th>
</tr>

<tr>
<td valign="top">Database and database log files</td> 
<td valign="top">The database is the directory for the new domain. 
The default location for the database and database log files is 
<i>systemroot</i>\NTDS, where <i>systemroot</i> is the Windows 2000 directory. 
For best performance, place the database and the log file on separate hard disks.</td>
</tr>

<tr>
<td valign="top">Shared system volume </td>
<td valign="top">The shared system volume is a folder structure that exists on all Windows 2000 domain 
controllers. It stores scripts and some of the group policy objects for both the current domain and the 
enterprise. The default location for the shared system volume is <i>systemroot</i>\SYSVOL. The 
 shared system volume must be located on a partition or 
 volume formatted with Microsoft Windows NT file 
 system (NTFS) 5.0.</td>
</tr>
 </table>
</p>

<p>Replication of the shared system volume occurs on the same schedule as replication of the Active 
Directory. As a result, you may not notice file replication to or from the newly created system volume 
until two replication periods have elapsed (typically, 10 minutes). This is because the first file 
replication period updates the configuration of other system volumes so that they are aware of the newly 
created system volume.</p>

<A NAME="167"><h2>Domain Modes</h2></A>
<p>There are two domain modes: mixed mode and native mode.</p>

<A NAME="168"><h3>Mixed Mode</h3></A>
<p>When you first install or upgrade a domain controller to Windows 2000 Server, the domain controller is set to run in <i>mixed mode.</i> Mixed mode allows the 
domain controller to interact with any domain controllers in the domain that are running previous versions of Windows NT.</p>

<A NAME="169"><h3>Native Mode</h3></A>
<p>When all the domain controllers in the domain run Windows 2000 Server, and you do not plan to add 
any more pre-Windows 2000 domain controllers to the domain, you can switch the domain from mixed mode 
to <i>native mode.</i></p>

<p>During the conversion from mixed mode to native mode</p>

<ul>
<p><li> Support for pre-Windows 2000 replication ceases. Because pre-Windows 2000 replication is gone, you 
can no longer have any domain controllers in your domain that are not running Windows 2000 Server.</li></p>

<p><li> You can no longer add new pre-Windows 2000 domain controllers to the domain.</li></p>

<p><li> The server that served as the primary domain controller during migration is no longer the 
domain master; all domain controllers begin acting as peers.</li></p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
The change from mixed mode to native mode is one-way only; you cannot change from native mode to mixed mode.</blockquote></div>
</p>

<p><li><b>To change the domain mode to native mode</b> </li></p>

<ol>

<p><li> Click Start, point to Programs, point to Administrative Tools, and then click Active Directory 
Users and Computers.</li></p>

<p><li> Right-click the domain and then click Properties.</li></p>

<p><li> On the General tab, click Change Mode.</li></p>

<p><li> In the Active Directory message box, click Yes, then click OK.</li></p>

<p><li> Restart your computer.</li></p>
</ol>

<A NAME="170"><h2>Removing Active Directory Services from a Domain Controller</h2></A>
<p>Running DCPROMO from the Run dialog box on an existing domain controller allows you to 
remove Active Directory from the domain controller, thus demoting it to a member server. If 
the domain controller is the last domain controller in the domain, it will become a stand-alone server. 
If you remove Active Directory from all domain controllers in a domain, you also delete the directory 
database for the domain, and the domain no longer exists. Computers joined to this domain can no longer 
log on to the domain or use domain services.</p>

<p><li><b>To remove Active Directory from a domain controller</b> </li></p>

<ol>

<p><li> Log on as Administrator.</li></p>

<p><li> Click Start, click Run, and then type <b>DCPROMO</b> in the Open box and click OK.</li></p>


<p>The Active Directory Installation Wizard appears.</p>


<p><li> Click Next on the Welcome To The Active Directory Installation Wizard page.</li></p>

<p><li> If the server is the last domain controller in the domain, select the check box, then click 
Next.</li></p>

<p><li> Enter a user name and password with Enterprise Administrator privileges for the domain, then 
click Next.</li></p>

<p><li> Enter and confirm the password to be assigned to the server Administrator account, 
then click Next.</li></p>

<p><li> Click Next on the Summary page.</li></p>

<p><li> Click Finish to complete the removal of Active Directory from the computer.</li></p>
</ol>

<p>
<img src="images/practic.JPG" width=92 height=74 border="0">
</p>

<A NAME="171"><h2>Practice: Installing Active Directory</h2></A>
<p>In this practice you install Active Directory on your stand-alone server, which will make it a domain controller of a new domain. In Exercise 1 you use the DCPROMO program and Active Directory Installation Wizard to install Active 
Directory. In Exercise 2 you view the domain you have created. In Exercise 3 you are introduced to the Active Directory Users and Computers console. In 
Exercise 4 you confirm that the DNS service is working.</p>

<A NAME="172"><h3>Exercise 1: Promoting a Stand-Alone Server to a Domain Controller</h3></A>
<p>In this exercise, you run DCPROMO to install the Active Directory service on your stand-alone server, 
making it a domain controller in a new domain, in a new tree, and in a forest.</p>

<p><li><b> To install the Active Directory service on a stand-alone server</b> </li></p>

<ol>

<p><li> Restart your computer and log on as Administrator.</li></p>

<p><li> If the Windows 2000 Configure Your Server page opens, close it because the DCPROMO program 
will be used instead to accomplish the tasks in this practice.</li></p>

<p><li> Click Start and then click Run.</li></p>


<p>The Run dialog box appears.</p>


<p><li> Type <b>DCPROMO</b> in the Open box and click OK.</li></p>


<p>The Active Directory Installation Wizard appears.</p>


<p><li> Click Next.</li></p>


<p>The Domain Controller Type page appears.</p>


<p><li> Select Domain Controller For A New Domain, then click Next.</li></p>


<p>The Create Tree Or Child Domain page appears.</p>


<p><li> Ensure that Create A New Domain Tree is selected, then click Next.</li></p>


<p>The Create Or Join Forest page appears.</p>


<p><li> Select Create A New Forest Of Domain Trees, then click Next.</li></p>


<p>The New Domain Name page appears.</p>


<p><li> In the Full DNS Name For New Domain box, type <b>microsoft.com</b> and click Next.</li></p>


<p>(If you are not using microsoft.com as your DNS domain name, type the name you are using for your DNS 
domain name.)</p>

<p>After a few moments, the NetBIOS Domain Name page appears.</p>


<p><li> Ensure that MICROSOFT (or a shortened form of the DNS name you have chosen) appears in the Domain 
NetBIOS Name box, then click Next.</li></p>


<p>The Database and Log Locations page appears.</p>


<p><li> Ensure that <i>systemroot</i>\NTDS is the location of both the database and the log and click Next. 
(If you did not install Windows 2000 in the WINNT directory, both locations should default to the NTDS 
folder in the folder where you did install Windows 2000.)</li></p>

<p>The Shared System Volume page appears.</p>

<p><li> Ensure that the SYSVOL folder location is <i>systemroot</i>\SYSVOL. (If you

did not install Windows 2000 in the WINNT directory, the SYSVOL location should default to a 
SYSVOL folder in the folder where you installed Windows 2000.)</li></p>

<p>What is the one SYSVOL location requirement?</p>

<p>What is the function of SYSVOL?</p>

<p><li> Click Next to accept <i>systemroot</i>\SYSVOL (or the path where you installed Windows 2000) 
as the path for SYSVOL.</li></p>


<p>The Active Directory Installation Wizard message box appears, reminding you to install and configure 
a DNS server. Click OK. The Configure DNS page appears.</p>


<p><li> Select Yes, Install And Configure DNS On This Computer, then click Next.</li></p>


<p>The Permissions page appears.</p>


<p><li> Unless your network administrator tells you to do otherwise, select Permissions Compatible Only With Windows 2000 Servers, then click Next.</li></p>


<p>The Directory Services Restore Mode Administrator Password page appears.</p>


<p><li> Type the password you want to assign to this server's Administrator account in the event the computer is started in Directory Services Restore mode, then click Next.</li></p>


<p>The Summary page appears, listing the options that you selected.</p>


<p><li> Review the contents of the Summary page, then click Next.</li></p>


<p>The Configuring Active Directory progress indicator appears as the Active Directory service is installed 
on the server. This process will take several 
minutes, during which you are prompted to place the Windows 2000 Server CD-ROM in your CD-ROM drive.</p>


<p><li> When the Completing The Active Directory Installation Wizard page appears, click Finish, then 
click Restart Now.</li></p>
</ol>

<p><a href="chaaa.htm#1054">Answers</a></p>

<A NAME="173"><h3>Exercise 2: Viewing Your Domain Using My Network Places</h3></A>
<p>In this exercise, you view your domain to verify Active Directory installation.</p>

<p><li> <b>To view a domain using My Network Places</b> </li></p>

<ol>

<p><li> Log on as Administrator.</li></p>

<p><li> If the Windows 2000 Configure Your Server page appears, close it.</li></p>

<p><li> Double-click My Network Places.</li></p>


<p>The My Network Places window appears.</p>

<p>What selections do you see?</p>


<p><li> Double-click Entire Network, and then double-click Microsoft Windows Network.</li></p>


<p>What do you see?</p>

<p><li> Close the Microsoft Windows Network window.</li></p>
</ol>

<p><a href="chaaa.htm#1055">Answers</a></p>

<A NAME="174"><h3>Exercise 3: Viewing a Domain Using the Active Directory Users and Computers Console</h3></A>
<p>In this exercise, you use the Active Directory Users and Computers console to view your domain.</p>

<p><li> <b>To view a domain using the Active Directory Users and Computers console</b> </li></p>

<ol>

<p><li> Click Start, point to Programs, point to Administrative Tools, then click
Active Directory Users And Computers.</li></p>


<p>Windows 2000 displays the Active Directory Users and Computers console.</p>


<p><li> In the console tree, double-click microsoft.com (or the name of your domain).</li></p>


<p>What selections are listed under microsoft?</p>

<p><li> In the console tree, click Domain Controllers.</li></p>


<p>Notice that SERVER1 appears in the details pane. If you did not use SERVER1 as your server name, 
the DNS name of your server appears in the details pane.</p>


<p><li> Close the Active Directory Users and Computers console.</li></p>
</ol>

<p><a href="chaaa.htm#899">Answers</a></p>

<A NAME="175"><h3>Exercise 4: Testing Your DNS Server</h3></A>
<p>In this exercise, you confirm that your DNS service is working.</p>

<p><li> <b>To test your DNS service using the DNS console</b> </li></p>

<ol>

<p><li> Click Start, point to Programs, point to Administrative Tools, and then click DNS.</li></p>

<p><li> The DNS console appears. In the DNS console tree, right-click SERVER1 
(or the name of your server), then click Properties.</li></p>


<p>The SERVER1 Properties dialog box appears. (If you did not use SERVER1 as your server name, the 
dialog box will reflect your server name.)</p>


<p><li> Click the Monitoring tab.</li></p>

<p><li> Under Select A Test Type, select the A Simple Query Against This DNS Server check box and the A 
Recursive Query To Other DNS Servers check box, then click Test Now.</li></p>


<p>On the SERVER1 Properties dialog box, under Test Results, you should see PASS in the Simple 
Query and Recursive Query columns.</p>


<p><li> Click OK.</li></p>

<p><li> Close the DNS console.</li></p>
</ol>

<A NAME="176"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned about installing Active Directory, including running Windows 2000 
Configure Your Server to start the Active Directory Installation Wizard. You can also go to a command 
prompt and type DCPROMO to launch the Active Directory Installation Wizard. You can use the Active 
Directory Installation Wizard to add a domain controller to an existing domain, to create the first domain 
controller of a new domain, to create a new child domain, and to create a new domain tree. You also learned 
how the Active Directory Installation Wizard can be used to remove Active Directory from a domain 
controller.</p>

<p>In addition, you learned about the Active Directory database, which is the directory for the new domain, 
and the database log files. The default location for the database and database log files is 
<i>systemroot</i>\NTDS. You also learned about the shared system volume that Active Directory creates 
during installation. The shared system volume is a folder structure that exists on all Windows 2000 
domain controllers. It stores scripts and some of the group policy objects for both the current 
domain and the enterprise. The default location for the shared system volume is <i>systemroot</i>\SYSVOL.</p>

<p>You learned how Active Directory uses DNS as its location service, enabling computers to find the location of domain controllers. You cannot install Active Directory without having DNS on your network, because Active Directory uses DNS as its location service. You can configure your Windows 2000 DNS server automatically by using the Active Directory Installation Wizard. Unless you are using a DNS server other than Windows 2000 or you want to perform a special configuration, you do not need to manually configure DNS to support Active 
Directory.</p>

<p>You also learned about mixed and native domain modes. Mixed mode allows compatibility with previous 
versions of Windows NT. Native mode is only used when all domain controllers in the domain are running 
Windows 2000 Server.</p>

<p>In the practice portion of this lesson, you used the Active Directory Installation Wizard to install 
Active Directory on your computer, to promote your computer to a domain controller, and to create a domain. 
You then viewed your domain 
using My Network Places and the Active Directory Users and Computers console. Finally, you used 
the DNS console to confirm that your DNS service is working.</p>

</BODY>
</HTML>







