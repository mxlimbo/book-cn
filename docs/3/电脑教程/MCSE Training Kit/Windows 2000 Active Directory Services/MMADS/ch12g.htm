<html>
<head>
<title>Lesson 6: Troubleshooting Group Policy</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch12f.htm", "ch12h.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="680"><h1>Lesson 6: Troubleshooting Group Policy</h1></A>
<p>This lesson describes problems you may encounter that relate to group policy. It also describes some best practices you should employ to keep group policy troubleshooting activities to a minimum.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li> Troubleshoot group policy</li></p>

<p><li> Employ best practices for group policy</li></p>
</ul>

<p><b>Estimated lesson time: 10 minutes</b></p>
</blockquote></div>
</p>

<A NAME="681"><h2>Troubleshooting Group Policy</h2></A>
<p>An important part of troubleshooting group policy problems is to consider dependencies between components. For example, Software Installation relies on group policy, and group policy relies on Active Directory. Active Directory relies on proper configuration of network services. When trying to fix problems that appear in one component, it is generally helpful to check whether components, services, and resources on which it relies are working correctly. Event logs are useful for tracking down problems caused by this type of hierarchical dependency.</p>

<p>Table 12.9 describes scenarios in which there are problems using the Group Policy snap-in.</p>

<p><b>Table 12.9</b> <i>Group Policy Snap-In Problems and Solutions</i></p>

<p><table cellpadding=5 width="95%">
<tr><th colspan="2">Symptom: The user cannot open a GPO even though he or she has Read access to it</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">An administrator must have both Read permission and Write permission for the GPO to open it in the Group Policy snap-in. </td>
<td valign="top">Be a member of a security group with Read and Write permission for the GPO. For example, a domain administrator can manage nonlocal GPOs. An administrator for a computer can edit  the local GPO on that computer.</td></tr>

<tr><th colspan="2">Symptom: When the user tries to edit a GPO, 
the &quot;Failed To Open The Group Policy Object&quot; message appears</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">A networking problem, specifically a problem with the domain name system (DNS) configuration.</td>
<td valign="top">Make sure DNS is working properly. </td></tr>
</table></p>


<p>Table 12.10 describes scenarios where group policy settings are not taking effect.</p>

<p><b>Table 12.10</b> <i>Group Policy Settings Problems and Solutions</i></p>

<p><table cellpadding=5 width="95%">
<tr><th colspan="2">Symptom: Group policy is not being applied to users 
and computers in a security group that contains those users and 
computers, even though a GPO is linked to an OU containing that security group</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">This is correct behavior. Group policy affects only users and computers contained in sites, domains, and OUs. GPOs are not applied to security groups. </td>
<td valign="top">Link GPOs to sites, domains, and OUs only. Keep in mind that the location of a security group in Active Directory is unrelated to whether group policy applies to the users and computers in that security group.</td></tr>

<tr><th colspan="2">Symptom: Group policy is not affecting 
users and computers in a site, domain, or OU</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">Group policy settings can be prevented, intentionally or inadvertently, from taking effect on users and computers in several ways. A GPO can be disabled from affecting users, computers, or both. It also needs to be linked either directly to an OU containing the users and computers or linked to a parent domain or OU so that the group inheritance. When multiple GPOs apply, they are processed in this order: local, site, domain, OU. By default, settings applied later have precedence. In addition, group policy can be blocked at the level of any OU, or enforced through a setting of No Override applied to a particular GPO link. Finally, the user or computer must belong to one or more security groups with appropriate permissions set.</td>
<td valign="top">Make sure that the intended policy is not being blocked. Make sure no policy set at a higher level of Active Directory has been set to No Override. If Block Policy Inheritance and No Override are both used, keep in mind that No Override takes precedence. Verify that the user or computer is not a member of any security group for which the AGP permission is set to Deny. Verify that the user or computer is a member of at least one security policy settings apply through group for which the AGP permission is set to Allow. Verify that the user or computer is a member of at least one security group for which the Read permission is set to Allow.</td></tr>

<tr><th colspan="2">Symptom: Group policy is not affecting 
users and computers in an Active Directory container</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">GPOs cannot be linked to Active Directory containers other than sites, domains, and OUs.</td>
<td valign="top">Link a GPO to an OU that is a parent to the Active Directory container. Then, by default,  those settings are applied to the users and  computers in the container through inheritance.</td></tr>

<tr><th colspan="2">Symptom: Group policy is not taking effect on the local computer</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">Local policies are the weakest. Any nonlocal GPO can overwrite them.</td>
<td valign="top">Check to see what GPOs are being applied  through Active Directory and if those GPOs have settings that are in conflict with the local settings.</td></tr>
</table></p>


<p>Table 12.11 describes scenarios in which there are problems using the Software 
Installation extension.</p>

<p><b>Table 12.11</b> <i>Software Installation Extension Problems and Solutions</i></p>

<p><table cellpadding=5 width="95%">
<tr><th colspan="2">Symptom: Published applications do not 
appear in Add/Remove Programs in Control Panel</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">Several causes are possible: Group policy was not applied. Active Directory cannot be accessed. User does not have any published applications in the GPOs that apply to him or her. Client is running Terminal Server.</td>
<td valign="top">Investigate each possibility. Note that Software Installation is not supported for Terminal Server clients.</td></tr>

<tr><th colspan="2">Symptom: Document activation of a 
published application does not cause the application to install</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">The administrator did not set auto-install.</td>
<td valign="top">Ensure that Auto-Install This Application By File Extension Activation is checked in the Deployment tab in the application's properties sheet.</td></tr>

<tr><th colspan="2">Symptom: The user receives an error message such as 
&quot;The feature you are trying to install cannot be found in the source directory&quot;</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">Network or permissions problems.</td>
<td valign="top">Make sure the network is working correctly. Ensure that the user has Read and AGP permission for the GPO. Ensure that the user has Read permission for the SDP. Ensure that the user has Read permission for the application.</td></tr>

<tr><th colspan="2">Symptom: After removal of an application, 
the shortcuts for the application still appear on the user's desktop</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">The user has created shortcuts and Windows Installer has no knowledge of them.</td>
<td valign="top">The user must remove the shortcuts manually. 
</td></tr>

<tr><th colspan="2">Symptom: The user receives an error 
message such as &quot;Another Installation Is Already In Progress&quot;</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">An uninstallation might be taking place in the background with no user interface presented to the user, or perhaps the user has inadvertently triggered two installations simultaneously (which is not supported).</td>
<td valign="top">The user can try again later.</td></tr>

<tr><th colspan="2">Symptom: The user opens an already installed 
application, and the Windows Installer starts</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">An application might be undergoing automatic repair or a user-required 
feature is being added.</td>
<td valign="top">No action is required.</td></tr>

<tr><th colspan="2">Symptom: The user receives error messages such as &quot;Active Directory Will Not Allow The Package To Be Deployed&quot; or &quot;Cannot Prepare Package For Deployment&quot;</th></tr>

<tr><th>Cause</th><th>Solution</th></tr>

<tr><td valign="top">The package might be corrupted or there might be a networking problem.</td>
<td valign="top">Investigate and take appropriate action.</td></tr>
</table></p>

<A NAME="682"><h2>Group Policy Best Practices</h2></A>
<p>The following best practices may minimize your need to troubleshoot 
group policy.</p>

<A NAME="683"><h3>General Group Policy Practices</h3></A>
<ul>
<p><li> <b>Disable unused parts of a GPO.</b> If a GPO has, under the User Configuration or Computer Configuration node of the console, only settings that are Not Configured, you can avoid processing those settings by disabling the node. This expedites startup and logon for those users and computers subject to the GPO.</li></p>

<p><li> <b>Use the Block Policy Inheritance and No Override features sparingly.</b> Routine use of these features makes it difficult to troubleshoot group policy.</li></p>

<p><li> <b>Minimize the number of GPOs associated with users or computers in domains or OUs.</b> The more GPOs applied to a user, the longer it takes to start up and log on.</li></p>

<p><li> <b>Filter policy based on security group membership.</b> Users who do not have permissions directing that a particular GPO be applied to them can avoid the associated logon delay, because the GPO will not be processed for those users.</li></p>

<p><li> <b>Use loopback only when necessary.</b> Use loopback only if you need the desktop configuration to be the same regardless of who logs on.</li></p>

<p><li> <b>Avoid cross-domain GPO assignments.</b> The processing of GPOs will slow logon and startup if group policy is obtained from another domain.</li></p>
</ul>

<A NAME="684"><h3>Software Installation Practices</h3></A>
<ul>
<p><li> <b>Specify application categories for your organization.</b> Using categories makes it easier for users to find an application in Add/Remove Programs in Control Panel. For example, you could define categories such as Sales Applications, Accounting Applications, and so on.</li></p>

<p><li> <b>Make sure Windows Installer packages include modifications before they are published or assigned.</b> Remember that modifications are applied to packages at the time of assignment or publication. In practical terms, this means that you should make sure the Modifications tab of the package Properties dialog box is set up as you intend before you click OK. If you neglect to do this, and assign or publish a modified package before you have completely configured it, you can either remove the software and republish or reassign it or upgrade the software with a completely modified version.</li></p>

<p><li> <b>Assign or publish just once per GPO.</b> A Windows Installer package should be assigned or published no more than once in the same GPO. For example, if you assign Microsoft Office to the computers affected by a GPO, then do not assign or publish it to users affected by the GPO.</li></p>

<p><li> <b>Take advantage of authoring tools.</b> Developers familiar with the files, registry entries, and other requirements for an application to work properly can author native Windows Installer packages using tools available from various software vendors.</li></p>

<p><li> <b>Repackage existing software.</b> You can use commercially available tools to create Windows Installer packages for software that does not include natively authored .msi files. These work by comparing a computer's state before and after installation. For best results, install onto a computer free of other application software (clean install).</li></p>

<p><li> <b>Use SMS and Dfs.</b> Microsoft Systems Management Server (SMS) and the Windows 2000 Distributed File System (Dfs) are helpful in managing the SDPs (the network shares from which users install their managed software).</li></p>

<p><li> <b>Assign or publish close to the root in the Active Directory hierarchy.</b> Because group policy settings apply by default to child Active Directory containers, it is efficient to assign or publish by linking a GPO to a parent OU or domain. Use security descriptors (ACEs) on the GPO for finer control over who receives the software.</li></p>

<p><li> <b>Use Software Installation properties for widely scoped control.</b> This spares administrative keystrokes when assigning or publishing a large number of packages with similar properties in a single GPO&#8212;for example, when all the software is published and it all comes from the same SDP.</li></p>

<p><li> <b>Use Windows Installer package properties for fine control.</b> Use the package properties for assigning or publishing a single package.</li></p>
</ul>

<A NAME="685"><h3>Folder Redirection Practices</h3></A>
<ul>
<p><li> <b>Incorporating %username% into fully qualified UNC paths.</b> This allows users to have their own folders. For example, \\server\share\%username%\My Documents</li></p>

<p><li> <b>Having My Pictures follow My Documents.</b> This is advisable unless there is a compelling reason not to, such as file share scalability.</li></p>

<p><li> <b>Policy removal considerations.</b> Keep in mind the behavior your Folder Redirection policies will have upon policy removal, as described in &quot;<A HREF="ch12f.htm#678">Policy Removal Considerations</A>.&quot;</li></p>

<p><li> <b>Accepting defaults.</b> In general, accept the default Folder Redirection settings.</li></p>
</ul>

<A NAME="686"><h2>Lesson Summary</h2></A>
<p>In this lesson you examined some group policy problems that you may encounter and possible solutions. You also learned some best practices for handling group policy.</p>

</BODY>
</HTML>







