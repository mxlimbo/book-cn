<html>
<head>
<title>Lesson 6: Backing Up Active Directory</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch11f.htm", "ch11h.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="564"><h1>Lesson 6: Backing Up Active Directory</h1></A>
<p>This lesson guides you through the steps required to back up data. When you create a backup, you need to conduct several preliminary tasks, and then perform a number of tasks using the Backup Wizard. You will also learn about scheduling and running an unattended backup.</p>

<p>
<div class="sidebar"><blockquote>

<b>After this lesson, you will be able to</b>

<ul>

<p><li>Back up Active Directory at a local computer</li></p>

<p><li>Schedule a backup of Active Directory</li></p>

</ul>

<p><b>Estimated lesson time: 20 minutes</b></p>

</blockquote></div>
</p>


<A NAME="565"><h2>Performing Preliminary Tasks</h2></A>
<p>An important part of backing up Active Directory is performing the preliminary tasks. One task that you must do is ensuring that the files that you want to back up are closed. You should send a notification to users to close files before you begin backing up data. Applications using the system or users who cannot be notified (such as users logged on through the Internet) will have their sessions terminated. Windows Backup does not back up files that are locked by applications. You can use e-mail or the Send Console Message dialog box (available in the Computer Management and the Services consoles and the Shared Folders snap-in) to send administrative messages to users.</p>

<p>If you use a removable media device, make sure that the following preliminary tasks occur:</p>

<ul>

<p><li>The backup device is attached to a computer on the network and is turned on. If you are backing up to tape, you must attach the tape device to the computer on which you run Windows Backup.</li></p>

<p><li>The media device is listed on the Windows 2000 Hardware Compatibility List (HCL).</li></p>

<p><li>The media is loaded in the media device. For example, if you are using a tape drive, ensure that a tape is loaded in the tape drive.</li></p>

</ul>


<A NAME="566"><h2>The Backup Wizard</h2></A>
<p>After you have completed the preliminary tasks, you can perform the Active Directory backup using the Backup Wizard.</p>

<p><li><b>To start the Backup Wizard</b></li></p>

<ol>

<p><li> Log on to your domain as Administrator, and then point to Start, point to Programs, point to Accessories, point to System Tools, and select Backup.</li></p>

<p><li> Select Backup Wizard on the Welcome To The Windows 2000 Backup And Recovery Tools page.</li></p>

<p><li> Click Next to begin using the Backup Wizard. Proceed through the What To Back Up, Where To Store The Backup, and Advanced Backup Settings pages as needed.</li></p>

<p><li> On the Completing The Backup Wizard page, click Finish.</li></p>

</ol>


<A NAME="567"><h2>What to Back Up</h2></A>
<p>The first phase of using the Backup Wizard to back up Active Directory is to specify that you want to back up only System State data (see Figure 11.8).</p>

<p>
<A HREF="javascript:fullSize('11wtk08x.htm')"> <img src="images/11wtk08.JPG" width=404 height=309 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 11.8</b> <i>Backup Wizard What To Back Up page</i><!-- /caption -->
</p>


<p>For Windows 2000 Server operating systems, the System State data comprises the registry, the COM+ Class Registration database, system boot files, and the Certificate Services database (if the server is a certificate server). If the server is a domain controller, Active Directory and the SYSVOL directory are also contained in the System State data. When you choose to back up System State data, all of the System State data that is relevant to your computer is backed up; you cannot choose to back up individual components of the System State data. This is due to dependencies among the System State components. You can only back up the System State data on a local computer. You cannot back up the System State data on a remote computer.</p>


<A NAME="568"><h2>Where to Store the Backup</h2></A>
<p>After you indicate that you need to back up System State data, you need to 
provide information about the backup media (see Figure 11.9).</p>

<p>
<A HREF="javascript:fullSize('11wtk09x.htm')"> <img src="images/11wtk09.JPG" width=404 height=309 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 11.9</b> <i>Backup Wizard Where To Store The Backup page</i><!-- /caption -->
</p>


<p>Table 11.8 describes the information that you must provide for the backup media options.</p>

<p><b>Table 11.8</b> <i>Backup Media Options</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th>Option</th>
			<th>Description</th>
		</tr>

		<tr>
			<td valign="top">Backup Media Type</td>
			<td valign="top">The target medium to use, such as tape or file. A file can be located on any disk-based medium, including a hard disk, a shared network folder, or a removable disk.</td>
		</tr>

		<tr>
			<td valign="top">Backup Media Or File Name</td>
			<td valign="top">The location where Windows Backup will store the data. For a tape, enter the tape name. For a file, enter the path for the backup file.</td>
		</tr>
		
	</table>
</p>

<p>After you provide the media information, the Backup Wizard displays the 
wizard settings and provides the opportunity to do either of the following:</p>

<ul>

<p><li> <b>Start the backup.</b> If you click Finish, during the backup process, the Backup Wizard displays status information about the backup job in the Backup Progress dialog box.</li></p>

<p><li> <b>Specify advanced backup options.</b> If you click Advanced, the Backup Wizard allows you to select the advanced backup settings.</li></p>

</ul>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
When the backup process is complete, you can choose to review the backup report, which is the backup log. A <i>backup log</i> is a text file that records backup operations. It is stored on the hard disk of the computer on which you are running Windows Backup.
</blockquote></div>
</p>


<A NAME="569"><h2>Specifying Advanced Backup Settings</h2></A>
<p>When you specify advanced backup settings, you are changing the default backup settings for only the current backup job. The advanced settings are listed in Table 11.9.</p>

<p><b>Table 11.9</b> <i>Advanced Backup Settings</i></p>

<p>
	<table valign="top" cellpadding="5" width="95%">
	
		<tr>
			<th>Advanced Settings Page</th>
			<th>Advanced Option</th>
			<th>Description</th>
		</tr>
		
		<tr>
			<td valign="top" rowspan=2>Type Of Backup</td>
			<td valign="top">Select The Type Of Backup Operation To Perform</td>			
			<td valign="top">A list that allows you to choose the backup type that is used for this backup job. Select one of the following types: Normal, Copy, Incremental, Differential, or Daily.</td>
		</tr>

		<tr>
			<td valign="top">Backup Migrated Remote Storage Data</td>			
			<td valign="top">A check box that backs up data that Hierarchical Storage Manager (HSM) has moved to remote storage when checked.</td>
		</tr>

		<tr>
			<td valign="top" rowspan=2>How To Backup</td>
			<td valign="top">Verify Data After Backup</td>			
			<td valign="top">A check box that confirms that files are correctly backed up. Windows Backup compares the backup data and the source data to verify that they are the same when checked. <i>Microsoft recommends that you select this option.</i></td>
		</tr>

		<tr>
			<td valign="top">Use Hardware Compression, If Available</td>			
			<td valign="top">A check box that enables hardware compression for tape devices that support it if checked. If your tape device does not support hardware compression, this check box is unavailable.</td>
		</tr>

		<tr>
			<td valign="top" rowspan=2>Media Options</td>
			<td valign="top">If The Archive Media Already Contains Backups</td>			
			<td valign="top">Options that specify whether to append or replace the existing backup on the backup media. Choose Append This Backup To Media to store multiple backup jobs on a storage device. Choose Replace The Data On The Media With This Backup if you do not need to save previous backup jobs and you only want to save the most recent backup data.</td>
		</tr>

		<tr>
			<td valign="top">Allow Only Owner And The Administrator Access To The Backup Data And To Any Backups Appended To 
This Media</td>			
			<td valign="top">A check box that allows you to restrict who can gain access to the completed backup file or tape. This option is only available if you choose to replace an existing backup on a backup medium, rather than appending to the backup medium. If you back up the registry or Active Directory, click this option to prevent others from getting copies of the backup data.</td>
		</tr>

		<tr>
			<td valign="top" rowspan=2>Backup Label</td>
			<td valign="top">Backup Label</td>			
			<td valign="top">A box that allows you to specify a name and description for the backup job. The name and description appear in the backup log. The default set is Set Created <i>Date</i> At <i>Time</i>. You can change the <i>name</i> and description to a more intuitive name (for example, Active Directory backup 09-12-00).</td>
		</tr>

		<tr>
			<td valign="top">Media Label</td>
			<td valign="top">A box that allows you to specify the name of the backup medium (for example, the tape name). The default name is Media Created <i>Date</i> At <i>Time</i>. The first time that you back up to a new medium or overwrite an existing backup job, you can specify the medium name, such as Active Directory.</td>
		</tr>

		<tr>
			<td valign="top" rowspan=4>When To Back Up</td>
			<td valign="top">When to back up</td>			
			<td valign="top">Options that allow you to specify Now or Later. If you choose Later, you specify the job name and the start date. You can also set the schedule.</td>
		</tr>

		<tr>
			<td valign="top">Job Name</td>			
			<td valign="top">A box that allows you to specify the backup job name.</td>
		</tr>
		
		<tr>
			<td valign="top">Start Date</td>			
			<td valign="top">A box that allows you to set the backup start date.</td>
		</tr>

		<tr>
			<td valign="top">Set Schedule</td>			
			<td valign="top">A button that allows you to set the backup schedule.</td>
		</tr>
		
	</table>
</p>

<p>Depending on whether you chose to back up now or later, the Backup Wizard provides you with the opportunity to do either of the following:</p>

<ul>

<p><li>If you chose to finish the backup process, the Backup Wizard displays the Completing The Backup Wizard settings and then presents the option to finish and immediately start the backup. During the backup, the wizard displays status information about the backup job.</li></p>

<p><li>If you chose to back up later, you are shown additional dialog boxes to schedule the backup process to occur later, as described in the next section.</li></p>

</ul>


<A NAME="570"><h2>Scheduling Active Directory Backup Jobs</h2></A>
<p>Scheduling an Active Directory backup job means that you can have an unattended backup job occur later when users are not at work and files are closed. You can also schedule Active Directory backup jobs to occur at regular intervals. To enable this, Windows 2000 integrates Windows Backup with the Task Scheduler service.</p>

<p><li><b>To schedule a backup</b></li></p>

<ol>

<p><li> Click Later on the When To Back Up page of the Backup Wizard.</li></p>

<p>The Task Scheduler service presents the Set Account Information dialog box, prompting you for your password. The user account must have the appropriate user rights and permissions to perform backup jobs.</p>

</ol>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If the Task Scheduler service is not running or not set to start automatically, Windows 2000 displays a dialog box prompting you to start the service. Click OK, and the Set Account Information dialog box appears.
</blockquote></div>
</p>

<ol start=2>

<p><li> Enter your password in the Password box and Confirm Password box, then click OK.</li></p>

<p>The When To Back Up page appears. You must provide a name for the backup job, and by default, the wizard displays the present date and time for the start date.</p>

<p><li> Type in the appropriate name in the Job Name box.</li></p>

<p><li> Click Set Schedule to set a different start date and time. This selection causes Task Scheduler to display the Schedule Job dialog box.</li></p>

<p>In the Schedule Job dialog box, you can set the date, time, and number of occurrences for the backup job to repeat, such as every Friday at 10:00 PM. You can also display all of the scheduled tasks for the computer by selecting the Show Multiple Schedules check box. This helps to prevent you from scheduling multiple tasks on the same computer at the same time.</p>

<p>By clicking the Advanced button, you can also schedule how long the backup can last and for how many days, weeks, months, or years you want this schedule to continue.</p>

</ol>

<p>After you schedule the backup job and complete the Backup Wizard, Windows Backup places the backup job on the calendar in the Schedule Jobs tab in Windows Backup. The backup job automatically starts at the time that you specified.</p>


<A NAME="571"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned that you must ensure that the files that you want to back up are closed because Windows Backup does not back up files that are locked by applications. You also learned that in using the Backup Wizard, the first phase is to specify what to back up. To back up Active Directory you must back up System State data. After you select System State data, you need to provide the target destination and the backup medium or file name. Then you can finish the backup or you can specify advanced backup options. You also learned how Windows Backup allows you to schedule backup jobs using the Task Scheduler service.</p>


</BODY>
</HTML>







