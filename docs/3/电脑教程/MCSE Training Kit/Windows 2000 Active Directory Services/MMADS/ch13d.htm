<html>
<head>
<title>Lesson 3: Using Security Logs</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch13c.htm", "ch13e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="721"><h1>Lesson 3: Using Security Logs</h1></A>
<p>The security log contains information on security events that are specified in the audit policy. To view the security log, you use the Event Viewer console. Event Viewer also allows you to find specific events within log files, filter the events shown in log files, and archive security log files.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li> View a log</li></p>

<p><li> Locate events in a log</li></p>

<p><li> Filter events in a log</li></p>

<p><li> Configure the size of audit logs</li></p>

<p><li> Archive security logs</li></p>
</ul>

<p><b>Estimated lesson time: 25 minutes</b></p>
</blockquote></div>
</p>

<A NAME="722"><h2>Understanding Windows 2000 Logs</h2></A>
<p>You use the Event Viewer console to view information contained in Windows 2000 logs. By default, there are three logs available to view in Event Viewer. These logs are described in Table 13.9.</p>

<p><b>Table 13.9</b> <i>Logs Maintained by Windows 2000</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>Log</th>
<th>Description</th>
</tr>
<tr><td valign="top">Application log</td>
<td valign="top">Contains errors, warnings, or information that programs, such as a database program or an e-mail program, generate. The program developer presets which events to record.</td></tr>

<tr><td valign="top">Security log</td>
<td valign="top">Contains information about the success or failure of audited events. The events that Windows 2000 records are a result of your audit policy.</td></tr>

<tr><td valign="top">System log</td>
<td valign="top">Contains errors, warnings, and information that Windows 2000 generates. Windows 2000 presets which events to record.</td></tr>
</table>
</p>
<p>Application and system logs can be viewed by all users. Security logs are accessible only to system administrators. By default, security logging is turned off. To enable security logging, you must use group policy at the appropriate level to set up an audit policy.</p>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
If additional services are installed, they might add their own event log. For example, the Domain Name System (DNS) Service logs events that this service generates in the DNS server log.</blockquote></div>
</p>

<A NAME="723"><h2>Viewing Security Logs</h2></A>
<p>The security log contains information about events that are monitored by an audit policy, such as failed and successful logon attempts.</p>

<p><li> <b>To view the security log</b></li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Event Viewer.</li></p>

<p><li> In the console tree, select Security Log.</li></p>

<p>In the details pane, Event Viewer displays a list of log entries and summary information for each item, as shown in Figure 13.8.</p>

<p>Successful events appear with a key icon and unsuccessful events appear 
with a lock icon. Other important information includes the date and time 
that the event occurred, the category of the event, and the user who generated the event.</p>

<p>The category indicates the event category, such as object access, account management, directory service access, or logon events.</p>

<p>
<A HREF="javascript:fullSize('13wtk07x.htm')"> <img src="images/13wtk07.JPG" width=404 height=312 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 13.8</b> <i>Event Viewer displaying a sample security log</i><!-- /caption -->
</p>


<p><li> To view additional information for any event, double-click the event.</li></p>
</ol>

<p>Windows 2000 records events in the security log on the computer at which the event occurred. You can view these events from any computer as long as you have administrative privileges for the computer where the events occurred.</p>

<p><li> <b>To view the security log on a remote computer</b></li></p>

<ol>
<p><li> Ensure that security auditing has been enabled on a remote machine. (Refer to <a href="ch13c.htm">Lesson 2</a> for details.)</li></p>

<p><li> Click Start, point to Programs, point to Administrative Tools, then click Event Viewer.</li></p>

<p><li> Right-click the Event Viewer (Local) node and select Connect To Another Computer.</li></p>

<p><li> In the Select Computer dialog box, click Another Computer and type the network name, IP address, or DNS address for the computer for which Event Viewer will display a security log. You can also browse for the computer name.</li></p>

<p><li> Click OK.</li></p>
</ol>

<A NAME="724"><h2>Locating Events</h2></A>
<p>When you first start Event Viewer, it automatically displays all events that are recorded in the security log. You can search for specific events by using the Find command.</p>

<p><li> <b>To find events</b></li></p>

<ol>
<p><li> Start Event Viewer, click the security log, then click Find on the View menu.</li></p>

<p><li> On the Find In dialog box for the security log, configure the options shown in Figure 13.9 and described in Table 13.10.</li></p>

<p><b>Table 13.10</b> <i>Options on the Find In Dialog Box</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr><th>Option</th>
<th>Description</th></tr>
<tr><td valign="top">Event Types</td>
<td valign="top">Check boxes that indicate the types of events to find. In the 
security log you can only find audit events, because others are not recorded.</td></tr>
<tr><td valign="top">Event Source</td>
<td valign="top">A list that indicates the software or component driver that logged the event.</td></tr>
<tr><td valign="top">Category</td>
<td valign="top">A list that indicates the event category, such as a logon or logoff attempt or a system event.</td></tr>
<tr><td valign="top">Event ID</td>
<td valign="top">An event number to identify the event. This number helps 
product support representatives track events.</td></tr>
<tr><td valign="top">User</td>
<td valign="top">A user logon name.</td></tr>
<tr><td valign="top">Computer</td>
<td valign="top">A computer name.</td></tr>
<tr><td valign="top">Description</td>
<td valign="top">Text that is in the description of the event.</td></tr>
<tr><td valign="top">Search Direction</td>
<td valign="top">The direction in which to search the log (up or down).</td></tr>
<tr><td valign="top">Find Next</td>
<td valign="top">Finds and selects the next occurrence defined by the Find settings.</td></tr>
</table>
</p>
<p>
<img src="images/13wtk09.JPG" width=384 height=418 border="0">
</p><p>
<!-- caption --><b>Figure 13.9</b> <i>The Find In dialog box for a security log</i><!-- /caption -->
</p>

</ol>

<A NAME="725"><h2>Filtering Events</h2></A>
<p>To show specific events that appear in the security log&#8212;for example, attempting to write to a text file without the necessary permissions&#8212;you can narrow down the events to display by using the Filter command.</p>

<p><li> <b>To filter events</b></li></p>

<ol>
<p><li> Start Event Viewer, click the security log, then click Filter on the View menu.</li></p>

<p><li> In the Security Log Properties dialog box, in the Filter tab, configure the options shown in Figure 13.10 and described in Table 13.11.</li></p>


<p><b>Table 13.11</b> <i>Options on the Filter Tab of the Security Log Properties Dialog Box</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>Option</th>
<th>Description</th>
</tr>
<tr>
<td valign="top">Event Types</td>
<td valign="top">Check boxes that indicate the types of events to filter. In the 
security log you can only filter using audit events, because 
others are not recorded.</td>
</tr>
<tr>
<td valign="top">Event Source</td>
<td valign="top">A list that indicates the software or component driver that logged the event.</td>
</tr>
<tr>
<td valign="top">Category</td>
<td valign="top">A list that indicates the type of event, such as a logon or logoff attempt or a system event.</td>
</tr>
<tr>
<td valign="top">Event ID</td>
<td valign="top">An event number to identify the event. This number helps product support representatives track events.</td>
</tr>
<tr>
<td valign="top">User</td>
<td valign="top">A user logon name.</td>
</tr>
<tr>
<td valign="top">Computer</td>
<td valign="top">A computer name.</td>
</tr>
<tr>
<td valign="top">From</td>
<td valign="top">The beginning of the range of events that you want to filter. In the list under From, select First Event to see events starting with the first event in the log. Select Events On to see events that 
occurred starting at a specific time and date.</td>
</tr>
<tr>
<td valign="top">To</td>
<td valign="top">The end of the range of events that you want to filter. In the list under To, select Last Event to see events ending with the last event in the log. Select Events On to see events that occurred ending at a specific time and date.</td>
</tr>
</table>
</p>
<p>
<img src="images/13wtk10.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 13.10</b> <i>The Filter tab of the Security Log Properties dialog box</i><!-- /caption -->
</p>

</ol>

<A NAME="726"><h2>Configuring Security Logs</h2></A>
<p>Security logging begins when you set an audit policy for the domain controller or local computer. Logging stops when the security log becomes full and cannot overwrite itself, either because it has been set for manual clearing or because the first event in the log is not old enough. When security logging stops, an error may be written to the application log. You can avoid a full security log by logging only key events. You can configure the properties of each individual audit log.</p>

<p><li> <b>To configure the settings for security logs</b></li></p>

<ol>
<p><li> Open Event Viewer.</li></p>

<p><li> Right-click the security log in the console tree, then click Properties.</li></p>

<p><li> In the Security Log Properties dialog box, in the General tab, configure the options shown in Figure 13.11 and described in Table 13.12.</li></p>

<p><b>Table 13.12</b> <i>Options on the General Tab of the Security Log Properties Dialog Box</i></p>
<p>
<table valign="top" cellpadding="5" width="95%">
<tr>
<th>Option</th>
<th>Description</th>
</tr>
<tr>
<td valign="top">Display Name</td>
<td valign="top">The name of the log view. You can change the name to 
 distinguish different views of the same log on one computer 
 or to distinguish logs on different computers.</td>
</tr>
<tr>
<td valign="top">Log Name</td>
<td valign="top">The name and location of the log file.</td>
</tr>
<tr>
<td valign="top">Maximum Log Size</td>
<td valign="top">The size of each log, which can be from 64 KB to 4,194,240 
 KB (4 GB). The default size is 512 KB.</td>
</tr>
<tr>
<td valign="top">Overwrite Events As Needed</td>
<td valign="top">Specifies whether all new events will be written to the log, 
 even when the log is full. When the log is full, each new event 
 replaces the oldest event. Use this option with caution; it can 
 be used to hide undesirable events.</td>
</tr>
<tr>
<td valign="top">Overwrite Events Older Than X Days</td>
<td valign="top">Specifies the number of days (1-365) a log file will be 
 retained before writing over it. New events will not be added 
 if the maximum log size is reached and there are no events 
 older than this period.</td>
</tr>
<tr>
<td valign="top">Do Not Overwrite Events (Clear Log Manually)</td>
<td valign="top">Specifies whether existing events will be retained when the 
log is full. If the maximum log size is reached, new events are 
discarded. This option requires you to manually clear the log.</td>
</tr>
<tr>
<td valign="top">Using A Low Speed Connection</td>
<td valign="top">Specifies whether the log file is located on another computer, 
 and whether your computer is connected to it by a low speed 
 device, such as a modem.</td>
</tr>
</table>
</p>

<p>
<img src="images/new13-11.JPG" width=404 height=448 border="0">
</p><p>
<!-- caption --><b>Figure 13.11</b> <i>The General tab of the Security Log Properties dialog box</i><!-- /caption -->
</p>

</ol>
<p>When the log is full and no more events can be logged, you can free the log by manually clearing it. Clearing the log erases all events permanently. Reducing the amount of time you keep an event also frees the log if it allows the next record to be overwritten.</p>

<p><li> <b>To manually clear the security log</b></li></p>

<ol>
<p><li> Open Event Viewer.</li></p>

<p><li> Right-click the security log in the console tree, then click Clear All Events.</li></p>

<p><li> On the Event Viewer message box</li></p>

	<ul>
	<p><li> Click Yes to archive the log before clearing</li></p>
	
	<p><li> Click No to permanently discard the current event records and start recording new events</li></p>
	</ul>

<p><li> If you clicked Yes, in the Save As dialog box, in the File Name list, enter a name for the log file to be archived.</li></p>

<p><li> In the Save As Type list, click a file format, then click Save.</li></p>
</ol>

<A NAME="727"><h2>Archiving Security Logs</h2></A>
<p>Archiving security logs allows you to maintain a history of security-related events. Many organizations have policies on keeping archive logs for a specified period to track security-related information over time. When you archive a log file, the entire log is saved, regardless of filtering options.</p>

<p><li> <b>To archive a security log</b></li></p>

<ol>
<p><li> Open Event Viewer.</li></p>

<p><li> Right-click the security log in the console tree, then click Save Log File As.</li></p>

<p><li> In the Save As dialog box, in the File Name list, enter a name for the log file to be archived.</li></p>

<p><li> In the Save As Type list, click a file format, then click Save.</li></p>
</ol>

<p>If you archive a log in log-file format you can reopen it in Event Viewer. Logs saved as event log files (*.evt) retain the binary data for each event recorded. If you archive a log in text or comma-delimited format (*.txt and *.csv, respectively), you can reopen the log in other programs such as word processing or spreadsheet programs. Logs saved in text or comma-delimited format do not 
retain the binary data.</p>

<p><li> <b>To view an archived security log</b></li></p>

<ol>
<p><li> Open Event Viewer.</li></p>

<p><li> Right-click the security log in the console tree, then click Open Log File.</li></p>

<p><li> In the Open dialog box, click the file you want to open. You may need to search for the drive or folder that contains the document.</li></p>

<p><li> In the Log Type list, select Security for the type of log to be opened.</li></p>

<p><li> In the Display Name box, enter the name of the file as you want it to appear in the console tree, then click Open.</li></p>
</ol>

<p>To remove an archived log file from your system, delete the file in 
Windows Explorer.</p>

<p><img src="images/practic.JPG" width=92 height=74 border="0"></p>

<A NAME="728"><h2>Practice: Using the Security Log</h2></A>
<p>In this practice you view the security log file and configure Event Viewer to 
overwrite events when the log file is filled. Then you clear and archive a security log file.</p>

<p>
<div class="warning"><blockquote><b>IMPORTANT</b><hr>
Before attempting the exercises in this practice, you must first 
complete all exercises in <a href="ch13c.htm">Lesson 2</a>.</blockquote></div>
</p>

<A NAME="729"><h3>Exercise 1: Viewing the Security Log</h3></A>
<p>In this exercise you view the security log for your computer. Then, you use Event Viewer to filter events and to search for potential security breaches.</p>

<p><li> <b>To view the security log for your computer</b></li></p>

<ol>
<p><li> Click Start, click Programs, click Administrative Tools, then click Event Viewer.</li></p>

<p><li> In the console tree, click the security log and view the contents. As you scroll through the log, double-click a couple of events to view a description.</li></p>
</ol>

<A NAME="730"><h3>Exercise 2: Managing the Security Log</h3></A>
<p>In this exercise you configure Event Viewer to overwrite events when the log file gets full.</p>

<p><li> <b>To configure the size and contents of the security log file</b></li></p>

<ol>
<p><li> Right-click the security log in the console tree, then click Properties.</li></p>

<p><li> In the Security Log Properties dialog box, click Overwrite Events As Needed.</li></p>

<p><li> In the Maximum Log Size box, change the maximum log size to 2048 KB, then click OK.</li></p>

<p>Windows 2000 will now allow the log to grow to 2048 KB, and will then overwrite older events with new events as necessary.</p>
</ol>

<A NAME="731"><h3>Exercise 3: Clearing and Archiving the Security Log</h3></A>
<p>In this exercise you clear the security log, archive a security log, and view the archived security log.</p>

<p><li> <b>To clear and archive the security log</b></li></p>

<ol>
<p><li> Open Event Viewer.</li></p>

<p><li> Right-click the security log in the console tree, then click Clear All Events.</li></p>

<p><li> In the Event Viewer message box, click Yes to archive the log before clearing.</li></p>

<p><li> In the Save As dialog box, in the File Name list, type <b>archive</b> to name the log file to be archived.</li></p>

<p><li> In the Save As Type list, ensure that the Event Log (*.evt) file type is selected, then click Save.</li></p>
</ol>

<p><li> <b>To view the archived security log</b></li></p>

<ol>
<p><li> Right-click the security log in the console tree, then click Open Log File.</li></p>

<p><li> On the Open dialog box, click the ARCHIVE.EVT file (or the name of the file you archived).</li></p>

<p><li> In the Log Type list, select Security for the type of log to be opened.</li></p>

<p><li> In the Display Name box, ensure that Saved Security Log appears, then click Open.</li></p>

<p>The Saved Security Log appears in Event Viewer. You cannot click Refresh or Clear All Events to update the display or to clear an archived log.</p>

<p><li> Close Event Viewer.</li></p>
</ol>

<A NAME="732"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned about the Windows 2000 security log. You learned how to use Event Viewer to view the contents of the Windows 2000 security logs, to locate and display specific events in security logs, to configure log size, and to archive security logs.</p>

<p>In the practice portion of this lesson you viewed the security log file and 
configured Event Viewer to overwrite events when the log file is filled. Then 
you cleared and archived a security log file.</p>

</BODY>
</HTML>







