<html>
<head>
<title>Lesson 3: Monitoring Access to Shared Folders</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch14c.htm", "ch14e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="813"><h1>Lesson 3: Monitoring Access to Shared Folders</h1></A>
<p>Microsoft Windows 2000 includes the Shared Folders snap-in so that you can easily monitor access to network resources and send administrative messages to users. You monitor access to network resources to assess and manage current 
usage on network servers.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b>

<ul>
<p><li>Identify the tool included with Windows 2000 to monitor access to network resources and to send administrative messages</li></p>

<p><li>Identify who can monitor access to network resources</li></p>

<p><li>Determine the shared folders on a computer</li></p>

<p><li>Monitor shared folders</li></p>

<p><li>Monitor open files</li></p>

<p><li>Disconnect users from one or all open files</li></p>
</ul>

<b>Estimated lesson time: 20 minutes</b>
</blockquote></div>
</p>

<A NAME="814"><h2>Why Monitor Network Resources?</h2></A>
<p>Some of the reasons it is important to assess and manage network resources are the following:</p>

<ul>
<p><li><b>Maintenance.</b> You should determine which users are currently using a resource so that you can notify them before making the resource temporarily or permanently unavailable.</li></p>

<p><li><b>Security.</b> You should monitor user access to resources that are confidential or need to be secure to verify that only authorized users are accessing them.</li></p>

<p><li><b>Planning.</b> You should determine which resources are being used and how much they are being used so that you can plan for future system growth.</li></p>
</ul>

<p>Microsoft Windows 2000 includes the Shared Folders snap-in so that you can easily monitor access to network resources and send administrative messages to users. The Shared Folders snap-in is preconfigured in the Computer Management console, allowing you to monitor resources on the local computer. If you add the Shared Folders snap-in to an MMC, you can specify whether you want to monitor the resources on the local computer or a remote computer.</p>

<A NAME="815"><h2>Network Resource Monitoring Requirements</h2></A>
<p>Not all users can monitor access to network resources. Table 14.7 lists the group membership requirements for monitoring access to network resources.</p>

<p><b>Table 14.7</b> <i>Groups that Can Access Network Resources</i></p>


<table cellpadding="5" border="0" width="95%">
<tr><th>A Member of These Groups</th><th>Can Monitor</th></tr>
<tr><td valign="top">Administrators or Server Operators for the domain</td><td valign="top">All computers in the domain</td></tr>
<tr><td valign="top">Administrators or Power Users for a member server, stand-alone server, or computer running Microsoft Windows 2000 Workstation</td><td valign="top">That computer</td></tr>
</table>

<A NAME="816"><h2>Monitoring Access to Shared Folders</h2></A>
<p>You use the Shares folder in the Shared Folders snap-in to view a list of all shared folders on the computer and to determine how many users have a connection to each folder. In Figure 14.7, the Shares folder has been selected in the Computer Management console tree and all the shared folders on that computer are shown in the details pane.</p>

<p>
<A HREF="javascript:fullSize('14wtk07x.htm')"> <img src="images/14wtk07.JPG" width=404 height=250 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 14.7</b> <i>The Shares folder of the Shared Folders snap-in</i><!-- /caption -->
</p>


<p>Table 14.8 explains the information provided in the details pane shown in Figure 14.7.</p>

<p><b>Table 14.8</b> <i>Fields in the Details Pane for the Shares Folder</i></p>

<table cellpadding="5" border="0" width="95%">
<tr><th>Column Name</th><th>Description</th></tr>
<tr><td valign="top">Shared Folder</td><td valign="top">The name of the shared folders on the computer.</td></tr>
<tr><td valign="top">Shared Path</td><td valign="top">The path to the shared folder.</td></tr>
<tr><td valign="top">Type</td><td valign="top">The operating system that must be running on a computer so that it can be used to gain access to the shared folder.</td></tr>
<tr><td valign="top"># Client Redirections</td><td valign="top">The number of clients who have made a remote connection to the shared folder.</td></tr>
<tr><td valign="top">Comment</td><td valign="top">Descriptive text about the folder. This comment was provided when the folder was shared.</td></tr>
</table>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
Windows 2000 does not update the list of shared folders, open files, and user sessions automatically. To update these lists, on the Action menu, click Refresh.</blockquote></div>
</p>

<A NAME="817"><h3>Determining How Many Users Can Access a Shared Folder Concurrently</h3></A>
<p>You can use the Shared Folders snap-in to determine the maximum number of users that are permitted to gain access to a folder. In the Shared Folders details pane, click the shared folder for which you want to determine the maximum number of concurrent users that can access the folder. On the Action menu, click Properties, and the Properties dialog box for the shared folder appears. The General tab shows you the user limit.</p>

<p>You can also use the Shared Folders snap-in to determine if the maximum number of users that are permitted to gain access to a folder has been reached. This is an easy way to troubleshoot connectivity problems. If a user cannot connect to a share, determine the number of connections to the share and the maximum connections allowed. If the maximum number of connections has already been made, the user cannot connect to the shared resource.</p>

<A NAME="818"><h3>Modifying Shared Folder Properties</h3></A>
<p>You can modify existing shared folders, including shared folder permissions, from the Shares folder. To change a shared folder's properties, click the shared folder, and then on the Action menu, click Properties. The General tab of the Properties dialog box shows you the share name, the path to the shared folder, and any comment that has been entered. The General tab also allows you to view and set a user limit for accessing the shared folder. The Security tab allows you to view and change the shared folders permissions.</p>

<A NAME="819"><h2>Monitoring Open Files</h2></A>
<p>Use the Open Files folder in the Shared Folders snap-in to view a list of open files that are located in shared folders and the users who have a current connection to each file (see Figure 14.8). You can use this information when you need to contact users to notify them that you are shutting down the system. Additionally, you can determine which users have a current connection and should be contacted when another user is trying to gain access to a file that is in use.</p>

<p>
<A HREF="javascript:fullSize('14wtk08x.htm')"> <img src="images/14wtk08.JPG" width=404 height=250 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 14.8</b> <i>The Open Files folder of the Shared Folders snap-in</i><!-- /caption -->
</p>


<p>Table 14.9 describes the information that is available in the Open Files folder.</p>

<p><b>Table 14.9</b> <i>Information Available in the Open Files Folder</i></p>

<table cellpadding="5" border="0" width="95%">
<tr><th>Column Name</th><th>Description</th></tr>
<tr><td valign="top">Open File</td><td valign="top">The name of the open files on the computer.</td></tr>
<tr><td valign="top">Accessed By</td><td valign="top">The logon name of the user who has the file open.</td></tr>
<tr><td valign="top">Type</td><td valign="top">The operating system running on the computer where the user is logged on.</td></tr>
<tr><td valign="top"># Locks</td><td valign="top">The number of locks on the file. Programs can request the operating system to lock a file to gain exclusive access and prevent other programs from making changes to the file.</td></tr>
<tr><td valign="top">Open Mode</td><td valign="top">The type of access that the user's application requested when it opened the file, such as Read or Write.</td></tr>
</table>

<A NAME="820"><h2>Disconnecting Users from Open Files</h2></A>
<p>You can disconnect users from one open file or from all open files. If you make changes to Windows NT file system (NTFS) permissions for a file that is currently opened by a user, the new permissions will not affect the user until he or she closes and then attempts to reopen the file.</p>

<p>You can force these changes to take place immediately by doing either of the following:</p>

<ul>
<p><li>Disconnecting all users from all open files. To disconnect all users from all open files, in the Shared Folders snap-in console tree, click Open Files, and then on the Action menu, click Disconnect All Open Files.</li></p>

<p><li>Disconnecting all users from one open file. To disconnect users from one open file, in the Shared Folders snap-in console tree, click Open Files. In the details pane select the open file, and then on the Action menu, click Close Open File.</li></p>
</ul>

<p><div class="caution"><blockquote>
<b>CAUTION</b><hr>
Disconnecting users from open files can result in data loss.
</blockquote></div></p>

<A NAME="821"><h2>Sending Console Messages</h2></A>
<p>To avoid data loss, you can send a message to some or all users who have an active session with the shared folders that you are managing.</p>

<p><li><b>To send a console message to a connected user</b></li></p>

<ol>
<p><li>Click the Shared Folders snap-in, click the Action menu, select All Tasks, then click Send Console Message.</li></p>
<p><li>In the Send Console Message dialog box, type the message you want to send to users in the Message box.</li></p>
<p><li>Select the computer name that will receive the message in the Recipients box, then click Send.</li></p>
<p>If a user is logged on to more than one computer, only the computer that has its name in the recipient list will receive the message.</p>
<p>If any recipients do not successfully receive the message, you are returned to the Send Console Message dialog box. Recipients that did not successfully receive the message are the only computer names remaining in the list. You should check to see if the computer names are valid or if the computers are unavailable.</p>
</ol>

<p><img src="images/practic.JPG" width=92 height=74 border="0"></p>

<A NAME="822"><h2>Practice: Managing Shared Folders</h2></A>
<p>In this practice you use the Shared Folders snap-in to view the shared folders and open files on your server. You will disconnect all users from all open files.</p>

<p><li><b>To view the shared folders on your computer</b></li></p>

<ol>
<p><li>Click Start, point to Programs, point to Administrative Tools, then click Computer Management.</li></p>

<p><li>In the console tree of Computer Management, expand System Tools, then expand Shared Folders.</li></p>

<p><li>In the console tree, click Shares under Shared Folders.</li></p>

<p>Notice that the details pane shows a list of the existing Shared Folders on your computer.</p>
</ol>

<p><li><b>To view the open files on your computer</b></li></p>

<ol>
<p><li>In the console tree, click Open Files under Shared Folders.</li></p>

<p>If you are working on a computer that is not connected to a network, there will not be any open files because the open files only show connections from a remote computer to a share on your computer.</p>
</ol>

<p><li><b>To disconnect all users from open files on your computer</b></li></p>

<ol>
<p><li>In the console tree, select Open Files under Shared Folders, then click Disconnect All Open Files on the Action menu.</li></p>
<p>If you are not on a network, there will not be any open files to disconnect.</p>
<p><li>Close Computer Management.</li></p>
</ol>

<A NAME="823"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned that Windows 2000 includes the Shared Folders snap-in so that you can monitor access to network resources. You can monitor resources on the local computer or on a remote computer. To monitor resources on a remote computer, you specify the computer on which you want to monitor resources when you add the Shared Folders snap-in to an MMC console.</p>

<p>You also learned that you use the Shares folder in the Shared Folders snap-in to view a list of all shared folders on the computer and to determine how many users have a connection to each folder. The General tab of the Properties page for a shared folder shows you the user limit, or maximum number of users that can concurrently connect to that share. You use the Open Files folder in the Shared Folders snap-in to view a list of open files that are located in shared folders and the users who have a current connection to each file.</p>

<p>In the practice portion of this lesson you viewed the shared folders and open files on your server and disconnected all users from all open files.</p>

</BODY>
</HTML>







