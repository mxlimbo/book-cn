<html>
<head>
<title>Lesson 3: Administering RIS</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch15c.htm", "ch15e.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="869"><h1>Lesson 3: Administering RIS</h1></A>
<p>This section discusses the tasks necessary to administer RIS, including managing client installation images, managing RIS client computers, and managing RIS security.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li>Manage RIS client installation images</li></p>

<p><li>Manage RIS client computers</li></p>

<p><li>Manage RIS security</li></p>
</ul>

<b>Estimated lesson time: 20 minutes</b> 
</blockquote></div>
</p>

<A NAME="870"><h2>Administering RIS</h2></A>
<p>Administering RIS includes the following tasks:</p>

<ul>
<p><li>Managing RIS client installation images</li></p>

<p><li>Managing RIS client computers</li></p>

<p><li>Managing RIS security</li></p>
</ul>

<A NAME="871"><h2>Managing RIS Client Installation Images</h2></A>
<p>Managing RIS client installation images includes the following tasks:</p>

<ul>
<p><li>Adding new client OS installation images</li></p>

<p><li>Associating unattended setup answer files</li></p>
</ul>

<p><li><b>To add a new client OS installation image</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, right-click the applicable RIS server, then click Properties.</li></p>

<p><li> In the Properties dialog box for the server, click the Remote Install tab, then click Advanced Settings.</li></p>

<p><li> In the Remote Installation Services Properties dialog box, click the Images tab.</li></p>

<p><li> Click Add to start the Add Wizard.</li></p>

<p><li> On the New Answer File Or Installation Image page, click Add A New Installation Image, then click Next to start the Add Installation Image Wizard.</li></p>

<p><li> On the Welcome To The Add Installation Image Wizard page, click Next.</li></p>

<p><li> On the Installation Source Files Location page, type the location of the Windows 2000 Professional installation image, then click Next. The location can be either a CD-ROM or network share.</li></p>

<p><li> On the Windows Installation Image Folder Name page, type a name for the Windows installation image, then click Next.</li></p>

<p><li> On the Friendly Description And Help Text page, enter the friendly description and help text for the installation image, then click Next.</li></p>

<p><li> If a previous set of CIW screens exists, the Previous Client Installation Screens Found page appears. Select the CIW screen you want to use for this image, then click Next.</li></p>

<p><li> On the Review Settings page, review the installation summary, then click Finish.</li></p>

<p>The Remote Installation Setup Wizard completes the addition of the new client installation image.</p>
</ol>

<p><li><b>To associate unattended setup answer files</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, right-click the applicable RIS server, then click Properties.</li></p>

<p><li> In the Properties dialog box for the server, click the Remote Install tab, then click Advanced Settings.</li></p>

<p><li> In the Remote Installation Services Properties dialog box, click the Images tab.</li></p>

<p><li> Click Add to start the Add Wizard.</li></p>

<p><li> On the New Answer File Or Installation Image page, click Associate A New Answer File To An Existing Image, then click Next.</li></p>

<p><li> On the Unattended Setup Answer File Source page, click the source that contains the unattended setup file you want to copy:</li></p>

<ul>
<p><li>Windows Image Sample Files</li></p>
<p><li>Another Remote Installation Server</li></p>
<p><li>An Alternate Location</li></p>
</ul>

<p><li> Click Next.</li></p>

<p><li> On the Select An Installation Image page, select the installation image the answer file will be associated with, then click Next.</li></p>

<p><li> On the Select A Sample Answer File page, select a sample unattended setup answer file, then click Next.</li></p>

<p><li> On the Friendly Description And Help Text page, enter the friendly description and help text for the installation image, then click Next.</li></p>

<p><li> On the Review Settings page, review the settings summary, then click Finish.</li></p>
</ol>

<A NAME="872"><h2>Managing RIS Client Computers</h2></A>
<p>Managing RIS client computers includes the following tasks:</p>

<ul>
<p><li>Prestaging RIS client computers</li></p>

<p><li>Finding RIS client computers</li></p>
</ul>

<A NAME="873"><h3>Prestaging RIS Client Computers</h3></A>
<p>Prestaging an RIS client computer is the process of creating a valid client CAO within Active Directory. By prestaging the client computer account in Active Directory, you can configure the RIS servers to only respond to prestaged client computers. This ensures that only those client computers that have been prestaged as authorized users are allowed to install an OS from the RIS server. Prestaging can save time and money by reducing, and in some cases eliminating, the need to fully preinstall the computer.</p>

<p>When you prestage a client computer, you can define a specific computer name and optionally specify the RIS server to service the computer. This information is used to identify and route the client computers during the network service boot request. Make sure you set the appropriate access permissions for users of the prestaged client computer. When prestaging a client computer into a domain with multiple domain controllers, the replication delay of the client CAO information can cause a client computer to be serviced by another RIS server.</p>

<p><li><b>To prestage a client computer</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>
<p><li> In the console tree, right-click the applicable OU that will contain the new client computer, click New, then click Computer.</li></p>
<p><li> In the New Object-Computer dialog box (see Figure 15.12), type the client computer name, authorize domain join permissions for the user or security group containing the user that will receive the physical computer this computer account represents, then click Next.</li></p>
<p>
<A HREF="javascript:fullSize('15wtk12x.htm')"> <img src="images/15wtk12.JPG" width=404 height=340 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.12</b> <i>New Object-Computer dialog box</i><!-- /caption -->
</p>

<p><li> In the Managed dialog box (see Figure 15.13), click This Is A Managed Computer, type the client computer GUID into the text entry field, then click Next. See &quot;<A HREF="ch15d.htm#875">Locating the GUID for Client Computers</A>&quot; later in this lesson for details.</li></p>
<p>
<A HREF="javascript:fullSize('15wtk13x.htm')"> <img src="images/15wtk13.JPG" width=404 height=340 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.13</b> <i>Managed dialog box</i><!-- /caption -->
</p>

<p><li> In the Host Server dialog box (see Figure 15.14), click one of the following options to determine which server will support this client computer:</li></p>
<ul>
<p><li> <b>Any Available Remote Installation Server.</b> Selecting this option indicates this client computer can be serviced by any RIS server.</li></p>

<p><li> <b>The Following Remote Installation Server.</b> Selecting this option allows you to designate a specific server.</li></p>
</ul>

<p>
<A HREF="javascript:fullSize('15wtk14x.htm')"> <img src="images/15wtk14.JPG" width=404 height=340 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.14</b> <i>Host Server dialog box</i><!-- /caption -->
</p>


<p>You can use the options in the Host Server dialog box to manually set clients across the available RIS servers within your organization and to segment the network traffic, if you know the physical location of the specific RIS server and where this computer will be delivered. For example, if an RIS server was located on the fifth floor of your building, and you are delivering these computers to users on that floor, then you could choose to assign this computer to the RIS server on the fifth floor.</p>

<p><li> Click Next.</li></p>

<p><li> Review the settings on the New Object-Computer dialog box, then click Finish.</li></p>
</ol>

<A NAME="874"><h3>Finding RIS Client Computers</h3></A>
<p>You can search Active Directory for RIS client computer accounts using their computer name or GUID. The Show Clients feature searches for all client computers that are prestaged for this RIS server. The search process can include the entire Active Directory structure or be limited to a specific domain. The search process returns a list of the client computers and displays them by their computer name and GUID.</p>

<p>The Show Clients search process uses a wildcard search attribute appended to the current RIS server computer name. For example, if the RIS server is named RISsvr1, the Show Clients feature will use RISsvr1* for the server name. When you use the Show Clients feature in multiple RIS server environments, the search result might contain client computers from multiple servers. For example, if you have multiple RIS servers with computer names such as RISsvr1, RISsvr10, and RISsvr100, the search will return, from each of the servers, client computers that begin with the same computer name.</p>

<A NAME="875"><h3>Locating the GUID for Client Computers</h3></A>
<p>The computer's GUID appears in the following areas:</p>

<ul>
<p><li>A label on the side of the computer case</li></p>

<p><li>A label within the computer case</li></p>

<p><li>The BIOS of the client computer</li></p>
</ul>

<p>The manufacturer supplies the computer's GUID. The GUID must be in the form {<i>dddddddd-dddd-dddd-dddd-dddddddddddd</i>}, where <i>d</i> is a hexadecimal text digit. For example: 8 hexadecimal text digits, followed by 4, then 4, then 4, then 12, such as the following: {921FB974-ED42-11BE-BACD-00AA0057B223}</p>

<p>Valid entries for the client GUID are restricted to the following:</p>

<p>0 1 2 3 4 5 6 7 8 9 a b c d e f - A B C D E F</p>

<p>Dashes are optional and spaces are ignored. Brackets {} must be included.</p>

<p><li><b>To find RIS client computers</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, right-click the applicable RIS server, then click Properties.</li></p>

<p><li> In the Properties dialog box for the server, click the Remote Install tab.</li></p>

<p><li> In the Remote Install dialog box, click Show Clients.</li></p>

<p><li> In the Find Remote Installation Clients dialog box (see Figure 15.15), in the GUID box, enter the client computer's GUID, then click Find Now.</li></p>
</ol>

<ul>
<p>
<A HREF="javascript:fullSize('15wtk15x.htm')"> <img src="images/15wtk15.JPG" width=404 height=369 border=0 ALT = "Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 15.15</b> <i>Find Remote Installation Clients dialog box</i><!-- /caption -->
</p>
</ul>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
You can limit the client computer search to a specific RIS server by 
entering the server name in the RI server box.</blockquote></div>
</p>

<ol start="6">
<p><li> The RIS client computers appear in the Name and GUID columns in the lower portion of the Find Remote Installation Clients dialog box.</li></p>

<p><li> Close the Find Remote Installation Clients dialog box.</li></p>

<p><li> Close the Properties dialog box for the server.</li></p>
</ol>

<A NAME="876"><h2>Managing RIS Security</h2></A>
<p>Managing RIS security includes the following tasks:</p>

<ul>
<p><li>Setting permissions for creating prestaged and user-created computer accounts</li></p>
<p><li>Setting permissions for joining computers created in the Computers container and OUs to the domain</li></p>
</ul>

<A NAME="877"><h3>Setting Permissions for Creating Computer Accounts</h3></A>
<p>To create new computer accounts in Active Directory, users need to have permissions and rights assigned to them. You must determine which users will be creating new client computer accounts and modify the users' rights and privileges accordingly.</p>

<p><li><b>To set permissions for creating prestaged computer accounts</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> On the View menu, enable Users, Groups And Computers As Containers and Advanced Features.</li></p>

<p><li> In the console tree, right-click the applicable client computer account, then click Properties.</li></p>

<p><li> In the Properties dialog box, click the Security tab, then click Add.</li></p>

<p><li> In the Select Users, Computers, Or Groups dialog box, select the user or group from the list, click Add, then click OK.</li></p>

<p><li> In the Properties dialog box, click the user or group you have added.</li></p>

<p><li> In the Permissions box, click the Read, Write, Change Password, and Reset Password permissions, then click OK.</li></p>

<p>If a group is allowed to have these permissions, remember to add users to that group.</p>

<p>For client computer accounts that are prestaged in another Active Directory folder location, expand the Active Directory Users and Computer console and select the appropriate client computer account.</p>
</ol>

<p><li><b>To set permissions for creating user-created computer accounts</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, right-click the applicable domain, then click Delegate Control to start the Delegation Of Control Wizard.</li></p>

<p><li> On the Welcome To The Delegation Of Control Wizard page, click Next.</li></p>

<p><li> On the Users Or Groups page, click Add.</li></p>

<p><li> In the Select Users, Computers, Or Groups dialog box, click the user account or security group (preferred) containing the users you are setting permissions for, click Add, then click OK.</li></p>

<p><li> On the Users Or Groups page, click Next.</li></p>

<p><li> On the Tasks To Delegate page, click Delegate The Following Common Tasks, click Join A Computer To The Domain, then click Next.</li></p>

<p><li> Review the delegation of control summary information, then click Finish.</li></p>
</ol>

<A NAME="878"><h3>Setting Permissions for Joining Computer Accounts to a Domain</h3></A>
<p>To join new computer accounts to the domain, users need to have permissions and rights assigned to them. You must determine which users will be joining new client computer accounts to a domain and modify the users' rights and privileges accordingly.</p>

<p><li><b>To set permissions for joining computer accounts created in the Computers container to the domain</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, right-click the applicable domain, then click Delegate Control to start the Delegation Of Control Wizard.</li></p>

<p><li> On the Welcome To The Delegation Of Control Wizard page, click Next.</li></p>

<p><li> On the Users Or Groups page, click Add.</li></p>

<p><li> In the Select Users, Computers, Or Groups dialog box, click the user account or security group (preferred) containing the users that will be joining client computers to the domain, click Add, then click OK.</li></p>

<p><li> On the Users Or Groups page, click Next.</li></p>

<p><li> On the Tasks To Delegate page, click Delegate The Following Common Tasks, click Join A Computer To The Domain, then click Next.</li></p>

<p><li> Review the delegation of control summary information, then click Finish.</li></p>
</ol>

<p><li><b>To set permissions for joining computer accounts created in OUs to the domain</b> </li></p>

<ol>
<p><li> Click Start, point to Programs, point to Administrative Tools, then click Active Directory Users And Computers.</li></p>

<p><li> In the console tree, right-click the applicable OU, then click Properties.</li></p>

<p><li> In the Properties dialog box for the OU, in the Group Policy tab, click the GPO in the Group Policy Object Links box, then click Edit.</li></p>

<p><li> In the Group Policy snap-in, open Computer Configuration, click Windows Settings, click Security Settings, click Local Policies, then click User Rights Assignment.</li></p>

<p><li> Double-click Add Workstations To Domain.</li></p>

<p><li> In the Security Policy Setting dialog box, click Add.</li></p>

<p><li> In the Add User Or Group dialog box, type or use the Browse button to enter the names of the user accounts or security groups (preferred) containing the users who will be adding client computers to the domain in the User And Group Names box, then click OK.</li></p>

<p><li> In the Security Policy Setting dialog box, click OK.</li></p>

<p><li> Close the Group Policy snap-in.</li></p>

<p><li> In the Properties dialog box for the OU, click OK.</li></p>
</ol>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Because the changes that you make to RIS policy take effect only when the policy is propagated (applied) to your computer, do one of the following to initiate policy propagation:
<ul>
<p><li>Type <b>secedit /refreshpolicy machine_policy</b> at the command prompt, then press Enter.</li></p>
<p><li>Restart your computer.</li></p>
<p><li>Wait for automatic policy propagation, which occurs at regular, configurable intervals. By default, policy propagation occurs every 8 hours.</li></p>
</ul>
</blockquote></div>
</p>


<A NAME="879"><h2>Lesson Summary</h2></A>
<p>In this lesson you learned about the tasks necessary to administer RIS, including managing RIS client installation images, managing RIS client computers, and managing RIS security.</p>

</BODY>
</HTML>







