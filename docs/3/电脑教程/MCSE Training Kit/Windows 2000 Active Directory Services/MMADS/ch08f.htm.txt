<html>
<head>
<title>Lesson 5: Groups for Administrators</title>
<link rel="STYLESHEET" type="text/css" href="mmads.css">

<SCRIPT LANGUAGE="JavaScript"><!-- 
function fullSize(sURL){window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}
--></SCRIPT>
</head>
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch08e.htm", "ch08g.htm", "images/unit_p_a1.gif", "images/unit_p_a2.gif", "images/unit_p_b1.gif", "images/unit_p_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#aa22aa", "2");
//--></SCRIPT><P>

<A NAME="399"><h1>Lesson 5: Groups for Administrators</h1></A>
<p>For optimum security, Microsoft recommends that you do not assign administrators to the Administrators group and that you avoid running your computer while logged on as an administrator. This lesson examines reasons why you should not run your computer as an administrator, and the actions you should take to ensure security for administrators.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to</b> 

<ul>
<p><li> Explain why you should not run your computer as an administrator</li></p>

<p><li> Explain the groups administrators should use to log on</li></p>

<p><li> Explain how to use Run As to start a program as an administrator</li></p>
</ul>

<b>Estimated lesson time: 15 minutes</b> 
</blockquote></div>
</p>

<A NAME="400"><h3>Why You Should Not Run Your Computer as an Administrator</h3></A>
<p>Running Windows 2000 as an administrator or a member of one of the administrative groups makes the network vulnerable to Trojan horse attacks and other security risks. The simple act of visiting an Internet site can be extremely damaging to the system. An unfamiliar Internet site may contain Trojan horse code that can be downloaded to the system and executed. If you are logged on with administrator privileges, a Trojan horse could possibly reformat your hard drive, delete all files, create a new user account with administrative access, and so on.</p>

<p>Therefore, you should not assign yourself to the Administrators group and you should avoid running nonadministrative tasks on your computer while logged on as an administrator. For most computer activity, you should assign yourself to the Users or Power Users group. Then, if you need to perform an administrator-only task, you should log on as an administrator, or run the program as the administrator, perform the task, and then log off.</p>

<A NAME="401"><h3>Administrators as Members of the Users and Power Users Groups</h3></A>
<p>When you log on as a member of the Users group, you can perform routine tasks, including running programs and visiting Internet sites, without exposing your computer to unnecessary risk. As a member of the Power Users group, you can perform routine tasks and install programs, add printers, and use most Control Panel items. If you need to perform administrative tasks such as upgrading the operating system or configuring system parameters, then log off and log back on as an administrator.</p>

<p>If you frequently need to log on as an administrator, for certain administrative tasks you can use Run As to start a program as an administrator.</p>

<A NAME="402"><h2>Using Run As to Start a Program</h2></A>
<p>To run a program that requires you to be logged on as an administrator, you can use the Run As program. This program allows you to run administrative tools with either local or domain administrator rights and permissions while logged on as a normal user.</p>

<p>The Run As program can be used to start any program, program shortcut, saved MMC console, or Control Panel item, as long as</p>

<ul>
<p><li> You provide the appropriate user account and password information</li></p>
<p><li> The user account has the ability to log on to the computer</li></p>
<p><li> The program, MMC tool, or Control Panel item is available on the system and to the user account</li></p>
</ul>

<p>Some applications, such as Windows Explorer, the Printers folder, and desktop items are started indirectly by Windows 2000 and therefore cannot be started with the Run As program.</p>

<p><li><b>To use Run As to start a program as an administrator</b> </li></p>

<ol>
<p><li> In Windows Explorer, click the program or its shortcut, MMC console, or Control Panel item you want to open.</li></p>
<p><li> Press Shift and right-click the program, tool, or item; then click Run As.</li></p>
<p><li> On the Run As Other User dialog box (see Figure 8.8), click Run The Program As The Following User.</li></p>


<p>
<img src="images/08wtk08.JPG" width=347 height=295 border="0">
</p><p>
<!-- caption --><b>Figure 8.8</b> <i>Run As Other User dialog box</i><!-- /caption -->
</p>


<p><li> In the User Name and Password boxes, type the user name and password of the administrator account you want to use.</li></p>

<p><li> In the Domain box:</li></p>
<ul>
<p><li> If you want to use the local administrator account on your computer, type the name of your computer.</li></p>
<p><li> If you want to use the domain administrator account on your computer, type the name of the domain.</li></p>
</ul>
<p><li> Click OK.</li></p>
</ol>

<p>If you attempt to start a program, MMC console, or Control Panel item from a network location using the Run As program, it may fail if the credentials used to connect to the network share are different from the credentials used to start the program. The credentials used to run the program may not be able to gain access to the same network share.</p>

<p>If the Run As program fails, the RUNAS service may not be running. You can set the RUNAS service to start automatically when the system starts using the RUNAS Service option in the Services console.</p>

<p>
<div class="note"><blockquote><b>NOTE</b> <hr>
Run As is usually used to run programs as an administrator, although it is not limited to administrator accounts. Any user with multiple accounts can use Run As to run a program, MMC tool, or Control Panel item with alternate credentials.
</blockquote></div>
</p>

<p>You can also set a property on shortcuts to programs and MMC tools so that you will always be prompted for alternate credentials when you use the shortcut. To set the property, right-click the shortcut, click Properties, and then click the Run As Different User check box. When you start the shortcut, the Run As Other User dialog box appears, prompting you for the alternate user name, password, and domain as described previously.</p>

<A NAME="403"><h2>RUNAS Command</h2></A>
<p>The RUNAS command performs the same functions as the Run As program. The syntax for the RUNAS command is as follows:</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
runas [/profile] [/env] [/netonly] /user:<i>UserAccountName</i> program
</pre>
</td></tr>
</table>
</p>

<p>where:</p>

<ul>
<p><li> <b>/profile</b> specifies the name of the user's profile, if it needs to be loaded.</li></p>

<p><li> <b>/env</b> specifies that the current network environment be used instead of the user's local environment.</li></p>

<p><li> <b>/netonly</b> indicates that the user information specified is for remote access only.</li></p>

<p><li> <b>/user:<i>UserAccountName</i></b> specifies the name of the user account under which to run the program. The user account format should be <i>user@domain</i> or <i>domain\user</i>. If you want to use the Administrator account on your computer, for the <b>/user:</b> parameter, type <b>/user:<i>AdministratorAccountName</i>@<i>ComputerName</i></b> or <b>/user:<i>ComputerName</i>\<i>AdministratorAccountName</i></b> .</li></p>

<p>If you want to use this command as a domain administrator, type <b>/user:<i>AdministratorAccountName</i>@<i>DomainName</i></b> or <b>/user:<i>DomainName</i>\<i>AdministratorAccountName</i></b> .</p>

<p><li> <b>/program</b> specifies the program or command to run using the account specified in /user.</li></p>
</ul>

<A NAME="404"><h2>RUNAS Examples</h2></A>
<ul>
<p><li> To start an instance of the Windows 2000 command prompt as an administrator on the local computer, type:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
RUNAS