<HTML>
<HEAD>
<TITLE>Lesson 3: Using Visual Database Tools</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch01c.htm", "ch01e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>


<A NAME="65"><H1>Lesson 3: Using Visual Database Tools</H1></A>

<P>Microsoft Visual Database Tools, now integrated into all members of the Visual Studio suite, provide extensive support for building data-centric applications rapidly. With Visual Database Tools, you can:</P>

<ul>

<p><li> Connect to and explore any ODBC or OLE-DB database (including SQL Server and Oracle).</li></p>

<p><li> Create and modify databases using database diagrams.</li></p>

<p><li> Design, execute, and save complex queries.</li></p>

<p><li> Add, update, and delete data stored in database tables.</li></p>

<p><li> Design objects, such as tables, triggers, and stored procedures, in  SQL Server and Oracle databases.</li></p>

<p><li> Drag database objects onto a design surface to bind controls to those objects.</li></p>

</ul>

<P><DIV CLASS="SIDEBAR"><BLOCKQUOTE>

<b>After this lesson you will be able to:</b>
<ul>

<p><li> Use the Data View window to browse properties of tables and fields in a database.</li></p>

<p><li> Describe the purpose of the Query Builder.</li></p>

<p><li> Add a Data Environment to a project.</li></p>

</ul>
<b>Estimated lesson time: 20 minutes</b>

</BLOCKQUOTE></DIV></P>

<A NAME="66"><H2>Using Visual Database Tools with Visual Studio</H2></A>

<P>Using Visual Studio 6.0 Enterprise Edition, you can interactively debug and view SQL stored procedures from each development environment. Using integrated SQL debugging, you can implement stored procedures in an SQL database and verify or debug them in the context of the application that is calling them. Using the power of distributed computing technology, you can step from Visual C++, Visual J++, Visual Basic script, or Visual Basic source code executing on a client computer to SQL Server 7.0 source code executing on a remote server computer.</P>


<A NAME="67"><H3>Visual Database Tools Integration</H3></A>

<P>The Database Designer and Query Designer supplied with Visual Database Tools provide a visual interface to help you create and modify database structures (schemas) and queries. You can create SQL Server and Oracle database tables, use drag-and-drop operations to create views, and automatically change column data types.</P>

<P>Visual Database Tools consists of four components: </P>

<ol>

<p><li> Data View</li></p>

<p><li> Database Designer</li></p>

<p><li> Query Designer</li></p>

<p><li> Source Code Editor for stored procedures and triggers</li></p>

</ol>

<P>This combination of database design tools provides a complete, tightly integrated, database-development and administration tool for developers. The specific functionality available in each component depends on the database server you are using. In this course, you will focus on using the Data View window and Query Designer.</P>


<A NAME="68"><H3>Using the Data View Window</H3></A>

<P>The Data View window contains a list of all the database connections currently available to your project. You can see the entire structure of the database using the Data View window. In addition to inspecting the structure of your database, as illustrated in Figure 1.5, you can drag objects from the Data View onto the Data Environment to quickly create ADO recordset commands.</P>

<P>
<img src="images/F01xx05.GIF" width=365 height=445 border="0">
</P><P>
<!--caption--><b>Figure 1.5</b> <i>The Data View window</i><!--/caption-->
</P>


<P>The Data View component provides a visual interface in which you can view live connections to the databases in each project, as well as the objects available in each database, organized into folders, including:</P>

<ul>

<p><li> Database diagrams</li></p>

<p><li> Tables</li></p>

<p><li> Triggers</li></p>

<p><li> Views</li></p>

<p><li> Stored procedures</li></p>

</ul>


<A NAME="69"><H3>Using the Query Designer</H3></A>

<P>The Query Designer provides four different ways for you to construct and execute queries against any ODBC-compliant database. You can: </P>

<ul>

<p><li> Use a visual query diagram to drag tables into the query and use graphical controls to manipulate the query definition.</li></p>

<p><li> Use a criteria grid to specify search criteria, sort order, output columns, and so on.</li></p>

<p><li> Use an SQL pane to type ANSI-SQL statements-or let the Query Designer generate the SQL for you-for Select, Insert, Update, and Delete queries, as illustrated in Figure 1.6.</li></p>

<p><li> Browse and edit live views of data in your database tables.</li></p>

</ul>

<P>
<A HREF="javascript:fullSize('F01xx06x.htm')"> <img src="images/F01xx06.JPG" width=404 height=371 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 1.6</b> <i>The Query Designer</i><!--/caption-->
</P>



<A NAME="70"><H2>Deriving Physical Design Using Visual Database Tools</H2></A>

<P>A physical design is the implementation of the database's tables, columns, and relationships. It is specific to a particular data store. In this design, you specify data types, primary keys, relationship types, and other implementation details. The physical design of the database is based on the database schema. You can create the physical data structure using Visual Database Tools such as Database Designer and the Data View window. With Database Designer, you can implement the physical structure more easily than you can with SQL Server or Oracle.</P>

<P>Using Visual Database Tools, you can:</P>

<ul>

<p><li> View tables, modify data, and create SQL queries within the development environment for any ODBC- or OLE DB-compliant database.</li></p>

<p><li> Visually design and modify schemas and objects for Microsoft SQL Server 7.0 and Oracle 7.3.3+ databases.</li></p>

</ul>

<P>The Visual Database tools let you create and modify many elements in a database. The tools cannot, however, create new databases. You must use a database-specific tool such as SQL Server Enterprise Manager to create new databases.</P>

<P>
<img src="images/practice.gif" width=67 height=55 border="0">
</P>

<A NAME="71"><H2>Practice: Tour of the SQL Server Pubs database </H2></A>

<P>In this practice, you will use the Visual Database Tools to take a tour of the Pubs sample database in SQL Server 7.0.</P>

<P><li><B>To use the Visual Database Tools in Visual Basic 6.0</B></li></P>

<ol>

<p><li> Start Visual Basic 6.0 and create a new Standard EXE project.</li></p>

<p><li> From the <B>View</B> menu, click <B>Data</B> <B>View</B> <B>Window</B>.</li></p>

<p><li> On the <B>Data View</B> toolbar, click <B>Add Data Environment to the Current Project</B> (the middle button).</li></p>

<p>The <B>Data Environment</B> window appears.</p>

<p><li> Right-click the <B>Connection1</B> icon in the Data Environment, then click <B>Properties</B>.</li></p>

<p>The <B>Data Link Properties</B> window appears.</p>

<p><li> Click <B>Microsoft OLE DB Provider for SQL Server</B>, then click <B>Next</B>.</li></p>

<p><li> Type in your database server name, set the user name to <B>sa</B>, and select the <B>Pubs</B> database.</li></p>

<p>Your screen should look similar to the illustration in Figure 1.7.</p>


<P>
<img src="images/F01xx07.GIF" width=367 height=460 border="0">
</P><P>
<!--caption--><b>Figure 1.7</b> <i>Setting data link properties to connect to the Pubs database</i><!--/caption-->
</P>



<p><li> Click <B>Test Connection</B>.</li></p>

<p><li> Click <B>OK</B> to close the <B>Data Link Properties</B> window.</li></p>

<p><li> Use the tree view in the <B>Data View</B> window to open the <B>Tables</B> folder.</li></p>

<p><li> Under the <B>Tables</B> folder, open the <B>Authors</B> table.</li></p>

<p><li> Right-click in the <B>au_id</B> field and click <B>Properties</B>.</li></p>

<p>Your screen should look similar to the illustration in Figure 1.8.</p>

<P>
<A HREF="javascript:fullSize('F01xx08x.htm')"> <img src="images/F01xx08.JPG" width=404 height=303 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 1.8</b> <i>Viewing the au_id filed properties</i><!--/caption-->
</P>



<p><li> Click <B>OK</B> to close the <B>Properties</B> window.</li></p>

<p><li> View some other fields in various tables in the Pubs database, then close the <B>Data View</B> and <B>Data Environment</B> designer windows.</li></p>

<p><li> Close Visual Basic 6.0.</li></p>

</ol>


<A NAME="72"><H2>Lesson Summary </H2></A>

<P>Visual Database Tools, now integrated into all members of the Visual Studio suite, provide extensive support for building data-centric applications rapidly. The  Visual Database Tools (Database Designer and Query Designer) provide a visual interface to help you create and modify database structures (schemas) and queries. You can create SQL Server and Oracle database tables, use drag-and-drop operations to create views, and automatically change column data types. In this course, you will focus on using the Data View window and Query Designer. </P>

<P>The Data View window contains a list of all the database connections currently available to your project. You can see the entire structure of the database using the Data View window, which provides the means to browse and edit data from tables and views.</P>

<P>Using the Query Designer you can:</P>

<ul>

<p><li> Use a visual query diagram to drag tables into the query and use graphical controls to manipulate the query definition.</li></p>

<p><li> Use a criteria grid to specify search criteria, sort order, output columns, and so on.</li></p>

<p><li> Use an SQL pane to type ANSI-SQL statements-or let the Query Designer generate the SQL for you-for Select, Insert, Update, and Delete queries.</li></p>

<p><li> Browse and edit live views of data in your database tables.</li></p>

</ul>


</BODY>
</HTML>



