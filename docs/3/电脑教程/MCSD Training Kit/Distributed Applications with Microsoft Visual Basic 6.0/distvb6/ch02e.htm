<HTML>
<HEAD>
<TITLE>Lab: Creating a User Interface Dynamically </TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch02d.htm", "ch02f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>


<A NAME="112"><H1>Lab: Creating a User Interface Dynamically </H1></A>

<P>In this lab, you will create the Chateau St. Mark, Weekly Work Hours form. You will add several ActiveX controls to this form. You will also use the Add and Remove methods to dynamically modify controls on the form. You will then add a menu to the Weekly Work Hours form. The completed form will look like Figure 2.5.</P>

<p>
<img src="images/video.gif" width=78 height=54 border="0">
</p>

<P>To see a demonstration of this lab, run the Lab02.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>


<b>Estimated lesson time: 60 minutes</b>


<P>
<A HREF="javascript:fullSize('F02xx05x.htm')"> <img src="images/F02xx05.JPG" width=404 height=338 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 2.5</b> <i>The completed user interface form</i><!--/caption-->
</P>


<A NAME="113"><H2>Exercise 1: Creating the User Interface</H2></A>

<P>In this exercise, you will create the user interface by adding controls to the Weekly Work Hours form.</P>

<p><li><b>To create a new Visual Basic project</B></li></P>
<UL>
<p><li>Open a new <B>Standard EXE</B> project. Define the following project and form properties:</li></p>

<P>
<TABLE CELLPADDING=5 WIDTH="95%">
<TR>
<TH>Object
</TH>
<TH>Property
</TH>
<TH>Value
</TH></TR>
<TR>
<TD VALIGN="TOP">Project1
</TD>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">WrkHours
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="4">Form1
</TD>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">frmHours
</TD>
</TR>
<TR>
<TD VALIGN="TOP">BorderStyle
</TD>
<TD VALIGN="TOP">1 - Fixed Single
</TD></TR>
<TR>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">Chateau St. Mark Weekly Work Schedule
</TD></TR>
<TR>
<TD VALIGN="TOP">MinButton
</TD>
<TD VALIGN="TOP">True
</TD></TR></TABLE></P>

</UL>

<p><li><b>To add ActiveX controls to your project and form</B></li></P>
<OL>
<p><li>On the <B>Project</B> menu, click <B>Components</B>.</li></p>

<p><li>Select the <B>Microsoft Windows Common Controls 6.0</B> and the <B>Microsoft Masked Edit Control 6.0 </B>check boxes.</li></p>

<p><li>Click <B>OK</B> to close the <B>Components</B> dialog box.</li></p>


<p>The new controls appear in the Toolbox.</p>
</OL>
<p><li><b>To add controls to the user interface.</B></li></P>
<UL>
<p><li>Add the following controls to the form, as illustrated in Figure 2.6, and define the following properties:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%">
<TR>
<TH>Control
</TH>
<TH>Control Type
</TH>
<TH>Property
</TH>
<TH>Value
</TH></TR>
<TR>
<TD VALIGN="TOP">Label1
</TD>
<TD VALIGN="TOP">Label
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">First Name
</TD></TR>
<TR>
<TD VALIGN="TOP">Label2
</TD>
<TD VALIGN="TOP">Label
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">Last Name
</TD></TR>
<TR>
<TD VALIGN="TOP">Label3
</TD>
<TD VALIGN="TOP">Label
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">SSN
</TD></TR>
<TR>
<TD VALIGN="TOP">Label4
</TD>
<TD VALIGN="TOP">Label
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">Full Time?
</TD></TR>
<TR>
<TD VALIGN="TOP">Label5
</TD>
<TD VALIGN="TOP">Label
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP"># Days Working
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">Label6
</TD>
<TD VALIGN="TOP" rowspan="3">Label
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">Date
</TD></TR>
<TR>
<TD VALIGN="TOP">Top
</TD>
<TD VALIGN="TOP">1350
</TD></TR>
<TR>
<TD VALIGN="TOP">Left
</TD>
<TD VALIGN="TOP">400
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">Label7
</TD>
<TD VALIGN="TOP" rowspan="3">Label
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">Number of Hours
</TD></TR>
<TR>
<TD VALIGN="TOP">Top
</TD>
<TD VALIGN="TOP">1350
</TD></TR>
<TR>
<TD VALIGN="TOP">Left
</TD>
<TD VALIGN="TOP">3000
</TD>
</TR>
<TR>
<TD VALIGN="TOP" rowspan="2">Text1
</TD>
<TD VALIGN="TOP" rowspan="2">TextBox
</TD>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">txtFirstName
</TD></TR>
<TR>
<TD VALIGN="TOP">Text
</TD>
<TD VALIGN="TOP">&lt;blank&gt;
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="2">Text2
</TD>
<TD VALIGN="TOP" rowspan="2">TextBox
</TD>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">txtLastName
</TD></TR>
<TR>
<TD VALIGN="TOP">Text
</TD>
<TD VALIGN="TOP">&lt;blank&gt;
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">Text3
</TD>
<TD VALIGN="TOP" rowspan="3">TextBox
</TD>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">TxtDaysWorking
</TD></TR>
<TR>
<TD VALIGN="TOP">MaxLength
</TD>
<TD VALIGN="TOP">1
</TD></TR>
<TR>
<TD VALIGN="TOP">Text
</TD>
<TD VALIGN="TOP">&lt;blank&gt;
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="2">MaskEdBox1
</TD>
<TD VALIGN="TOP" rowspan="2">MaskEdBox
</TD>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">MskSSN
</TD></TR>
<TR>
<TD VALIGN="TOP">AutoTab
</TD>
<TD VALIGN="TOP">True
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="2">Check1
</TD>
<TD VALIGN="TOP" rowspan="2">CheckBox
</TD>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">ChkFullTime
</TD></TR>
<TR>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&lt;blank&gt;
</TD></TR></TABLE></P>

<P>
<A HREF="javascript:fullSize('F02xx06x.htm')"> <img src="images/F02xx06.JPG" width=404 height=338 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 2.6</b> <i>The registration form</i><!--/caption-->
</P>


</UL>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
Use each control's TabIndex property to control the order in which the user navigates through the form when pressing the Tab key.
</blockquote></div>
</p>

<A NAME="114"><H2>Exercise 2: Validating User Input</H2></A>

<P>In this exercise you will validate the user's input in the txtDaysWorked text box by only accepting a numeric values from 1 to 9. You will also convert the characters entered into txtFirstName and txtLastName to upper case and define the Mask property for the MaskEdBox control.</P>

<p><li><b>To validate user input</B></li></P>
<OL>
<p><li>To convert the characters entered from lower to uppercase characters add the following code to the <B>txtFirstName_KeyPress </B>and the <B>txtLastName_KeyPress </B>event procedures:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
Private Sub txtFirstName_KeyPress(KeyAscii As Integer)
    ' Use the Chr function to return the character 
    ' associated with the specified character code
    ' After the character is converted to upper case
    ' convert the uppercase character back into an ASCII value
    KeyAscii = Asc(UCase(Chr(KeyAscii)))
End Sub

Private Sub txtLastName_KeyPress(KeyAscii As Integer)
    ' Use the Chr function to return the character 
    ' associated with the specified character code
    ' After the character is converted to upper case
    ' convert the uppercase character back into an ASCII value
    KeyAscii = Asc(UCase(Chr(KeyAscii)))
End Sub
</PRE></TD></TR></TABLE></P>

<p><li>Set the <B>Mask</B> property of the <B>mskSSN</B> MaskEdBox control to <B>###-##-####</B>.</li></p>

<p><li>In the <B>txtDaysWorking_KeyPress</B> event, enter the following code:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
' Allow the use of the BACKSPACE key
If KeyAscii = vbKeyBack Then
    Exit Sub
End If
' Only digits are valid characters
If KeyAscii &lt; vbKey0 Or KeyAscii &gt; vbKey9 Then
    KeyAscii = 0
    Beep
End If
</PRE></TD></TR></TABLE></P>

<p>This code restricts a text box to receiving only digits, the BACKSPACE character, or the other non-ASCII keys.</p>

<p><li>Save your project into the \Labs\Lab02 folder and test the application.</li></p>
</OL>
<A NAME="115"><H2>Exercise 3: Adding and Coding a Menu Bar</H2></A>

<P>In this exercise, you will use the Menu Editor to create a menu bar for the frmHours form.</P>

<p><li><b>To add a menu to the project</B></li></P>
<OL>
<p><li>Click the <B>frmHours</B> form.</li></p>

<p><li>On the <B>Tools</B> menu, either click <B>Menu Editor</B> or click the <B>Menu Editor</B> button on the toolbar.</li></p>

<p><li>In the <B>Caption</B> text box, enter <B>&amp;File</B>.</li></p>

<p>The ampersand (&amp;) provides an access key to the menu.</p>

<p><li>In the <B>Name</B> text box, enter <B>mnuFile. </B></li></p>

<p>This is the name that you will use to refer to the menu control in code. Figure 2.7 illustrates the menu in the Menu Editor.</p>

<P>
<img src="images/F02xx07.GIF" width=366 height=366 border="0">
</P><P>
<!--caption--><b>Figure 2.7</b> <i>Menu Editor showing Student Registration application menu</i><!--/caption-->
</P>


<p><li>Repeat steps 3 and 4 to create the following menu array:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%">
<TR>
<TH>Menu Item
</TH>
<TH>Property
</TH>
<TH>Value
</TH></TR>
<TR>
<TD VALIGN="TOP" rowspan="2">File
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;File
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuFile
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">&nbsp;&nbsp;&nbsp;&nbsp;New Employee
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;New Employee
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuFileItem
</TD></TR>
<TR>
<TD VALIGN="TOP">Index
</TD>
<TD VALIGN="TOP">0
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&lt;Menu Break&gt;
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">-
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuFileItem
</TD></TR>
<TR>
<TD VALIGN="TOP">Index
</TD>
<TD VALIGN="TOP">1
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">Print
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;Print
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuFileItem
</TD></TR>
<TR>
<TD VALIGN="TOP">Index
</TD>
<TD VALIGN="TOP">2
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">Exit
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">E&amp;xit
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuFileItem
</TD></TR>
<TR>
<TD VALIGN="TOP">Index
</TD>
<TD VALIGN="TOP">3
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="2">Schedule
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;Schedule
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuSchedule
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">Add day
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;Add day
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuSchedItem
</TD></TR>
<TR>
<TD VALIGN="TOP">Index
</TD>
<TD VALIGN="TOP">0
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="3">Delete day
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;Delete day
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuSchedItem
</TD></TR>
<TR>
<TD VALIGN="TOP">Index
</TD>
<TD VALIGN="TOP">1
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="2">Help
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;Help
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuHelp
</TD></TR>
<TR>
<TD VALIGN="TOP" rowspan="2">About
</TD>
<TD VALIGN="TOP">Caption
</TD>
<TD VALIGN="TOP">&amp;About...
</TD></TR>
<TR>
<TD VALIGN="TOP">Name
</TD>
<TD VALIGN="TOP">mnuHelpAbout
</TD></TR></TABLE></P>

<p><li>Click <B>OK</B> to close the Menu Editor.</li></p>

</OL>

<p><li><b>To add code to menu items</B></li></P>
<OL>
<p><li>On the form's menu, click <B>File</B>, then click <B>Exit</B>.</li></p>

<p>The <B>mnuFileItem_Click</B> event procedure appears.</p>

<p><li>In the <B>mnuFileItem_Click</B> event use a Select Case statement to check the <B>Index</B> argument value and assign code to the correct menu item. Use the following code example: </li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
Private Sub <B>mnuFileItem_</B>Click(Index As Integer)
    Select Case Index
        Case 0  ' New employee schedule
        Case 1  ' Not used
        Case 2  '
            Me.PrintForm
        Case 3  ' Exit application
            Unload Me
    End Select
End Sub  
</PRE></TD></TR></TABLE></P>

<p><li>Define the Select Case statement for the <B>mnuSchedItem_Click</B> event procedure. You can add code to the Select Case statement later.</li></p>

<p><li>Save and test the application.</li></p>
</OL>

<A NAME="116"><H2>Exercise 4: Dynamically Adding Controls</H2></A>

<P>In this exercise you will dynamically add controls to your form by using the Add method and remove those controls by using the Remove method.</P>

<p><li><b>To add controls dynamically</B></li></P>
<OL>
<p><li>Create two form-level Integer variables called <B>intTotalCourses </B>and<B> intTop, as shown here:</B></li></p>
<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
Private intTotalDays As Integer
Private intTop As Integer
</PRE></TD></TR></TABLE></P>

<p><li>Add the following code to the <B>txtDaysWorked_Change </B>event:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>
Private Sub txtDaysWorking_Change()
    Dim intDays As Integer
    Dim strWeekDayName As String
    Dim strWeekDayNum As String
    Dim ctlWName As Object
    Dim ctlWNum As Object


    For intDays = 1 To txtDaysWorking.Text
        strWeekDayName = &quot;txtWeekDayName&quot; &amp; Trim(Str(intDays))
        strWeekDayNum = &quot;txtWeekDayNum&quot; &amp; Trim(Str(intDays))
        Set ctlWName = frmHours.Controls.Add(&quot;VB.TextBox&quot;, _
            strWeekDayName, frmHours)
        Set ctlWNum = frmHours.Controls.Add(&quot;VB.TextBox&quot;, _
            strWeekDayNum, frmHours)

        If intDays &gt; 1 Then
            intTop = intTop
        Else
            intTop = 1350
            intTop = intTop + 400
        End If

		
 With ctlWName
            .Visible = True
            .Top = intTop
            .Left = 200
            .Width = 2000
            .Height = 200
            .Font.Size = 10
            ' Increment to the next day
            .Text = Date + intDays 
        End With

        With ctlWNum
            .Visible = True
            .Top = intTop
            .Left = 3000
            .Width = 2000
            .Height = 200
            .Font.Size = 10
            .Text = 0
        End With
        intTop = intTop + 400
    Next
    txtDaysWorking.Enabled = False
    intTotalDays = intDays - 1
End Sub
</PRE></TD></TR></TABLE></P>
</OL>

<p><li><b>To remove a control dynamically</B></li></P>
<OL>
<p><li>Add the following code to the <B>mnuSchedItem_Click</B> event:</li></p>

<P><TABLE CELLPADDING="5" WIDTH="95%"><TR><TD>
<PRE>

Private Sub mnuSchedItem_Click(Index As Integer)
    Select Case Index
        Case 0  'Add day
            ' [Statement to add another control]
        Case 1  'Remove day
            If intTotalDays &lt; 1 Then
                Exit Sub
            End If
            frmHours.Controls.Remove &quot;txtWeekDayName&quot; &amp; intTotalDays
            frmHours.Controls.Remove &quot;txtWeekDayNum&quot; &amp; intTotalDays
            intTotalDays = intTotalDays - 1
    End Select
End Sub
</PRE></TD></TR></TABLE></P>


<p><li>Save and test your application.</li></p>
</ol>


</BODY>
</HTML>



