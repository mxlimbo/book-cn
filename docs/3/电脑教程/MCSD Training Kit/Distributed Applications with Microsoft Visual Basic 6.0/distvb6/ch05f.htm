<HTML>
<HEAD>
<TITLE>Lab: Using the Data Environment and ADO</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05e.htm", "ch05g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>


<A NAME="221"><H1>Lab: Using the Data Environment and ADO</H1></A>

<P>In this lab, you will import the Rsvn.mdb database into a new SQL Server 7.0 database. You will then create a front-end form to access the new database using a Data Environment in Visual Basic. </P>

<P>
<img src="images/video.gif" width=78 height=54 border="0">
</P>

<P>To see a demonstration of this lab, run the Lab05.exe animation located in the Animations folder on the Supplemental Course Material CD-ROM that accompanies this book.</P>


<b>Estimated lesson time: 30 minutes</b>


<P><li><B> To import the Rsvn.mdb database</B></li></P>
<OL>
<p><li> Start the SQL Server Enterprise Manager.</li></p>

<p><li> Under Console Root\Microsoft SQL Servers\SQL Server Group\&lt;database server name&gt;, click the Databases folder, as illustrated in Figure 5.16.</li></p>

<P>
<A HREF="javascript:fullSize('F05xx16x.htm')"> <img src="images/F05xx16.JPG" width=404 height=278 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 5.16</b> <i>Clicking the Databases folder under the database server</i><!--/caption-->
</P>



<p><LI>On the <B>Tools</B> menu, click <B>Data</B> <B>Transformation</B> <B>Services</B>, and then click <B>Import</B> <B>Data</B>.</LI></p>

<p>The <B>DTS Import Wizard</B> appears.</p>

<p><li> Click <B>Next</B> to start the Wizard.</li></p>

<p><li> On the Source drop-down list, click <B>Microsoft</B> <B>Access</B> to choose a data source.</li></p>

<p><li> Click the ellipsis (<B>...</B>) to the right of the <B>File </B>name box, browse to the \Labs\Lab05\Rsvn.mdb database on the Supplemental Course Material CD-ROM that accompanies this book, and then click <B>Open</B></li></p>

<p><li> Click <B>Next</B> to choose a destination for the import.</li></p>

<p><li> On the Destination drop-down list, select <B>Microsoft OLE DB Provider for SQL Server</B>.</li></p>

<p><li> Set the Server name to the server to which you want to import the Rsvn.mdb database.</li></p>

<p><li> Click <B>Use SQL Server authentication</B>, type <B>sa</B> for the username, and leave the password blank.</li></p>

<p><li> On the Database drop-down list, click <B>&lt;new&gt;</B>.</li></p>

<p>The Create Database dialog box appears.</p>

<p><li> On the Create Database dialog box, type <B>Rsvn</B> for the Name as illustrated in Figure 5.17, and then click <B>OK</B>.</li></p>

<P>
<A HREF="javascript:fullSize('F05xx17x.htm')"> <img src="images/F05xx17.JPG" width=404 height=333 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 5.17</b> <i>Naming the new database</i><!--/caption-->
</P>


<p><li> Click <B>Next</B> to go to the <B>Specify Copy</B> or <B>Query</B> option.</li></p>

<p><li> In the <B>Specify Copy</B> or <B>Query</B> option page, click <B>Copy table(s) from the source database</B>, then click <B>Next</B>.</li></p>

<p><li> Click the <B>Reservation </B>and<B> ReservationArchive</B> tables, as illustrated in Figure 5.18, then click <B>Next</B>.</li></p>

<P>
<A HREF="javascript:fullSize('F05xx18x.htm')"> <img src="images/F05xx18.JPG" width=404 height=309 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 5.18</b> <i>Importing the Reservation and ReservationArchive tables</i><!--/caption-->
</P>


<p><li> Click <B>Next</B> to run the Save, Schedule, And Replicate Package option immediately.</li></p>

<p>The Completing The DTS Wizard page appears.</p>

<p><li> Click <B>Finish</B> to close the DTS Import Wizard.</li></p>

<p>The Rsvn database has been added to your SQL Server.</p>
</OL>

<P><li><B> To create a front-end reservation browser</B></li></P>
<OL>
<p><li> Start Visual Basic 6.0 and open a new Standard EXE project.</li></p>

<p><li> Add a <B>Data Environment</B> to your project.</li></p>

<p><li> Establish a connection to the Rsvn database on your SQL Server.</li></p>

<p><li> Add a command to retrieve the FirstName, LastName, Address, Phone, and Status fields from the Reservation table.</li></p>

<p><li> Add bound controls to the form in your project to display the FirstName, LastName, Address, Phone, and Status fields from the Rsvn database.</li></p>

<p><li> Add controls to navigate records returned from the Reservation table.</li></p>

<p>Your form should look similar to Figure 5.19.</p>

<P>
<img src="images/F05xx19.GIF" width=357 height=231 border="0">
</P><P>
<!--caption--><b>Figure 5.19</b> <i>Controls on the browser form</i><!--/caption-->
</P>


<p><li> Save and test your work.</li></p>

<p>You can compare your work with the Lab 5 solution code located on the Supplemental Course Material CD-ROM in the \Labs\Lab05\Solution folder.</p>
</OL>

</BODY>
</HTML>



