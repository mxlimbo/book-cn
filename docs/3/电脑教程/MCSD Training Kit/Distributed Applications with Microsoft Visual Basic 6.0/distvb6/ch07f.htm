<HTML>
<HEAD>
<TITLE>Lab: Using Disconnected Recordsets </TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch07e.htm", "ch07g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>


<A NAME="304"><H1>Lab: Using Disconnected Recordsets </H1></A>

<P>In this lab, you will create a front-end application that will be used to retrieve records from the Rsvn database, disconnect from the database, and allow users of the Chateau St. Mark Hotel reservation system to use the records. The application will create a disconnected recordset and then update the Rsvn database when the connection is restored.</P>

<p>
<img src="images/video.gif" width=78 height=54 border=0>
</p>

<P>To see a demonstration of this lab, run the Lab07.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>

<p>
<div class="note"><blockquote><b>NOTE</b><hr>
Before you can complete this lab, you must import the Rsvn database into SQL by completing the lab in Chapter 5, &quot;<A HREF="ch05a.htm#194">Introducing ActiveX Data Objects</A>.&quot;
</blockquote></div>
</p>


<b>Estimated lesson time: 45 minutes</b>


<P><li><B> To create the front-end form</B></li></P>

<ol>
<p><li>Create a new standard EXE project in Visual Basic.</li></p>

<p><li>Create a form that contains label controls to display the LastName, FirstName, Status, and RoomNumber from the Reservation table.</li></p>

<p><li>Add recordset navigation controls to the form to move to the first, previous, next, and last records of a recordset.</li></p>

<p><li>Add a command button that will be used to update the current reservation status for people to check-in and check-out of the hotel.</li></p>

<p><li>Add command buttons to allow the user of the front-end application to disconnect from the Rsvn database, and re-connect to update reservation information.</li></p>

<p>Your form should look similar to the illustration in Figure 7.5.</p>

<P>
<A HREF="javascript:fullSize('F07xx05x.htm')"> <img src="images/F07xx05.JPG" width=404 height=204 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><b>Figure 7.5</b> <i>Front-end Reservation Manager form</i><!--/caption-->
</P>


</ol>

<P><li><B> To work with disconnected data</B></li></P>

<ol>
<p><li>Add code to recordset navigation controls to allow the user to browse records in the disconnected Recordset.</li></p>

<p><li>Create a procedure that will display fields from the Recordset in the label controls.</li></p>

<p><li>In the cmdUpdateStatus command button's click event procedure, add code that will allow the user to update the reservation status for the current record.</li></p>

<p><li>In the cmdDisconnect command button's click event procedure, add code to create a disconnected recordset.</li></p>

<p><li>In the cmdReconnect command button's click event procedure, add code to reconnect to the Rsvn database and update the Reservation table with any changes made.</li></p>

<p><li>Save and test your work.</li></p>
</ol>

</BODY>
</HTML>



