<HTML>
<HEAD>
<TITLE>Lab: Creating Class Modules</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch06f.htm", "ch06h.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>




<A NAME="329"><H1>Lab: Creating Class Modules</H1></A>

<P>In this lab, you will continue to develop the Chateau St. Mark hotel reservation system. You will use the Class Builder to create a Reservation class module. You can continue to work with the files you created in Lab 3, or you can use the files provided for you in the \Labs\Lab06\Partial folder. The solution code can be found in the \Labs\Lab06\Solution folder.</P>
<p>
<img src="images/video.gif" width=78 height=54 border="0">
</p>
<P>To see a demonstration of the solution, run the Lab06.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>


<A NAME="330"><H3>Estimated lesson time: 30 Minutes</H3></A>

<A NAME="331"><H2>Exercise 1: Creating Class Modules with the Class Builder</H2></A>

<P>In this exercise, you will use the Class Builder to create the CReservation class module. You will add several methods and an event to this class module.</P>

<P><LI><B>To load the Class Builder Utility add-in</B></LI></P>

<OL>
<P><LI>Open your application file or the Hotelres.vbp file located in the \Labs\Lab06\Partial folder.</LI></P>

<P><LI>On the <B>Add-Ins</B> menu, click <B>Add-In Manager&#8230;</B></LI></P>

<P>The <B>Add-In Manager</B> dialog box appears.</P>
<P><LI>In the <B>Add-In Manager</B> dialog box, click the <B>VB 6 Class Builder Utility</B> and select the <B>Loaded/Unloaded</B> check box.</LI></P>

<P><LI>Click <B>OK</B> to close the <B>Add-In Manager</B> dialog box.</LI></P>
</ol>

<P><LI><B>To create the CReservation Class</B></LI></P>

<OL>
<P><LI>On the <B>Add-Ins </B>menu, click <B>Class Builder Utility&#8230;</B></LI></P>

<P>The <B>Class Builder Utility</B> appears.</P>
<P><LI>On the <B>Class Builder </B>toolbar, click <B>Add New Class</B>.</LI></P>

<P>The <B>Class Module Builder</B> dialog box appears.</P>
<P><LI>Click the <B>Properties</B> tab, then enter <B>CReservation</B> for the Name property.</LI></P>

<P><LI>Click <B>OK</B>.</LI></P>

<P><LI>Add the following four methods to the <B>CReservation </B>class module: <B>AddReservation</B>, <B>CheckIn</B>, <B>CheckOut</B>, and <B>CancelReservation</B>.</LI></P>

<P>Each method will be a Public Function with a Boolean return type. Arguments for these methods will be added in later labs.</P>


<P><LI>Add an event called <B>ResError</B>.</LI></P>

<P>The event will have two arguments: <B>Number</B> and <B>Description</B>. <B>Number</B> will be a Long data type passed by value. <B>Description</B> will be a String value passed by value.</P>
<P><LI>Add a MsgBox statement to each method in the class. Your code should look like to the following:</LI></P>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>Option Explicit
'To fire this event, use RaiseEvent with the following syntax:
'RaiseEvent ResError[(arg1, arg2, ... , argn)]
Public Event ResError(ByVal Number As Long, _
     ByVal Description As String)

Public Function CancelReservation() As Boolean
     MsgBox &quot;CancelReservation code will run here.&quot;
End Function

Public Function CheckOut() As Boolean
     MsgBox &quot;CheckOut code will run here.&quot;
End Function

Public Function CheckIn() As Boolean
     MsgBox &quot;CheckIn code will run here.&quot;
End Function

Public Function AddReservation() As Boolean
     MsgBox &quot;AddReservation code will run here.&quot;
End Function
</pre>
</td></tr>
</table>
</p>


<P><LI>Declare the following private variable in the General Declarations section of <B>frmReservation</B>.</LI></P>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>Private WithEvents Res As Creservation</pre>
</td></tr>
</table>
</p>
</ol>
<p>
<div class="note"><blockquote><b>NOTE</b><hr>
The WithEvents keyword specifies that the variable Res will be used to handle an object's events. You specify the kind of object by supplying the name of the class (CReservation) from which the object will be created.
</blockquote></div>
</p> 

<ol>
<P><LI value="9">In Load event of <B>frmReservation</B>, create an instance of <B>CReservation</B> as follows:</LI></P>

<p>
<table cellpadding=5 width="95%"><tr><td><pre>
Private Sub Form_Load()
     Set Res = New CReservation
     DisableControls
End Sub
</pre>
</td></tr>
</table>
</p>
</ol>	
<P><LI><B>To call the CReservation methods</B></LI></P>

<OL>
<P><LI>Above the DisableControls procedure in the <B>cmdDone_Click</B> event, call the <B>AddReservation</B> method of the Res object.</LI></P>

<P><LI>In the <B>mnuGuestReservationCheckIn_Click</B> event, call the <B>CheckIn</B> method of the Res object.</LI></P>

<P><LI>In the <B>mnuGuestReservationCheckout_Click</B> event, call the <B>CheckOut</B> method of the Res object.</LI></P>

<P><LI>In the <B>mnuGuestReservationCancel_Click</B> event, call the <B>CancelReservation</B> method of the Res object.</LI></P>

<P><LI>Save and test your application.</LI></P>

<P>Accept the default filename for the CReservation class module.</P>
</ol>

</BODY>
</HTML>





