<HTML>
<HEAD>
<TITLE>Lab: Debugging An Application</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch04d.htm", "ch04f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="253"><H1>Lab: Debugging an Application</H1></A>

<P>In this lab, you will be given a small application that contains syntax, run-time, and logic errors. Use the Visual Basic debugging tools to fix these problems. If you have difficulty implementing a solution for this lab, you can view the solution code provided in your \Labs\Lab04\Solution folder.</P>
<p>
<img src="images/video.gif" width=78 height=54 border="0">
</p>
<P>To see a demonstration of the solution, run the Lab04.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>


<b>Estimated lesson time: 35 minutes</b>


<P><LI><B>To open the Lab 4 project</B></LI></P>

<OL>
<P><LI>Start Visual Basic.</LI></P>

<P><LI>On the <B>New Project</B> dialog box, click the <B>Existing</B> tab.</LI></P>

<P><LI>Use the <B>Look in</B> drop-down list to browse to the prjDebug.vbp file located in the \Labs\Lab04\Partial folder, then click <B>Open</B>.</LI></P>
</OL>

<P><LI><B>To debug the Click event for Add Values</B></LI></P>

<OL>
<P><LI>On the <B>Run</B> menu, click <B>Start</B>.</LI></P>

<P><LI>Type <B>10</B> for the first value, then type <B>10</B> for the second value, then click <B>Add</B> <B>Values</B>.</LI></P>


<P>Notice that a compile error occurs, as illustrated in Figure 4.6. 
</P>

<P>
<img src="images/F04xx06.GIF" width=236 height=126 border="0">
</P><P>
<!--caption--><B>Figure 4.6</B> <i>Visual Basic Compile error dialog box</i>  <!--/caption-->
</P>


<P><LI>Click <B>OK</B> to close the <B>Compile error</B> dialog box, then correct the line of code that caused the compile error.</LI></P>

<P>The compile error description reads, &quot;Method or data member not found.&quot; This is because Text is an invalid property for a label. </P>
<P><LI>Change the label's property value in your code to correct this error.</LI></P>

<P><LI>On the <B>Run</B> menu, click <B>Start</B> to run the application again.</LI></P>

<P><LI>Type <B>10</B> for the first value, then type <B>10</B> for the second value, then click <B>Add</B> <B>Values</B>.</LI></P>

<P>Notice that a Type mismatch run-time error occurs, as illustrated in Figure 4.7. 
</P>

<P>
<img src="images/F04xx07.GIF" width=371 height=201 border="0">
</P><P>
<!--caption--><B>Figure 4.7</B> <i>The Visual Basic Run-time error dialog box</i>  <!--/caption-->
</P>


<P><LI>On the <B>Run-time error</B> dialog box, click <B>Debug</B> to correct this error.</LI></P>

<P>Because we want to assign the value of the <B>Result</B> variable to the <B>Caption</B> property of <B>lblResult</B>, the highlighted line of code illustrated in Figure 4.8 contains a logic error. </P>

<P>
<A HREF="javascript:fullSize('F04xx08x.htm')"> <img src="images/F04xx08.JPG" width=404 height=205 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><B>Figure 4.8</B> <i>Code statement highlighted in the Code window</i>  <!--/caption-->
</P>


<P><LI>Correct this logic error.</LI></P>

<P><LI>After you have fixed the logic and syntax errors, press <B>F5</B> to continue running the application.</LI></P>

<P>Notice that the results display as 1010 instead of 20, as illustrated in Figure 4.9. This is due to a logic error in the Click event for <B>Add Values</B>.</P>
</OL>

<P>
<img src="images/F04xx09x.gif" width=407 height=239 border=0> 
</P><P>
<!--caption--><B>Figure 4.9</B> <i>Invalid results displayed for Add Values</i>  <!--/caption-->
</P>


<P><LI><B>To use the Add Watch window</B></LI></P>

<OL>
<P><LI>Stop the application and, on the <B>Debug</B> menu, click <B>Add Watch. </B></LI></P>

<P>The <B>Add Watch</B> window appears.</P>
<P><LI>Create a watch expression that will cause the code to break when the value of the <B>Result</B> variable changes in the <B>cmdAddValues_Click</B> event. Set the properties shown in the <B>Add Watch</B> window illustrated in Figure 4.10.</LI></P>

<P>
<img src="images/F04xx10.GIF" width=384 height=277 border="0">
</P><P> 
<!--caption--><B>Figure 4.10</B> <I>The Add Watch window</I><!--/caption-->
</P>

<P><LI>Run and test the application by typing <B>10</B> for the first value, then type <B>10</B> for the second value, then click <B>Add</B> <B>Values</B>.</LI></P>

<P>The code will break when the value of the <B>Result</B> variable changes.</P>
<P><LI>When your code breaks, test the values of <B>txtFirstValue.Text</B>, <B>txtSecondValue.Text</B>, and <B>Result</B>.</LI></P>

<P>Test the text box values by holding your mouse over them or by using the <B>Immediate</B> window. Notice that the value of the text boxes are strings and the value of <B>Result</B> is numeric.</P>
<P><LI>Stop the application and correct the logic error in the Click event for <B>Add Values</B>.</LI></P>
</OL>

<P><LI><B>To debug the Subtract Values Click event</B></LI></P>

<OL>
<P><LI>On the <B>Run</B> menu, click <B>Start</B>.</LI></P>

<P><LI>Type <B>20</B> for the first value and <B>10</B> for the second value.</LI></P>

<P><LI>Click <B>Subtract</B> <B>Values</B> to test the Click event procedure.</LI></P>

<P>Notice that the result is displayed as 2010. This is the result of  a logic error in the subroutine.</P>
<P><LI>On the <B>Run</B> menu, click <B>End</B>.</LI></P>

<P><LI>To eliminate the logic error, change the code statement in the <B>Subtract Values </B>Click event procedure from an addition (+) to a subtraction (-).</LI></P>

<P><LI>After you have corrected the logic error, start the application, then type <B>20</B> for the first value and <B>hello</B> for the second value.</LI></P>

<P><LI>Click <B>Subtract Values</B> to test the Click event procedure.</LI></P>

<P>Notice that a type mismatch run-time error occurs.</P>
<P><LI>Click <B>Debug</B> to correct the code statement that caused the run-time error.</LI></P>

<P><LI>After you correct the code statement that caused the run-time error, press <B>F5</B> to continue running the application. </LI></P>

<P>If you have corrected the code statement properly, your results will display as 20, as illustrated in Figure 4.11.</P>

<P>
<img src="images/F04xx11x.gif" width=407 height=239 border=0> 
</P><P>
<!--caption--><B>Figure 4.11</B> <i>Results displayed after correcting Subtract Values</i>  <!--/caption-->
</P>


<P><LI>On the <B>Run</B> menu, click <B>End</B>.</LI></P>

<P><LI>Save and test your application.</LI></P>

<P>The solution provided in the \Labs\Lab04\Solution folder shows some techniques that you can use to prevent errors in your application. In Lab 5, you will learn how to prevent run-time errors using error handling.</P>
</OL>

</BODY>
</HTML>





