<HTML>
<HEAD>
<TITLE>Lesson 3: Using Visual Sourcesafe</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch01c.htm", "ch01e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="53"><H1>Lesson 3: Using Visual SourceSafe</H1></A>

<P>Software development in a team environment introduces concerns such as tracking file usage and loss of critical information, such as code, documents, data, etc. These concerns can detract and delay the development process. Microsoft Visual Source Safe (VSS), which is a version control system for team development of software applications, is a viable solution that lets you effectively manage project files. Version control systems track and store changes to a file so that developers can review a file's history, return to earlier versions of a file, and develop programs concurrently.</P>

<P>Visual Basic provides complete integration with VSS. This integration is included with the Professional and Enterprise Editions of Visual Basic. Although you can use Visual SourceSafe to mange software projects, you can also use it as version control software for all types of files including Word documents, Excel spreadsheets, text, graphics, and binary files.</P>

<p><div class="sidebar"><blockquote>
<b>After this lesson, you will be able to:</b>
<UL>

<p><li>State the advantages of using Visual SourceSafe.</li></p>

<p><li>Explain the installation options of Visual SourceSafe's main components.</li></p>

<p><li>Explain the use of commonly used commands.</li></p>

</UL>
<b>Estimated lesson time: 15 minutes</b>
</blockquote></div></P>

<A NAME="54"><H2>Overview of Visual SourceSafe</H2></A>

<P>With version control systems, you use a database to track, organize, and manage projects. These projects are a unit of organization, like a folder, and can contain various kinds of files, including code, graphics and documentation. You can create a VSS project to group together related files. For example, you can create a project in VSS to store a Visual Basic project file. All .frm, .vbp, .cls, .bas, and other files from your Visual Basic project can be included in the VSS project folder. VSS functions in a similar way as Windows Explorer in that project files can be organized into folders and subfolders. In addition, a single file can be shared among multiple projects within VSS.</P>

<P>Using VSS as your version control software offers several advantages:</P>

<ul>
<p><li>VSS maintains multiple versions of a file, including a record of the changes to the file from version to version. Using reverse delta technology, VSS has to store changes made to the file only when the file is checked in. (You check files out to work on them and then check the files back into VSS when you're not working on them.) This allows VSS to use disk space efficiently.</li></p>

<p><li>Only one person at a time can modify a file. This prevents accidental replacement of another user's changes. (Your SourceSafe administrator can change this default to allow multiple, simultaneous file check-outs.)</li></p>

<p><li>VSS can archive and track old versions of source code and other files. These files can be retrieved if necessary.</li></p>

<p><li>You can see the history of a source control project through the History command in the development environment. This tells you when the latest changes were made, by whom the changes were made, and what happened to the item each time it was checked in, starting from the time the item was first created.</li></p>
</ul>

<p>
<img src="images/practice.gif" width=67 height=55 border="0">
</p>

<A NAME="55"><H2>Practice: Adding Visual SourceSafe to Visual Basic</H2></A>

<P>In this practice you will integrate Visual SourceSafe into a Visual Basic project.</P>

<P><LI><B>To use Visual SourceSafe in Visual Basic</B></LI></P>

<ol>
<p><li>Start Visual Basic.</li></P>

<p><li>On the <B>New Project</B> dialog box, click <B>Standard EXE,</B> then click <B>Open</B>.</li></P>

<p><li>On the <B>Add-ins</B> menu, click <B>Add-in Manager</B>.</li></P>

<P>The <B>Add-in Manager</B> dialog box appears.</P>

<p><li>Click the <B>Source Code Control</B> add-in, then click the <B>Loaded/Unloaded</B> check box.</li></P>

<P>The word <B>Loaded</B> appears to the right of the add-in.</P>

<p><li>Click <B>OK</B> to close the <B>Add In</B> Manager dialog box.</li></P>
</ol>

<A NAME="56"><H2>Visual SourceSafe Components</H2></A>

<P>Visual SourceSafe consists of two components: the Visual SourceSafe Explorer (the user interface) and the Visual SourceSafe Database.</P>

<P>The Visual SourceSafe Explorer is the client component of VSS that is installed on each user's computer. It is the user's interface with the files stored in the Visual SourceSafe Database. It is similar to Windows Explorer in that its window is made up of two panes. The project's folder structure is on the left and the files listed in the selected folder on the right. The menu bar and toolbar allow the user to check files in and out of VSS easily.</P>

<P>The Visual SourceSafe Database is the central repository where master copies, history, project structures, and user information are stored. The Visual SourceSafe Database is installed on a server computer so that each client can access files stored in VSS. A project is always stored within one database. A database can house multiple projects, and multiple Visual SourceSafe databases can exist to store multiple projects.</P>

<A NAME="57"><H2>Managing Files in VSS</H2></A>

<P>Visual SourceSafe uses several commands to move files from the VSS database to the user's working directory. Common commands are Check Out, Check In, Undo Check Out, and Get Latest Version.</P>

<A NAME="58"><H3>Check Out</H3></A>

<P>The Check Out command copies one or more selected files from the current project in VSS into your current working directory so that you can modify them. You must have permission to use a file in VSS before you can check it out. The administrator sets file permissions in VSS. When you check out a file, a check mark appears to the left of the filename in the Visual Basic Project window, as shown in Figure 1.3. </P>

<P>
<img src="images/F01xx03.GIF" width=242 height=155 border=0>
</P><P>
<B>Figure 1.3</B> <i>Files checked out in the Visual Basic Project Explorer</i>
</P>

<A NAME="59"><H3>Check In</H3></A>

<P>When you finish editing the file, check it in to Visual SourceSafe using the Check In command. Checking in the file copies the modified file from your folder into Visual SourceSafe's database, making your changes accessible to other users. However, Visual SourceSafe stores all the changes that have been made to the file&#8212;the most recent copy is always available, but previous versions can be retrieved as well. Visual SourceSafe's reverse delta technology ensures that all versions of a file are available while minimizing use of disk space. </P>

<A NAME="60"><H3>Undo Check Out</H3></A>

<P>The Undo Check Out command cancels a Check Out operation. Any changes you made are lost. You must have a file checked out to use this command.</P>

<A NAME="61"><H3>Get Latest Version</H3></A>

<P>When you want to view a file or project, but not modify it, use the Get Latest Version command. Get Latest Version copies the file or project from the current project into a local folder referred to as the working folder. The file placed in your working folder is read-only, and any modifications you make are not saved in the VSS project.</P>

<A NAME="62"><H2>Reusing Visual SourceSafe Files</H2></A>

<P>In Visual SourceSafe you can reuse files within the same project or with other projects. Some of the commands used to reuse these files are Share, Branch, and Merge.</P>

<p>
<img src="images/video.gif" width=78 height=54 border="0">
</p>

<P>To see a demonstration, run the Chap01.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>

<A NAME="63"><H3>Sharing</H3></A>

<P>In VSS, one file can be shared among multiple projects. Changes to the file from one project are automatically seen by other projects sharing the file. To share a file, you create a share link between two projects. The file is then in two (or more) projects at the same time. When you check in the file to any one of the projects, your changes are automatically updated in all of the linked files. </P>

<P><LI><B>To share a file between multiple projects</B></LI></P>

<ol>
<p><li>In Visual SourceSafe, open the folder that will hold the shared file.</li></p>

<p><li>On the <B>SourceSafe</B> menu, click <B>Share...</B></li></p>

<P>The <B>Share With</B> dialog box appears.</P>

<p><li>Click the file that you wish to share, then click <B>Share</B>.</li></p>

<P>The shared file is added to the open folder. The icon to the left of the filename indicates that it is a shared file.</P>

<p><li>Click <B>Close</B>.</li></p>
</ol>

<P><LI><B>To display a list of all projects that share a specific file</B></LI></P>

<ol>
<p><li>In the VSS Explorer, click the filename.</li></p>

<p><li>On the <B>File</B> menu, click <B>Properties...</B></li></p>

<P>The <B>Properties</B> dialog box appears.</P>

<p><li>Click the <B>Links</B> tab to view the names of projects that share the file.</li></p>
</ol>

<A NAME="64"><H3>Branching</H3></A>

<P>VSS allows you to share files between projects; normally when you do this, only one version of the file exists. However, you might want to create a copy of the file for a customized version of an application that you create. For example, if you develop software in which code for each customer is the same, but you need to create a custom version of the software for a particular customer, you can use the VSS branching feature. Branching duplicates files from one project and uses the duplicates to create a new version of the project. These duplicate files can be altered without affecting the original version of the files.</P>

<P><LI><B>To branch a project file</B></LI></P>

<ol>
<p><li>In Visual SourceSafe, click the shared file you want to branch.</li></p>

<p><li>On the <B>SourceSafe</B> menu, click <B>Branch...</B></li></p>

<P>The <B>Branch</B> dialog box appears.</P>

<p><li>Type in a comment, then click <B>OK</B>.</li></p>

<P>The icon to the left of the filename changed to a normal icon.</P>
</ol>

<A NAME="65"><H3>Merging</H3></A>

<P>Merging is the process of combining differences in two or more changed copies of a file into a single, new version of the file. In VSS, a merge can occur in three different circumstances:</P>

<ol>
<p><li>Using multiple checkouts</li></p>

<P>If multiple users have checked out a file, the first user simply checks in the file. Subsequent users also check in the file, but their changes are merged with all other users' changes, and VSS retains all the modifications.</P>

<p><li>Explicitly merging previously branched files</li></p>

<P>When file branches are merged back into one of the branched projects, VSS takes the changes made along one line of the project and merges the changes with the other line.</P>

<p><li>Using Get Latest Version</li></p>

<P>VSS will allow you to merge the differences between an existing local copy of a file and the most up-to-date version of the file saved in the VSS database by using the Get Lastest Version command.</P>
</ol>

<P>When a merge occurs, VSS takes the file(s) with differences, compares the differences to the original file, and then creates a resulting file containing all the changes. For example, if you check in a file that causes a merge, the file on your hard disk and the file in the project are combined into a resultant file containing both sets of changes.</P>

<P><LI><B>To merge branched files</B></LI></P>

<ol>
<p><li>In VSS Explorer, click the shared file you want to branch.</li></p>

<p><li>On the <B>SourceSafe</B> menu click <B>Merge</B> <B>Branches...</B></li></p>

<P>The <B>Merge To</B> dialog box appears.</P>

<p><li>Click the project into which you want to merge your file.</li></p>

<P>The <B>Versions</B> column shows the version numbers you will be merging. </P>

<p><li>Click <B>Merge</B>.</li></p>
</ol>

<A NAME="66"><H2>Using Administration Tools</H2></A>

<P>The Visual SourceSafe Administrator is an easy way to preserve project data. Backing up project files takes only moments, but provides many benefits to both the server and the Visual SourceSafe application. For example, if your original files are damaged or lost, you can restore them from these archived files.</P>

<P>New to Visual SourceSafe 6.0 is the ability to archive and restore databases from the VSS Administrator wizard. In previous versions, all archiving and restoring was done from the command line. The VSS Administrator can open databases, archive information, and restore data from archived files.</P>

<A NAME="67"><H3>Opening SourceSafe Databases</H3></A>

<P>The VSS Administrator can manage multiple databases. Before you can archive or restore a database, it must be open in the VSS Administrator.</P>

<P><LI><B>To open a database</B></LI></P>

<ol>
<p><li>Open the <B>VSS Administrator</B>.</li></p>

<p><li>On the <B>Users</B> menu, click <B>Open SourceSafe Database...</B></li></p>

<P>The <B>Open SourceSafe Database</B> dialog box appears.</P>

<p><li>Click the name of the database to open in the list.</li></p>

<p><li>Click <B>Open</B> on the <B>Open SourceSafe Database</B> dialog box.</li></p>
</ol>

<P><DIV CLASS="NOTE"><BLOCKQUOTE><B>NOTE</b><HR>
If the database is not in the list, click the <B>Browse</B> button. Navigate to the srcsafe.ini file for an existing VSS database, then click the srcsafe.ini file. Click <B>Open</B> to add the database to the list.
</blockquote></div></P>

<A NAME="68"><H3>Archiving Projects</H3></A>

<P>Archiving databases lets you:</P>

<ul>
<p><li>Save disk space on the VSS database server.</li></p>

<p><li>Transport files and projects between VSS databases, keeping the history information intact.</li></p>

<p><li>Back up all or part of the VSS database to a compressed file.</li></p>
</ul>

<P><LI><B>To archive a database</B></LI></P>

<ol>
<p><li>Open <B>VSS Administrator</B>.</li></p>

<p><li>Open the database containing the information to be archived.</li></p>

<p><li>On the <B>Archive</B> menu, click <B>Archive Projects&#8230;</B></li></p>

<P>The <B>Archive Wizard</B> appears.</P>

<p><li>Click the names of the project(s) you want to archive.</li></p>

<p><li>Click <B>OK</B>, and then click <B>Next</B>.</li></p>

<P>Step 2 appears.</P>

<p><li>Specify how you want the project to be archived:</li></p>

<ul>
<p><li><b>Save data to file</B>&#8212;this overwrites existing files.</li></p>

<p><li><b>Save data to file, then delete the data from the database to save space</B>&#8212;this overwrites existing files.</li></p>

<p><li><b>Delete data permanently</B>&#8212;the <B>Archive</B> check box is disabled.</li></p>
</UL>

<p><li>Click <B>Next</B>.</li></p>

<P>Step 3 appears.</P>

<p><li>Specify the version of the data you'd like archived.</li></p>

<ul>
<p><li>To archive by version number, type the number in the <B>Version</B> box.</li></p>

<P><LI> To archive by label, type <B>L</B> followed by the label string.</li></p>

<P><LI> To archive by date, type <B>D</B> followed by a date string--for example, D11/26/98.</li></p>
</UL>

<p><li>Click <B>Finish</B>.</li></p>
</ol>

<A NAME="69"><H2>Lesson Summary</H2></A>

<P>Microsoft Visual Source Safe (VSS) is a version control system for team development of software applications that provides the following advantages:</P>

<ul>
<p><li>VSS can maintain multiple versions of a file, including a record of changes.</li></p>

<p><li>VSS can archive and track old versions of files. </li></p>

<p><li>Only one person at a time can modify a file. This prevents accidental changes and deletions.</li></p>

<p><li>Projects with multiple development platforms can have one code base.</li></p>

<p><li>Code modules can be reused.</li></p>
</ul>

<P>VSS has two components:</P>

<ul>
<p><li>VSS Explorer is the client application used to access VSS files; it is similar to Windows Explorer.</li></p>

<p><li>VSS Database is the central repository of master copies, history, project structure, and user information. All files related to one project are always contained within a single database. The VSS Database is stored on a server computer to allow clients to access the files stored in VSS.</li></p>
</ul>

<P>Use VSS commands to access and manage project files:</P>

<ul>
<p><li>Check Out lets you work offline on the master file. Other users cannot change the master file when it is checked out.</li></p>

<p><li>Check In returns a file to the database when it has been edited under the Check Out command. Your changes will appear in the master file.</li></p>

<p><li>Undo Check Out cancels a Check Out command without any changes.</li></p>

<p><li>Get Latest Version lets you work offline on a file, but you cannot save changes to the master file in the database.</li></p>

<p><li>Other VSS features include the capability to share a file between projects, archive files, and restore files.</li></p>
</ul>

</BODY>
</HTML>





