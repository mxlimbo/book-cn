<HTML>
<HEAD>
<TITLE>Lab: Creating the Chateau St. Mark User Interface</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">


</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch02f.htm", "ch02h.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="155"><H1>Lab: Creating the Chateau St. Mark User Interface</H1></A>

<P>In this lab, you will create the Chateau St. Mark hotel reservation application in Visual Basic. You will add controls and work with control arrays. In subsequent labs, you will continue to add to the hotel reservation application and explore each of the tasks you try here in more detail. The completed form will look like Figure 2.22.</P>

<p>
<img src="images/video.gif" width=78 height=54 border="0">
</p>

<P>To see a demonstration of the solution, run the Lab02.exe animation located in the Animations folder on the Supplemental Course Materials CD-ROM that accompanies this book.</P>


<b>Estimated lesson time: 55 minutes</b>

<P>
<A HREF="javascript:fullSize('F02xx22x.htm')"> <img src="images/F02xx22.JPG" width=404 height=319 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><B>Figure 2.22</B> <i>The Chateau St. Mark hotel reservation form</i>  <!--/caption-->
</P>


<A NAME="156"><H2>Exercise 1: Creating the User Interface</H2></A>

<P>In this exercise, you will create the user interface by adding controls to the Chateau St. Mark reservations form. Some of these controls will be implemented as control arrays.</P>

<P><LI><B>To create a new Visual Basic project</B></LI></P>

<OL>
<P><LI>Open a new <B>Standard EXE</B> project. Define the following project and form properties:</LI></P>
<P>
<table cellpadding=5 width="95%">
<TR>
<th valign="top">Object</th>
<th valign="top">Property</th>
<th valign="top">Value</th>
</TR>

<TR>
<TD>Project1</TD>
<TD>Name</TD>
<TD>HotelReservation</TD></TR>

<TR>
<TD>Form1</TD>
<TD>Name</TD>
<TD>frmReservations</TD></TR>

<TR>
<TD> </TD>
<TD>BorderStyle</TD>
<TD>1 - Fixed Single</TD></TR>

<TR>
<TD> </TD>
<TD>Caption</TD>
<TD>Chateau St. Mark Hotel</TD></TR>

<TR>
<TD> </TD>
<TD>MinButton</TD>
<TD>True</TD></TR>
</table>
</P>

<P><LI>Add the following controls to the form:</LI></P>

<P>
<table cellpadding=5 width="95%">
<TR>
<th valign="top">Control</th>
<th valign="top">Control Type</th>
<th valign="top">Property</th>
<th valign="top">Value</th>
</TR>

<TR>
<TD>Text1</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtFirstName</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;</TD></TR>

<TR>
<TD>Text2</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtLastName</TD></TR>

<TR>
<TD> </TD><TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;</TD></TR>

<TR>
<TD>Text3</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtAddress</TD></TR>

<TR>
<TD> </TD><TD> </TD>
<TD>Multiline</TD>
<TD>True
</TD></TR>

<TR>
<TD></TD><TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;
</TD></TR>

<TR>
<TD>Text4 </TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtPhone
</TD></TR>

<TR>
<TD> </TD><TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;
</TD></TR>

<TR>
<TD>Text5</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtNumPeople</TD></TR>

<TR>
<TD> </TD><TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;
</TD></TR>

<TR>
<TD>Text6</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtNumDays
</TD></TR>

<TR>
<TD> </TD><TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;
</TD></TR>

<TR>
<TD>Text7</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtCheckOut
</TD></TR>

<TR>
<TD> </TD><TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;
</TD></TR>

<TR>
<TD>Text8</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtRoomNumber</TD></TR>

<TR>
<TD> </TD><TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;
</TD></TR>

<TR>
<TD>Text9</TD>
<TD>TextBox</TD>
<TD>Name</TD>
<TD>txtRate</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Text</TD>
<TD>&lt;blank&gt;
</TD></TR>

<TR>
<TD>Frame1</TD>
<TD>Frame</TD>
<TD>Name</TD>
<TD>fraPmtType
</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Caption</TD>
<TD>Payment Type
</TD></TR>

<TR>
<TD>Command1</TD>
<TD>CommandButton</TD>
<TD>Name</TD>
<TD>cmdDone</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Caption</TD>
<TD>&amp;Done
</TD></TR></TABLE>
</P>
</OL>
<p><div class="note"><blockquote><b>NOTE</b><HR>
Use each control's TabIndex property to control the order in which the user will navigate through the form when pressing the Tab key.</blockquote></div></p>

<P><LI><B>To create control arrays</B></LI></P>

<OL>
<P><LI>On <B>frmReservation</B>, add the following three OptionButton controls to the Frame control by clicking <B>OptionButton</B> in the toolbox, and then drawing the controls inside of <B>fraPmtType</B>:</LI></P>
<P>
<table cellpadding=5 width="95%">

<TR>
<th valign="top">Control</th>
<th valign="top">Control Type</th>
<th valign="top">Property</th>
<th valign="top">Value</th>
</TR>

<TR>
<TD>Option1</TD>
<TD>OptionButton</TD>
<TD>Name</TD>
<TD>grpPmtType</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Index</TD>
<TD>0</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Caption</TD>
<TD>Credit Card</TD></TR>

<TR>
<TD>Option2</TD>
<TD>OptionButton</TD>
<TD>Name</TD>
<TD>grpPmtType
</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Index</TD>
<TD>1
</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Caption</TD>
<TD>Check</TD></TR>

<TR>
<TD>Option3</TD>
<TD>OptionButton</TD>
<TD>Name</TD>
<TD>grpPmtType
</TD></TR>
<TR>
<TD> </TD>
<TD> </TD>
<TD>Index</TD>
<TD>2
</TD></TR>
<TR>
<TD> </TD>
<TD> </TD>
<TD>Caption</TD>
<TD>Cash
</TD></TR></TABLE>
</P>

<P><LI>Add the appropriate labels for the textboxes on the hotel reservation form, as shown in Figure 2.22.</LI></P>
</ol>
<A NAME="157"><H2>Exercise 2: Adding Custom Controls to the Form</H2></A>

<P>In this exercise, you will add the Masked Edit and StatusBar Custom controls to the Chateau St. Mark reservation form. You will modify the properties of these controls at design time in the Properties Pages and programmatically at run time. The form with status bar is illustrated in Figure 2.23.</P>

<P><LI><B>To add ActiveX controls to your project and form</B></LI></P>

<OL>
<P><LI>On the <B>Project</B> menu, click <B>Components</B>.</LI></P>

<P><LI>Select the <B>Microsoft Windows Common Controls 6.0</B> and the <B>Microsoft Masked Edit Control 6.0 </B>check boxes.</LI></P>

<P><LI>Click <B>OK</B> to close the <B>Components</B> dialog box.</LI></P>

<P>The new controls appear in the toolbox.</P>
<P><LI>Add the following controls to the form and set their properties:</LI></P>

<P>
<table cellpadding=5 width="95%">
<TR><th valign="top">Control</th>
<th valign="top">Control Type</th>
<th valign="top">Property</th>
<th valign="top">Value</th>
</TR>

<TR>
<TD>MaskEdBox1</TD>
<TD>MaskedEdBox</TD>
<TD>Name</TD>
<TD>mskCheckIn</TD></TR>

<TR>
<TD> </TD>
<TD> </TD>
<TD>Mask</TD>
<TD>##-##-####</TD></TR>

<TR>
<TD>StatusBar1</TD>
<TD>StatusBar</TD>
<TD>Name</TD>
<TD>staAdditionalInfo</TD></TR>
</TABLE>
</P><P><LI>Add a Label control with the Caption property set to <B>Check-in Date</B>. Position the label to the left of the MaskEdBox control.</LI></P>
</OL>

<P><LI><B>To modify an ActiveX control's properties</B></LI></P>

<OL>
<P><LI>Right-click on the status bar and click <B>Properties</B>.</LI></P>

<P>The control's Property Pages appear.</P>

<P><LI>Click the <B>Panels</B> tab in the <B>StatusBar Property Pages</B> dialog box and set the following properties for Index 1:</LI></P>

<P>
<table cellpadding=5 width="95%">
<TR>
<th valign="top">Index 1 Property</th>
<th valign="top">Value</th>
</TR>
 
<TR>
<TD>ToolTip Text</TD>
<TD>The current time</TD>
</TR>

<TR>
<TD>Key</TD>
<TD>Time</TD>
</TR>

<TR>
<TD>Style</TD>
<TD>5 &#8212; sbrTime</TD>
</TR>

<TR>
<TD>Bevel</TD>
<TD>0 &#8212; sbrNoBevel</TD>
</TR></TABLE>
</P><P><LI>On the <B>Panels</B> tab, click the <B>Insert Panel</B> button.</LI></P>

<P><LI>Change the Index property to <B>2</B> by clicking the arrow to the right of the <B>Index</B> text box and setting the following properties:</LI></P>
<P>
<table cellpadding=5 width="95%">
<TR>
<th valign="top">Index 2 Property</th>
<th valign="top">Value</th>
</TR>
 
<TR>
<TD>ToolTip Text</TD>
<TD>The current date</TD>
</TR>

<TR>
<TD>Key</TD>
<TD>Date</TD>
</TR>

<TR>
<TD>Style</TD>
<TD>6 &#8212; sbrDate</TD>
</TR>

<TR>
<TD>Bevel</TD>
<TD>2 &#8212; sbrRaised</TD>
</TR></TABLE>
</P><P><LI>On the <B>Panels</B> tab, click <B>Insert Panel</B>.</LI></P>

<P><LI>Change the Index property to <B>3</B> by clicking the arrow to the right of the <B>Index</B> text box and setting the following properties:</LI></P>

<P>
<table cellpadding=5 width="95%">
<TR>
<th valign="top">Index 3 Property</th>
<th valign="top">Value</th>
</TR>

<TR>
<TD>ToolTip Text</TD>
<TD>Additional information</TD></TR>

<TR>
<TD>Key</TD>
<TD>addinfo</TD></TR>

<TR>
<TD>Style</TD>
<TD>0 - sbrText</TD></TR>

<TR>
<TD>Bevel</TD>
<TD>1 - sbrInset</TD></TR>

<TR>
<TD>AutoSize</TD>
<TD>1 &#8212; sbrSpring</TD></TR>
</TABLE>
</P><P><LI>Click <B>OK</B>. </LI></P>
</OL>

<P>
<A HREF="javascript:fullSize('F02xx23x.htm')"> <img src="images/F02xx23.JPG" width=404 height=304 border=0 ALT = "Click to view at full size."> </A>
</P><P>
<!--caption--><B>Figure 2.23</B> <i>Form layout with StatusBar</i>  <!--/caption-->
</P>


<P><LI><B>To add text to the StatusBar panel</B></LI></P>

<OL>
<P><LI>Double-click one of the option buttons in the <B>Payment Type</B> frame.</LI></P>

 <p>The following procedure appears:</p>

<table cellpadding=5 width="95%"><TR><TD>
<PRE>
Private Sub grpPmtType_Click(Index As Integer)

End Sub
</PRE>
</td></tr></table>  

<P><LI>Add the following code to the <B>grpPmtType_Click</B> event procedure:</LI></P>

<table cellpadding=5 width="95%"><TR><TD>
<PRE>
Private Sub grpPmtType_Click(Index As Integer)
      Select Case Index
            Case 0    'Credit card
                 staAdditionalInfo.Panels(&quot;addinfo&quot;).Text = _
                      &quot;Visa, Master Card or American Express accepted.&quot;
            Case 1    'Check
                 staAdditionalInfo.Panels(&quot;addinfo&quot;).Text = _
                      &quot;Picture ID and check guarantee card required.&quot;
            Case 2    'Cash
                 staAdditionalInfo.Panels(&quot;addinfo&quot;).Text = _
                      &quot;Hotel's do not carry a lot of extra change.&quot;
     End Select
End Sub
</PRE>
</td></tr></TABLE>
<P><LI>Save your application to the \Labs\Lab02\Partial folder. Save the project as Hotelres.vbp. Save the form as Frmrsvn.frm. </LI></P>

<P><LI>Run and test the application.</LI></P>
</OL>

<A NAME="158"><H2>Exercise 3: Adding a Menu Bar</H2></A>

<P>In this exercise, you will use the Menu Editor to create a menu bar for the Chateau St. Mark hotel reservation form. You will add code to the Click event of the Exit menu item.</P>

<P><LI><B>To add a menu to the project</B></LI></P>

<OL>
<P><LI>Click the <B>frmReservation</B> form.</LI></P>

<P><LI>On the <B>Tools</B> menu, click <B>Menu Editor</B>, or click the <B>Menu Editor</B> button on the toolbar.</LI></P>

<P><LI>In the <B>Caption</B> text box, enter <B>&amp;File</B>.</LI></P>

<P>The ampersand (&amp;) provides an access key to the menu.</P>
<P><LI>In the <B>Name</B> text box, enter <B>mnuFile. </B>This is the name that you will use to refer to the menu control in code. Figure 2.24 illustrates the menu in the Menu Editor.</LI></P>

<P>
<img src="images/F02xx24.GIF" width=366 height=366 border=0>
</P><P>
<!--caption--><B>Figure 2.24</B> <i>Menu Editor showing reservation application menu</i>  <!--/caption-->
</P>


<P><LI>Repeat steps 3 and 4 to create the following menu structure:</LI></P>


<P>
<table cellpadding=5 width="95%">
<TR>
<th valign="top">Menu Item</th>
<th valign="top">Property</th>
<th valign="top">Value</th>
</TR>

<TR>
<TD>File</TD>
<TD>Caption</TD>
<TD>&amp;File</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>MnuFile</TD></TR>

<TR>
<TD><blockquote>Exit</blockquote></TD>
<TD>Caption</TD>
<TD>E&amp;xit</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuFileExit</TD></TR>
<TR>

<TD>Guest</TD>
<TD>Caption</TD>
<TD>&amp;Guest</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuGuest</TD></TR>

<TR>
<TD><blockquote>Reservation</blockquote></TD>
<TD>Caption</TD>
<TD>&amp;Reservation</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuGuestReservation</TD></TR>

<TR>
<TD><blockquote><blockquote>Add</blockquote></blockquote></TD>
<TD>Caption</TD>
<TD>&amp;Add</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuGuestReservationAdd</TD></TR>

<TR>
<TD><blockquote><blockquote>Check-In</blockquote></blockquote></TD>
<TD>Caption</TD>
<TD>Check-&amp;In</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuGuestReservationCheckIn</TD></TR>

<TR>
<TD><blockquote><blockquote>Check-Out</blockquote></blockquote></TD>
<TD>Caption</TD>
<TD>Check-&amp;Out</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuGuestReservationCheckOut</TD></TR>

<TR>
<TD><blockquote><blockquote>Cancel Reservation</blockquote></blockquote></TD>
<TD>Caption</TD>
<TD>&amp;Cancel Reservation</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuGuestReservationCancel</TD></TR>
<TR>
<TD><blockquote>Search</blockquote></TD>
<TD>Caption</TD>
<TD>&amp;Search</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuGuestSearch</TD></TR>

<TR>
<TD>Help</TD>
<TD>Caption</TD>
<TD>&amp;Help</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuHelp</TD></TR>

<TR>
<TD><blockquote>Contents</blockquote></TD>
<TD>Caption</TD>
<TD>&amp;Contents...</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>mnuHelpContents</td>
</TR>

<TR>
<TD><blockquote>About</blockquote></TD>
<TD>Caption</TD>
<TD>&amp;About</TD></TR>

<TR>
<TD> </TD>
<TD>Name</TD>
<TD>MnuHelpAbout</TD></TR>
</TABLE>
</P>
<P><LI>Click <B>Ok</B> to close the Menu Editor.</LI></P>
</OL>

<P><LI><B>To add code to menu items</B></LI></P>

<OL>
<P><LI>On the <B>Forms</B> menu, click <B>File</B>, and then click <B>Exit</B>.</LI></P>

<P>The <B>mnuFileExit_Click</B> event appears.</P>
<P><LI>Add the Unload method to the <B>mnuFileExit_Click</B> event. For example:</LI></P>

<table cellpadding=5 width="95%"><TR><TD>
<PRE>
Private Sub mnuFileExit_Click()
      Unload Me
End Sub
</PRE>
</td></tr></TABLE>
<P><LI>Save and test the application.</LI></P>
</OL>



</BODY>
</HTML>





