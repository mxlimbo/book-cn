<HTML>
<HEAD>
<TITLE>Lab 14: Packaging and Deploying the STUpload Application</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch14f.htm", "ch14h.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="577"><H1>Lab 14: Packaging and Deploying the STUpload Application</H1></A>

<p>This lab finishes the STUpload project, bundling it into an installation program
named Setup. When executed on the client's system, the Setup program decompresses
data stored in a .cab file, copies STUpload's executable files to the hard disk,
and registers the application's components. In this lab, you will:</p>

<ul>
<p><li> Create a release version of STUpload.</li></p>

<p><li> Create an InstallShield project for the installation program.</li></p>

<p><li> Add dependencies to the installation project.</li></p>

<p><li> Build and test a Setup program and .cab files.</li></p>
</ul>


<p>The exercises assume that the customer, StockWatch Data Services Inc., maintains a
large network connecting members of its staff. The deployed package will therefore be
copied to the network, allowing users to run the Setup program and install STUpload on
their individual computers.</p>

<p>As mentioned in <a href="ch14c.htm#547">Lesson 2</a> of this chapter, the Learning and Standard Editions of
Visualç‡™++ do not include the InstallShield tool, but you can purchase the tool
separately. If you do not have access to InstallShield, you should still follow along
with the text, but you will not be able to complete Exercises 2 through 4.</p>

<p><b>Estimated lesson time: 15 minutes</b></p>


<A NAME="578"><H2>Building a Release Version of STUpload</H2></A>

<p>Now that STUpload has been debugged and thoroughly tested, you are ready to create a
release version of the program. The release version is smaller and faster than the
debug version created in the previous chapter, because the compiler does not add symbol
information to the object files, and also because the compiler optimizes the code to
reduce its size.</p>

<p><li> <b>To create a release build optimized for size</b></li></p>

<ol>
<p><li> Open the STUpload project in Visual C++.</li></p>

<p><li> On the <b>Build</b> toolbar, select the <b>Win32 Release</b> build context as
shown in Figure