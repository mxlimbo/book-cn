<HTML>
<HEAD>
<TITLE>Lesson 3: Accessing the Registry</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch06c.htm", "ch06e.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="252"><H1>Lesson 3: Accessing the Registry</H1></A>

<p>The Windows registry is a central, hierarchically organized database that holds
persistent configuration information for the operating system and for applications. On
Windows NT, Windows 95, and Windows 98, the registry provides a secure alternative to
the .ini configuration files used by 16-bit Windows platforms. In this lesson, you will
learn how to use the registry to save and retrieve user settings for a Windows
application.</p>

<p>
<div class="sidebar"><blockquote>
<b>After this lesson, you will be able to:</b>


<ul>
<p><li> Recognize the registry's basic organizational structure.</li></p>

<p><li> Understand how MFC supports programmatic access to the registry and how you can
use these features to store and retrieve application settings.</li></p>

<p><li> Describe the circumstances under which you might use the Win32 API to access the
registry, and the principal functions that enable you to perform this action.</li></p>
</ul>


<b>Estimated lesson time: 40 minutes</b>
</blockquote></div>
</p>


<A NAME="253"><H2>Registry Data</H2></A>

<p>The registry is used to store configuration information for the operating system and
settings for applications. It is used to store everything from the IP address of
installed network cards to the Regional Settings found in the Control Panel to the view
mode (Scientific or Standard) of the Windows calculator. As a result, the registry
typically contains at least several megabytes of data.</p>

<p>To facilitate manipulating such large amounts of data, the logical view of the
registry is that of a hierarchy. While the underlying physical structure of the files
constituting the registry is different under Windows NT than under Windows 95 and
Windows 98, the Win32 API hides these differences from users and developers by
providing a consistent interface for storing and retrieving registry settings. However,
before attempting to programmatically manipulate the registry, you should become
familiar with the registry hierarchy. A good way to do that is through the <i>registry
editor</i>.</p>

<p>The registry editor for Windows 95 and Windows 98 is <i>regedit.exe</i>, which can
be found in the Windows directory. Windows NT users will find an additional registry
editor&#8212;<i>regedt32.exe&#8212;</i>in the Winnt\System32 directory. Regedt32.exe has
some additional features useful under Windows NT. (It is able to set security for
registry keys and to view or edit the <b>REG_EXPAND_SZ</b> and <b>REG_MULTI_SZ</b> data
types.) Most users prefer the search features of regedit, but for exploration under
Windows NT, the read-only mode of regedt32 affords the beginning programmer an added
level of protection against accidentally corrupting the registry.</p>

<p>
<div class="caution"><blockquote><b>CAUTION</b><hr>
Improper editing of your registry entries could cause your
applications to stop working, and could even permanently cause your operating system to
become unavailable. Before editing the registry, you should first back up the registry
files. With Windows