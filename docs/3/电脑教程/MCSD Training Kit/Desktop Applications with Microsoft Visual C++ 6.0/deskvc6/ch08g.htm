<HTML>
<HEAD>
<TITLE>Lab 8: Using the OLE/COM Object Viewer</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch08f.htm", "ch08h.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="352"><H1>Lab 8: Using the OLE/COM Object Viewer</H1></A>

<p>In this lab, you will become familiar with aspects of implementing COM objects and
ActiveX controls. You will use the OLE/COM Object Viewer to browse through the registry
and you will inspect both a COM object and an ActiveX control.</p>

<p><li><b>To open the OLE/COM Object Viewer</b></li></p>

<ol>
<p><li>Start Visual Studio.</li></p>

<p><li>On the <b>Tools</b> menu, click <b>OLE/COM Object Viewer</b>.</li></p>

<p><li>On the <b>View</b> menu, click <b>Expert Mode</b>. Then scroll down the list of
folders at the left of the Viewer until you find the folder labeled <b>All
Objects</b>.</li></p>

<p><li>Click the plus sign at the left of this folder to obtain a list of all the
COM objects and ActiveX controls appearing in the registry. Some entries appear as
GUIDs. Other entries use string names.</li></p>
</ol>

<p><li><b>To browse a COM object</b></li></p>

<ol>
<p><li>Scroll down the list of entries until you find <b>ADODB.Connection</b>.
This object is the <b>ADO Connection</b> object that you will use in Lab 10.</li></p>

<p><li>Click the <b>ADO Connection</b> object. Information about the object's
registry entries appears in the right pane. Note the <b>InprocServer32</b> entry, which
contains the path to the DLL that implements the object.</li></p>

<p><li>Click the plus sign at the left of this folder to obtain a list of all the
interfaces supported by this COM object. The viewer should look like Figure 8.13.</li></p>

<p>
<A HREF="javascript:fullSize('f08DA13x.htm')"> <img src="images/f08DA13.jpg" width=404 height=303 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 8.13</b> <i>The OLE/COM Object Viewer</i><!-- /caption -->
</p>

<p>Several interfaces appear in this list. The <b>IUnknown</b> interface supports
interface pointer retrieval. By implementing the <b>IDispatch</b> interface, scripting
languages, such as VBScript, can access this COM object. The interface 
that clients use most frequently is the <b>_Connection</b> interface. This
interface contains methods that allow you to connect to a data source.</p>

<p><li>Click the <b>_Connection</b> interface. This action causes information about the
interface to appear in the panel at the right.</li></p>

<p>If you look under the <b>CLSID</b> entry in the panel at the right, you see that
the <b>InprocServer32</b> entry is <i>oleaut32.dll</i>&#8212;the Windows Automation
marshaler. The use of the Automation marshaler to marshal this interface means that you
have to use Automation-compatible types (types that can be packaged as a <b>
VARIANT</b>) when passing arguments to and return values from any method supported by
this interface.</p>

<p>Below the <b>TypeLib</b> entry, you find the <b>win32</b> key set to
&quot;C:\Program Files\ Common Files\ADO\MSADO15.DLL&quot;. This indicates that the
type library is linked to the server DLL.</p>

<p>Double click the <b>_Connection</b> interface. In response, you see the <b>Default
Interface Viewer</b> dialog box.</p>

<p><li>In the <b>Default Interface Viewer</b> dialog box, click <b>View Type
Info</b>.</li></p>

<p><li>In the <b>ITypeInfo Viewer</b> dialog box, click the plus sign at the left of
the Methods folder.</li></p>

<p><li>Scroll down the list of methods until you find the <b>Open</b> method.</li></p>

<p><li>Click the <b>Open</b> method.</li></p>

<p><li>In the panel at the right, you see detailed information about the method, as
shown in Figure 8.14.</li></p>

<p>
<A HREF="javascript:fullSize('f08DA14x.htm')"> <img src="images/f08DA14.jpg" width=404 height=291 border=0 ALT="Click to view at full size."> </A>
</p><p>
<!-- caption --><b>Figure 8.14</b> <i>The ITypeInfo Viewer</i><!-- /caption -->
</p>

<p>The first entry that you see is the dispatch identifier. Next, you see the
arguments that your client application provides for this method. Note the use of 
Automation-compatible data types.</p>

<p><li>Close the <b>ITypeInfo Viewer</b> dialog box.</li></p>

<p><li>In the <b>Default Interface Viewer</b> dialog box, click <b>Close</b>.</li></p>

<p><li>Click the minus sign to the left of the <b>ADODB.Connection</b> entry in the
OLE/COM Object Viewer.</li></p>
</ol>

<p><li><b>To browse an ActiveX control</b></li></p>

<ol>
<p><li>Scroll down the entries at the left of the OLE/COM Object Viewer until you find
the <b>Microsoft ADO Data Control</b>.</li></p>

<p><li>Click the entry named <b>Microsoft ADO Data Control</b>. At the right side of
the Viewer, you see detailed information about this control.</li></p>

<p><li>Under the CLSID, you see the <b>InprocServer32</b> defined as &quot;[system
directory]\MSADODC.OCX&quot;. ActiveX controls typically reside in files that end with
the extension .ocx. (However, these files are DLLs.)</li></p>

<p><li>At the right side of the Viewer, you should see the key name <b>Control</b>. The
inclusion of this key is another strong indicator that you are viewing an ActiveX
control.</li></p>

<p><li>Click the plus sign at the left of the <b>Microsoft ADO Data Control</b> entry
in the left panel of the Viewer.</li></p>

<p><li>You see a large number of interfaces supported by this entry. This list includes
all the interfaces that most ActiveX control containers expect an ActiveX control to
support.</li></p>

<p><li>Double click the <b>IAdodc</b> interface beneath the <b>Microsoft ADO Data
Control</b> entry.</li></p>

<p><li>In the <b>Default Interface Viewer</b> dialog box, click <b>View Type
Info</b>.</li></p>

<p><li>Click the plus sign at the left of the Methods folder in the <b>ITypeInfo
Viewer</b> dialog box to expand the Methods folder.</li></p>

<p><li>Click any of the methods in the Methods folder. The dispatch identifier and the
method signature appear in the panel at the right of the <b>ITypeInfo Viewer</b> dialog
box.</li></p>

<p><li>Close the <b>ITypeInfo Viewer</b> dialog box.</li></p>

<p><li>On the <b>Default Interface Viewer</b> dialog box, click <b>Close</b>.</li></p>

<p><li>Close the OLE/COM Object Viewer.</li></p>
</ol>

</BODY>
</HTML>







