 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --Delphi中的图形显示技巧</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='143' HEIGHT='50' ALT='电脑报' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/issue/all.html'>2000 年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->35期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{Delphi中的图形显示技巧}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{Delphi中的图形显示技巧}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　目前在许多学习软件、游戏光盘中，经常会看到各种图形显示技巧，凭着图形的移动、交错、雨滴状、百页窗、积木堆叠等显现方式，使画面变得更为生动活泼，更能吸引观众。本文将探讨如何在Delphi中实现各种图形显示技巧。 
      <br>
      　　 一、基本原理<br>
      　　 在Delphi中，实现一副图像的显示是非常简单的，只要在Form中定义一个TImage组件，设置其picture属性，然后选择任何有效的.ICO、.BMP、.EMF或.WMF文件，进行Load，所选文件就显示在TImage组件中了。但这只是直接将图形显示在窗体中，毫无技巧可言。为了使图形显示具有别具一格的效果，可以按下列步骤实现： 
      <br>
      　　1．定义一个TImage组件，把要显示的图形先装入到TImage组件中，也就是说，把图形内容从磁盘载入内存中，作为图形缓存。 <br>
      　　2．创建一新的位图对象，其尺寸跟TImage组件中的图形一样。 <br>
      　　3．利用画布(Canvas)的CopyRect功能(将一个画布的矩形区域拷贝到另一个画布的矩形区域)，使用一定技巧，动态形成位图文件内容，然后在窗体中显示位图。<br>
      　　二、实现方法<br>
      　　下面介绍各种图形显示技巧： <br>
      　　1.推拉效果 <br>
      　　将要显示的图形由上、下、左、右方向拉进屏幕内显示，同时将屏幕上原来的旧图覆盖掉，此种效果可分为四种，上拉、下拉、左拉、右拉，但原理都差不多，以上拉效果为例。 
      <br>
      　　原理：首先将放在暂存图形的第一条水平线搬移至要显示的位图的最后一条，接着再将暂存图形的前两条水平线，依序搬移至要显示位图的最后两条水平线，然后搬移前三条、前四条...直到全部图形数据搬完为止。在搬移的过程中即可看到显示的位图由下而上浮起，而达到上拉的效果。 
      <br>
      　　程序算法： <br>
      　　procedure TForm1.Button1Click(Sender: TObject); <br>
      　　var <br>
      　　newbmp: TBitmap; <br>
      　　i,bmpheight,bmpwidth:integer; <br>
      　　begin <br>
      　　newbmp:= TBitmap.Create; <br>
      　　newbmp.Width:=image1.Width; <br>
      　　newbmp.Height:=image1.Height; <br>
      　　bmpheight:=image1.Height; <br>
      　　bmpwidth:=image1.Width; <br>
      　　for i:=0 to bmpheight do <br>
      　　begin <br>
      　　newbmp.Canvas.CopyRect(Rect <br>
      　　(0,bmpheight－i,bmpwidth,bmpheight), <br>
      　　image1.Canvas, <br>
      　　Rect(0,0,bmpwidth,i)); <br>
      　　form1.Canvas.Draw(120,100,newbmp); <br>
      　　end; <br>
      　　newbmp.free; <br>
      　　end; <br>
      　　2.垂直交错效果 <br>
      　　原理：将要显示的图形拆成两部分，奇数条扫描线由上往下搬移，偶数条扫描线则由下往上搬移，而且两者同时进行。从屏幕上便可看到分别由上下两端出现的较淡图形向屏幕中央移动，直到完全清楚为止。 
      <br>
      　　程序算法： <br>
      　　procedure TForm1.Button4Click(Sender: TObject); <br>
      　　var <br>
      　　newbmp:TBitmap; <br>
      　　i,j,bmpheight,bmpwidth:integer; <br>
      　　begin <br>
      　　newbmp:= TBitmap.Create; <br>
      　　newbmp.Width:=image1.Width; <br>
      　　newbmp.Height:=image1.Height; <br>
      　　bmpheight:=image1.Height; <br>
      　　bmpwidth:=image1.Width; <br>
      　　i:=0; <br>
      　　while i&lt; =bmpheight do <br>
      　　begin <br>
      　　j:=i; <br>
      　　while j &gt;0 do <br>
      　　begin <br>
      　　newbmp.Canvas.CopyRect(Rect(0,j－1,bmpwidth,j), <br>
      　　image1.Canvas, <br>
      　　Rect(0,bmpheight－i＋j－1,bmpwidth,bmpheight－i＋j)); <br>
      　　newbmp.Canvas.CopyRect(Rect <br>
      　　(0,bmpheight－j,bmpwidth,bmpheight－j＋1), <br>
      　　image1.Canvas, <br>
      　　Rect(0,i－j,bmpwidth,i－j＋1)); <br>
      　　j:=j－2; <br>
      　　end; <br>
      　　form1.Canvas.Draw(120,100,newbmp); <br>
      　　i:=i＋2; <br>
      　　end; <br>
      　　newbmp.free; <br>
      　　end; <br>
      　　3.水平交错效果<br>
      　　同垂直交错效果原理一样，只是将分成两组后的图形分别由左右两端移进屏幕，程序算法从略。 <br>
      　　4.雨滴效果<br>
      　　原理：将暂存图形的最后一条扫描线，依序搬移到可视位图的第一条到最后一条扫描线，让此条扫描线在屏幕上留下它的轨迹。接着再把暂存图形的倒数第二条扫描线，依序搬移到可视位图的第一条到倒数第二条扫描线。其余的扫描线依此类推。 
      <br>
      　　程序算法： <br>
      　　procedure TForm1.Button3Click(Sender: TObject); <br>
      　　var <br>
      　　newbmp:TBitmap; <br>
      　　i,j,bmpheight,bmpwidth:integer; <br>
      　　begin <br>
      　　newbmp:= TBitmap.Create; <br>
      　　newbmp.Width:=image1.Width; <br>
      　　newbmp.Height:=image1.Height; <br>
      　　bmpheight:=image1.Height; <br>
      　　bmpwidth:=image1.Width; <br>
      　　for i:=bmpheight downto 1 do <br>
      　　for j:=1 to i do <br>
      　　begin <br>
      　　newbmp.Canvas.CopyRect(Rect(0,j－1,bmpwidth,j), <br>
      　　image1.Canvas, <br>
      　　Rect(0,i－1,bmpwidth,i)); <br>
      　　form1.Canvas.Draw(120,100,newbmp); <br>
      　　end; <br>
      　　newbmp.free; <br>
      　　end; <br>
      　　5.百叶窗效果<br>
      　　原理：将放在暂存图形的数据分成若干组，然后依次从第一组到最后一组搬移，第一次每组各搬移第一条扫描线到可视位图的相应位置，第二次搬移第二条扫描线，接着搬移第三条、第四条扫描线，其余扫描线依此类推。<br>
      　　程序算法： <br>
      　　procedure TForm1.Button6Click(Sender: TObject); <br>
      　　var <br>
      　　newbmp:TBitmap; <br>
      　　i,j,bmpheight,bmpwidth:integer; <br>
      　　xgroup,xcount:integer; <br>
      　　begin <br>
      　　newbmp:= TBitmap.Create; <br>
      　　newbmp.Width:=image1.Width; <br>
      　　newbmp.Height:=image1.Height; <br>
      　　bmpheight:=image1.Height; <br>
      　　bmpwidth:=image1.Width; <br>
      　　xgroup:=16; <br>
      　　xcount:=bmpheight div xgroup; <br>
      　　for i:=0 to xcount do <br>
      　　for j:=0 to xgroup do <br>
      　　begin<br>
      　　newbmp.Canvas.CopyRect(Rect <br>
      　　(0,xcount＊j＋i－1,bmpwidth,xcount＊j＋i), <br>
      　　image1.Canvas, <br>
      　　Rect(0,xcount＊j＋i－1,bmpwidth,xcount＊j＋i)); <br>
      　　form1.Canvas.Draw(120,100,newbmp); <br>
      　　end; <br>
      　　newbmp.Free; <br>
      　　end; <br>
      　　如有什么疑问，请发E－Mail给我：zxx@myrice.com 。<br>
      　　（曾小迅）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://www.cpcw.com/issue/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
