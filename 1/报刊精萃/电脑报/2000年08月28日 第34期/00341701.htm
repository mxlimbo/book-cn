 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --Delphi程序设计中的鼠标控制</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='143' HEIGHT='50' ALT='电脑报' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/issue/all.html'>2000 年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->34期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{Delphi程序设计中的鼠标控制}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{Delphi程序设计中的鼠标控制}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　在Windows环境下，鼠标和键盘是主要的输入设备。在Delphi中几乎每个对象都具有反映鼠标控制的事件，这些事件的主要功能包括改变鼠标指针的形状，移动、触发、拖动鼠标等。鼠标控制的三个相关属性是Cursor、DragCursor、DragMode；鼠标控制的三个对象方法是BeginDrag、Dragging、EndDrag；鼠标控制的七个事件包括OnDragDrop等。<br>
      　　一、改变鼠标指针的形状<br>
      　　改变鼠标指针的形状在Windows环境下是不可缺少的功能。当应用程序在执行一个较长时间的指令或动作时，我们可以改变鼠标指针的形状来通知用户程序执行的状态，等到执行的动作完成之后，再把鼠标指针的形状变回来。此外，在拖动的过程中我们也可以改变鼠标指针的形状，使拖动的过程更加清楚。<br>
      　　在编辑过程中，我们可以用属性Cursor和DragCursor改变鼠标指针的形状，前者是记录鼠标指针在对象上出现的情况；后者是设定对象被拖动时鼠标指针的形状。对于这两个属性，Delphi提供了如下值供用户选择：cdDefault、crArrow、cdCross、crBeam、crSize等十几个属性值。<br>
      　　二、鼠标的移动<br>
      　　鼠标移动时会触发事件OnMouseMove,语法如下：<br>
      　　procedure ObjectMouseMove(Sender:TObject;Shift:TshiftState;X,Y:Integer)<br>
      　　其中参数Sender代表目标对象，参数Shift代表鼠标移动时需同时按下的组合键，由{ssShift,ssAlt,ssCtrl,ssRight,ssLeft,ssMiddle,ssDouble}组成。此外，我们也可以利用参数X和Y取得鼠标移动的坐标位置，通常我们使用OnMouseMove事件时，最重要的就是这两个参数。<br>
      　　三、鼠标按键<br>
      　　鼠标按键在窗口环境中也是最重要的输入方法之一，同时还可以配合Shift,Alt,Ctrl三个键而发挥不同的作用。和鼠标按键有关的事件有OnMouseDown和OnMouseUp。当用户按下鼠标的一个键后，会触发OnMouseDown事件，其语法如下：<br>
      　　procedure ObjectMouseDown(Sender:TObject;Button:TMouseButton;Shift:TShiftState;X,Y:Integer);<br>
      　　参数Button指出按下的鼠标键是哪一个，可以是{mbLeft,mbRight,mbMiddle}三者之一。参数Shift可以反映按下的键盘键与鼠标的关系，其值是由{ssShift,ssAlt,ssCtrl,ssLeft，ssRight,ssMiddle,ssDouble}所组合而成的集合，这些参数值分别代表Shift，Alt，Ctrl键、鼠标的左、中、右键，及同时按下左右键。例如，同时按下鼠标的右键和Alt键，参数Shift的值就是{ssAlt,ssRight}。<br>
      　　四、鼠标的拖动<br>
      　　（一）启动拖动状态<br>
      　　拖动状态的方式及启动是根据属性DragMode值的设定而决定的，可以分成两类情况：<br>
      　　1．不必程序控制　如果DragMode的值是dmAutomatic，当鼠标左键一按，对象就自动进入拖动状态。<br>
      　　2．需要程序控制　如果DragMode的值是dmManual，要使对象进入拖动状态，可以调用方法BeginDrag。<br>
      　　此外，Delphi提供一个对象方法Dragging，让程序判断对象是否进入拖动状态。如果返回值是TRUE，代表已进入拖动状态，否则就是没有。要使对象进入拖动状态，可以调用对象方法BeginDrag。当对象进入拖动状态时，事件OnStartDrag会被触发，有关语法如下：<br>
      　　对象方法Dragging语法如下：<br>
      　　function Dragging:Boolean;<br>
      　　对象方法BeginDrag语法如下：<br>
      　　Procedure BeginDrag(Immediate:Boolean);<br>
      　　事件OnStartDrag语法如下：<br>
      　　Procedure ObjectStartDrag(Sender:TObject;Var DragObject:TDragObject);<br>
      　　（二）拖动中的事件<br>
      　　关于对象在拖动状态的事件有两个：OnDragDrop和OnDragOver。假设把对象A拖动并放入对象B中，此时对象B的事件OnDragDrop会被触发。其语法如下：<br>
      　　procedure ObjectDragDrop(Sender,Source:TObject;X,Y:Integer);<br>
      　　参数Sender和Source分别代表目标对象B及被拖动的对象A，参数X，Y代表拖动结束时的位置坐标，此坐标是以目标对象的坐标为参考的，而实际上拖动中的对象并不是真的移动，所以以X，Y的值将对象移到新的位置。<br>
      　　(三)停止拖动<br>
      　　如果要停止拖动，可以使用对象方法EndDrag来完成；其语法如下：<br>
      　　procedure ObjectEndDrag(Drop:Boolean);<br>
      　　参数Drop若是Ture，被拖动的对象将被放置于与目前所在的位置；否则，对象的拖动就被放弃，而回到原来的位置。例如下面的程序段就代表对象Lable1放弃拖动，并恢复原状：<br>
      　　Lable1.EndDrag(False);<br>
      　　而停止拖动会触发事件OnEndDrag，其语法如下：<br>
      　　Procedure ObjectEndDrag(Sender,Target:TObject;X,Y:Integer);<br>
      　　不管是放弃拖动或是对象已经拖动到目标对象，均会触发这个事件。参数Sender和Target分别指向被拖动对象及目标对象，但是如果拖动没有成功，则Target值为null。<br>
      　　对于上述的鼠标操作，我举一个例子。<br>
      　　例如模拟“鼠过留痕”（单击第一下鼠标，鼠标不管移动到哪里都会留下痕迹，单击第二下，就不再留下痕迹）。<br>
      　　unit Unit1;<br>
      　　interface<br>
      　　uses<br>
      　　Windows,Messages,SysUtils,Classes,Graphics,Controls,Forms,Dialogs;<br>
      　　type<br>
      　　TForm1=class(TForm)<br>
      　　procedure FormCreate(Sender:TObject);<br>
      　　private<br>
      　　{Private declarations}<br>
      　　public<br>
      　　{Public declarations}<br>
      　　end;<br>
      　　var<br>
      　　Form1:TForm1;<br>
      　　implementation<br>
      　　{＄R ＊.DFM}<br>
      　　var<br>
      　　Canvas:TCanvas;<br>
      　　Flag:Boolean;<br>
      　　procedure TForm1.FormCreate(Sender:TObject);<br>
      　　begin<br>
      　　Flag:=False;<br>
      　　end;<br>
      　　procedure TForm1FormMouseDown(Sender:TObject;Buttom:TMouseButton;Shift:TShiftState;X,Y:Integer);<br>
      　　begin<br>
      　　if Flag=False Then<br>
      　　　begin<br>
      　　　Canvas.MouseTO(X,Y);<br>
      　　　Flag:=Ture;<br>
      　　end;<br>
      　　else<br>
      　　　Flag:=false;<br>
      　　end;<br>
      　　procedure TForm1FormMouseDown(Sender:TObject;Buttom:TMouseButton;Shift:TShiftState;X,Y:Integer);<br>
      　　begin<br>
      　　if Flag=Ture Then<br>
      　　　begin<br>
      　　　Canvas.Pen.Color:=clBlack;<br>
      　　　Canvas.LineTO(X,Y);<br>
      　　end;<br>
      　　end;　　（湖北　许长才）}<!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="http://nethome.yesky.com/sp/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
