 
<HTML>
<!-- #BeginTemplate "/模板/software.dwt" --> 
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --用VB制作动画时钟</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='top'> 
    <TD WIDTH='100%'><IMG SRC='../../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
  <TR> 
    <TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
    <TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'> 
      <a href="http://chat.yesky.com" target="_blank"><img src="images/0823-3.gif" width="468" height="60" border="0"></a>
    </TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR> 
    <TD WIDTH='100%'><IMG SRC='../../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
  <TR VALIGN='bottom'> 
    <TD WIDTH='100%'><IMG SRC='../../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/index.html'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/all.html'>2000年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->40期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{用VB制作动画时钟}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
  <TR> 
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{用VB制作动画时钟}<!-- #EndEditable --> 
      》</SPAN></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" --> 
      <p>{　　大家都知道在Win 9X的“日期/时间”属性中有一个直观漂亮的动画时钟，那么我们自己能不能也做一个呢？当然答案是肯定的。VB以简单实用而著称，下面就介绍用VB来制作动画时钟：<br>
        　　1．如何画时钟表盘上的所有直线元素<br>
        　　用Load命令建立原始Line控件的14个拷贝(因为表盘有12个点和时、分、秒共15个Line)，该控件数组每一个实例的端点坐标属性设置为每条线在时钟表盘上的适当位置。这些拷贝中大多数只放置一次，而3个Line控件每秒钟更新一次，产生时钟指针移动的感觉。<br>
        　　注意：在应用程序代码中并没有直接擦除任何一条线。当我们改变每一个Line控制的端点时，每一根针在移动时擦除和重画的所有技术工作都由VB来处理。<br>
        　　2．如何修改时针的形状<br>
        　　通过调整代码中的属性设置，可以改变时钟的形状。例如:通过改变每一个Line控制的Borderwidth属性设置，可以建立更细或更粗的线。<br>
        　　3．计时器的Interval属性设置<br>
        　　计时器的Interval属性设置为10，即为1/100秒。<br>
        　　4.程序的编写与执行<br>
        　　（1）新建工程<br>
        　　先新建一个工程（工程类型为标准EXE），然后用“工具箱”中的工具加入一个timer1（计时器）和Line1（直线），其index（指针）分别设置为空和0。然后双击Form1窗体，输入源代码。<br>
        　　（2）程序源代码<br>
        　　DefDbl A－Z<br>
        　　Private Sub Form_Load()<br>
        　　timer1.Interval=100<br>
        　　Width=4000<br>
        　　Height=4000<br>
        　　Left=Screen.Width\2－2000<br>
        　　Top=(Screen.Height－Height)\2<br>
        　　End Sub<br>
        　　Private Sub Form_Resize()<br>
        　　Dim i, Angle</p>
      <p> Static flag As Boolean<br>
        　　If flag=False Then<br>
        　　flag=True<br>
        　　For i=0 To 14<br>
        　　′画出表盘12个点和时、分、秒共15个Line<br>
        　　If i&gt;0 Then Load Line1(i)<br>
        　　Line1(i).Visible=True<br>
        　　Line1(i).BorderWidth=5<br>
        　　Line1(i).BorderColor=RGB(0, 128, 0)　′设置Line的粗细和颜色<br>
        　　Next i<br>
        　　End If<br>
        　　For i=0 To 14<br>
        　　Scale (－1, 1)－(1, －1)<br>
        　　Angle=i ＊ 2 ＊ Atn(1)/3<br>
        　　Line1(i).X1=0.9 ＊ Cos(Angle)<br>
        　　Line1(i).Y1=0.9 ＊ Sin(Angle)<br>
        　　Line1(i).X2=Cos(Angle)<br>
        　　Line1(i).Y2=Sin(Angle)<br>
        　　Next i<br>
        　　End Sub<br>
        　　Private Sub timer1_Timer()<br>
        　　Const HH=0<br>
        　　Const MH=13<br>
        　　Const SH=14<br>
        　　Dim Angle<br>
        　　Static LS<br>
        　　If Second(Now)=LS Then Exit Sub<br>
        　　LS=Second(Now)<br>
        　　Angle=0.5236 ＊ (15－(Hour(Now)＋Minute(Now)/60))　′设置时针<br>
        　　Line1(HH).X1=0<br>
        　　Line1(HH).Y1=0<br>
        　　Line1(HH).X2=0.3 ＊ Cos(Angle)<br>
        　　Line1(HH).Y2=0.3 ＊ Sin(Angle)<br>
        　　Angle=0.1047 ＊ (75－(Minute(Now)＋Second(Now)/60))　′设置分针<br>
        　　Line1(MH).X1=0<br>
        　　Line1(MH).Y1=0<br>
        　　Line1(MH).X2=0.7 ＊ Cos(Angle)<br>
        　　Line1(MH).Y2=0.7 ＊ Sin(Angle)<br>
        　　Angle=0.5236 ＊ (75－Second(Now))<br>
        　　′设置秒针<br>
        　　Line1(SH).X1=0<br>
        　　Line1(SH).Y1=0<br>
        　　Line1(SH).X2=0.8 ＊ Cos(Angle)<br>
        　　Line1(SH).Y2=0.8 ＊ Sin(Angle)<br>
        　　form1.Caption=Str(date＋ time())<br>
        　　′窗口显示精确的日期和数字化的时间<br>
        　　End Sub<br>
        　　（3）程序的编译和执行<br>
        　　点击VB“运行”菜单中的“启动”或“全面编译”命令，即可对程序编译并运行！<br>
        　　注：上述程序在中文Windows 98和VB 6.0中文企业版下调试通过。（山东　何修华）}</p>
      <!-- #EndEditable --></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR> 
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
  </TR>
</TABLE>
<BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
  <TR ALIGN='center' VALIGN='bottom'> 
    <TD HEIGHT='6'><IMG SRC='../../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
  </TR>
</TABLE>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
  <TR ALIGN='center'> 
    <TD> 
      <script language="JavaScript" src="../../download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
