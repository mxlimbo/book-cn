<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>

<TITLE>电脑报电子版 -- 用C＋＋Builder编写发送电子邮件软件</TITLE>

<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span><A NAME='top'></A> 
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
    <TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='/issue/'>CPCW电子版</A> 
      &gt; <A HREF='/issue/2000/'>2000 年</A> &gt; <a href="index.html">06期</a> 
      &gt; <a href="software.html">软件世界</a>
      &gt;用C＋＋Builder编写发送电子邮件软件</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 用C＋＋Builder编写发送电子邮件软件
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>　　2000年第一期的《电脑报》刊登了题目为《自己动手编写电子邮件软件》的文章，文章讲述了如何用VB编写一个简单的电子邮件发送程序。其实，如果你是一个C＋＋Builder爱好者，完全可以更快、更简捷地编写出这类软件。请听我下文分解：<br>
      　　与E－mail密切相关的两个协议是POP3和SMTP，POP3是Post Protocol 3的缩写，用于从POP3服务器接收电子邮件，SMTP是Simple 
      Mail Transfer Protocol的缩写，用于通过SMTP服务器发送电子邮件。这两个协议本身是很复杂的，但C＋＋Builder从NetManage公司引进了POP、SMTP控件，这样，我们完全可以不去管那些收发邮件的机理，只要设置好这些控件就可以编出一个C＋＋Builder的发送邮件程序了。下面介绍SMTP控件：<br>
      　　SMTP控件位于控件栏的Internet页面上，名称为：NMSMTP。SMTP的主要属性有：<br>
      　　Host属性，用来指定SMTP服务器的主机名。<br>
      　　Port属性，用于指定SMTP服务器的端口号，一般设为25。<br>
      　　UserId属性，登录SMTP服务器时用于设置用户名。<br>
      　　PostMessage属性，此属性非常重要，从以下它的内容你就可以看出来了：<br>
      　　FromName 用于指定发件人的名称。<br>
      　　FromAddress 用于指定发件人的e－mail地址。<br>
      　　LocalProgram 用于指定发件人所使用的邮件客户程序。<br>
      　　ToAddress 收件人的地址。<br>
      　　Body 邮件正文。<br>
      　　Subject 邮件主题。<br>
      　　SMTP控件的方法：<br>
      　　Connect函数，用于登录到SMTP服务器，使用此函数前，Host、Port、UserId等属性必须已设好。<br>
      　　Disconnect函数，用于断开与SMTP服务器的连接。<br>
      　　SendMail函数，用于向SMTP服务器发送邮件。知道了这些，我们就可以写程序了。<br>
      　　新建应用程序，将工程名保存为sendmail，在Form1上加入NMSMTP控件，Host属性添入SMTP服务器的名称，如：“smtp.yeah.net”,UserId属性添入你在此邮箱申请的用户名,其它属性保持默认值；加入4个Label控件，将其Caption分别设为：“发件人名称”、“收件人地址”、“邮件主题”和“邮件正文”；加入4个Edit控件，将其Name分别设为：“Name1”、“Address1”、“Subject1”和“Body1”；一个SpeedButton控件，Caption为：“发送”(以上属性均不含引号)，Click事件代码为：<br>
      　　NMSMTP1－&gt;Connect();<br>
      　　NMSMTP1－&gt;PostMessageA－&gt;FromName=Name1－>Text;<br>
      　　NMSMTP1－&gt;PostMessageA－&gt;FromAddress=″superlink@yeah.net″;<br>
      　　NMSMTP1－&gt;PostMessageA－&gt;ToAddress－&gt;Add(Address1－&gt;Text);<br>
      　　NMSMTP1－&gt;PostMessageA－&gt;Subject=Subject1－&gt;Text;<br>
      　　NMSMTP1－&gt;PostMessageA－&gt;Body－&gt;Add(Body1－&gt;Text);<br>
      　　NMSMTP1－&gt;PostMessageA－&gt;LocalProgram=″SendMail″;<br>
      　　NMSMTP1－&gt;SendMail();<br>
      　　Application－&gt;MessageBoxA(″发送完成!″,″邮件系统″,MB_OK);<br>
      　　NMSMTP1－&gt;Disconnect();<br>
      　　完成！有人不禁要问：“就这么简单？”，的确就这么简单。不过，NMSMTP控件还有大量的功能没在此一一列出，同时还有NMPOP3控件可用来编写接收邮件的程序，如果喜爱C＋＋Builder的朋友感兴趣，完全可以写出象OutLook 
      Express、FoxMail这样的电子邮件软件。<br>
      <b> 　　（河北　冯增广）</b></TD>
  </TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> CPCW版权所有，<A HREF='mailto:webmaster@cpcw.com'>CPCW网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>