<HTML><!-- #BeginTemplate "/模板/software.dwt" -->
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=gb2312'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 --Powerbuilder开发中控制焦点转移几法</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><script language="JavaScript" src="http://ad.cpcw.com/js/hardware.js"></script></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='../../images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><a href='http://www.cpcw.com/issue/index.html'>CPCW电子版</a> 
      &gt; <a href='http://www.cpcw.com/issue/all.html'>2000年</a> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->04期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->{Powerbuilder开发中控制焦点转移几法}<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->{Powerbuilder开发中控制焦点转移几法}<!-- #EndEditable --> 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->{　　PowerBuilder（以下简称PB）是现在比较流行的客户／服务器模式应用程序开发工具，在实际应用开发过程中，如何能使操作键盘更快捷、更符合用户原来的操作习惯，实现起来并不容易，要通过PB的一些小技巧来实现，下面介绍方便用户控制焦点转移的二种方法。<br>
      　　一、窗口中命令控件(COMMADN BUTTON)间焦点切换用TAB键或SHIFT TAB组合键实现，选中控件用鼠标点击，用户在输入数据过程中很不方便。用户习惯用光标键移动控件按钮，按回车键选中控件，下面介绍实现这一用户需要的方法：<br>
      　　1.在窗口中定义局部外部函数(LOCAL EXTERNAL FUNCTIONS)keybd_event。<br>
      　　SUBROUTINE keybd_event(INT bvk,INT bscan,INT dwflags,＆ INT dwextrainfo)LIBRARY“user32.dll”<br>
      　　2.在窗口用户自定义事件key中写如下程序：<br>
      　　GRAPHICOBJECT cb_control／／定义环境变量<br>
      　　CHOOSE CASE KEY<br>
      　　CASE KEYRIGHTARROW!／／按光标右键右移焦点<br>
      　　keybd_event(9,0,0,0)<br>
      　　keybd_event(9,0,2,0)<br>
      　　CASE KEYDOWNARROW!／／按光标下移键右移焦点<br>
      　　keybd_event(9,0,0,0)<br>
      　　keybd_event(9,0,20)<br>
      　　CASE KEYLEFTARROW!／／按光标左键左移焦点<br>
      　　keybd_event(16,0,0,0)<br>
      　　keybd_event(9,0,0,0)<br>
      　　keybd_event(16,0,2,0)<br>
      　　keybd_event(9,0,20)<br>
      　　CASE KEYUPARROW!／／按光标上移键左移焦点<br>
      　　keybd_event(16,0,0,0)<br>
      　　keybd_event(9,0,0,0)<br>
      　　keybd_event(16,0,2,0)<br>
      　　keybd_event(9,0,2，0)<br>
      　　CASE KEYENTER!／／按回车键触发焦点处控件<br>
      　　cb_control=GETFOCUS()<br>
      　　IF TYPEOF(cb_control)=COMMANDBUTTON!THEN<br>
      　　TRIGGEREVENT(cb_control,clicked!)<br>
      　　END IF<br>
      　　END CHOOSE<br>
      　　二、PB中数据窗口输入栏目间的切换通过按TAB键或SHIFT TAB组合键实现，用ENTER键代TAB键实现焦点向后转移，很多资料介绍了实现方法，但用户仍然需用SHIFT 
      TAB组合键实现焦点向前转移，仍不方便，下面介绍一种用SHIFT键代替SHIFT TAB组合键，同时用ENTER键代替TAB键，并且在数据窗口末尾按ENTER键系统能自动追加数据行的方法(以下所有定义在数据窗口控件中进行)。<br>
      　　1.定义局部外部函数(LOCAL EXTERNAL FUNCTIONS)keybd_event，方法如下：<br>
      　　SUBROUTINE keybd_event(INT bvk,INT bscan,INT dwflags,＆ INT dwextrainfo)LIBRARY“user32.dll”<br>
      　　2.在用户定义事件(Use Events)中选择pbm_dwnkey并命名为press_shift，选择pbm_dwnprocessenter并命名为press_enter。<br>
      　　3.定义局部变量(Instance Variables)i,方法如下：<br>
      　　INTEGER i=0<br>
      　　4.在Itemfocuschanged用户事件中定义如下语句：<br>
      　　i=0<br>
      　　5.在用户定义事件press_shift中输入如下程序：<br>
      　　IF KEYDOWN(KEYSHIFT!)AND i=0 THEN<br>
      　　keybd_event(16,0,0,0)<br>
      　　keybd_event(9,0,0,0)<br>
      　　keybd_event(16,0,2,0)<br>
      　　keybd_event(9,0,2,0)<br>
      　　i=1<br>
      　　RETURN 1／／按shift键向前移焦点<br>
      　　END IFT<br>
      　　6.在用户自定义事件press_enter输入如下程序：<br>
      　　IF THIS.GETCOLUMN()=LONG (THIS.OBJECT.DATAWINDOW.COLUMN.COUNT)THEN<br>
      　　IF THIS.GETROW()=THIS.ROWCOUNT()THEN<br>
      　　THIS。INSERTROW(0)／／数据窗口末按ENTER键追加数据行<br>
      　　THIS.SCROLLTOROW(THIS.GETROW()＋1)<br>
      　　THIS.SETCOLUMN(1)<br>
      　　RETURN 1<br>
      　　END IF<br>
      　　END IF<br>
      　　SEND (HANDLE(THIS)，256，9，LONG(0，0))／／按ENTER键向后移焦点<br>
      　　RETURN 1}<!-- #EndEditable --></TD>
  </TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='../../images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>
      <script language="JavaScript" src="../../download/yeskye.js">
</script>
    </TD>
    <TD> <noscript></noscript> <a href='/'>《电脑报》版权所有</a>，<a href='mailto:webmaster@staff.yesky.com'>YESKY网站编辑部</a>设计制作发布</TD>
</TR>
</TABLE></BODY><!-- #EndTemplate --></HTML>